50 A$=RIGHT(DATE,5)
60 A1$=A$
70 A$=LEFT(A$,2)+RIGHT(A1$,1)
80 A$="COM."+A$+"-A"
90 OPEN A$ FOR SYMBOLIC RANDOM IO AS FILE 15
100 LOL 256
130 ON ERROR GOTO 190
160 GOTO 340
190 PRINT "ERROR"
220 PRINT "ERRCD:":ERRCD
250 REM
280 PRINT "IN LINE":ERRLN
310 END
340 DEF INTEGER EXTERNAL SIMPL  RH( INTEGER X)  AKA ".RH"
370 DEF INTEGER EXTERNAL SIMPL  LH( INTEGER X)  AKA ".LH"
400 DEF INTEGER EXTERNAL SIMPL  XWD( INTEGER ( L, R))  AKA ".XWD"
430 DEF INTEGER EXTERNAL        FILE.PARSE (STRING F, STRING A(*)) AKA "FL.PRS"
460 DEF LOGICAL EXTERNAL        ST.PER
490 DEF         EXTERNAL        EXITPE
520 DEF         EXTERNAL SIMPL  RUNUUO (STRING S, INTEGER I)
550 DEF INTEGER EXTERNAL SIMPL  FILE.DATE(STRING F)
580 DEF STRING  EXTERNAL        DT.CNV(INTEGER D)
610 DEF INTEGER EXTERNAL        JOBNO AKA  ".JOBNO"
640 DEF INTEGER EXTERNAL        INT.BOUNDS.1(*)(INTEGER A(*)) AKA"BND.AR"
670 DEF INTEGER EXTERNAL        REAL.BOUNDS.2(*)(REAL A(*,*)) AKA "BND.AR"
700 DEF LOGICAL EXTERNAL        FD.OPEN(STRING UFD.NAME)
730 DEF         EXTERNAL        FD.CLOSE
760 DEF LOGICAL EXTERNAL        FD.STEP
790 DEF         EXTERNAL        FD.EXACT(STRING (FILENAME, EXTENSION))
820 DEF         EXTERNAL        FD.WILD(STRING (FILENAME,EXTENSION))
850 DEF LOGICAL EXTERNAL        FD.QUERY
880 DEF         EXTERNAL        FD.SET(INTEGER (BUFFER.LENGTH,CONTROL.CODE))
910 DEF STRING  EXTERNAL        FD.NAME
940 DEF STRING  EXTERNAL        FD.EXT
970 DEF INTEGER EXTERNAL        FD.SIZE
1000 DEF INTEGER EXTERNAL        FD.LIC
1030 DEF INTEGER EXTERNAL        FD.DATE
1060 DEF INTEGER EXTERNAL        FD.STAT
1090 DEF LOGICAL EXTERNAL        IFTP
1120 DEF INTEGER EXTERNAL        SYSNO
1150 DEF STRING  EXTERNAL        GETPJC
1180 DEF         EXTERNAL        DISABLE AKA ".DISABLE"
1210 DEF         EXTERNAL        ENABLE AKA ".ENABLE"
1240 DEF          EXTERNAL        CENABLE AKA ".CENABLE"
1270 DEF STRING   EXTERNAL        GET.LOG.PPN AKA "GET.LO"
1300 DEF STRING   EXTERNAL        GET.GFD.PPN AKA "GET.GF"
1330 DEF STRING   EXTERNAL        GET.RUN.PPN AKA "GET.RU"
1360 DEF STRING   EXTERNAL        GET.PROG.NAM AKA "GET.PR"
1390 DEF STRING   EXTERNAL        F.CHR(INTEGER I)
1420 DEF  INTEGER EXTERNAL        F.ASC(STRING S)
1450 DEF  STRING  EXTERNAL        F.CHRA(INTEGER K(*))
1480 DEF  INTEGER EXTERNAL        F.ASCA(*)(STRING S)
1510 DEF  INTEGER EXTERNAL        QCKSRT(*)(INTEGER N.RECS)
1540 DEF  INTEGER EXTERNAL SIMPL ST.REG(INTEGER I)
1570 DEF          EXTERNAL SIMPL  STUFIB(STRING S)
1600 DEF INTEGER  EXTERNAL        ILOG.PPN
1630 DEF INTEGER  EXTERNAL        IGFD.PPN
1660 DEF INTEGER  EXTERNAL        IRUN.PPN
1690 DEF          EXTERNAL        SET.FLDOVF.CH(INTEGER CH.CODE) AKA ".FLDOC"
1720 DEF          EXTERNAL        BLANK.ZFP(LOGICAL DO.IT) AKA ".BLZFP"
1750 DEF          EXTERNAL        REPROMPT(LOGICAL DO.NOT) AKA ".REPRO"
1780 DEF INTEGER  EXTERNAL        CNC(INTEGER INX)
1810 DEF          EXTERNAL        WCNC(INTEGER(INX,VALUE))
1840 DEF STRING   EXTERNAL        CN$
1870 DEF          EXTERNAL        WCN$(STRING F$)
1900 DEF          EXTERNAL        WPICK(STRING F$)
1905 REM CALL DISABLE
1930 SNAME$="NEWADV"
1960 E$="DAT"
1990 CALL NCHECK
2020 IF A<>1 THEN PRINT "SORRY YOU MUST HAVE TWO FILES ON YOUR SYSTEM TO PLAY:"
2050 IF A<>1 THEN PRINT "RUN FILER.SHR"
2080 IF A<>1 THEN PRINT "YOU MAY RUN MY 'FILER' PROGRAM TO GET THEM."
2110 IF A<>1 THEN STOP "BYE BYE!"
2140 DEF INTEGER  EXTERNAL        SORT(IN$,OUT$,COM$)
2170 PRINT "HELLO. WELCOME TO MY WORLD."
2175 PRINT "HELLO, YOU CAN SELL ITEMS TO THE MERCHANT NOW..MORE MODS SOON."
2200 A=295,B=87
2230 DIM M(824,10)
2235 DIM TTYPE(30)    ! THIS IS THE LIST OF TREASURES (BY NCODE)
2260 DIM NHITS(A)
2290 DIM GETTN(B)
2320 DIM NHITSII(A)
2350 DIM MLOC(B)
2380 DIM NLOC(A)
2410 DIM VERB$(60),VCODE(60)
2440 DIM NOUN$(A)
2470 DIM NCODE(A)
2500 DIM MONEXP(B)
2530 DIM NUMHITS(A)
2560 DIM MALIGN(A)
2590 DIM PREP$(5)
2620 DIM ADJECT$(34)
2650 DIM ADMOD$(7)
2680 DIM APOINT(A)
2710 DIM APMOD(A)
2740 DIM SLOC(824)
2770 DIM DFLAG(100) !****** DFLAG!!
2800 DIM NDAM(A)
2830 DIM MMOV(A)
2860 DIM PRICE(B)
2890 DIM WORD$(10)
2920 DIM CLOC(6)
2950 DIM PLOC(6)
2980 DIM HP(6)
3010 DIM HPTOTAL(6)
3040 DIM S(6)
3070 DIM D(6)
3100 DIM C(6)
3130 DIM II(300)
3160 DIM W(6)
3190 DIM CH(6)
3220 DIM AC(6)
3250 DIM GOLD(A)
3280 DIM EXPERIENCE(6)
3285 DIM CWEP(6)   ! WEAPON IN HAND FOR CHARACTERS
3310 DIM TBIL(6,6)
3330 DIM G.VIC(6)               !REM TELSS PLAYERS I THE GNOME FIGHTS
3335 D.ATT=0,VI=0,GC=0,GP=1,GPP=1,GWEP=12
3337 DIM GMAD(6)      ! ** IS THE GNOME MAD AT A CHARACTER
3340 DIM PMESSAGE(6)            ! TELLS IS HE GOT PCIKED
3345 DIM CURSE(6)    ! THIS IS THE CURSE ARRAY 
3370 DIM NAME$(6)
3375 DIM RANK$(5)
3400 DIM RACE$(6)
3410 DIM MASTERRANK$(4,17)
3430 DIM CLASS$(6)
3460 DIM FPOOL(6)
3490 DIM TNUM(6)
3520 DIM ALIGN$(6)
3550 DIM PASS$(6)
3580 DIM LEVEL(6)
3610 DIM ONUM(6)
3640 DIM LSORCE(6)        !THIS IS CHARACTERS LAMP ON FLAG!
3670 DIM MANA(6),MANATOTAL(6)
3700 DIM MSPELL$(27),MSLEVEL(27)
3730 DIM SACT(6,27),SGOAL(6,27),SCOUNT(6,27)
3760 DIM ASLEEP(295)
3790 DIM GONE(6)
3820 DIM EGOAL(4,10)
3850 DIM REGOAL(4)
3880 DIM ALLPRINT(A)
3910 REM *** READ IN-PROGRAM DATA
3940 OPEN "NEWADV.DAT-A" FOR BINARY IO AS FILE 1
3970 MAT INPUT FROM 1:M
4000 MAT INPUT FROM 1:VERB$
4030 MAT INPUT FROM 1:VCODE
4060 MAT INPUT FROM 1:ADJECT$
4090 MAT INPUT FROM 1:ADMOD$
4120 MAT INPUT FROM 1:NOUN$
4150 MAT INPUT FROM 1:NLOC
4180 MAT INPUT FROM 1:PREP$
4210 MAT INPUT FROM 1:GETTN
4240 MAT INPUT FROM 1:NHITS
4245 MAT NHITSII=NHITS
4270 MAT INPUT FROM 1:NDAM
4300 MAT INPUT FROM 1:NCODE
4330 MAT INPUT FROM 1:SLOC
4360 MAT INPUT FROM 1:MLOC
4390 MAT INPUT FROM 1:MMOV
4420 MAT INPUT FROM 1:EGOAL
4450 MAT INPUT FROM 1:REGOAL
4480 MAT INPUT FROM 1:NUMHITS
4510 MAT INPUT FROM 1:APOINT
4540 MAT INPUT FROM 1:APMOD
4570 INPUT FROM 1:GOLD(11:A)
4600 MAT INPUT FROM 1:MONEXP
4630 MAT INPUT FROM 1:PRICE
4660 MAT INPUT FROM 1:MALIGN
4810 INPUT FROM 1:TURN
4840 CLOSE 1
4870 SNAME$="SCENAR"
4900 E$="IO"
4930 CALL NCHECK
4960 IF A=0 THEN CALL SCENARIOS
4965 CALL SCENARIOR
4980 CALL GOLDINIT
4990 MAT READ TTYPE
4991 MAT READ MSPELL$
4992 MAT READ MSLEVEL
4994 READ MASTERRANK$(1:3,1:11)
4995 READ MASTERRANK$(4,1:17)
4996 DIM M.AC(17),M.DAM(17)
4997 MAT READ M.AC,M.DAM
5020 REM ********************************************************
5050 REM **     THIS IS MASTER CONTROL STATION
5080 REM ** FIRST CALL ADDCHARACTER
5110 REM ********************************************************
5140 REM ** FIRST CALL ADDPLAYER TO ADD CHARACTERS IN **
5170 CALL ADDPLAYER
5175 MAT WRITE ON 15:NAME$,CLASS$
5176 WRITE ON 15 IN FORM "R":DATE
5200 IF CNUM=1 THEN CNUM2=1
5230 IF CNUM=1 THEN P=CLOC(1)
5260 IF CNUM=1 THEN CALL PRINTER
5320 REM ** START CHARACTER LOOP GIVING EACH PLAYER 2 TURNS
5350 FOR CNUM2=1 TO CNUM6
5355 IF CNUM5>0 THEN CNUM2=CNUM5
5380 IF HP(CNUM2)<1 THEN GOTO 6850
5410 REM ** BUT IF CHARACTER'S LOC IS NONEXISTENT SKIP HIM
5440 IF CLOC(CNUM2)<1 THEN GOTO 6850
5470 REM *** IF ASLEEP THEN SKIP
5500 IF ASLEEP(CNUM2)<>0 THEN
5530 IF ASLEEP(CNUM2)=1 THEN PRINT NAME$(CNUM2):" IS ASLEEP."
5532 IF ASLEEP(CNUM2)>0 AND GONE(CNUM2)=1 THEN
5534         PRINT "BEING ASLEEP :":NAME$(CNUM2):" FALLS FROM THE WALL."
5535 IF CLASS$(CNUM2)="MONK" THEN GOTO 5548
5536         DAM=INT(RND(0)*5)+1
5538         PRINT "HE TAKES ":DAM:" POINTS OF DAMAGE."
5540         IF HP(CNUM2)-DAM<1 THEN
5542                 S(CNUM2)=0
5544                 CALL QDONE
5546                 ENDIF
5548         ENDIF
5560 IF ASLEEP(CNUM2)=2 THEN PRINT NAME$(CNUM2):" IS PARALYZED."
5590 A=INT(RND(0)*19)+1
5620 IF A>(C(CNUM2)-12)+10 THEN A=0 ELSE A=-1
5650 IF A=0 THEN ASLEEP(CNUM2)=0
5680 IF A=0 THEN PRINT NAME$(CNUM2):" RECOVERED HIS CONSCIOUSNESS."
5710 ENDIF
5740 IF ASLEEP(CNUM2)<>0 THEN GOTO 6850
5770 IF CNUM=1 THEN GOTO 6100
5800 REM ** PRINT HIS NAME AND TELL HIM IT IS HIS TURN
5830 PRINT FOR I=1 TO 2
5860 PRINT NAME$(CNUM2):" IT IS *YOUR* ":
5890 PRINT CHARTABLE(7):FOR I=1 TO 5
5920 PRINT "TURN."
5950 IF PMESSAGE(CNUM2)<>0 THEN
5980 PRINT
6010 PRINT "YOU WERE RECENTLY PICK POCKETED BY ":NAME$(PMESSAGE(CNUM2))
6040 PMESSAGE(CNUM2)=0
6070 ENDIF
6072 IF G.VIC(CNUM2)>0 THEN
6074 PRINT "THE GNOME JUST ATTACKED A ":NOUN$(G.VIC(CNUM2)):"!"
6076 G.VIC(CNUM2)=0
6078 ENDIF
6100 REM ** LET HIM KNOW WHERE HE IS ... **
6130 CALL SREGULAR
6160 CALL CHANGEOVER
6190 IF CNUM>1 THEN CALL PRINTER
6220 IF CNUM4=1 THEN
6250 PRINT "IT IS NOW YOUR TURN----->":NAME$(CNUM2)
6280 CNUM4=0
6310 ENDIF
6340 REM ** START TURNS **
6370 REM *********************
6400 REM *HERES WHERE WE FIGURE HOW MANY TURNS THE DUFUS GETS!
6430 TNUM(CNUM2)=0
6460 TNUM(CNUM2)=TNUM(CNUM2)+INT(D(CNUM2)/4)
6490 IF NLOC(172)=-CNUM2 THEN TNUM(CNUM2)=TNUM(CNUM2)+4
6492 IF CLASS$(CNUM2)="MONK" THEN TNUM(CNUM2)=TNUM(CNUM2)+(INT(LEVEL(CNUM2))/2)
6495 IF TNUM(CNUM2)<1 THEN TNUM(CNUM2)=2
6520 FOR NUMTURN=1 TO TNUM(CNUM2)
6550 CALL CHANGEOVER
6580 REM ** IF HE DIED DURING HIS TURN THEN SCREW HIM !
6610 IF NHITS(CNUM2)<1 THEN GOTO 6850
6640 CALL PARSER ! SEND HIM OFF!
6670 CALL CHANGEBACK !RETURN CHARACTER STATS
6700 CALL DFLAGSTAT
6720 G=277
6721 CALL HOBBIT !!!!!!!!!!!
6730 NEXT NUMTURN
6760 REM ** HE'S DONE NOW FIX THE OTHER CHARACTERS **
6780 IF P=16 THEN A=1 ELSE A=4
6790 IF TURN/A=INT(TURN/A) AND HP(CNUM2)<HPTOTAL(CNUM2) THEN HP(CNUM2)=HP(CNUM2)+1
6820 IF TURN/5=INT(TURN/5) AND MANA(CNUM2)<MANATOTAL(CNUM2) THEN MANA(CNUM2)=MANA(CNUM2)+1
6830 CALL GNOME
6835 CALL MMOVE
6850 NEXT CNUM2
6885 CALL RES.SUB
6910 TURN=TURN+1
6940 REM ** ALL CHARACTERS ARE DONE LET'S DO IT AGAIN
6970 GOTO 5320
7000 REM ************************************************************
7030 DEFINE ADDPLAYER
7060 REM **
7090 REM **        WE ARE GOING TO ADD SOME PLAYERS INTO THE GAME
7120 REM **
7150 REM **       UP TO SIX MAXIMUM
7180 REM **     SEE FORMAT
7210 REM **
7240 REM ************************************************************
7270 PRINT "IF YOU NEED IN STRCUTIONS REFER TO MY 'INSTRU' FILE."
7300 PRINT "DO YOU WANT TO STOP AND ROLL UP A CHARACTER":
7330 INPUT Y$
7360 IF Y$="P" THEN CALL PRINTN
7390 IF Y$="Y" OR Y$="YES" THEN END
7420 PRINT "GOOD."
7450 PRINT "WHAT IS YOUR CHARACTERS NAME?":
7480 INPUT IN FORM"R":SNAME$
7510 E$="ADV"
7540 CALL NCHECK
7570 IF A=0 THEN PRINT "SORRY, BUT I CANNOT FIND YOUR FILE... "
7600 IF A=0 THEN GOTO 7300
7630 CNUM=CNUM+1
7660 CNUM3=CNUM3+1,CNUM6=CNUM6+1
7690 OPEN SNAME$+".ADV-A" FOR SYMBOLIC RANDOM IO AS FILE CNUM
7720 NOUN$(CNUM)=SNAME$
7750 REM ** READ IN DATA **
7780 NUM$="DDDDDDD"
7810 INPUT FROM CNUM IN FORM NUM$:S(CNUM)
7815 A=0
7840 IF S(CNUM)<1 THEN
7850 PRINT "THAT CHARACTER IS DEAD."
7855 IF S(CNUM)<1 THEN END "TRY AGAIN SUCKER"
7860 CLOSE CNUM
7870 CNUM3=CNUM3-1
7880 CNUM=CNUM-1
7890 A=1
7900 ENDIF
7960 IF A=1 THEN GOTO 9580
7990 INPUT FROM CNUM IN FORM NUM$:D(CNUM)
8020 INPUT FROM CNUM IN FORM NUM$:C(CNUM)
8050 INPUT FROM CNUM IN FORM NUM$:II(CNUM)
8080 INPUT FROM CNUM IN FORM NUM$:W(CNUM)
8110 INPUT FROM CNUM IN FORM NUM$:CH(CNUM)
8140 INPUT FROM CNUM IN FORM NUM$:HP(CNUM)
8170 INPUT FROM CNUM IN FORM NUM$:HPTOTAL(CNUM)
8200 INPUT FROM CNUM IN FORM NUM$:AC(CNUM)
8230 INPUT FROM CNUM IN FORM NUM$:GOLD(CNUM)
8260 INPUT FROM CNUM IN FORM NUM$:CLOC(CNUM)
8290 NLOC(CNUM)=CLOC(CNUM)
8320 INPUT FROM CNUM IN FORM NUM$:PLOC(CNUM)
8350 INPUT FROM CNUM IN FORM NUM$:EXPERIENCE(CNUM)
8380 INPUT FROM CNUM IN FORM NUM$:LEVEL(CNUM)
8410 FOR I=1 TO 8
8440 INPUT FROM CNUM IN FORM NUM$:DUMMY
8470 IF DUMMY>0 THEN NLOC(DUMMY)=-CNUM
8500 NEXT I
8530 INPUT FROM CNUM IN FORM NUM$:MANA(CNUM)
8560 INPUT FROM CNUM IN FORM NUM$:MANATOTAL(CNUM)
8590 FOR I=1 TO 5
8620 INPUT FROM CNUM IN FORM NUM$:TBIL(CNUM,I)
8650 NEXT I
8680 INPUT FROM CNUM IN FORM NUM$:GONE(CNUM)
8710 INPUT FROM CNUM IN FORM NUM$:FPOOL(CNUM)
8715 INPUT FROM CNUM IN FORM NUM$:CWEP(CNUM)
8740 REM **** GET STRINGS NOW ***
8770 AA=0
8800 A$=""
8830 MAT WORD$=""
8860 INPUT FROM CNUM IN FORM "X":I$
8890 IF ASC(I$)=13 THEN GOTO 8860
8920 IF I$="@" THEN GOTO 9040
8950 IF I$="*" THEN GOTO 9040
8980 A$=A$+I$
9010 GOTO 8860
9040 AA=AA+1
9070 WORD$(AA)=A$
9100 A$=""
9130 IF I$="*" THEN GOTO 9190
9160 GOTO 8860
9190 PRINT "WHAT IS THE PASSWORD FOR THE CHARACTER?":
9220 CLOSE CNUM
9250 INPUT IN FORM "R":Y$
9280 IF Y$<>WORD$(5) THEN CLOSE CNUM
9310 IF Y$<>WORD$(5) THEN CNUM=CNUM-1
9340 IF Y$<>WORD$(5) THEN PRINT "SORRY , THAT'S NOT IT!"
9370 IF Y$<>WORD$(5) THEN GOTO 7450
9400 NAME$(CNUM)=SNAME$
9430 RACE$(CNUM)=WORD$(2)
9460 CLASS$(CNUM)=WORD$(3)
9490 ALIGN$(CNUM)=WORD$(4)
9520 PASS$(CNUM)=WORD$(5)
9525 RANK$(CNUM)=WORD$(6)    ! RANK
9550 IF CNUM=6 THEN GOTO 9700
9580 PRINT "WOULD YOU LIKE TO ADD ANOTHER CHARACTER?":
9610 INPUT IN FORM "R":Y$
9640 IF LEFT(Y$,1)="Y" THEN GOTO 7450
9670 REM 7360!
9700 REM HEY! DON'T FORGET 16000
9730 ENDF ADDPLAYER
9760 DEFINE PARSER
9790 REM **********************************************************
9820 REM **
9850 REM **      SPLIT UP INPUT INTO WORDS YOU TURDS!
9880 REM **
9910 REM **********************************************************
9940 AA=1
9970 MAT WORD$=" "
10000 CIB
10030 PRINT "]":
10060 INPUT IN FORM "X":I$
10065 IF TURN.ON<>1 THEN GOTO 11079
10090 IF I$="%" THEN INPUT A
10120 IF I$="%" THEN PRINT "THE ":NOUN$(A):" HAS ":MONEXP(NCODE(A)):" XP. POINTS"
10150 IF I$="&" THEN MAT PRINT MSPELL$
10180 IF I$=";" THEN PRINT "PP ":PP,"P :":P
10185 IF I$="-" THEN
10187 PRINT "HOW MANY EXPERIENCE DO YOU NEED?":
10189 INPUT A
10191 EXPERIENCE(CNUM2)=EXPERIENCE(CNUM2)+A
10193 ENDIF
10210 IF I$="@" THEN INPUT A1
10212 IF I$="@" THEN PRINT "MMOV(":A1:")=":MMOV(A1):"."
10240 IF I$="@" THEN PRINT "THE ":NOUN$(A1):" IS AT ":NLOC(A1)
10270 IF I$="!" THEN INPUT A1
10300 IF I$="!" THEN PRINT "WHERE DO YOU WANT TO PUT THE ":NOUN$(A1)
10330 IF I$="!" THEN INPUT A2
10360 IF I$="!" THEN NLOC(A1)=A2
10390 IF I$="+" THEN PRINT "NNUM:":NNUM,"VNUM:":VNUM,"INUM:":NNUM1
10420 IF I$="+" AND VNUM<1 THEN GOTO 10480 
10450 IF I$="+" THEN PRINT VERB$(VNUM):"-VERB"
10480 IF I$="+" AND NNUM<1 THEN GOTO 10540 
10510 IF I$="+" THEN PRINT NOUN$(NNUM):"-NOUN"
10540 IF I$="+" AND NNUM1<1 THEN GOTO 10600
10570 IF I$="+" THEN PRINT NOUN$(NNUM1):"-INDIRECT OBJECT."
10600 IF I$="<" THEN
10602         INPUT A
10604         INPUT CLOC(A)
10606         INPUT PLOC(A)
10608         ENDIF
10630 IF I$="*" THEN PRINT "YOU HAVE ":HP(CNUM2):" HITS OUT OF ":HPTOTAL(CNUM2)
10660 IF I$="-" THEN PRINT "GONE(CNUM2)=":GONE(CNUM2)
10690 IF I$=":" THEN PRINT "WHERE DO YOU WANT TO GO?"
10720 IF I$=":" THEN INPUT A
10750 IF I$=":" THEN P=A
10780 IF I$=":" THEN PRINT "YOU HAVE BEEN TELEPORTED TO ":A
10785 IF I$="'" THEN PRINT "LSORCE ARRARY=":LSORCE(1:6)
10810 IF I$="$" THEN PRINT "HOW MANY HIT POINTS DO YOU NEED?":
10840 IF I$="$" THEN INPUT HP(CNUM2),HPTOTAL(CNUM2)
10870 IF I$="$" THEN NHITS(CNUM2)=HP(CNUM2)
10872 IF I$=">" THEN
10874 PRINT "ENTER SECRET PASSWORD:":
10876 INPUT IN FORM "R":P$
10878 IF P$="SAURON" THEN
10880 SPELL.TEST=1 
10882 PRINT "CONGRATS TO YOU."
10884 ENDIF
10886 ENDIF
10900 IF I$="/" THEN
10930 PRINT "YOUR TURN TOTAL IS ":TNUM(CNUM2):"."
10960 ENDIF
10990 IF I$="?" THEN
11020 PRINT "GC:":GC:"   "
11050 ENDIF
11060 REM ****** THAT IS END OF TEST FUNCTIONS!!!! *********
11079 REM ****** THAT IS END OF TEST FUNCTIONS!!!! *********
11080 IF ASC(I$)=13 AND LENGTH(A1$)<1 THEN GOTO 10000
11110 IF ASC(I$)<>13 AND I$<>" " AND I$<>"," THEN A1$=A1$+I$
11140 IF I$="=" THEN PRINT "CNUM:":CNUM,"CNUM2:":CNUM2,"CNUM3:":CNUM3
11170 IF ASC(I$)=13 THEN GOTO 11260
11200 IF I$=" " THEN GOTO 11260
11230 GOTO 10060
11260 WORD$(AA)=A1$
11290 A1$=""
11320 IF WORD$(AA)="THE" THEN AA=AA-1
11350 AA=AA+1
11380 IF ASC(I$)=13 THEN GOTO 11440
11410 GO TO 10060
11440 REM DONE
11470 REM *********************************************************
11500 REM *****     SEARCH WORD LISTS FOR RECOGNIZABEL WORDS
11530 REM *****
11560 REM **********************************************************
11590 IF WORD$(1)="END@" THEN END
11595 IF WORD$(1)="SPELL" OR WORD$(1)="SPELLS" THEN PRINT MSPELL$(I),MSLEVEL(I) FOR I=1 TO 27
11596 IF WORD$(1)="DAVID+STAFFORD" THEN TURN.ON=1
11597 IF WORD$(1)="ABCDEFG" THEN TURN.ON=0
11620 VNUM=0,NNUM=0
11650 INUM=0
11680 PNUM=0,INUM=0,IANUM=0
11710 NNUM1=0,PNUM=0,ANUM=0
11740 REM SEARCH FOR VERB AND THEN NOUN
11770 FOR I=1 TO 60
11800 IF WORD$(1)=VERB$(I) THEN VNUM=I
11830 NEXT I
11860 CALL ADJSEARCH
11890 IF B=0 THEN CALL ADMSEARCH
11920 IF VNUM<1 THEN B=B-1
11950 FOR I=1 TO 295
11980 IF WORD$(B+2)=NOUN$(I) THEN NNUM=I
12010 IF NNUM>0 THEN GOTO 12100
12040 NEXT I
12070 IF ANUM<1 AND NNUM<1 THEN B=B-1
12100 FOR I=1 TO 5
12130 IF WORD$(B+3)=PREP$(I) THEN PNUM=I
12160 NEXT I
12190 CALL ADJSEARCH5
12220 FOR I=1 TO 295
12250 REM **    INDIRECT OBJECTS
12280 IF WORD$(B+4)=NOUN$(I) THEN NNUM1=I
12310 IF NNUM1>0 THEN GOTO 12370
12340 NEXT I
12370 REM HEY HEY HEY
12400 CALL INDIRECTSEARCH
12405 IF NNUM<1 THEN GOTO 12460
12430 IF VNUM<1 AND NNUM>0 AND NLOC(NNUM)=NLOC(CNUM2) THEN CALL EOBJECT
12431 IF VNUM<1 AND NNUM>0 AND NLOC(NNUM)=-CNUM2 THEN CALL EOBJECT
12460 IF VNUM<1 AND NNUM>0 THEN GOTO 13480
12490 IF VNUM>1 AND NNUM>1 AND PNUM>1 AND INUM<1 THEN PRINT PREP$(PNUM):" WHAT?"
12520 IF VNUM>1 AND NNUM>1 AND PNUM>1 AND INUM<1 THEN GOTO 13480
12550 IF NNUM<1 THEN GOTO 12760
12580 IF ANUM<1 THEN GOTO 12610
12610 IF AANUM<1 THEN GOTO 12700
12640 IF APMOD(NNUM)<>AANUM THEN PRINT "ADJECTIVE MODIFIER DOESN'T MATCH NOUN."
12700 IF NNUM1<1 OR IANUM<1 THEN GOTO 12730
12730 REM THIS IS A LINE, OH YES FRIENDS THIS IS A *BLANK LINE*
12760 REM *** NOW WHAT TO DO WITH WAHT FOUND OUT!
12790 IF VNUM<1 THEN PRINT "WHAT?"
12820 IF VNUM<1 THEN GOTO 9940
12850 IF VNUM>20 THEN GOTO 12940
12880 N=VCODE(VNUM)
12910 IF VNUM<21 THEN CALL MOVE
12940 IF VCODE(VNUM)=29 THEN CALL PRINTER
12970 IF VCODE(VNUM)=21 THEN CALL GETT
13000 IF VCODE(VNUM)=22 THEN CALL DROP
13030 IF VCODE(VNUM)=24 THEN CALL QDONE
13060 IF VCODE(VNUM)=23 THEN CALL KILL
13070 IF VCODE(VNUM)=28 THEN CALL LLIGHT
13090 IF VCODE(VNUM)=30 THEN CALL INVENTORY
13120 IF VCODE(VNUMTHEN GOTO 9940
13150 IF VCODE(VNUM)=31 THEN CALL STATUS
13180 IF VCODE(VNUM)=31 THEN GOTO 9940
13200 IF VCODE(VNUM)=51 THEN CALL CLOSEE
13205 IF VCODE(VNUM)=54 THEN CALL INVOKE.SUB
13210 IF VCODE(VNUM)=32 THEN PRINT "RADICAL! MAN! RADICAL!"
13240 IF VCODE(VNUM)=34 THEN CALL CAST
13270 IF VCODE(VNUM)=35 THEN CALL PICK
13300 IF VCODE(VNUM)=36 THEN CALL CWALLS
13330 IF VCODE(VNUM)=39 THEN CALL RREAD
13360 IF VCODE(VNUM)=40 THEN PRINT "OK."
13390 IF VCODE(VNUM)=40 THEN NUMTURN=25
13420 IF VCODE(VNUM)=41 THEN CALL BUY
13450 IF VCODE(VNUM)=42 THEN CALL OPENN
13455 IF VCODE(VNUM)=48 THEN CALL BBACK
13460 IF VCODE(VNUM)=49 THEN CALL WEPDRAW
13465 IF VCODE(VNUM)=46 THEN CALL DDESC
13467 IF VCODE(VNUM)=50 THEN CALL SELL.SUB
13480 ENDF PARSER
13510 DEFINE MOVE
13540 REM *****************************************************
13570 REM **
13600 REM **     MOVE SUB . COME ON MAN! MOVE SUB!
13630 REM *:
13660 REM *****************************************************
13690 REM HEY BLOOD IT WON'T HAPPEN!
13720 IF N<1 OR N>10 THEN GOTO 13690
13750 IF N=10 AND GONE(CNUM2)=1 THEN A=1 ELSE A=0
13780 IF A=1 THEN PRINT "YOU ARE DOWN FROM THE WALL."
13810 IF A=1 THEN GONE(CNUM2)=0
13840 IF A=1 THEN GOTO 14770
13870 IF GONE(CNUM2)=1 THEN CALL CWALLS !SEE IF HE MAKES HIS ROLL!
13900 P=M(P,N)
13930 IF P<1 THEN NUMTURN=NUMTURN-1
13960 IF P=0 THEN PRINT "YOU CAN'T GO THAT WAY"
13990 IF P=-1 THEN PRINT "THERE IS A WALL THERE."
14020 IF P=-2 THEN PRINT "GOD FORBIDS YOU TO GO INTO UNEXPLORED AREAS!"
14050 IF P<1 THEN GOTO 14590
14080 IF SLOC(P)=1 AND NLOC(20)=-CNUM2 THEN GOTO 14590
14110 IF SLOC(P)=1 THEN PRINT "YOU CANNOT GO IN THE WATER WITHOUT A BOAT!"
14140 IF SLOC(P)=1 THEN GOTO 14770
14170 IF SLOC(P)=1 THEN P=PP
14200 IF GONE(CNUM2)=1 AND SLOC(P)<>9 THEN PRINT "YOU FELL OF THE WALL YOU WERE ON!"
14230 IF GONE(CNUM2)=1 AND SLOC(P)<>9 THEN A=1 ELSE A=0
14260 IF A=1 THEN A1=INT(RND(-1)*5+1)
14290 IF A=1 THEN PRINT "YOU TOOK ":A1:" POINTS OF DAMAGE FROM THE FALL."
14320 IF A=1 THEN GONE(CNUM2)=0
14350 IF A=1 THEN NHITS(CNUM2)=NHITS(CNUM2)-A1
14380 IF NHITS(CNUM2)<1 THEN PRINT "YOU DIED."
14410 IF NHITS(CNUM2)<1 THEN DEAD=-1 AND S(CNUM2)=0
14440 IF NHITS(CNUM2)<1 THEN CALL QDONE
14470 IF GONE(CNUM2)=1 AND SLOC(PP)=9 AND INT(RND(0)*99+1)>TBIL(CNUM2,4) AND A<>1 THEN A=2
14500 IF A=2 THEN PRINT "YOU FELL OFF THE WALL THAT YOU WERE ON!"
14530 IF A=2 THEN A=1 AND A1=1 ELSE A1=0
14560 IF A1=1 THEN GOTO 14260
14590 IF P<1 THEN P=PP
14620 IF PP<1 THEN GOTO 14680
14650 IF NLOC(20)>39 AND NLOC(20)<43 THEN NLOC(20)=1
14680 IF P<>PP THEN CALL PRINTER
14710 PP=P
14711 REM **************** SPECIAL LOCATIONS !!! *******
14740 IF P=687 THEN CALL PPOOL
14742 IF P=1 OR P=24 OR P=686 OR P=756 OR P=699 OR P=703 OR P=733 OR P=687 THEN NUMTURN=NUMTURN+6
14745 CALL TRAP.SUB
14770 ENDF MOVE
14800 DEFINE PRINTER
14830 REM *********************************************************
14860 REM **
14890 REM **       BOYS! BOYS! BOYS! MUST YO FORGET TO PRINT
14920 REM *:  OUR LOCATION DESCRIPTIONS!?! WHERE WOULD WE
14950 REM **  BE WITHOUTH THEM? THATS RIGHT! NOWHERE
14980 REM **   NOW GET GOING!
15010 REM **
15011 REM *********************************************************
15012 IF P>87 AND P<672 THEN GOTO 15070
15040 IF P<43 THEN GOTO 15070
15041 CLOC(CNUM2)=P
15042 A=0
15044 FOR J=1 TO 6
15046 IF LSORCE(J)=1 AND CLOC(J)=P THEN A=A+1
15048 NEXT J
15050 IF A>0 THEN A=1 ELSE A=-1
15051 IF A=-1 THEN PRINT "IT IS COMPLETELY DARK."
15052 IF A=-1 THEN GOTO 30010
15060 IF SLOC(P)=1 THEN PRINT "YOU ARE FLOATING ON THE WATER!"
15070 IF P=1 THEN PRINT "YOU ARE IN THE CENTER OF A SMALL TOWN."
15100 IF P=1 THEN PRINT "THERE ARE BUILDINGS IN EACH DIRECTION."
15130 IF P=1 THEN PRINT "AS FAR AS YOU CAN SEE THE CITY IS COMPLETELY SURROUNDED BY TREES."
15160 IF P=2 THEN PRINT "YOU ARE FACING THE REAR WALL OF A BUILDING TO YOUR NORTH."
15190 IF P=3 THEN PRINT "YOU ARE IN THE UPPER RIGHT OF THIS SEEMINGLY OVAL GROVE."
15220 IF P=3 THEN PRINT "THE DOOR TO AN INN LIES TO THE SW OF YOU."
15250 IF P=4 THEN PRINT "YOU FURTHER UP IN THE UPPER RIGHT OF THIS DEFINATLEY OVAL GROVE."
15280 IF P=4 THEN PRINT "THE GROVE NARROWS UP TO THE NORTH. A BEACH"
15310 IF P=4 THEN PRINT "LIES TO THE NW"
15340 IF P=5 THEN PRINT "YOU ARE BY THE EDGE OF THE GROVE, UNDER SOME TREES."
15370 IF P=5 THEN PRINT "THE BEACH GET LARGER TO THE WEST."
15400 IF P=6 THEN PRINT "YOU ARE AT THE ENTRANCE TO A STORE."
15430 IF P=6 THEN PRINT "THERE IS A LAKE STRETCHING BEYOND A BEACH TO THE WEST."
15460 IF P=7 THEN PRINT "YOU ARE IN THE STORE MANY ITEMS ARE SCATTERED AROUND."
15490 IF P=7 THEN PRINT "THERE IS A LARGE COUNTER HERE."
15520 IF P=8 THEN PRINT "YOU ARE ON THE BEACH. THE SHORLINE TRAILS UP TO THE NE AND BACK DOWN"
15550 IF P=8 THEN PRINT "TO THE SW .A BUILDING LIES TO THE DISTANT SOUTH."
15580 IF P=8 THEN PRINT "THE STORE IS TO THE EAST."
15610 IF P=9 THEN PRINT "YOU ARE BETWEEN THE BEACH AND THE SIDE OF THE STORE."
15640 IF P=9 THEN PRINT "A TAVERN LIES TO THE SOUTH."
15670 IF P=10 THEN PRINT "YOU ARE ON THE BEACH. TO THE WEST YOU CAN GAZE OUT OVER"
15700 IF P=10 THEN PRINT "THE BEUTIFUL ROUND LAKE STRETCHING WAY OUT SO FAR"
15730 IF P=10 THEN PRINT "THAT YOU CAN BARELY MAKE OUT THE OTHER SIDE."
15760 IF P=11 THEN PRINT "YOU ARE AT THE SOUTHERN END OF THE BEACH IN A POCKET BETWEEN"
15790 IF P=11 THEN PRINT "THE CLIFFS THAT SURROUND THE LAKE AND THE FOREST THAT SURROUNDS THE CITY."
15820 IF P=12 THEN PRINT "YOU ARE AT THE TOP OF THE GROVE. BETWEEN THE TREES AND THE BEACH"
15850 IF P=12 THEN PRINT "AND BEFORE THE GRAND CLIFFS THAT SURROUND THE LAKE."
15880 IF P=13 THEN PRINT "YOU ARE IN FRONT OF THE ENTRANCE TO THE 'FLYING GOBLIN TAVERN'."
15910 IF P=14 THEN PRINT "YOU ARE NEAR THE EAST WALL OF THE TAVERN."
15940 IF P=15 THEN PRINT "YOU ARE BEFORE THE ENTRANCE TO THE 'MA AND PA' INN."
15970 IF P=16 THEN PRINT "YOU ARE INSIDE THE MA AND PA INN."
16000 IF P=16 THEN PRINT "BEDS AND STUFF ARE SCATTERED AROUND."
16030 IF P=17 THEN PRINT "YOU ARE BEFORE THE ENTANCE OF ZEUS'S TEMPLE."
16060 IF P=18 THEN PRINT "YOU ARE NORTHWEST OF ZEUS'S TEMPLE."
16090 IF P=19 THEN PRINT "YOU ARE NEAR THE REAR OF THE TAVERN."
16120 IF P=20 THEN PRINT "YOU ARE *NE* OF ZEUS'S TEMPLE."
16150 IF P=21 THEN PRINT "YOU ARE NEAR THE EDGE OF THE SOUTHERN END OF THE GROVE."
16180 IF P=22 THEN PRINT "YOU ARE ON THE EDGE OF THE SOUTHWESTERN PART OF THE GROVE."
16210 IF P=23 THEN PRINT "YOU ARE ON THE LEFT SIDE OF ZEUS'S TEMPLE."
16240 IF P=24 THEN
16250         PRINT "YOU ARE IN THE TEMPLE OF ZEUS.HERE IS A VERY TRANGUIL PLACE WHERE"
16260         PRINT "MANY DISICIPLES WALK AROUND IN A SEEMING DAZE."
16270         PRINT "SEVERAL OF THE PRIESTS HERE MAKE IT PLAIN THAT YOU MUST BE VERY QUITE."
16280         ENDIF
16330 IF P=25 THEN PRINT "YOU ARE ON THE RIGHT SIDE OF SAURONS MAGIC SHOP."
16360 IF P=26 THEN PRINT "YOU ARE IN THE SOUTHEASTERN CORNER OF THE GROVE."
16390 IF P=27 THEN PRINT "YOU ARE INSIDE A RELATIVELY EMPTY SALOON."
16450 IF P=27 AND NLOC(13)=27 THEN PRINT "A BARTENDER STANDS HERE DRINKING ALE."
16480 IF P=28 THEN PRINT "YOU ARE JUST OFF THE SOUTHERN COAST OF THE TOWN BEACH."
16510 IF P=28 THEN PRINT "YOU CAN NOW TELL THE LAKE IS COMPLETELY SURRONDED BY HIGH"
16540 IF P=28 THEN PRINT "CLIFFS. EXCEPT TOWARD THE WEST."
16570 IF P=29 THEN PRINT "YOU ARE WEST OF THE NORTHEASTERN COAST OF THE TOWN."
16600 IF P=30 THEN PRINT "YOU ARE ON THE LAKE BY A CANYON, A SIGN READS :"
16630 IF P=30 THEN PRINT '" GO NO FURTHER WEST , NAY! SON HEAD EAST OR BE KILLED!"'
16660 IF P=31 THEN PRINT "YOU ARE ON THE LAKE NEAR THE EDGE BY SOME OF THE SURROUNDING CLIFFS."
16690 IF P=32 THEN PRINT "YOU ARE ON THE LAKE."
16720 IF P=33 THEN PRINT "YOU ARE ON THE LAKE, YOU CAN SEE A BEACH TO THE EAST."
16750 IF P=34 THEN PRINT "YOU ARE ON THE LAKE."
16780 IF P=35 THEN PRINT "YOU ARE IN THE CENTER OF THE LAKE. TO THE WEST YOU CAN SEE A BEACH."
16810 IF P=36 THEN PRINT "YOU ARE ON THE LAKE."
16840 IF P=37 THEN PRINT "YOU ARE EAST OF A FOREIGN BEACH TO THE WEST."
16870 IF P=38 THEN PRINT "YOU ARE OFF THE COAST OF A FOREIGN BEACH TO THE WEST."
16900 IF P=39 THEN PRINT "YOU ARE ON THE EDGE OF THE BEACH OF THE FOREIGN LAND."
16930 IF P=39 THEN PRINT "YOU CAN SEE A CAVE TO THE WEST, SKULLS AND BONES LITTER "
16960 IF P=39 THEN PRINT "THE AREA. A RANK STENCH EMITS FROM THE CAVE'S HOLE."
16990 IF P=40 THEN PRINT "YOU ARE ON THE LOWER PART OF THE BEACH ."
17020 IF P=41 THEN PRINT "YOU ARE ON THE BEACH NEXT TO THE CAVE TO THE WEST. YOU STAND"
17050 IF P=41 THEN PRINT "AMONGST THE REMAINS OF PAST ADVENTURERS."
17080 IF P=42 THEN PRINT "YOU ARE ON THE UPPER RIGHT SECTION OF THE BEACH."
17110 IF P=43 THEN PRINT "YOU ARE IN A SET OF STAIRS GOING UP, A PASSAGE GOES SOUTH."
17140 IF P=44 THEN PRINT "YOU ARE SOUTH OF THE STAIRS GOING UP."
17170 IF P=45 THEN PRINT "YOU ARE IN A FOUR WAY INTERSECTION ,THIS PART OF THE DUNGEON"
17200 IF P=45 THEN PRINT "SEEMS TO BE ABANDONED."
17230 IF P=46 THEN PRINT "YOU ARE IN A PASSAGE BETWEEN A ROOM TO TE NW AND ANOTHER"
17260 IF P=46 THEN PRINT "PASSAGE TO THE SE."
17290 IF P=47 THEN PRINT "YOU ARE IN A 30' BY 30' ROOM."
17320 IF P=47 THEN PRINT "THIS ROOM IS EMPTY AND STRANGELY ENOUGH SPOTLESS."
17350 IF P=48 THEN PRINT "YOU ARE IN A TEN BY TEN FOOT CUBICLE WITH NO APPARENT EXITS."
17380 IF P=49 THEN PRINT "YOU ARE IN A TERTIARY PASSAGE WITH A ROOM TO THE SE AND "
17410 IF P=49 THEN PRINT "CORRIDOR TO THE NW."
17440 IF P=50 THEN PRINT "YOU ARE IN ANOTHER 30' BY 30' FOOT ROOM."
17470 IF P=51 THEN PRINT "YOU ARE IN A NORTH SOUTH PASSAGE."
17500 IF P=52 THEN PRINT "YOU ARE IN AN EAST WEST PASSAGE."
17530 IF P=53 THEN PRINT "YOU ARE IN A PASSAGE THAT GOES EAST SOUTH AND HAS A CAVE TO THE WEST."
17560 IF P=54 THEN PRINT "YOU ARE IN A SMALL DARK CAVE. YOU FEEL VERY STRANGE"
17590 IF P=54 THEN PRINT "AS YOUR HEAD STARTS SPINNING."
17620 IF P=55 THEN PRINT "YOU ARE IN A TERTIARY PASSAGE WAY GOING NW AND SE."
17650 IF P=56 THEN PRINT "YOU ARE IN AN EAST WEST PASSAGE WITH A FOUR WAY INTERSECTIO EASTWARD."
17680 IF P=57 THEN PRINT "YOU ARE IN A FOUR WAY PASSAGE."
17710 IF P=57 THEN PRINT "YOU CAN HEAR STRANGE NOISES COMING FROM THE EAST."
17740 IF P=58 THEN PRINT "YOU ARE IN AN EAST WEST PASSAGE WITH A PASSAGE TO THE SOUTH"
17770 IF P=58 THEN PRINT "THE NOISES FROM THE EAST ARE LOUDER AS YOU TRAVEL EASTWARD."
17800 IF P=59 THEN PRINT "YOU ARE IN A FOUR WAY INTERSECTION WITH A CHAMBER BEFORE YOU."
17830 IF P=59 AND PP=58 THEN PRINT "YOU NOTICE THAT A IRON BAR GATE HAS CRASHED BEHIND BLOCKING YOUR RETURN."
17860 IF P=59 THEN PRINT "LOUD NOISES COME FROM THE CHAMBER TO THE EAST."
17890 IF P=60 THEN PRINT "YOU ARE IN A TERTIARY PASSAGE GOING NE AND SW."
17920 IF P=61 THEN PRINT "YOU ARE IN A TERTIARY PASSAGE GOING NW AND SE."
17950 IF P=62 THEN PRINT "YOU ARE STANDING BEFORE A DREARY LOOKING CAVE."
17980 IF P=63 THEN PRINT "YOU ARE STANDING BEFORE A BRIGHT LOOKING CAVE."
18010 IF P=64 THEN PRINT "YOU ARE IN A DREARY LOOKING CAVE."
18040 IF P=65 THEN PRINT "YOU ARE IN A BRIGHT LOOKING CAVE."
18070 IF P=66 THEN PRINT "YOU ARE IN THE LAIR OF THE MINOTAUR."
18100 IF P=66 THEN PRINT "STRAW LIES ALL ABOUT."
18130 IF P=67 THEN PRINT "YOU ARE IN AN EAST WEST PASSAGE."
18160 IF P=68 THEN PRINT "YOU ARE IN A FOUR WAY INTERSECTION."
18190 IF P=69 THEN PRINT "YOU ARE IN A SLANTING PASSAGE GOING SW AND NE."
18220 IF P=70 THEN PRINT "YOU ARE AT THE ENTRANCE OF A ROOM."
18250 IF P=71 THEN PRINT "YOU ARE IN A 30' BY 30' ROOM."
18280 IF P=72 THEN PRINT "YOU ARE STANDING BEFORE A PASSAGE GOING EAST/WEST IN FRONT OF YOU."
18310 IF P=73 THEN PRINT "YOU ARE IN AN EAST.WEST PASSAGE WITH A PASSAGE GOING NORTH."
18340 IF P=74 THEN PRINT "YOU ARE IN A PASSAGE GOING EAST AND SOUTH."
18370 IF P=75 THEN PRINT "YOU ARE IN A PASSAGE GOING SOUTH AND WEST."
18400 IF P=76 THEN PRINT "YOU ARE IN A PASSAGE GOING NORTH AND EAST."
18430 IF P=77 THEN PRINT "YOU ARE IN AN EAST/WEST PASSAGE."
18460 IF P=78 THEN PRINT "YOU ARE IN A PASSAGE THAT GOES NORTH AND EAST."
18490 IF P=79 THEN PRINT "YOU ARE IN A PASSAGE THAT GOES NORTH SOUTH AND EAST."
18520 IF P=80 THEN PRINT "YOU ARE STANDING BEFORE A WALL TO YOUR NORTH."
18550 IF P=81 THEN PRINT "YOU ARE IN A PASSAGE GOING EAST/WEST AND NORTH."
18580 IF P=82 THEN PRINT "YOU ARE IN A TERTIARY PASSAGE GOING SE AND NW."
18610 IF P=83 THEN PRINT "YOU ARE IN A CAVE."
18640 IF P=84 THEN PRINT "YOU ARE IN A TERTIARY PASSAGE GOING SW AND NE."
18670 IF P=85 THEN PRINT "YOU ARE IN A GRAND OCTAGANAL ROOM."
18700 IF P=85 THEN PRINT "THERE IS A LARGE PEDESTAL IN THE MIDDLE OF THE ROOM."
18730 IF P=85 THEN PRINT "LIGHTS FLASH ON AND OFF IN A VIOLENT FRENZY."
18760 IF P=86 THEN PRINT "YOU ARE IN A NORTH EAST PASSAGE WAY."
18790 IF P=87 THEN PRINT "YOU ARE IN A DEAD END."
18792 IF P=100 THEN
18794         PRINT "YOU ARE FLOATING IN A STRANGE,DARK ABYSS WHERE LIGHT AND "
18796         PRINT "DARKNESS ARE AS ONE."
18798         ENDIF
18820 IF P=669 THEN PRINT "YOU ARE IN A SMALL HUT."
18850 IF P=669 THEN PRINT "THERE IS A BED HERE RESTING ON A DIRT FLOOR."
18880 IF P=465 THEN PRINT "YOU ARE SOUTH OF A GREAT MOUND OF DIRT, WITH A CAVE TO THE NORTH."
18910 IF P=466 THEN PRINT "YOU HAVE ENTERED A GREAT CAVERN, OLD DECREPED KNIGHTS LAY HERE"
18940 IF P=466 THEN PRINT "SCATTERED AROUND."
18970 IF P=466 THEN PRINT "CAVERN BECOMES WIDER AND LARGER TO THE NORTH."
19000 IF P=670 THEN PRINT "YOU HAVE ENTERED A GREAT BARROW INTO THE HILLSIDE."
19030 IF P=670 THEN PRINT "YOU NOTICE MANY HOLES (5-8 FEET IN DIAMETER) IN AND OUT"
19060 IF P=670 THEN PRINT "AND AROUND THE CAVERN."
19090 IF P=671 THEN PRINT "YOU ARE ON AN OLD DECREPED SET OF STAIRS."
19120 IF P=672 THEN PRINT "YOU HAVE ENTERED A SQUARISH CAVERN FILLED WITH"
19150 IF P=672 THEN PRINT "THE REMAINS OF BROKEN STATUES, AND VARIOUS SMALL PIECES"
19180 IF P=672 THEN PRINT "OF DESTROYED FURNITURE.EXITS LEAD NW,NE,W,E ."
19210 IF P=673 THEN PRINT "YOU ARE IN A ROUGHLY HEWN PASSAGE GOING EAST AND WEST."
19240 IF P=674 THEN PRINT "THE PASSAGEWAY YOU ARE IN CURVES TO THE"
19270 IF P=674 THEN PRINT "EAST AND SOUTH."
19300 IF P=675 THEN PRINT "YOU ARE AT THE ENTRANCE TO A LARGE NARROW ROOM."
19330 IF P=675 THEN PRINT "AN AWFUL ODOR BELLOWS FROM THE ROOM."
19360 IF P=676 THEN PRINT "YOU HAVE ENTERED WHAT WAS ONCE A VERY"
19390 IF P=676 THEN PRINT "DECORATIVE ROOM.GREAT TAPESTRIES THAT ONCE HUNG ON THE WALL NOW"
19420 IF P=676 THEN PRINT "LAY DEFILED ON THE GROUND.PILLOWS AND BEDDING LIE TORN AND STREW"
19450 IF P=676 THEN PRINT "ABOUT.THE STENCH GETS STRONGER AT THE FAR END OF THE"
19480 IF P=676 THEN PRINT "ROOM TO THE SOUTH."
19510 IF P=677 THEN PRINT "YOU ARE AT THE SOUTH END OF THE ROOM.HERE THE JUNK"
19540 IF P=677 THEN PRINT "HAS BEEN SHIEFTED AROUND IN A SOMEWHAT ORDERLY FASHION IMPLYING"
19570 IF P=677 THEN PRINT "THAT SOMETHING HAS RE-INHABITED THIS PLACE."
19600 IF P=678 THEN PRINT "YOU ARE IN PASSAGEWAY GOING EAST,WEST AND SOUTH."
19630 IF P=678 THEN PRINT "THE FLOOR IS DAMP HERE,AND IT GETS WETTER TO THE SOUTH."
19660 IF P=679 THEN PRINT "YOU ARE KNEE DEEP IN A SLUDGY,SWAMPY,PIOND."
19690 IF P=680 THEN PRINT "YOU ARE IN A BEND IN THE PASSAGE WAY GOING WEST AND SOUTH,"
19720 IF P=680 THEN PRINT "WITH A ROOM TO THER NORTH."
19750 IF P=681 THEN PRINT "YOU ARE IN A CORRIDOR GOING NORTH AND SOUTH."
19780 IF P=682 THEN PRINT "THE PASSAGE YOU ARE IN BECOMES A 'T' TO THE SOUTH."
19810 IF P=683 THEN PRINT "YOU ARE IN A CORRIDOR THAT GOES EAST AND WEST, TO THE WEST YOU"
19840 IF P=683 THEN PRINT "SEE A STRANGE GLOW,TO THE EAST THE PASSAGE TURNS."
19870 IF P=684 THEN PRINT "YOU ARE STANDING AMIDST A BRIGHTLY GLOWING SPHERE OF LIGHT."
19900 IF P=684 THEN PRINT "YOU CAN SEE NO POSSIBLE EXITS."
19930 IF P=685 THEN PRINT "THE PASSAGE GOES WEST AND SOUTH, TO THE SOUTH A ROOM WIDENS, BUT"
19960 IF P=685 THEN PRINT "TO THE WEST YOU CAN BARELY SEE SOME LIGHT."
19990 IF P=685 THEN PRINT "THE FLOOR IS WET HERE."
20020 IF P=686 THEN PRINT "YOU HAVE ENTERED A GREAT ROUND ROOM, THERE IS A POOL OF WATER IN"
20050 IF P=686 THEN PRINT "THE CENTER OF THE ROOM.THE FLOOR IS WET HERE."
20080 IF P=687 THEN PRINT "YOU ARE SWIMMING AROUND IN A POOL OF WATER."
20110 IF P=688 THEN PRINT "YOU ARE IN A SMALL ANTECHAMBER CONNECTING THE SOUTHERN ROOM TO A"
20140 IF P=688 THEN PRINT "NORTHERN PASSAGE."
20170 IF P=689 THEN PRINT "YOU ARE IN A PASSAGE WAY LEADING FAR TO THE NORTH AND A ROOM "
20200 IF P=689 THEN PRINT "TO THE SOUTH."
20230 IF P=690 THEN PRINT "YOU ARE IN A PASSAGE GOING SOUTH,TO YOUR NORTH IS A "
20260 IF P=690 THEN PRINT "SET OF STAIRS GOING DOWN."
20290 IF P=691 THEN PRINT "YOU ARE IN A SET OF STAIRS GOING DOWN."
20320 IF P=692 THEN PRINT "YOU ARE IN A PASSAGE WAY GOING NORTHWEST AND SOUTHEAST."
20350 IF P=693 THEN PRINT "YOU ARE IN A 3-WAY INTERSECTION GOING SOUTHEAST,NORTH AND WEST."
20380 IF P=694 THEN PRINT "YOU ARE BEFORE AN ENTRANCE TO A ROOM TO THE NORTH."
20410 IF P=695 THEN PRINT "YOU ARE IN A CORRIDOR GOING EAST AND WEST."
20440 IF P=696 THEN PRINT "YOU ARE BEFORE THE ENTRANCE WAY OF A VERY LARGE ROOM."
20470 IF P=697 THEN PRINT "YOU HAVE ENTERED A HUGE TRIANGULAR ROOM."
20500 IF P=697 THEN PRINT "YOU CAN TELL BY MARKINGS ON THE WALLS THAT THIS WAS ONCE A RELIGOUS HALL."
20530 IF P=697 THEN PRINT "THE ENTIRE SOUTH SIDE OF THE ROOM IS COVERED IN WATER ENTERING THE"
20560 IF P=697 THEN PRINT "SOUTHWESTERN POINT OF THE ROOM."
20590 IF P=697 THEN PRINT "THERE IS AN ALTAR AT THE SOUTH END OF THE ROOM SUNKEN "
20620 IF P=697 THEN PRINT "INTO THE WATER."
20650 IF P=698 THEN PRINT "YOU HAVE ENTERED A VERY LARGE AND LONG ROOM, IT APPEARS TO HAVE"
20680 IF P=698 THEN PRINT "ONCE BEEN A CRYPT O SOME SORT.YOU CAN SEE SOME COFFINS"
20710 IF P=698 THEN PRINT "BROKEN AND SCATTERED ABOUT.THE ROOM CONTINUES TO THE"
20740 IF P=698 THEN PRINT "SOUTH,BUT YOU CAN SENSE AN EVIL PRESENCE IN THAT DIRECTION."
20770 IF P=699 THEN PRINT "HERE AT THE END OF THE CRYPT YOU SEE MORE COFFINS SCATTERED AROUND."
20800 IF P=699 THEN PRINT "BUT THESE COFFINS SEEM MUCH OLDER, AN EVIL PRESENCE SURROUNDS YOU."
20830 IF P=700 THEN PRINT "YOU ARE IN A DIAGANAL PASSAGE WAY GOING"
20860 IF P=700 THEN PRINT "NORTHEAST AND SOUTHWEST."
20890 IF P=701 THEN PRINT "YOU ARE IN A THREE WAY INTERSECTION GOING"
20920 IF P=701 THEN PRINT "SOUTHWEST,NORTH, AND EAST."
20950 IF P=702 THEN PRINT "YOU ARE AT THE ENTRANCE TO A GREAT ROOM."
20980 IF P=703 THEN PRINT "YOU HAVE ENTERED THE WESTERN END OF A GREAT DORMITORY."
21010 IF P=703 THEN PRINT "A FEW BEDS LIE SCATTERED AROUND (IN TACT).THE DORMITORY CONTINUES EAST."
21040 IF P=704 THEN PRINT "YOU ARE AT THE EAST END OF THE DORMITORY.MANY MORE BEDS LIE HERE."
21070 IF P=704 THEN PRINT "EXITS LIE TO THE EST AND SOUTH."
21100 IF P=705 THEN PRINT "YOU HAVE ENTERED THE EAST OF A LARGE ROOM."
21130 IF P=705 THEN PRINT "IT APPEARS TO BE A PRISON FOR OUTCASTS."
21160 IF P=706 THEN PRINT "YOU ARE AT THE WEST END OF THE PRISON, MANY DEAD AND DECAYING (DWARVEN)"
21190 IF P=706 THEN PRINT "BODIES LIE HERE. THE AIR HERE IS THICK AND REEKS OF DEATH."
21220 IF P=707 THEN PRINT "YOU ARE IN AN ANTECHAMBER THAT LINKS UP WITH THE DORMITORY TO THE WEST."
21250 IF P=707 THEN PRINT "THERE ARE MURALS ON THE WALLS DEPICTING GREAT DWARVES DOING WONDROUS"
21280 IF P=707 THEN PRINT "DEEDS IN COMBAT.THERE IS AN EXIT TO THE SOUTH."
21310 IF P=708 THEN PRINT "YOU ARE IN A PASSAGE WAY GOING NORTH INTO AN ANTECHAMBER AND"
21340 IF P=708 THEN PRINT "SOUTHWARD THE PASSAGE CONTINUES."
21370 IF P=709 THEN PRINT "YOU ARE AT A FORK IN THE PASSAGE ONE CORRIDOR GOES SOUTHWEST AND"
21400 IF P=709 THEN PRINT "THE OTHER GOES SOUTHEAST,THE PASSAGE GOES BACK TO THE NORTH."
21430 IF P=710 THEN PRINT "YOU ARE IN A PASSAGE GOING NW AN SE."
21460 IF P=711 THEN PRINT "YOU ARE IN A PASSAGE GOING NORTHWEST, AND EAST. TO THE "
21490 IF P=711 THEN PRINT "EAST IS A SET OF STAIRS."
21520 IF P=712 THEN PRINT "YOU ARE IN A SET OF STAIRS GOING *UP*"
21550 IF P=713 THEN PRINT "YOU ARE IN A CORRIDOR GOING NE AND SW."
21580 IF P=714 THEN PRINT "YOU ARE IN A CORRIDOR GOING NORTHEAST AND SOUTHEAST."
21610 IF P=715 THEN PRINT "YOU ARE IN A DIAGANAL PASSAGE GOING NORTHWEST AND SOUTHEAST."
21640 IF P=715 THEN PRINT "TO THE SOUTHEAST IS A ROOM."
21670 IF P=716 THEN PRINT "YOU ARE IN A WELL DECORATED ROOM WHICH HAS NOT BEEN VANDALIZED.AN EXIT"
21700 IF P=716 THEN PRINT "LEADS TO THE EAST."
21730 IF P=717 THEN PRINT "YOU ARE IN A CONNECTING PASSAGE THAT LEADS TO TWO ROOMS ONE TO THE EAST"
21760 IF P=717 THEN PRINT "AND ONE TO THE WEST."
21790 IF P=718 THEN PRINT "YOU ARE IN A GRAND THRONE ROOM."
21820 IF P=718 THEN PRINT "BEUTIFUL TAPESTRIES HANG ON THE WALLS."
21850 IF P=719 THEN PRINT "YOU ARE IN A CORRIDOR GOING NORTH AND SOUTH."
21880IF P=720 THEN PRINT "YOU ARE IN A PASSAGE GOING NORTHEAST AND SOUTH."
21910 IF P=721 THEN PRINT "YOU ARE IN A PASSAGE GOING NE AND SW (WELL YOU GOTTO GET THERE SOMEWAY!)"
21940 IF P=722 THEN PRINT "THE PASSAGE TURNS HERE GOING SOUTHWEST AND SOUTH."
21970 IF P=723 THEN PRINT "YOU ARE IN WHAT ONCE WAS A HAREM OF SOME SORT."
22000 IF P=723 THEN PRINT "PILLOWS AND OTHER BEDDING LIE SCATTERED AROUND HERE.A FEW DWARVEN "
22030 IF P=723 THEN PRINT "SKELETONS LIE CHAINED TO THE WALL HERE."
22060 IF P=724 THEN PRINT "YOU ARE AT THE WEST END OF WHAT WAS ONCE A GREAT AVIAR."
22090 IF P=724 THEN PRINT "SEVERAL TREES GROW AROUND HERE, BUT YOU SEE NO BIRDS."
22120 IF P=725 THEN PRINT "THIS IS THE EAST END OF THE AVIARY."
22150 IF P=726 THEN PRINT "YOU ARE FLOATING IN THE WATER ON THE SOUTHERN"
22180 IF P=726 THEN PRINT "OF THE RELIGOUS HALL.THE CURRENT TUGS AT YOUR BOAT FROM THE SOUTHWEST."
22210 IF P=727 THEN PRINT "YOU ARE DRIFTING ALONG A WATER FILLED TUNNEL.THE TUNNEL IS "
22240 IF P=727 THEN PRINT "ROUGHLY HEWN,AS IT WERE BURROWED BY A LARGE CREATURE."
22270 IF P=727 THEN PRINT "THE RIVER VEERS OFF TO THE SOUTHEAST."
22300 IF P=728 THEN PRINT "THE TUNNEL CONTINUE TO THE WEST AND GOES BACK NORTHEAST."
22330 IF P=729 THEN PRINT "YOU HAVE TURNED ONTO A STRAIGHTAWAY GOING EAST AND WEST."
22360 IF P=729 THEN PRINT "THE TUNNEL IS WIDE HERE BUT IT NARROWS UP VERY QUICKLY TO THE WEST."
22390 IF P=729 THEN PRINT "THE CURRENT IS VERY STRONG HERE."
22420 IF P=730 THEN PRINT "THE TUNNEL GETS VERY NARROW HERE.THE WATER PUSHES THROUGH TO THE "
22450 IF P=730 THEN PRINT "WEST VERY QUICKLY HERE BECAUSE OF THE BUILDING CURRENT."
22480 IF P=730 THEN PRINT "THE TUNNEL WIDENS AGAIN TO THE WEST."
22510 IF P=731 AND PP=730THEN PRINT "THE WATER PROPELS YOU WESTWARD ALMOST THROWING YOU OUT OF THE BOAT."
22540 IF P=731 THEN PRINT "YOU HAVE ENTERED A GREAT UNDERGROUND CAVERN."
22570 IF P=731 THEN PRINT "THE ENTIRE EASTERN HALF IS SUNKEN IN WATER. THERE IS LAND TO THE WEST."
22600 IF P=731 THEN PRINT "A TUNNEL LEADS OF TO THE NORTHEAST."
22610 IF P=731 THEN PRINT "THERE IS ALSO A TUNNEL FLOWING SOUTHWARD"
22630 IF P=732 THEN PRINT "YOU ARE ON THE EDGE OF THE UNDERGROUND POOL. IN A CAVERN."
22660 IF P=732 THEN PRINT "YOU SEE MANY ANCIENT ROWBOATS HERE RUINED BY CENTURIES OF AGING."
22690 IF P=733 THEN PRINT "YOU ARE ON THE WESTERN SIDE OF A GREAT CAVERN. THE PLACE SEEMS"
22720 IF P=733 THEN PRINT "TO BE COUNTLESS CENTUREIES OLD. THE AIR HERE IS STRANGELY VERY STILL."
22750 IF P=733 THEN PRINT "A ROUGH PASSAGE LEAD NORTHWEST."
22780 IF P=734 THEN PRINT "YOU ARE IN AN UNEVEN PASSAGE THAT TURNS OFF TO THE NORTHEAST."
22810 IF P=735 THEN PRINT "THE ROUGH TUNNEL ENDS HERE.TO THE NORTH IS A ROOM."
22840 IF P=736 THEN PRINT "YOU HAVE ENTERED A SMALL ANTECHAMBER,DUST ABOUNDS "
22870 IF P=736 THEN PRINT "EVERYWHERE IN THIS ANCIENT CHAMBER.REMNANTS OF A SMASHED WOODEN "
22900 IF P=736 THEN PRINT "TABLE ARE SCATTERED HERE.EXITS LIE TO THE NORTHWEST,NORTH,NORTHEAS AND"
22930 IF P=736 THEN PRINT "SOUTH."
22960 IF P=737 THEN PRINT "THIS IS ROOM IS VERY LARGE,INDEED IT IS ROUGHLY 30' SQUARE "
22990 IF P=737 THEN PRINT "FEET IN SIZE.IT ONCE WAS AN ANCIENT BATHING AREA FOR MANY PEOPLE(?)"
23020 IF P=737 THEN PRINT "THERE IS A LARGE POOL HERE COMPLETE WITH DIVING BOARD, "
23050 IF P=737 THEN PRINT "A DISABLED WATERFALL AND MISCELLANEOUS POOL FACILITIES,UNFORTUNATELY"
23080 IF P=737 THEN PRINT "IT IS ALL DRIED OUT AND RUSTED.THE ONLY EXIT IS SOUTHWARD."
23110 IF P=738 THEN PRINT "THIS COULD HAVE ONCE BEEN A SHOW ROOM.THERE ARE ROWS OF SEATS "
23140 IF P=738 THEN PRINT "SURROUNDING A RAISED PLATFORM.STRANGE THOUGH,A ROW OF PRISON CELLS"
23170 IF P=738 THEN PRINT "CONTAINING SKELETEL BODIES LINE THE NORTHERN WALL."
23200 IF P=739 THEN PRINT "YOU ARE IN A NORTH/SOUTH PASSAGE.TO THE SOUTH IS A ROOM."
23230 IF P=740 THEN PRINT "THE PASSAGE THAT YOU ARE IN LEADS TO THE NORTH AND SOUTH."
23260 IF P=741 THEN PRINT "THE PASSAGE BRANCHES OFF TO YOUR NORTH,AND IT GOES BACK SOUTH."
23290 IF P=742 THEN PRINT "YOU ARE IN A THREE WAY PASSAGE GOING NORTH,NORTHEAST, AND SOUTH."
23320 IF P=743 THEN PRINT "YOU HAVE ENTERED A DIAMOND SHAPED ROOM WITH TWO EXITS; ONE TO "
23350 IF P=743 THEN PRINT "THE NORTH AND ONE TO THE SOUTH."
23380 IF P=743 THEN PRINT "THIS OLD ROOM MIGHT HAVE BEEN AN OFFICE SOME TIME AGO.THERE IS"
23410 IF P=743 THEN PRINT "AN OLD DESK HERE WITH A CHAIR.THIS ROOM TOO, IS VERY DUSTY."
23440 IF P=744 THEN PRINT "YOU ARE IN A DIAGANAL PASSAGE GOING NORTHWEST AND SOUTHEAST."
23470 IF P=745 THEN PRINT "YOU ARE IN A CORRIDOR THAT GOES SOUTHWEST AND NORTHEAST."
23500 IF P=746 THEN PRINT "YOU ARE IN A STRANGE 3-WAY INTERSECTION THAT GOES NW,NE, AND SE."
23530 IF P=746 THEN PRINT "YOU CAN SMELL A SULFERIC,SMOKY ODOR COMING FROM THE NORTHEAST."
23560 IF P=746 THEN PRINT "THE ODOR IS VERY REPULSIVE."
23590 IF P=747 THEN PRINT "YOU ARE IN A THREE WAY INTERSECTION THAT GOES NORTHWEST,NORTHEAST,"
23620 IF P=747 THEN PRINT "AND SOUTHWEST."
23650 IF P=748 THEN PRINT "YOU ARE IN A CORRIDOR THAT GOES SOUTH,SOUTHWEST AND SOUTHEAST."
23680 IF P=749 THEN PRINT "YOU ARE IN A PASSAGE THAT GOES NORTH,SOUTH,AND SOUTHEAST.YOU NOW"
23710 IF P=749 THEN PRINT "DISCOVER THE SOURCE OF THE SULFERIC ODOR,"
23740 IF P=749 THEN PRINT "BECAUSE HERE LIES THE SMOKING REMAINS OF SOME HUMANOID CREATURE.THE"
23770 IF P=749 THEN PRINT "THE ODOR HERE IS NEARLY UNBEARABLE."
23800 IF P=750 THEN PRINT "YOU ARE BEFORE THE ENTRANCE TO A ROOM SOUTHWARD.THE PASSAGE LEADS"
23830 IF P=750 THEN PRINT "BACK TO THE NORTH."
23860 IF P=751 THEN PRINT "YOU HAVE ENTERED THE EASTERN SIDE OF AN ANCIENT STORE ROOM."
23890 IF P=751 THEN PRINT "MANY WORTHLESS BOXES LIE ON THE FLOOR.ALL THE FOOD HAS BEEN INFESTED BY"
23920 IF P=751 THEN PRINT "INSECTS,PREDOMINATELY BEETLES."
23950 IF P=752 THEN PRINT "YOU ARE AT THE WEST END OF THA ANCIENT STORE ROOM.INSECTS ABOUND HERE."
23980 IF P=753 THEN PRINT "YOU HAVE ENTERED A NICE HOMEY LOOKING ROOM.OBVIOUSLY INHABITED BY"
24010 IF P=753 THEN PRINT "SOME FORM OF CREATURE,DUE TO ITS ORGANIZED FASHION.THERE IS A"
24040 IF P=753 THEN PRINT "FIREPLACE HERE,AND A TABLE WITH CHAIRS.A GIANT BEETLE ROASTS ON AN"
24070 IF P=753 THEN PRINT "OPEN FIRE."
24100 IF P=753 THEN PRINT "THERE IS ALSO A COUPLE OF BEDS HERE."
24130 IF P=754 THEN PRINT "YOU ARE AT THE SOUTHERN END OF A *HUGE* ROOM.IT IS SO BIG "
24160 IF P=754 THEN PRINT "THAT YOU CAN NOT SEE THE NORTHERN END OF THE ROOM."
24190 IF P=754 THEN PRINT "YOU CAN FEEL A GENTLE WAVE OF HEAT COMING FROM THE NORTH."
24220 IF P=755 THEN PRINT "YOU ARE IN THE CENTER OF THE GREAT ROOM,THE HEAT FROM THE NORTH IS "
24250 IF P=755 THEN PRINT "INCREDIBLY HIGH,SO HIGH IN FACT THAT IT IS ALMOST"
24280 IF P=755 THEN PRINT "DAMAGEING."
24310 IF P=756 THEN PRINT "YOU ARE IN THE DRAGONS LAIR!"
24340 IF P=756 THEN PRINT "THE HEAT HERE IS SO INTENSE THAT YOUR SKINSTARTS TO BURN SLIGHTLY."
24370 IF P=756 THEN PRINT "IT IS COOLER TO THE SOUTH."
24400 IF P=757 THEN
24410 PRINT "YOU ARE AT THE MOUTH OF A TUNNEL LEADING SOUTHWARD,THE CURRENT TUGS AT YOU."
24420 ENDIF
24430 IF P=758 THEN 
24440 PRINT "YOU ARE IN A SMALL TUNNEL WITH THE WATER FLOWING SOUTHWARD INTO A WATER"
24450 PRINT "LOGGED CAVERN WITH A SMALL LAND MASS IN THE CENTER.THE CAVERN"
24460 PRINT "SEEMS VERY,VERY OLD,AS IF NO HAS BEEN HERE...EVER.YOU THINK"
24470 PRINT "PERHAPS IT IS A NATURAL CAVERN,UNTIL YOU NOTICE A SMALL HUT ON THE ISLAND"
24480 PRINT "TO YOUR SOUTH."
24490 ENDIF
28000 IF SLOC(P)=0 AND P>87 THEN PRINT "YOU ARE AMIDST A GRASSY CLEARING."
28010 IF SLOC(P)=2 AND P>87 THEN PRINT "YOU ARE IN THE FOREST."
28020 IF SLOC(P)=3 AND P>87 THEN PRINT "YOU ARE AMIDST HILLS."
28030 IF SLOC(P)=4 THEN PRINT "YOU ARE ON THE EDGE OF THE FOREST."
28040 IF SLOC(P)=5 THEN PRINT "YOU ARE ON THE EDGE SOME HILLS."
28050 IF SLOC(P)=6 THEN PRINT "YOU ARE ON A BEACH."
28060 IF SLOC(P)=8 THEN PRINT "YOU ARE ON THE DOCK."
28070 IF GONE(CNUM2)=1 THEN PRINT "YOU ARE ON THE WALL!"
28080 IF GONE(CNUM2)=2 THEN PRINT "YOU ARE INVISIBLE!"
30000 CALL OBJECTPRINT
30010 ENDF PRINTER
30020 DEFINE OBJECTPRINT
30030 REM ***********************************************************
30040 REM **
30050 REM **
30060 REM **    IF THERE IS ANY OBJECTS AT OUR BUDDY'S LOCATION 
30070 REM **  THEN LET'S TELL HIM
30080 REM **
30090 REM **
30100 REM ***********************************************************
30110 MAT ALLPRINT=0
30120 FOR J=1 TO 295
30130 CALL EPRINT
30140 IF J=276 THEN GOTO 30370
30150 IF NCODE(J)=49 THEN GOTO 30370
30160 IF J>6 THEN GOTO 30190
30170 IF GONE(J)=1 THEN GOTO 30370
30180 IF GONE(J)=2 AND RACE$(CNUM2)<>"ELF" THEN GOTO 30370
30190 J3=0,J4=0
30200 IF NLOC(J)<>P THEN GOTO 30370
30210 IF J<11 AND J<>CNUM2 THEN PRINT "THERE IS A FELLOW CHARACTER HERE NAMED ":NOUN$(J)
30220 IF J<11 THEN GOTO 30370
30230 IF ALLPRINT (NCODE(J))=1 THEN GOTO 30370
30240 FOR J1=1 TO 295
30250 IF NLOC(J1)=P AND NCODE(J1)=NCODE(J) THEN J3=J3+1
30260 IF NLOC(J1)=P AND NCODE(J1)=NCODE(J) THEN ALLPRINT(NCODE(J1))=1
30270 IF NLOC(J1)=P AND NCODE(J1)=NCODE(J) AND ASLEEP(J1)>0 THEN J4=J4+1
30280 NEXT J1
30290 IF APOINT(J)<1 OR J3>1 THEN GOTO 30310
30300 PRINT "THERE IS A ":ADJECT$(APOINT(J)):" ":NOUN$(J):" HERE."
30310 IF APOINT(J)<1 AND J3<2 THEN PRINT "THERE IS A ":NOUN$(J):" HERE."
30320 IF APOINT(J)<1 OR J3<2 THEN GOTO 30340
30330 PRINT "THERE ARE ":J3:" ":ADJECT$(APOINT(J)):" ":NOUN$(J):"'S HERE."
30340 IF J3>1 AND APOINT(J)<1 THEN PRINT "THERE ARE ":J3:" ":NOUN$(J):"'S HERE."
30350 IF J4=1 THEN PRINT "THE ":NOUN$(J):" IS ASLEEP."
30360 IF J4>1 THEN PRINT J4:" OF THE ":NOUN$(J):"'S ARE ASLEEP."
30370 NEXT J
30380 IF M(NLOC(215),10)=671 AND P=NLOC(215) THEN PRINT "THE TRAPDOOR IS OPEN."
30390 IF M(NLOC(215),10)=0 AND NLOC(215)=P THEN PRINT "THE TRAPDOOR IS CLOSED."
30400 ENDF OBJECTPRINT
30410 DEFINE GETT
30420 REM ***************************************************
30430 REM **
30440 REM **
30450 REM **      G E T  G E T  G E T  G E T  
30460 REM **
30470 REM **  HE WANT'S TO GET SOMTHING SO MAKE LOCATION VALUE
30480 REM **  NEGATIVE OF CNUM2
30490 REM **
30500 REM ***************************************************
30510 IF NNUM<1 THEN PRINT "GET WHAT?"
30520 IF NNUM<1 THEN GOTO 30680
30530 E=P
30540 CALL SEARCHP
30550 IF NLOC(NNUM)=-CNUM2 THEN PRINT "YOU ARE ALREADY CARRYING SIRE?"
30560 IF NLOC(NNUM)=-CNUM2 THEN GOTO 30680
30570 IF NLOC(NNUM)<>P THEN PRINT "I DON'T SEE IT HERE MY FRIEND."
30580 IF NLOC(NNUM)<>P THEN GOTO 30680
30590 IF GETTN(NCODE(NNUM))<>1 THEN PRINT NAME$(CNUM2):" YOU CANNOT GET THAT!"
30600 IF GETTN(NCODE(NNUM))<>1 THEN GOTO 30680
30610 IF ONUM(CNUM2)=8 THEN PRINT "YOU CAN'T CARRYING ANYTHING MORE, YOU'LL HAVE TO DROP SOMETHING FIRST."
30620 IF ONUM(CNUM2)=8 THEN GOTO 30680
30630 IF GONE(CNUM2)=1 THEN PRINT "YOU MAY NOT PICK UP OBJECTS WHILE HANGING ONTO A WALL!"
30640 IF GONE(CNUM2)=1 THEN GOTO 30680
30650 NLOC(NNUM)=-CNUM2
30660 PRINT "OK."
30670 ONUM(CNUM2)=ONUM(CNUM2)+1
30680 ENDF GETT
30690 DEFINE DROP
30700 REM *****************************************************
30710 REM **
30720 REM ** THIS IS WHERE WE DROP THINGS OUR FRIENDS HAVE
30730 REM **  PICKED UP. JUST MAKE LOCATION VALUE=CURRENT POSITION
30740 REM **
30750 REM *****************************************************
30760 IF NNUM<1 THEN PRINT "DROP WHAT?"
30770 IF NNUM<1 THEN GOTO 30960
30780 E=-CNUM2
30790 CALL USEARCH
30800 IF NLOC(NNUM)<>-CNUM2 THEN PRINT "YOU AREN'T CARRYING IT!"
30810 IF NLOC(NNUM)<>-CNUM2 OR NNUM<1 THEN GOTO 30960
30820 IF GONE(CNUM2)=1 THEN A=1 ELSE A=0
30830 IF A=1 THEN PRINT "WHILE DROPPING THE ":NOUN$(NNUM):" YOU FELL OFF THE WALL YOU WERE ON!"
30840 IF A=1 THEN A1=INT(RND(0)*5+1)
30850 IF A=1 THEN PRINT "YOU LOST ":A1:" HIT POINTS IN THE FALL."
30860 IF NHITS(CNUM2)<1 THEN PRINT "YOU DIED."
30870 IF NHITS(CNUM2)<1 THEN S(CNUM2)=0
30880 IF NHITS(CNUM2)<1 THEN CALL QDONE
30890 PRINT "OK."
30900 IF NCODE(NNUM)=14 AND LSORCE(CNUM2)=1 THEN
30910 PRINT "THE LAMP GOES OUT WHEN YOU LAY IT DOWN."
30920 LSORCE(CNUM2)=0
30930 ENDIF
30940 NLOC(NNUM)=P
30950 ONUM(CNUM2)=ONUM(CNUM2)-1
30960 ENDF DROP
30970 DEFINE INVENTORY
30980 REM *******************************************************
30990 REM **
31000 REM **    IF HE IS GOING TO BE ABLE TO GET AND DROP
31010 REM **  THINGS HE MIGHT AS WELL BE ABLE TO KNOW
31020 REM ** WHAT HE HAS AND NOT HAS , THUS WE HAVE DEVELOPED
31030 REM ** THEN INVENTORY COMMAND WHICH DOES AS IT IMPLIES
31040 REM **
31050 REM *******************************************************
31060 PRINT "OK."
31070 A=0
31080 MAT ALLPRINT=0
31090 PRINT "YOU,":NAME$(CNUM2):" ARE CARRYING THE FOLLOWING:"
31100 FOR J=1 TO 295
31110 IF NLOC(J)=-CNUM2 THEN A=A+1
31120 IF NLOC(J)<>-CNUM2 THEN GOTO 31250
31130 IF ALLPRINT(NCODE(J))=1 THEN GOTO 31260
31140 J3=0
31150 FOR J1=1 TO 295
31160 IF NLOC(J1)=P AND NCODE(J1)=NCODE(J) THEN J3=J3+1
31170 IF NLOC(J1)=P AND NCODE(J1)=NCODE(J) THEN ALLPRINT(NCODE(J1))=1
31180 NEXT J1
31190 IF APOINT(J)<1 OR J3>1 THEN GOTO 31210
31200 PRINT "A ":ADJECT$(APOINT(J)):" ":NOUN$(J):"."
31210 IF APOINT(J)<1 AND J3<2 THEN PRINT "A ":NOUN$(J):"."
31220 IF APOINT(J)<1 OR J3<2 THEN GOTO 31240
31230 PRINT J3:" ":ADJECT$(APOINT(J)):NOUN$(J):"'S."
31240 IF J3>1 AND APOINT(J)<1 THEN PRINT J3:" ":NOUN$(J):"'S."
31250 NEXT J
31260 REM
31270 IF A<1 THEN PRINT "NOTHING!"
31280 ENDF INVENTORY
31290 DEFINE QDONE
31300 REM ********************************************************
31310 REM **
31320 REM **
31330 REM **     HE HAS DECIDED TO LEAVE US
31340 REM **  SO IF THERE IS ONLY ONE , JUST END BUT IF MORE
31350 REM ** MUCK UP HIS DATA AND GO BACK (AFTER SAVING IT OF COURSE
31360 REM ********************************************************
31370 REM *** SAVE HIS DATA TO FILE
31380 OPEN NAME$(CNUM2)+".ADV-A" FOR SYMBOLIC RANDOM IO AS FILE CNUM2
31390 WRITE ON CNUM2 AT 1 IN FORM NUM$:S(CNUM2)
31400 WRITE ON CNUM2 IN FORM NUM$:D(CNUM2)
31410 WRITE ON CNUM2 IN FORM NUM$:C(CNUM2)
31420 WRITE ON CNUM2 IN FORM NUM$:II(CNUM2)
31430 WRITE ON CNUM2 IN FORM NUM$:W(CNUM2)
31440 WRITE ON CNUM2 IN FORM NUM$:CH(CNUM2)
31450 WRITE ON CNUM2 IN FORM NUM$:HP(CNUM2)
31460 WRITE ON CNUM2 IN FORM NUM$:HPTOTAL(CNUM2)
31470 WRITE ON CNUM2 IN FORM NUM$:AC(CNUM2)
31480 WRITE ON CNUM2 IN FORM NUM$:GOLD(CNUM2)
31490 WRITE ON CNUM2 IN FORM NUM$:CLOC(CNUM2)
31500 WRITE ON CNUM2 IN FORM NUM$:PLOC(CNUM2)
31510 WRITE ON CNUM2 IN FORM NUM$:EXPERIENCE(CNUM2)
31520 WRITE ON CNUM2 IN FORM NUM$:LEVEL(CNUM2)
31530 A=0
31540 FOR J=1 TO 295
31550 IF NLOC(J)=-CNUM2 THEN WRITE ON CNUM2 IN FORM NUM$:J
31560 IF NLOC(J)=-CNUM2 THEN A=A+1
31570 IF A=8 THEN GOTO 31590
31580 NEXT J
31590 IF A=8 THEN GOTO 31730
31600 A1=8-A
31610 A3=0
31620 FOR J=1 TO A1
31630 WRITE ON CNUM2 IN FORM NUM$:A3
31640 NEXT J
31650 WRITE ON CNUM2 IN FORM NUM$:MANA(CNUM2)
31660 WRITE ON CNUM2 IN FORM NUM$:MANATOTAL(CNUM2)
31670 FOR J=1 TO 5
31680 WRITE ON CNUM2 IN FORM NUM$:TBIL(CNUM2,J)
31690 NEXT J
31700 WRITE ON CNUM2 IN FORM NUM$:GONE(CNUM2)
31710 WRITE ON CNUM2 IN FORM NUM$:FPOOL(CNUM2)
31720 WRITE ON CNUM2 IN FORM NUM$:CWEP(CNUM2)
31730 WRITE ON CNUM2 IN FORM "R":NAME$(CNUM2)+"@"
31740 WRITE ON CNUM2 IN FORM "R":RACE$(CNUM2)+"@"
31750 WRITE ON CNUM2 IN FORM "R":CLASS$(CNUM2)+"@"
31760 WRITE ON CNUM2 IN FORM "R":ALIGN$(CNUM2)+"@"
31770 WRITE ON CNUM2 IN FORM "R":PASS$(CNUM2)+"@"
31780 WRITE ON CNUM2 IN FORM "R":RANK$(CNUM2)+"@"
31790 WRITE ON CNUM2 IN FORM "R":"*"
31800 CLOSE CNUM2
31810 IF CNUM=1 THEN CALL SCENARIOS
31820 IF DEAD<>-1 THEN P=0 
31830 NUMTURN=99
31840 PP=0
31850 CLOC(CNUM2)=0
31860 IF DEAD<>-1 THEN P=0 AND PP=0
31870 NLOC(CNUM2)=0
31880 A=0
31890 CNUM3=CNUM3-1
31900 CNUM=CNUM-1
31910 IF CNUM=1 THEN
31920 PRINT "WELL THAT ONLY LEAVES ONE CHARACTER."
31930 CNUM4=1
31940 REM       CNUM5=CNUM2
31950 ENDIF
31960 IF CNUM3=0 THEN PRINT "NO CHARACTERS LEFT TO PLAY... PLAY AGAIN SOON!"
31970 IF CNUM3=0 THEN END "BYE!"
31980 IF CNUM<1 THEN 
31990 CNUM3=0
32000 GOTO 31960
32010 ENDIF
32020 CALL SCENARIOS
32030 ENDF QDONE
32040 REM *********************************************************
32050 DEFINE CHANGEOVER
32060 REM **
32070 REM **    THIS ROUTINE TRANSLATES PERMANENT RECORDS
32080 REM **  INTO COMMON PROGRAM VARIABLES
32090 REM **
32100 REM *********************************************************
32110 PP=PLOC(CNUM2)
32120 P=CLOC(CNUM2)
32130 NHITS(CNUM2)=HP(CNUM2)
32140 NLOC(CNUM2)=P
32150 REM ** IF HES CRRYING RING NUMBER 265, THE REGENERATES
32160 IF NLOC(265)=-CNUM2 AND NHITS(CNUM2)<(HPTOTAL(CNUM2)-3) THEN NHITS(CNUM2)=NHITS(CNUM2)+3
32170 AC(CNUM2)=10
32180 IF D(CNUM2)>14 THEN AC(CNUM2)=AC(CNUM2)-(D(CNUM2)-14)
32190 REM **** RING NUMBER 221 PROTECTS!
32200 IF NLOC(221)=-CNUM2 THEN AC(CNUM2)=AC(CNUM2)-2
32210 IF NLOC(18)=-CNUM2 OR NLOC(162)=-CNUM2 OR NLOC(163)=-CNUM2 OR NLOC(164)=-CNUM2 OR NLOC(165)=-CNUM2 THEN AC(CNUM2)=AC(CNUM2)-3
32220 IF NLOC(166)=-CNUM2 THEN AC(CNUM2)=AC(CNUM2)-4
32230 IF NLOC(17)=-CNUM2 THEN AC(CNUM2)=AC(CNUM2)-1
32240 IF NLOC(20)=-CNUM2 AND P>756 THEN NLOC(20)=1
32250 IF P>670 AND P<757 THEN GOTO 32280
32260 IF NLOC(20)=-CNUM2 AND P>160 THEN NLOC(20)=1
32270 IF CLASS$(CNUM2)="MAGIC-USER" THEN MANATOTAL(CNUM2)=(II(CNUM2)*LEVEL(CNUM2))/2
32280 REM
32290 REM **** MONK ABILITIES ****
32295 IF CLASS$(CNUM2)<>"MONK" THEN GOTO 32320
32300 AC(CNUM2)=M.AC(LEVEL(CNUM2))
32310 IF CWEP(CNUM2)<1 THEN NDAM(CNUM2)=M.DAM(LEVEL(CNUM2))
32320 ENDF CHANGEOVER
32330 DEFINE CHANGEBACK
32340 REM ************************************************************
32350 REM **
32360 REM **   THIS CHANGES BACK NEW DATA IN TO CHARACTER RECORD
32370 REM **      (OPPOSITE OF CHANGEOVER)
32380 REM **
32390 REM ************************************************************
32400 PLOC(CNUM2)=PP
32410 CLOC(CNUM2)=P
32420 HP(CNUM2)=NHITS(CNUM2)
32430 IF CWEP(CNUM2)<1 THEN GOTO 32450
32440 IF NLOC(CWEP(CNUM2))<>-CNUM2 THEN CWEP(CNUM2)=0
32450 NLOC(CNUM2)=P
32460ENDF CHANGEBACK
32470 DEFINE SCENARIOS
32480 REM *****************************************************
32490 REM **
32500 REM **     THIS SUBPROGRAM SAVES SCENARIO DATA TO FILE
32510 REM **   SO THAT THE GAME CAN KEEP RECORD OF SPECIFIC DATA
32520 REM **  IT (THE FILE) IS WRITTEN IN BINARY SO USERS
32530 REM **   CANNOT SEE THE DATA
32540 REM **
32550 REM *****************************************************
32560 OPEN "SCENAR.IO-A" FOR BINARY IO AS FILE 1
32570 MAT WRITE ON 1:NLOC
32580 MAT WRITE ON 1:NHITS
32590 WRITE ON 1:GOLD(11:230)
32600 MAT WRITE ON 1:DFLAG
32610 WRITE ON 1:TURN
32620 WRITE ON 1:GP
32630 WRITE ON 1:GPP
32640 WRITE ON 1:GWEP
32650 MAT WRITE ON 1:GMAD
32660 WRITE ON 1:GC
32670 CLOSE 1
32680 ENDF SCENARIOS
32690 DEFINE SCENARIOR
32700 REM ************************************************
32710 REM ** 
32720 REM **   THIS IS OPPOSIT OF SCENARIOS(AVER)
32730 REM **   THIS SUB ROUTINE WILL RETIREVE THE DATA
32740 REM ** STORED ON DISK
32750 REM **
32760 REM ***********************************************
32770 OPEN "SCENAR.IO-A" FOR BINARY IO AS FILE 1
32780 FOR I=1 TO 295
32790         INPUT FROM 1:A
32800 IF ABS(A)>6 THEN NLOC(I)=A
32810         IF A>-1 THEN NLOC(I)=A
32820         NEXT I
32830 MAT INPUT FROM 1:NHITS
32840 INPUT FROM 1:GOLD(11:230)
32850 MAT INPUT FROM 1:DFLAG
32860 INPUT FROM 1:TURN
32870 INPUT FROM 1:GP,GPP
32880 INPUT FROM 1:GWEP
32890 MAT INPUT FROM 1:GMAD
32900 INPUT FROM 1:GC
32910 CLOSE 1
32920 FOR I=1 TO 10
32930 NLOC(I)=0
32940 NEXT I
32950 ENDF SCENARIOR
32960 REM ******************************************************
32970 DEFINE KILL
32980 REM **
32990 REM **     THIS IS THE "KILL" SUBROUTINE 
33000 REM **   HERE WE WILL DECIDE IF HIS COMMAND IS VALID
33010 REM **  AND THEN SEND HIM TO ONE OF THE VARIOUS
33020 REM **  COMBAT PROGRAMS...
33030 REM **
33040 REM ******************************************************
33050 IF NNUM<1 THEN PRINT "KILL WHAT?"
33060 IF NNUM<1 THEN GOTO 33360
33070 E=P
33080 CALL SEARCHP
33090   IF NNUM>10 THEN GOTO 33130
33100         IF GONE(NNUM)=1 OR GONE(NNUM)=2 THEN 
33110                 PRINT "I CAN'T SEE IT!"
33120                 GOTO 33360
33130                 ENDIF
33140 IF NLOC(NNUM)<>P THEN PRINT "I DON'T SEE IT HERE."
33150 IF NLOC(NNUM)<>P THEN GOTO 33360
33160 IF NNUM<11 THEN GOTO 33230
33170 IF MLOC(NCODE(NNUM))<>1 THEN PRINT NAME$(CNUM2):", YOU CANNOT ATTACK THAT!"
33180 IF MLOC(NCODE(NNUM))<>1 THEN GOTO 33360
33190 IF CWEP(CNUM2)>0 AND NNUM1<1 THEN
33200 NNUM1=CWEP(CNUM2)
33210 GOTO 33300
33220 ENDIF
33230 IF NNUM1<1 THEN GOTO 33300
33240 IF NLOC(NNUM1)<>-CNUM2 THEN PRINT "YOU HAVEN'T GOT ANY ":NOUN$(NNUM1):"!"
33250 IF NLOC(NNUM1)<>-CNUM2 THEN GOTO 33360
33260 IF NNUM1<>CWEP(CNUM2) THEN
33270 PRINT "YOUR ":NOUN$(NNUM1):" ISN'T DRAWN."
33280 GOTO 33360
33290 ENDIF
33300 IF NNUM1<1 THEN NNUM1=CNUM2
33310 IF NNUM<11 THEN CALL CCOMBAT
33320 IF NNUM>10 THEN CALL KMONSTER
33330 IF GONE(CNUM2)=2 THEN PRINT "YOU ARE NO LONGER INVISIBLE."
33340 GONE(CNUM2)=0
33350 NUMTURN=NUMTURN+3
33360 ENDF KILL
33370 DEFINE CCOMBAT
33380 REM **********************************************************
33390 REM **
33400 REM **    CHARACTER BATTLES ARE NEAT!
33410 REM **   FUN FUN FUN!
33420 REM **  AND HERE'S WHERE WE GET TO DO IT!
33430 REM **
33440 REM **********************************************************
33450 REM ** CHECK BONUES FOR FRIEND FBDAM AND FBHIT ARE USED
33460 IF S(CNUM2)>15 THEN FBDAM=(S(CNUM2)-15)
33470 IF S(CNUM2)>16 THEN FBHIT=(S(CNUM2)-16)
33480 IF CLASS$(CNUM2)="FIGHTER" THEN FBHIT=FBHIT+2
33490 IF CLASS$(CNUM2)="PRIEST" THEN FBHIT=FBHIT+1
33500 IF CLASS$(CNUM2)="MAGIC-USER" THEN FBHIT=FBHIT-1
33510 REM ** ENEMY BONUSES ARE EBDAM AND EBHIT
33520 IF S(NNUM)>15 THEN EBDAM=(S(NNUM)-15)
33530 IF S(NNUM)>16 THEN EBHIT=(S(NNUM)-16)
33540 REM ** NOW ROLL ... (15> HITS (-AC BONUS)
33550 TH=INT(RND(-1)*19)+1+FBHIT
33560 IF TH>10+AC(NNUM)-10-L THEN HIT=-1
33570 IF HIT<>-1 THEN PRINT "YOU MISSED!"
33580 IF HIT<>-1 THEN GOTO 33880
33590 PRINT "YOU HIT!"
33600 DAM=INT(RND(0)*NDAM(NNUM1))+1+FBDAM
33610 IF ASLEEP(NNUM)>0 THEN DAM=NDAM(NNUM1)
33620 IF ASLEEP(NNUM)>0 THEN DAM=DAM+FBDAM
33630 IF GONE(CNUM2)=1 AND CLASS$(CNUM2)="THIEF" THEN 
33640     IF LEVEL(CNUM2)>0 AND LEVEL(CNUM2)<5 THEN DAM=DAM*2
33650      IF LEVEL(CNUM2)>4 AND LEVEL(CNUM2)<9 THEN DAM=DAM*3
33660     IF LEVEL(CNUM2)>8 AND LEVEL(CNUM2)<13 THEN DAM=DAM*4
33670      IF LEVEL(CNUM2)>12 AND LEVEL(CNUM2)<17 THEN DAM=DAM*5
33680     IF LEVEL(CNUM2)>16 AND LEVEL(CNUM2)<21 THEN DAM=DAM*6
33690 IF LEVEL(CNUM2)>20 THEN DAM=DAM*7
33700 ENDIF
33710 PRINT "DOING ":DAM:" HIT POINTS!"
33720 NHITS(NNUM)=NHITS(NNUM)-DAM
33730 HP(NNUM)=HP(NNUM)-DAM
33740 IF NHITS(NNUM)<1 THEN DEAD=-1
33750 REM CALL PRINTER
33760 IF DEAD<>-1 THEN GOTO 33880
33770 PRINT "YOU KILLED ":NOUN$(NNUM)
33780 EXPERIENCE(CNUM2)=EXPERIENCE(CNUM2)+MONEXP(NCODE(NNUM))+HPTOTAL(NNUM)*3
33790 FOR I=1 TO 27
33800 IF NLOC(I)=-NNUM THEN NLOC(I)=P
33810 NEXT I
33820 Z=CNUM2
33830 CNUM2=NNUM
33840 S(NNUM)=0
33850 CALL QDONE
33860 CNUM2=Z
33870 HIT=0,FBDA=0,FBHIT=0,DAM=0
33880 CALL OBJECTPRINT
33890 ENDF CCOMBAT
33900 DEFINE CAST
33910 REM ************************************************************
33920 REM *
33930 REM *
33940 REM *      THIS IS WERE SPELLCASTING BEGINS....
33950 REM *    WE FIND OUT IF HE WANTS TO CAST SPELL IF SO TAKE CARE
33960 REM ** OF IT ELSE DROP WHATEER ELSE...
33970 REM **
33980 REM **
33990 REM *
34000 REM *
34010 REM ************************************************************
34020 IF NNUM<1 THEN PRINT "CAST WHAT!"
34030 IF NNUM<1 THEN GOTO 34130
34040 IF NNUM=25 THEN GOTO 34100
34050 IF NLOC(NNUM)<>-CNUM2 THEN PRINT "YOU DON'T HAVE IT!"
34060 IF NLOC(NNUM)<>-CNUM2 THEN GOTO 34130
34070 NLOC(NNUM)=P
34080 PRINT "OK"
34090 GOTO 34130
34100 IF CLASS$(CNUM2)="MAGIC-USER" THEN CALL MSPELL
34110 IF CLASS$(CNUM2)="MAGIC-USER" THEN GOTO 34130
34120 PRINT "YOU CANNOT CAST SPELLS!"
34130 ENDF CAST
34140 DEFINE MMOVE
34150 REM ************************************************************
34160 REM **
34170 REM **    THIS IS WERE WE MOVE MONSTERS AROUND THE ADVENTURE.
34180 REM **   FOR NOW THEY WILL JUST WANDER AROUND.
34190 REM **
34200 REM ************************************************************
34205 FOR MR=1 TO 295
34210 A=0      
34211         FOR I=1 TO 6
34212                 IF NLOC(MR)=P THEN GOTO 34220
34214                 IF NLOC(MR)=PLOC(I) THEN A=1
34216                 NEXT I
34218                 IF A=1 THEN GOTO 34785
34220         IF MR=277 THEN
34230                 CALL HOBBIT
34240                GOTO 34780
34250                 ENDIF
34260 IF MR=276 THEN GOTO 34780
34270 IF ASLEEP(MR)>0 THEN ASLEEP(MR)=ASLEEP(MR)-1
34280 IF ASLEEP(MR)>0 THEN GOTO 34780 ! HE'S ASLEEP
34290 IF NCODE(MR)=49 THEN GOTO 34780 ! FURNITURE
34300 IF NLOC(MR)<1 THEN GOTO 34780 ! GONE,NOT HERE
34310 IF MLOC(NCODE(MR))<>1 THEN GOTO 34780 ! MONSTERS ONLY!
34320 GOTO 34710
34330 REM ^^ GOTO MAIN BRANCH ^^
34340 REM ** MOVE **
34360 A=INT(RND(-1)*99)+1 ! CHANGE SEED
34370 A=INT(RND(0)*9)+1  ! CHOOSE DIRECTION
34380 A1=M(NLOC(MR),A) ! FIND NEW LOCATION
34390         IF A1<1 THEN GOTO 34415
34400         IF SLOC(A1)=1 THEN GOTO 34415
34410         IF SLOC(A1)=10 THEN GOTO 34415
34411 GOTO 34420
34415 GOTO 34480
34420         IF A1>0 THEN
34430                 IF A1<>NLOC(MR) AND NLOC(MR)=P THEN PRINT "A ":NOUN$(MR):" JUST LEFT GOING ":VERB$(VCODE(A)):"."
34440                 IF A1=P THEN PRINT "A ":NOUN$(MR):" IS WALKING NEARBYE."
34450           ENDIF
34460              G=99
34480 RETURN
34490 REM ** GET ** GET **
34500 FOR I=11 TO 295
34510 IF GETTN(NCODE(I))<>1 THEN GOTO 34550
34520 IF MLOC(NCODE(I))=1 THEN GOTO 34550
34530 IF NLOC(MR)=NLOC(I) THEN NLOC(I)=-MR
34540 IF NLOC(I)=-MR THEN GOTO 34560
34550 NEXT I
34560 RETURN
34570 REM ** KILL ** SLAY ** DEFILE ** ETC. **
34580 FOR I=1 TO 6
34590 REVENGE=0
34591 IF NCODE(MR)=60 OR NCODE(MR)=21 OR NCODE(MR)=19 THEN GOTO 34600
34592 IF NCODE(MR)=67 OR NCODE(MR)=68 THEN
34594         IF INT(RND(-1)*99)+1<55 THEN CALL MONBIL
34596         GOTO 34700
34598         ENDIF
34600 IF GONE(I)=1 THEN GOTO 34690
34603 IF NCODE(MR)=13 OR NCODE(MR)=20 OR NCODE(MR)=22 OR NCODE(MR)=28 OR NCODE(MR)=78 OR NCODE(MR)=81 THEN GOTO 34610
34609 IF GONE(I)=2 THEN GOTO 34690
34610         IF MALIGN(MR)=3 THEN GOTO 34690
34620         IF MALIGN(MR)=2 AND INT(RND(0)*99)+1<65 THEN GOTO 34690
34670 IF NLOC(MR)<>NLOC(I) THEN GOTO 34690
34675 IF NLOC(I)<1 THEN GOTO 34690
34680 CALL MKILL
34685 IF NHITS(MR)<(INT(NHITSII(MR)/2)) AND INT(RND(0)*99)+1<50 THEN GOTO 34780
34690 NEXT I
34700 RETURN
34710 REM ** MAIN BRANCH AREA **
34720 REM ** CHECK IF MONSTERS ARE CAPABLE OF GET
34730 IF NCODE(MR)=13 OR NCODE(MR)=20 OR NCODE(MR)=28 OR NCODE(MR)=30 OR NCODE(MR)=31 OR NCODE(MR)=32 THEN GOTO 34760 !KILL
34740 IF NCODE(MR)=32 OR NCODE(MR)=70 OR NCODE(MR)=71 OR NCODE(MR)=74 OR NCODE(MR)=75 OR NCODE(MR)=82 THEN GOTO 34760
34750 GOSUB 34490  ! GET AREA
34760 GOSUB 34570  ! KILL
34765 IF MMOV(MR)<>1 THEN GOTO 34771
34770 GOSUB 34340  ! MOVE
34771 REM
34780 IF NHITS(MR)<NHITSII(MR) THEN NHITS(MR)=NHITS(MR)+1
34781 IF NCODE(MR)=19 AND NHITS(MR)<NHITSII(MR) THEN NHITS(MR)=NHITS(MR)+2
34785 NEXT MR
34790 REM 
34800 ENDF MMOVE
34810 DEFINE KMONSTER
34820 REM ********************************************************
34830 REM **
34840 REM **     THIS IS WHERE THE CHARACTERS ATTACK
34850 REM **   NON-SIGNIFIGANT THINGS SUCH AS ORCS,DRAWVES
34860 REM **   SKELETONS ETC.
34870 REM **
34880 REM ********************************************************
34890 IF NNUM=276 THEN GMAD(CNUM2)=1
34900 MALIGN(NNUM)=1
34902 IF NCODE(NNUM)=78 AND NCODE(NNUM1)<>79 THEN
34904         PRINT "THE WEREWOLF IS NOT AFFECTED."
34906         GOTO 35620
34908         ENDIF
34910 REM ** TH IS THE DIE ROLL. ADD ABILITIE BONUS
34920 TH=TH+INT(RND(-1)*19+1)
34930 IF TH=20 THEN CCRIT1=-1
34940 IF TH=20 THEN GOTO 35050
34950 IF GONE(CNUM2)=1 THEN TH=TH+4
34960 IF GONE(CNUM2)=2 THEN TH=TH+4
34970 IF ASLEEP(NNUM)>0 THEN TH=TH+10
34980 IF S(CNUM2)>15 THEN TH=TH+(S(CNUM2)-16)
34990 IF CLASS$(CNUM2)="FIGHTER" THEN TH=TH+1
35000 IF TH>(11+INT(NHITS(NNUM)/10)) THEN HIT=-1
35010 IF CLASS$(CNUM2)="MAGIC-USER" THEN TH=TH-1
35020 IF HIT<>-1 THEN PRINT "YOU MISSED."
35030 IF HIT<>-1 THEN GOTO 35540
35040 PRINT "YOU HIT!"
35050 DAM=INT(RND(0)*NDAM(NNUM1)+1)
35052 IF NCODE(NNUM)=13 THEN DAM=INT(DAM/2)
35060 IF S(CNUM2)>15 THEN DAM=DAM+(S(CNUM2)-15)
35070 IF CCRIT1=-1 THEN CALL CCRIT
35080 IF CCRIT1=-1 THEN GOTO 35220
35090 IF GONE(CNUM2)=2 THEN DAM=DAM+4
35100 IF GONE(CNUM2)=1 AND CLASS$(CNUM2)<>"THIEF" THEN DAM=DAM*2
35110 IF GONE(CNUM2)<>1 THEN GOTO 35190
35120 IF CLASS$(CNUM2)="THIEF" OR CLASS$(CNUM2)="MONK" THEN
35130     IF LEVEL(CNUM2)>0 AND LEVEL(CNUM2)<5 THEN DAM=DAM*2
35140      IF LEVEL(CNUM2)>4 AND LEVEL(CNUM2)<9 THEN DAM=DAM*3
35150     IF LEVEL(CNUM2)>8 AND LEVEL(CNUM2)<13 THEN DAM=DAM*4
35160      IF LEVEL(CNUM2)>12 AND LEVEL(CNUM2)<17 THEN DAM=DAM*5
35170     IF LEVEL(CNUM2)>16 AND LEVEL(CNUM2)<21 THEN DAM=DAM*6
35180 ENDIF
35190 IF ASLEEP(NNUM)>0 THEN DAM=DAM+6
35200 PRINT "DOING ":DAM:" HIT POINTS OF DAMAGE!"
35210 PRINT
35220 NHITS(NNUM)=NHITS(NNUM)-DAM
35230 IF NHITS(NNUM)<1 THEN DEAD=-1
35240 IF DEAD=-1 THEN GOTO 35340
35250 IF (INT(RND(0)*99+1)+(NHITS(NNUM)/5))>35 THEN 35260 ELSE GOTO 35540
35260 REM **** VENGEANCE ****
35270 IF GONE(CNUM2)=1 OR GONE(CNUM2)=2 THEN GOTO 35540
35280 IF ASLEEP(NNUM)>0 THEN GOTO 35540
35290 REVENGE=1
35300 MR=NNUM
35310 I=CNUM2
35320 CALL MKILL
35330 GOTO 35540
35340 PRINT "YOU KILLED THE ":NOUN$(NNUM):"!"
35350 A=0
35352 FOR J=1 TO 6
35354         IF NLOC(J)=P THEN A=A+1
35356 NEXT J
35358 FOR J=1 TO 6
35360         IF NLOC(J)=P THEN EXPERIENCE(J)=EXPERIENCE(J)+INT(MONEXP(NCODE(NNUM))+NHITSII(NNUM)*2/A)
35362 NEXT J
35369 IF ASLEEP(NNUM)>0 THEN EXPERIENCE(CNUM2)=EXPERIENCE(CNUM2)-(MONEXP(NCODE(NNUM))*.5)
35370 IF GOLD(NNUM)<0 THEN GOLD(NNUM)=INT(RND(-1)*ABS(GOLD(NNUM))+1)
35380 IF GOLD(NNUM)<1 THEN GOTO 35430
35390 PRINT "THE MONSTER WAS CARRYING ":GOLD(NNUM):" GOLD PIECES."
35400 PRINT "THIS WILL BE ADDED TO YOUR SUM OF ":GOLD(CNUM2)
35410 PRINT "TO MAKE A TOTAL OF ":GOLD(NNUM)+GOLD(CNUM2)
35420 GOLD(CNUM2)=GOLD(CNUM2)+GOLD(NNUM)
35430 REM 22560
35440 A=0
35450 FOR I=1 TO 295
35460 IF NLOC(I)=-NNUM AND A<>1 THEN PRINT "HE DROPPED SOMETHING!"
35470 IF NLOC(I)=-NNUM THEN A=1
35480 IF NLOC(I)=-NNUM THEN NLOC(I)=P
35490 NEXT I
35500 NLOC(NNUM)=0
35510 PRINT
35520 REM GO GO GO GO GO GO
35530 REM
35540 REM
35550 IF NLOC(CNUM2)<>0 THEN CALL OBJECTPRINT
35560 REM
35570 IF HIT<>-1 THEN GOTO 35620
35575 IF CLASS$(CNUM2)<>"THIEF" AND CLASS$(CNUM2)<>"MONK" THEN GOTO 35620
35580 IF GONE(CNUM2)=1 THEN PRINT "YOU HAVE JUST EXECUTED A SURPRISE BACKSTAB!"
35590 IF GONE(CNUM2)=2 THEN GONE(CNUM2)=0
35600 IF GONE(CNUM2)=1 THEN EXPERIENCE(CNUM2)=EXPERIENCE(CNUM2)+LEVEL(CNUM2)
35610 IF GONE(CNUM2)=1 THEN GONE(CNUM2)=0
35620 DEAD=0,HIT=0,DAM=0,CCRIT1=0
35630 GONE(CNUM2)=0
35640 ENDF KMONSTER
35650 DEFINE MKILL
35660 REM ********************************************************
35670 REM **
35680 REM **    THIS IS WHERE MONSTERS GET TO KILL
35690 REM ** CHARACTERS
35700 REM **
35710 REM *********************************************************
35720 IF REVENFE<>1 THEN GOTO 35770
35730 IF REVENGE=1 THEN I=CNUM2
35740 IF REVENGE=1 THEN I=CNUM2
35750 IF REVENGE=1 AND GONE(I)=2 THEN GOTO 36210
35760 IF REVENGE=1 THEN GOTO 35780
35770 REM HEY BLOOD! I'M 64100 SOMETIMES
35780 IF REVENGE=1 THEN PRINT "THE ":NOUN$(MR):" ATTACKS BACK!"
35790 IF REVENGE<>1 THEN PRINT "THE ":NOUN$(MR):" ATTACKS ":NAME$(I)
35800 I8=NUMHITS(MR)
35810 IF REVENGE=1 THEN I8=1
35820 FOR I9=1 TO I8
35830 TH=INT(RND(0)*20+1)
35840 TH=TH-(10-AC(CNUM2))
35850 IF REVENGE=1 THEN TH=TH-5
35852 TH=TH+NHITSII(MR)/10
35853 IF ASLEEP(I)>0 THEN TH=TH+4
35860 IF TH>10 THEN HIT=-1
35870 IF HIT=-1 THEN HITT=HITT+1
35880 HIT=0
35890 NEXT I9
35900 IF HITT>0 THEN HIT=-1
35910 IF HIT<>-1 THEN PRINT "IT MISSED!"
35920 IF HIT<>-1 THEN GOTO 36200
35930 PRINT "IT HIT ":HITT:" TIMES !"
35940 FOR I9=1 TO HITT
35950 DAM=DAM+INT(RND(0)*NDAM(MR)+1)
35952 DAM=DAM+INT(NHITSII(MR)/5)
35960 IF REVENGE=1 AND DAM>4 THEN DAM=DAM-3
35970 IF REVENGE=1 THEN I9=99
35980 NEXT I9
35990 MONTURN=1
36000 PRINT "DOING ":DAM:" HITS!"
36010 IF NCODE(MR)<>67 AND NCODE(MR)<>68 THEN CALL MONBIL
36020 IF I>10 THEN GOTO 36040
36030 IF I<11 THEN HP(I)=HP(I)-DAM
36040 NHITS(I)=NHITS(I)-DAM
36050 IF NHITS(I)<1 THEN DEAD=-1
36060 IF DEAD<>-1 THEN GOTO 36200
36070 PRINT "AND HE KILLED HIM!"
36080 IF I>10 THEN GOTO 36190
36090 FOR A=1 TO 295
36100 IF NLOC(A)=-I THEN NLOC(A)=P
36110 NEXT A
36120 IF REVENGE=1 AND NHITS(I)<1 THEN P=0 AND PP=0
36130 Z=CNUM2
36140 CNUM2=I
36150 S(I)=0
36160 CALL QDONE
36170 CNUM2=Z
36180 IF CNUM2=I THEN NUMTURN=INT(D(CNUM2)/4)
36190 REM THIS WAS AT ONE TIME 27250 BUT NOT NOW!!!
36200 HIT=0,HITT=0,DAM=0,REVENGE=0
36210 MKIL=-1
36220 ENDF MKILL
36230 DEFINE STATUS
36240 REM ***********************************************
36250 REM **
36260 REM **       
36270 REM **  THIS IS WHERE THE MAN GET'S TO SEE HIS CHARACTER!
36280 REM **  
36290 REM ***********************************************
36300 PRINT "YOU HAVE ":HP(CNUM2):" HIT POINTS OUT OF A TOTAL ":HPTOTAL(CNUM2):"."
36310 PRINT
36320 PRINT "DO YOU WISH TO SEE YOUR CHARACTER?":
36330 INPUT IN FORM "R":Y$
36340 IF LEFT(Y$,1)<>"Y" THEN GOTO 36630
36350 PRINT "OK."
36360 PRINT 
36370 PRINT NAME$(CNUM2):" ":ALIGN$(CNUM2):" - ":CLASS$(CNUM2):" - ":RACE$(CNUM2)
36380 PRINT RANK$(CNUM2)
36390 PRINT
36400 PRINT "STRENGTH-":S(CNUM2):"         ":GOLD(CNUM2):" GOLD PIECES."
36410 PRINT "DEXTERITY-":D(CNUM2)
36420 PRINT "CONSTITUTION-":C(CNUM2):"      EXPERIENCE POINTS-":EXPERIENCE(CNUM2)
36430 PRINT "INTELIGENCE-":II(CNUM2)
36440 PRINT "WISDOM-":W(CNUM2)
36450 PRINT "CHARISMA-":CH(CNUM2)
36460 PRINT 
36470 PRINT "YOUR AC IS:":AC(CNUM2)
36480 PRINT "EXPERIENCE LEVEL-":LEVEL(CNUM2)
36490 PRINT "YOU HAVE ":HP(CNUM2):" HIT POINTS OUT OF A TOTAL-":HPTOTAL(CNUM2):"."
36500 IF CLASS$(CNUM2)="MAGIC-USER" THEN PRINT "YOU HAVE ":MANA(CNUM2):" SPELL POINTS,OUT OF A TOTAL-":MANATOTAL(CNUM2):"."
36510 PRINT
36520 IF CWEP (CNUM2)=0 THEN GOTO 36550
36530 PRINT "YOU HAVE YOUR ":NOUN$(CWEP (CNUM2)):" DRAWN."
36540 GOTO 36560
36550 PRINT "YOU ARE USING YOUR BARE HANDS AS A WEAPON!"
36560 PRINT "YOU ARE CARRYING THE FOLLOWING OBJECTS:":
36570 PRINT
36580 FOR I=1 TO 295
36590 IF NLOC(I)=-CNUM2 THEN PRINT "A ":NOUN$(I):"."
36600 NEXT I
36610 PRINT
36620 PRINT "DONE."
36630 PRINT "THIS IS ROUND #":TURN
36640 IF P=16 THEN CALL NEWEXP
36650 ENDF STATUS
36660 DEFINE SEARCHP
36670 REM **********************************************
36680 REM **
36690 REM **    THIS IS THE FIRST OF A FEW SEARCH PROGRAMS
36700 REM **   SEEING AS HOW I AM GOING TO HAVE MANY OF ONE TYPE
36710 REM **   OF NOUNS THE PARSER HAS TO PICK THE *FIRST*
36720 REM **   THAT FITS THE RQUIRMENTS OF THE CERTAIN
36730 REM **   ACTION SPECIFIED BY THE PLAYER THIS ONE
36740 REM **   SEARCHES FOR ALL NOUNS BY THE NAME (????)
36750 REM **  WHATEVER SPECIFIED THAT IS AT THE USERS LOC
36760 REM **
36770 REM ***********************************************
36780 IF NNUM<1 THEN GOTO 36900
36790 IF TEST.FUNCT=10 THEN PRINT "P=":P:" CLOC(CNUM2)=":CLOC(CNUM2):"  CNUM2=":CNUM2
36800 FOR I=NNUM TO 295
36810 A=0
36820 IF NLOC(I)=E AND NOUN$(I)=NOUN$(NNUM) THEN A=2
36830 IF ANUM<1 THEN GOTO 36870
36840 IF APOINT(I)<1 THEN GOTO 36870
36850 IF APOINT(I)=ANUM THEN GOTO 36870 ELSE A=0
36860 GOTO 36880
36870 IF A=2 THEN GOTO 36900
36880 NEXT I
36890 GOTO 36910
36900 NNUM=I
36910 ENDF SEARCHP
36920 DEFINE NEWEXP
36930 REM ****************************************************
36940 REM **
36950 REM **  THIS IS WHERE PEOPLE GAIN LEVELS.
36960 REM ** YOU MUST SAYS '*STATUS' WHILE IN THE INN
36970 REM **  GAIN HP AND LEVELS (FIGHT ETC.)
36980 REM **  ARRAY (2D) HAS REQUIRMENTS FOR NEW LEVELS
36990 REM **
37000 REM ****************************************************
37010A=0
37020 IF CLASS$(CNUM2)="WARRIOR" THEN A=1
37030 IF CLASS$(CNUM2)="MAGIC-USER" THEN A=2
37040 IF CLASS$(CNUM2)="PRIEST" THEN A=3
37050 IF CLASS$(CNUM2)="THIEF" THEN A=4
37060 IF CLASS$(CNUM2)="MONK" THEN A=1
37070 IF EXPERIENCE(CNUM2)>=EGOAL(A,LEVEL(CNUM2)) THEN GOTO 37100
37080 PRINT "YOU NEED ":(EGOAL(A,LEVEL(CNUM2))-EXPERIENCE(CNUM2)):" TO GAIN A LEVEL."
37090 GO TO 37520
37100 PRINT "YOU GAINED A LEVEL !!!!"
37110 PRINT
37120 FOR I=1 TO 6
37130 A1=INT(RND(0)*9+1)
37140 IF A1=10 OR A1=1 THEN GOTO 37200
37150 IF A1<3 THEN A1=-1 ELSE A1=1
37160 PRINT "YOU ":
37170 IF A1=1 THEN PRINT "GAINED ":
37180 IF A1=-1 THEN PRINT "LOST ":
37190 ON I GOTO 37220,37250,37280,37310,37340,37370
37200 NEXT I
37210 GOTO 37390
37220 PRINT "STRENGTH "
37230 S(CNUM2)=S(CNUM2)+A1
37240 GOTO 37200
37250 PRINT "DEXTERITY "
37260 D(CNUM2)=D(CNUM2)+A1
37270 GOTO 37200
37280 PRINT "CONSTITUTION "
37290 C(CNUM2)=C(CNUM2)+A1
37300 GOTO 37200
37310 PRINT "INTELIGENCE "
37320 II(CNUM2)=II(CNUM2)+A1
37330 GOTO 37200
37340 PRINT "WISDOM "
37350 W(CNUM2)=C(CNUM2)+A1
37360 GOTO 37200
37370 PRINT "CHARISMA "
37380 CH(CNUM2)=CH(CNUM2)+A1
37390 IF A=1 THEN HPTOTAL(CNUM2)=HPTOTAL(CNUM2)+INT(RND(0)*9+1)
37400 IF A=2 THEN HPTOTAL(CNUM2)=HPTOTAL(CNUM2)+INT(RND(0)*3+1)
37410 IF A=3 THEN HPTOTAL(CNUM2)=HPTOTAL(CNUM2)+INT(RND(0)*7+1)
37420 IF A=4 THEN HPTOTAL(CNUM2)=HPTOTAL(CNUM2)+INT(RND(0)*5+1)
37430 IF C(CNUM2)>14 THEN HPTOTAL(CNUM2)=HPTOTAL(CNUM2)+(C(CNUM2)-14)
37440 LEVEL(CNUM2)=LEVEL(CNUM2)+1
37450 IF CLASS$(CNUM2)="WARRIOR" THEN A=1
37460 IF CLASS$(CNUM2)="MAGIC-USER" THEN A=2
37470 IF CLASS$(CNUM2)="THIEF" THEN A=3
37480 IF CLASS$(CNUM2)="MONK" THEN A=4
37490 RANK$(CNUM2)=MASTERRANK$(A,LEVEL(CNUM2))
37500 IF CLASS$(CNUM2)="THIEF" THEN CALL TNEWB
37510 IF CLASS$(CNUM2)="MONK" THEN CALL TNEWB
37520 ENDF NEWEXP
37530 DEFINE ADJSEARCH
37540 REM *********************************************************
37550 REM **
37560 REM **      SEARCH FOR ADJECTIVES IN WORD 2
37570 REM **
37580 REM **
37590 REM **********************************************************
37600 FOR I=1 TO 34
37610 IF WORD$(2)=ADJECT$(I) THEN B=1
37620 IF WORD$(2)=ADJECT$(I) THEN ANUM=I
37630 IF WORD$(2)=ADJECT$(I) THEN GOTO 37660
37640 NEXT I
37650 B=0
37660 ENDF ADJSEARCH
37670 DEFINE PICK
37680 REM *******************************************************
37690 REM **
37700 REM **     THIS IS THE SUBROUTINE FOR THE VERB PICK...
37710 REM **   PICK IS MAINLY USED FOR THIEVES ALTHOUGH I MAY
37720 REM **  THINK OF ANOTHER USE IN THE FUTURE.
37730 REM **  TO USE PICK THE NOUN 'POCKET' MUST ALSO
37740 REM **  BE ENTERED. OTHERWISE "PICK WHAT?!?"
37750 REM **
37760 REM **
37770 REM *******************************************************
37780 PPNUM=0
37790 IF WORD$(2)="POCKET" THEN NNUM=136
37800 IF NNUM<>136 THEN PRINT "PICK WHAT?!?"
37810 IF NNUM<>136 THEN GOTO 38240
37820 IF CLASS$(CNUM2)<>"THIEF" THEN PRINT "ONLY THIEVES MAY ATTEMPT THIS!"
37830 IF CLASS$(CNUM2)<>"THIEF" THEN GOTO 38240
37840 PRINT "WHOSE POCKETS DO YOU WISH TO PICK?":
37850 INPUT IN FORM "R":A$
37860 FOR I=1 TO 295
37870 IF NOUN$(I)=A$ AND MLOC(NCODE(I))=1 THEN GOTO 37900
37880 IF NOUN$(I)=A$ AND I<7 THEN GOTO 37900
37890 NEXT I
37900 IF NOUN$(I)=A$ AND MLOC(NCODE(I))=1 THEN PPNUM=I
37910 IF NOUN$(I)=A$ AND I<11 THEN PPNUM=I
37912 IF PPNUM=CNUM2 THEN PPNUM=-1
37920 IF PPNUM<1 THEN PRINT "INVALID TARGET!"
37930 IF PPNUM<1 THEN GOTO 37840
37940 IF NLOC(PPNUM)<>P THEN
37950 PRINT "IT IS NOT HERE TO PICK."
37960 GOTO 38250
37970 ENDIF
37980 IF PPNUM<1 THEN GOTO 38240
37990 PRINT "ARE YOU ATTEMPTING TO STEAL (1)ITEMS OR (2)MONEY?":
38000 INPUT A
38010 IF A<1 OR A>2 THEN GOTO 37990
38020 A1=INT(RND(-1)*99)+1
38030 IF A1>TBIL(CNUM2,1)+12 THEN CAUGHC=-1
38040 IF A1>TBIL(CNUM2,1)+12 THEN CALL CAUGHT
38050 IF CAUGHC=-1 THEN GOTO 38240
38060 IF A1>TBIL(CNUM2,1) AND A1<TBIL(CNUM2,1)+12 THEN PRINT "YOU FAILED!"
38070 IF A1>TBIL(CNUM2,1) AND A1<TBIL(CNUM2,1)+12 THEN GOTO 38240
38080 IF A=1 THEN GOTO 38150
38090 A1=INT(RND(-1)*GOLD(PPNUM))+1
38100 PRINT "YOU STOLE ":A1:" GOLD PIECES!"
38110 GOLD(CNUM2)=GOLD(CNUM2)+A1
38120 GOLD(PPNUM)=GOLD(PPNUM)-A1
38130 EXPERIENCE(CNUM2)=EXPERIENCE(CNUM2)+A1
38140 GOTO 38240
38150 FOR E=1 TO 295
38160 A2=0
38170 IF NLOC(E)=-PPNUM THEN
38180 PRINT "YOU FOUND SOMETHING!"
38190 NLOC(E)=-CNUM2
38200 GOTO 38240
38210 ENDIF
38220 NEXT E
38230 PRINT "YOU FOUND NOTHING!"
38240 CAUGHC=0
38250 NUMTURN=NUMTURN+3
38252 GONE(CNUM2)=0
38258 ENDF PICK
38260 DEFINE CAUGHT
38270 REM *******************************************************
38280 REM ****** C A U G H T ************************************
38290 REM *******************************************************
38300 PRINT "YOU HAVE BEEN CAUGHT!"
38310 PRINT
38320 IF PPNUM<11 THEN
38330 PMESSAGE(PPNUM)=CNUM2
38340 GOTO 38420
38350 ENDIF
38360 PRINT "THE ":NOUN$(PPNUM):" ATTACKS YOU!"
38370 REVENGE=0
38380 I=CNUM2
38390 MR=PPNUM
38400 I =CNUM2
38410 CALL MKILL
38420 ENDF CAUGHT
38430 DEFINE GOLDINIT
38440 REM ******************************************************
38450 REM ** INITIALIZE GOLD VALUES FOR GOLD ARRAY
38460 REM ******************************************************
38470 FOR J=1 TO 295
38480 IF GOLD(J)<0 THEN GOLD(J)=INT(RND(-1)*ABS(GOLD(J)))+1
38490 NEXT J
38500 ENDF GOLDINIT
38510 DEFINE NCHECK
38520 REM *******************************************************
38530 REM **
38540 REM **    CHECK NAME OF CHARACTER AGIANST FILES ON DIR
38550 REM **
38560 REM *******************************************************
38570 A=0
38580 IF FD.OPEN("") THEN GOTO 38590 ELSE END "STOPPED IN 34060"
38590 CALL FD.WILD(SNAME$,E$)
38600 IF FD.STEP THEN
38610 A=1
38620 GOTO 38600
38630 ENDIF
38640 ENDF NCHECK
38650 DEFINE CWALLS
38660 REM ****************************************************
38670 REM **
38680 REM **   THIS IS THE NEXT THIEVING SUBROTUINE
38690 REM **  THIS ONE IS FOR THE ABILITY CLIMB WALLS.
38700 REM **  WHERE EVER THERE IS A SLOC VALUE THAT
38710 REM **  EQUALS 9 THE THIEF MAY CLIMB WALLS.
38720 REM **
38730 REM ****************************************************
38740 IF GONE(CNUM2)=1 THEN PRINT "YOU *ARE* ON THE WALL!"
38750 IF GONE(CNUM2)=1 THEN GOTO 39110
38760 IF NLOC(171)=-CNUM2 THEN GOTO 39000
38770 IF SACT(CNUM2,4)=1 AND GONE(CNUM2)=1 THEN GOTO 39110
38780 IF SACT(CNUM2,4)=1 THEN GOTO 39000
38790 IF SLOC(P)<>9 THEN PRINT "YOU CANNOT CLIMB ANY WALLS HERE."
38800 IF SLOC(P)<>9 THEN GOTO 39110
38810 NUMTURN=NUMTURN+3
38820 IF CLASS$(CNUM2)="THIEF" OR CLASS$(CNUM2)="MONK" THEN GOTO 38920
38830 IF SACT(CNUM2,4)=1 THEN GOTO 39000
38840 IF INT(RND(-1)*99+1)<LEVEL(CNUM2) THEN GOTO 39000
38850 PRINT "YOU ATTEMPT TO CLIMB THE WALLS BUT FALL AND YOU"
38860 A=INT(RND(0)*6+1)
38870 NHITS(CNUM2)=NHITS(CNUM2)-A
38880 PRINT "TAKE ":A:" POINTS DAMAGE!"
38890 IF NHITS(CNUM2)<1 THEN PRINT "YOU DIED."
38900 IF NHITS(CNUM2)<1 THEN CALL QDONE
38910 GOTO 39110
38920 IF INT(RND(0)*99+1)<TBIL(CNUM2,4) THEN GOTO 39000
38930 PRINT "YOUR CLIMB WALLS ATTEMPT FAILED."
38940 A=INT(RND(-1)*3)
38950 NHITS(CNUM2)=NHITS(CNUM2)-A
38960 PRINT "YOU TAKE ":A:" DAMAGE!"
38970 IF NHITS(CNUM2)<1 THEN PRINT "YOU DIED."
38980 IF NHITS(CNUM2)<1 THEN CALL QDONE
38990 GOTO 39110
39000 PRINT "YOU SUCCEDED IN CLIMBING THE WALL!"
39010 EXPERIENCE(CNUM2)=EXPERIENCE(CNUM2)+(20-LEVEL(CNUM2))
39020 GONE(CNUM2)=1
39030 GOTO 39110
39040 A=INT(RND(0)*99)+1
39050 IF A<TBIL(CNUM2,4) THEN
39060 GOTO 39110
39070 ENDIF
39080 PRINT "YOU FELL OFF OF THE WALL THAT YOU WERE ON!"
39090 GONE(CNUM2)=1
39100 GOTO 38860
39110 ENDF CWALLS
39120 DEFINE TNEWB
39130 REM ******************************************************
39140 REM **
39150 REM **    THIS SUBROUTINE UPDATES NEW THIEVING ABILITIES
39160 REM **  WHENEVER THE CHARACTER (IF HE IS A THIEF) GOES
39170 REM **  UP A LEVEL.
39180 REM **
39190 REM ******************************************************
39200 TBIL(CNUM2,1)=TBIL(CNUM2,1)+5
39210 TBIL(CNUM2,2)=TBIL(CNUM2,2)+4
39220 TBIL(CNUM2,3)=TBIL(CNUM2,3)+6
39230 TBIL(CNUM2,4)=TBIL(CNUM2,4)+1
39240 TBIL(CNUM2,5)=TBIL(CNUM2,5)+3
39250 ENDF TNEWB
39260 DEFINE ADMSEARCH
39270 REM ******************************************************
39280 REM ** 
39290 REM ** SEARCH FOR ADJECTIVE MODIFIER IN WORD 2
39300 REM ** IF FOUND THEN CHECK FOR ADJECTIVE IN WORD 3
39310 REM ** FOR MORE INFOR SEE DATA AFTER ADJECTIVES
39320 REM ** 
39330 REM ******************************************************
39340 FOR I=1 TO 7
39350 IF WORD$(2)=ADMOD$(I) THEN AANUM=I
39360 IF WORD$(2)=ADMOD$(I) THEN B=1 ELSE B=0
39370 IF WORD$(2)=ADMOD$(I) THEN GOTO 39390
39380 NEXT I
39390 IF B=1 THEN CALL ADJSEARCH3
39400 ENDF ADMSEARCH
39410 IF NNUM<11 THEN GOTO 39440
39420 IF NNUM1<1 THEN PRINT "YOUR LETHAL FISTS VANQUISHED IT!"
39430 IF NNUM1>1 THEN PRINT "YOU IMPALED YOUR WEAPON IN ITS ABDOMEN!"
39440 IF NNUM1>1 THEN NLOC(NNUM1)=P
39450 DAM=3000
39460 RETURN
39470 DEFINE ADJSEARCH3
39480 REM ************************************************
39490 REM ** SEARCH FOR AN ADJECTIVE IN WORD 3
39500 REM **
39510 REM ************************************************
39520 FOR I=1 TO 34
39530 IF WORD$(3)=ADJECT$(I) THEN B=2
39540 IF WORD$(3)=ADJECT$(I) THEN ANUM=I
39550 IF WORD$(3)=ADJECT$(I) THEN GOTO 39580
39560 NEXT I
39570 B=0
39580 ENDF ADJSEARCH3
39590 DEFINE USEARCH
39600 REM ******************************************************
39610 REM **
39620 REM **      THIS PROGRAM SEARCHES THE DATA FOR AN 
39630 REM **   OBJECT THAT FITS HIS INPUT, SUCH AS:
39640 REM ** IS THERE A 'DEAD RED CAR' AND CAN HE CLIMB IT?
39650 REM **  THAT IS WHAT WE ARE HERE TO FIND OUT.
39660 REM ******************************************************
39670 NNUM2=NNUM
39680 REM BUT? BUT? WHAT HAPPEND?
39690 IF NNUM<1 THEN GOTO 39920
39700 FOR I=(NNUM2+1) TO 295
39710 NNUM=I
39720 IF NOUN$(NNUM)<>NOUN$(NNUM2) THEN GOTO 39900
39730 IF NLOC(NNUM)<>E THEN GOTO 39890
39740 A=0
39750 A1=0
39760 IF ANUM<1 THEN GOTO 39790
39770 IF APOINT(NNUM)=ANUM THEN A=A+1
39780 A1=A1+1
39790 IF AANUM<1 THEN GOTO 39820
39800 IF APMOD(NNUM)=AANUM THEN A=A+1
39810 A1=A1+1
39820 IF IANUM<1 THEN GOTO 39860
39830 IF NNUM1<1 THEN GOTO 39860
39840 IF APOINT(NNUM )=IANUM THEN A=A+1
39850 A1=A1+1
39860 REM HEY CONTINUE!
39870 IF A=A1 THEN GOTO 39920
39880 IF A1<1 AND I<295 THEN GOTO 39890
39890 REM AH HA! YOU DIRTY RAT! DIE YOU SCUMBAGS...
39900 NEXT I
39910 NNUM=NNUM2
39920 REM HI GUY!
39930 ENDF USEARCH
39940 DEFINE ADJSEARCH5
39950 REM *********************************************************
39960 REM ***    
39970 REM ***    
39980 REM ***      SEARCH FOR ADJECTIVE IN WORD(5)
39990 REM *** IF IT IS THERE THEN IT IS AN ADJECTIVE FOR
40000 REM *** AN INDIRECT OBJECT
40010 REM ***
40020 REM ***
40030 REM *********************************************************
40040 FOR I=1 TO 34
40050 IF WORD$(B+4)=ADJECT$(I) THEN IANUM=I
40060 IF WORD$(B+4)=ADJECT$(I) THEN B=B+1
40070 IF WORD$(B+4)=ADJECT$(I) THEN GOTO 40090
40080 NEXT I
40090 REM
40100 ENDF ADJSEARCH5
40110 DEFINE INDIRECTSEARCH
40120 REM ***************************************************
40130 REM **
40140 REM ***
40150 REM ****       THIS SUB MATCHES CORRECT INDIRECT OBJECTS
40160 REM ***
40170 REM **
40180 REM ***************************************************
40190 IF NNUM1<1 THEN GOTO 40300
40200 FOR I=(NNUM1+1) TO 295
40210 A=0
40220 IF NLOC(I)=-CNUM2 AND NOUN$(I)=NOUN$(NNUM1) THEN A=2
40230 IF IANUM<1 THEN GOTO 40260
40240 IF APOINT(I)<1 THEN GOTO 40260
40250 IF APOINT(I)=ANUM THEN GOTO 40260 ELSE A=0
40260 IF A=2 THEN GOTO 40290
40270 NEXT I
40280 GOTO 40300
40290 NNUM1=I
40300 ENDF INDIRECTSEARCH
40310 DEFINE BUY
40320 REM ********************************************************
40330 REM ** 
40340 REM **   THIS SUBROUTINE ALLOWS THE CHARACTER TO PURCHASE
40350 REM **  ITEMS AT THE LOCATION 7 STORE.
40360 REM **
40370 REM ********************************************************
40380 IF NNUM<1 THEN GOTO 40540
40390 IF NLOC(CNUM2)<>7 THEN PRINT "YOU ARE NOT IN A STORE!"
40400 IF NLOC(CNUM2)<>7 THEN GOTO 40540
40410 E=10000
40420 CALL USEARCH
40430 IF NLOC(NNUM)<>10000 THEN PRINT "THE ":NOUN$(NNUM):" IS NOT FOR SALE ":NAME$(CNUM2):"!"
40440 IF NLOC(NNUM)<>10000 THEN GOTO 40540
40450 PRINT "THAT WILL COST YOU ":PRICE(NCODE(NNUM)):" GOLD PIECES."
40460 IF GOLD(CNUM2)<PRICE(NCODE(NNUM)) THEN PRINT "YOU CANNOT AFFORD IT ":NAME$(CNUM2):"!"
40470 IF GOLD(CNUM2)<PRICE(NCODE(NNUM)) THEN GOTO 40540
40480 PRINT "YOU'VE GOT A DEAL ":NAME$(CNUM2):" THE STORE MANAGER"
40490 PRINT "LAYS YOUR ":NOUN$(NNUM):" ON THE COUNTER."
40500 PRINT
40510 NLOC(NNUM)=7
40520 GOLD(CNUM2)=GOLD(CNUM2)-PRICE(NCODE(NNUM))
40530 PRINT "YOU HAVE ":GOLD(CNUM2):" GOLD PIECES LEFT."
40540 ENDF BUY
40550 DEFINE CCRIT
40560 REM *******************************************************
40570 REM *
40580 REM **
40590 REM ***
40600 REM **** THIS IS THE CRITICAL HIT TABLE FOR CHARACTER ATTACKS
40610 REM ***
40620 REM **
40630 REM *
40640 REM *******************************************************
40650 IF NNUM<11 THEN PRINT "YOU CRITICALLY HIT ":NAME$(NNUM):"!"
40660 IF NNUM>10 THEN PRINT "YOU CRITICALLY HIT THE ":NOUN$(NNUM):"!"
40670 PRINT
40680 A=INT(RND(-1)*2+1)
40690 ON A GOSUB 40710,40740,40770
40700 GOTO 40830
40710 PRINT "YOUR HIT INFLICTED TWICE NORMAL DAMAGE!"
40720 DAM=DAM*2
40730 RETURN
40740 PRINT "YOUR BLOW DID THRICE NORMAL DAMAGE!"
40750 DAM=DAM*3
40760 RETURN
40770 REM BAD ASSED CRIT!
40780 IF NNUM<11 AND NNUM1<1 THEN PRINT "YOUR DEADLY HANDS PUNCTURED HIS FUMBLING BODY!"
40790 IF NNUM<11 AND NNUM1>1THEN PRINT "YOU IMPALED YOUR "
40800 IF NNUM<11 AND NNUM1>1 THEN PRINT "WEAPON IN HIS CHEST!"
40810 DAM=1000
40820 IF NNUM1>0 THEN NLOC(NNUM1)=P
40830 ENDF CCRIT
40840 REM ***************************************************
40850 REM **
40860 REM **   ADVANCED NOUN STATISTICS
40870 REM **
40880 REM ***************************************************
40890 DEFINE PRINTN
40900 I1=1
40910 PRINT TAB(1):"NAME":TAB(10):"ADJECT":TAB(18):"NCODE":TAB(25):         TAB(34):"MMOVE":TAB(45):"NLOC":TAB(54):"MALIGN":
40920 PRINT
40930 FOR I=1 TO 295
40940 PRINT TAB(1):NOUN$(I):
40950 IF APOINT(I)=0 THEN GOTO 40970
40960 PRINT TAB(10):ADJECT$(APOINT(I)):
40970 PRINT TAB(18):NCODE(I):
40980 PRINT TAB(25):"#":I:
40990 PRINT TAB(34):MMOV(I):
41000 PRINT TAB(45):NLOC(I):
41010 PRINT TAB(54):MALIGN(I):
41020 PRINT
41030 IF I=295 THEN GOTO 41050
41040 IF NCODE(I)=NCODE(I1+1) THEN GOTO 41060
41050 PRINT "----------------------------------------------------------------"
41060 I1=I
41070 NEXT I
41080 ENDF PRINTN
41090 DEFINE DFLAGSTAT
41100 REM *****************************************************
41110 REM **
41120 REM **     THIS IS THE DFLAG STATION WHERE ALL
41130 REM **  HAPPENINGS ARE DISCOVERED AND ACTED UPON
41140 REM ** HOWEVER,DFLAG CAN BE USED ELSEWHERE, SEE MASTER LIST.
41150 REM **
41160 REM *****************************************************
41170 IF NLOC(61)=85 OR DFLAG(1)=1 THEN GOTO 41340 !DFLAG #1
41180 IF NLOC(61)<>85 AND ABS(NLOC(61))>10 THEN GOTO 41340
41190 IF NLOC(61)<>85 THEN PRINT "THE DIAMOND HAS BEEN RETRIEVED!"
41200 NUMTURN=99
41210 NLOC(229)=85,NHITS(229)=NHITSII(229)
41220 MMOV(229)=0
41230 A=0
41240 FOR I=1 TO 6
41250 IF NLOC(I)=85 THEN A=A+1
41260 NEXT I
41270 FOR I=1 TO 6
41280 IF NLOC(I)=85 THEN EXPERIENCE(I)=EXPERIENCE(I)+(2000/A)
41290 NEXT I
41300 PRINT 
41310 PRINT "THE DIAMOND FIZZLES IN TO A CLOUD OF SMOKE!"
41320 NLOC(61)=0
41330 DFLAG(1)=1
41340 REM ** CONTINUE
41350 ENDF DFLAGSTAT
41360 DEFINE RREAD
41370 REM ******************************************************
41380 REM **
41390 REM **   THIS IS WHERE WE READ THINGS....
41400 REM **            YEAH! BROTHERS AND SISTERS!
41410 REM **      READ! AND BE HEALED! YEAH!
41420 REM **
41430 REM ******************************************************
41440 IF NNUM<1 THEN PRINT "READ WHAT?"
41450 IF NNUM<1 THEN GOTO 42040
41460 IF NCODE(NNUM)=45 THEN E=P
41470 IF NCODE(NNUM)<>45 THEN E=-CNUM2
41480 CALL USEARCH
41490 IF NCODE(NNUM)<>45 AND NCODE(NNUM)<>41 AND NCODE(NNUM)<>40 THEN PRINT "YOU CANNOT READ THAT!"
41500 IF NCODE(NNUM)<>45 AND NCODE(NNUM)<>41 AND NCODE(NNUM)<>40 THEN GOTO 42040
41510 IF NCODE(NNUM)=45 AND NLOC(NNUM)<>P THEN PRINT "THE SIGN ISN'T HERE."
41520 IF NCODE(NNUM)=45 AND NLOC(NNUM)<>P THEN GOTO 42040
41530 IF NCODE(NNUM)<>45 AND NLOC(NNUM)<>-CNUM2 THEN PRINT "BUT YOU AREN'T CARRYING THE ":NOUN$(NNUM):"!"
41540 IF NCODE(NNUM)<>45 AND NLOC(NNUM)<>-CNUM2 THEN GOTO 42040
41550 PRINT "OKEE DOKEY,"
41560 IF NNUM<>167 THEN GOTO 41660
41570 PRINT
41580 PRINT "THE NOTE SAYS:"
41590 PRINT 
41600 PRINT "THERE ARE FIVE FINE RINGS"
41610 PRINT "APART,THEY DO WONDROUS THINGS"
41620 PRINT "JOIN THESE RINGS WHERE RHIANNON SINGS,"
41630 PRINT "        ....."
41640 PRINT 
41650 PRINT "THERE THE NOTE HAS BEEN TORN ALLOWING YOU TO READ NO FURTHER."
41660 IF NNUM<>168 THEN GOTO 41710
41670 PRINT "THE PAPER SAYS:"
41680 PRINT '"LED ZEPPELIN IS THE BEST'
41690 PRINT 'LED ZEPPELIN BEATS THE REST.'
41700 PRINT 'HEAR LED ZEPPELIN OR BECOME A PEST"'
41710 IF NNUM<>173 THEN GOTO 41750
41720 PRINT "THE SIGN SAYS:"
41730 PRINT '"GO NO FURTHER NORTH FOR THE GIANT WORM OF THE BARROW LIES THERE."'
41740 REM **  SIGN #2
41750 IF NNUM<>192 THEN GOTO 41890
41760 PRINT
41770 PRINT "ON SALE TODAY:"
41780 PRINT
41790 PRINT "ITEM":TAB(19):"PRICE(IN GOLD)"
41800 MAT ALLPRINT=0
41810 FOR J=1 TO 295
41820 IF ALLPRINT(NCODE(J))=1 THEN GOTO 41860
41830 IF NLOC(J)<>10000 THEN GOTO 41860
41840 IF NLOC(J)=10000 THEN PRINT NOUN$(J):TAB(20):PRICE(NCODE(J))
41850 ALLPRINT(NCODE(J))=1
41860 NEXT J
41870 PRINT
41880 PRINT "LIMITED SUPPLIES ON ALL SALE ITEMS."
41890 IF NNUM<>193 THEN GOTO 41940
41900 PRINT "THE SIGN SAYS:"
41910 PRINT '"THIS ADVENTURE GAME IS UNDER CONSTRUCTION BY DAVID'
41920 PRINT 'STAFFORD, COPYWRIGHT 1983"'
41930 PRINT "LIVE LONG AND PROSPER!"
41940 REM SIGN# 4
41950 IF NNUM=194 THEN
41960         PRINT "THE SIGN READS:"
41970         PRINT '"WELCOME TO THE TEMPLE OF ZEUS!'
41980         PRINT '  WE OFFER ROUND THE CLOCK RESURRECTION SERVICES!'
41990         PRINT '  FOR ANY RANK OF CHARACTER,AT REASONABLE RATES!'
42000         PRINT '  COME SEE OUR PRIESTS TODAY!'
42010         PRINT
42020         PRINT 'RESURRECTION COST = 300 GOLD PIECES PER LEVEL OF THE DECEASED "'
42030         ENDIF
42040 ENDF RREAD
42050 DEFINE OPENN
42060 REM ********************************************************
42070 REM **
42080 REM **  THIS IS WHERE WE OPEN THINGS
42090 REM **   SPECIFICLY THE TRAPDOOR LEADING TO DUNGEON #2
42100 REM **
42110 REM ********************************************************
42120 IF NNUM<1 THEN PRINT "OPEN WHAT?"
42130 IF NNUM<1 THEN GOTO 42180
42140 IF NNUM<>215 THEN PRINT "YOU CAN'T OPEN THAT NOW, THANK YOU!"
42150 IF NNUM<>215 THEN GOTO 42180
42160 M(NLOC(215),10)=671
42170 M(671,9 )=NLOC(215)
42180 ENDF OPENN
42190 DEFINE CLOSEE
42200 REM *************************************************
42210 REM **
42220 REM **   THIS IS WHERE WE CLOSE THINGS
42230 REM **   ONCE AGAIN, SPECIFICALY THE TRAPDOOR
42240 REM **
42250 REM *************************************************
42260 IF NNUM<1 THEN PRINT "CLOSE WHAT?"
42270 IF NNUM<1 THEN GOTO 42310
42280 IF NNUM<>215 THEN PRINT "YOU CAN'T CLOSE THAT RIGHT NOW."
42290 IF NNUM<>215 THEN GOTO 42310
42300 M(NLOC(215),10)=0
42310 ENDF CLOSEE
42320 DEFINE PPOOL
42330 REM *************************************************
42340 REM **
42350 REM **   WELL HE MUST'VE ENTERED MY MAGIC POOL
42360 REM **  OTHER WISE WE WOULDN'T BE HERE RIGHT? RIGHT!
42370 REM **
42380 REM *************************************************
42390 IF FPOOL(CNUM2)=1 THEN GOTO 42640
42400 FPOOL(CNUM2)=1
42410 PRINT "WHEN YOU ENTER THE POOL YOUR BODY IS ENGULFED IN A PULSATING"
42420 PRINT "ENERGETIC GLOW.THEN SUDDENLY YOU FEEL STRONGER!"
42430 A=INT(RND(-1)*4)+1
42440 ON A GOSUB 42460,42520,42560,42600
42450 GOTO 42640
42460 B=INT(RND(0)*9+1)
42470 HPTOTAL(CNUM2)=HPTOTAL(CNUM2)+B
42480 HP(CNUM2)=HP(CNUM2)+B
42490 NHITS(CNUM2)=NHITS(CNUM2)+B
42500 PRINT "YOU GAINED ":B:" HIT POINTS!"
42510 RETURN
42520 B=INT(RND(0)*2+1)
42530 S(CNUM2)=S(CNUM2)+B
42540 PRINT "YOU GAINED ":B:" STRENGTH POINTS!"
42550 RETURN
42560 B=INT(RND(0)*2+1)
42570 C(CNUM2)=C(CNUM2)+B
42580 PRINT "YOU GAINED ":B:" CONSTITUTION POINTS!"
42590 RETURN
42600 B=INT(RND(-1)*3)+1
42610 D(CNUM2)=D(CNUM2)+B
42620 PRINT " YOU GAINED ":B:" DEXTERITY POINTS!"
42630 RETURN
42640 ENDF PPOOL
42650 DEFINE MONBIL
42660 REM *******************************************************
42670 REM **
42680 REM **  THIS IS WHERE THE MONSTERS GET TO EXCERCISE
42690 REM **  ANY SPECIAL ABILITIES THEY MIGHT HAVE.
42700 REM **  (IE. PARALYZATION,LIFE DRAIN,BREATH WEAPON ETC.)
42710 REM **
42720 REM ** SO FAR ONLY MUMMY,WIGHT,RED DRAGON,WHITE DRAGON
42730 REM ** CARRION CRAWLER,GIANT WORM, AND VAMPIRES
42740 REM **
42750 REM ********************************************************
42760 IF NCODE(I)=28 THEN
42770 PRINT "YOU HAVE BEEN PARALYZED BY THE MUMMY!"
42780 ASLEEP(I1)=2
42790 ENDIF
42800 IF NCODE(I)=29 THEN
42810 PRINT "YOU FEEL YOUR LIFE ENERGY BEING DRAINED BY THE WIGHT AS HE HITS YOU!"
42820 LEVEL(I1)=LEVEL(I1)-1
42830 IF LEVEL(I1)<1 THEN PRINT "YOU DIED FROM THE LOSS OF ENERGY!"
42840 IF LEVEL(I1)>0 THEN GOTO 42890
42850 S(I1)=0
42860 DEAD=-1
42870 NHITS(I1)=0,HPTOTAL(I1)=0,HP(I1)=0
42880 CALL QDONE
42890 IF CLASS$(I1)="WARRIOR" THEN CHNUM=1
42900 IF CLASS$(I1)="MAGIC-USER" THEN CHNUM=2
42910 IF CLASS$(I1)="PRIEST" THEN CHNUM=3
42920 IF CLASS$(I1)="THIEF" THEN CHNUM=4
42930 IF LEVEL(I1)<2 THEN EXPERIENCE(I1)=0
42940 IF LEVEL(I1)<2 THEN GOTO 42960
42950 EXPERIENCE(I1)=EGOAL(CHNUM,LEVEL(I1-1))
42960 ENDIF
42970 IF NCODE(I)=67 THEN
42980 PRINT "THE RED DRAGON BREATHES HIS FIERY BREATH UPON YOU!"
42990 FIREBALL.FLAG=1
42995 DRAGON=1
42996 CALL MSPELL
43000 DRAGON=0,FIRE.BALL=0
43120 ENDIF
43130 IF NCODE(I)=68 THEN
43140 PRINT "THE WHITE DRAGON BREATHES AN ICY WAVE OF COLD ON YOU!"
43150 PRINT "YOU TAKE ":NHITS(I):" POINTS OF DAMAGE!"
43160 NHITS(I1)=NHITS(I1)-NHITS(I)
43170 HP(I1)=HP(I1)-NHITS(I)
43180 IF NHITS(I1)<1 THEN PRINT "YOU DIED."
43190 IF NHITS(I1)<1 THEN S(I1)=0
43200 IF NHITS(I1)<1 THEN DEAD=-1
43210 IF NHITS(I1)<1 THEN CALL QDONE
43220 ENDIF
43230 IF NCODE(I)=74 THEN
43240 PRINT "THE CARRION CRAWLER PARALYZED YOU!"
43250 IF RACE$(I1)="ELF" THEN
43260         PRINT "HOWEVER,BECAUSE OF YOUR ELVISH BACKGROUND,YOU RESIST."
43270         ENDIF
43280 ASLEEP(I1)=2
43290 ENDIF
43300 IF NCODE(I)=80 THEN
43310 PRINT "THE WORM'S STING POISONED YOU!"
43320 A=INT(RND(0)*19)+1
43330 IF A<(10+(C(I1)-14)) THEN A=0 ELSE A=-1
43340 DAM=0
43350 FOR B=1 TO 3
43360 DAM=INT(RND(B)*3)+1
43370 NEXT B
43380 IF A=0 THEN PRINT "THE POISON SEVERELY WEAKENED YOU!"
43390 IF A=0 THEN NHITS(I1)=NHITS(I1)-DAM
43400 IF A=0 AND NHITS(I1)<1 THEN NHITS(I1)=1
43410 IF A=-1 THEN PRINT "THE WORMS POISON KILLED YOU!"
43420 IF A=-1 THEN NHITS(I1)=-10
43430 IF A=-1 THEN S(I1)=0
43440 IF A=-1 THEN DEAD=-1
43450 IF A=-1 THEN CALL QDONE
43460 ENDIF
43470 IF NCODE(I)=81 THEN
43480 PRINT "THE VAMPIRES ATTACK CAUSED YOU TO LOSE YOUR LIFE ENERGY!"
43490 LEVEL(I1)=LEVEL(I1)-2
43500 IF LEVEL(I1)<1 THEN PRINT "YOU DIED!"
43510 IF LEVEL(I1)<1 THEN S(I1)=0
43520 IF LEVEL(I1)<1 THEN CALL QDONE
43530 IF LEVEL(I1)<1 THEN GOTO 43550
43540 ENDIF
43550 ENDF MONBIL
43560 DEFINE KTRACK
43570 REM **
43580 REM **  KEEP TRACK OF WHO PLAYS
43590 REM **
43600 REM *************************************************************
43610 OPEN "(STAFFORD)TRACK.ADV-A" FOR SYMBOLIC RANDOM IO AS FILE 10
43620 ON ENDFILE(10) GOTO 43650
43630 INPUT FROM 10:A$
43640 GOTO 43620
43650 FOR I=1 TO CNUM
43660 WRITE ON 10:NAME$(I)
43670 NEXT I
43680 WRITE ON 10:DATE
43690 CLOSE 10
43700 ENDF KTRACK
43710 DEFINE MSPELL
43720 REM *****************************************************
43730 REM **
43740 REM **   THIS IS WHERE MAGIC USERS DECIDE SPELLS TO CAST
43750 REM ** AND THEN SUBTRACT MANA POINTS ETC. ALSO WE DECIDE
43760 REM ** VALIDITY OF SPELL TO BE CAST
43770 REM ** AFTER DECIDING VALIDITY WE ACTIVATE THE
43780 REM **  SPELL,INFLICTING DAMAGE,TELEPORTING ETC.
43790 REM **
43800 REM *****************************************************
43810 IF FIREBALL.FLAG=1 THEN GOTO 45590
43820 IF MANA(CNUM2)<1 THEN
43830 PRINT "SORRY,YOUR OUT OF MANA POWER!"
43840 GOTO 46570
43850 ENDIF
43860 PRINT "WHAT SPELL WOULD YOU LIKE TO CAST?"
43870 PRINT ":":
43880 INPUT IN FORM "R":S$
43890 FOR J=1 TO 27
43900 IF MSPELL$(J)=S$ THEN SPNUM=J
43910 IF MSPELL$(J)=S$ THEN GOTO 43930
43920 NEXT J
43930 REM ** DONE CHECKING **
43940 IF SPNUM<1 THEN
43950 PRINT "ILLEGAL SPELL NAME."
43960 REM ** *** ****
43970 GOTO 46570
43980 ENDIF
43990 IF MSLEVEL(SPNUM)=1 THEN GOTO 44040
44000 IF LEVEL(CNUM2)<(MSLEVEL(SPNUM)*2)-1 THEN PRINT "YOU ARE NOT HIGH ENOUGH LEVEL TO USE THAT SPELL!"
44010 IF LEVEL(CNUM2)<(MSLEVEL(SPNUM)*2)-1 THEN GOTO 46570
44020 IF MANA(CNUM2)<MSLEVEL(SPNUM) THEN PRINT "YOU HAVEN'T GOT ENOUGH MANA TO CAST THE SPELL!"
44030 IF MANA(CNUM2)<MSLEVEL(SPNUM) THEN 46570
44040 REM ** FIRST CHECK IF THE SPELL IS CAST ONE ONLY ONE BEING
44050 REM ** IF SO FIND OUT WHICH ONE.
44060 IF SPNUM=1 OR SPNUM=2 OR SPNUM=10 OR SPNUM=15 OR SPNUM=23 OR SPNUM=24 OR SPNUM=27 THEN
44070 PRINT "WHAT CREATURE(OR OBJECT) ARE YOU CASTING THIS SPELL ON?"
44080 PRINT ":":
44090 INPUT IN FORM "R":V$
44100 IF ASC(V$)=13 THEN GOTO 44080
44110 FOR I=1 TO 295
44120 IF V$=NOUN$(I) THEN VI=I ELSE VI=0
44130 IF V$=NOUN$(I) THEN GOTO 44180
44140 NEXT I
44150 ELSE
44160 GOTO 44280
44170 ENDIF
44180 REM I DUNNO WHERE TO GO!
44190 IF VI>0 THEN NNUM=VI
44200 IF VI>0 THEN E=P
44210 IF VI>0 THEN CALL USEARCH
44220 IF VI>0 THEN VI=NNUM
44230 IF VI<1 OR NLOC(VI)<>P THEN
44240 PRINT "INVALID TARGET."
44250 NUMTURN=NUMTURN-1
44260 GOTO 46570
44270 ENDIF
44280 MANA(CNUM2)=MANA(CNUM2)-MSLEVEL(SPNUM)
44290 IF SPNUM>10 THEN GOTO 44310
44300 ON SPNUM GOSUB 44400,44530,44670,44950,45020,45120,45160,45200,45260,45440
44310 IF SPNUM<11 THEN GOTO 44360
44320 IF SPNUM>10 THEN
44330 SPNUM=SPNUM-10
44340 ON SPNUM GOSUB 45590,45860,45920,45990,46060,46190,46220,46510,46540
44350 ENDIF
44360 GOTO 46560
44370 REM ***********************************************************
44380 REM ** NOW TO ACTIVATE THE SPELLS
44390 REM ***********************************************************
44400 REM :: HEAL MINOR WOUNDS
44410 DAM=INT(RND(-1)*4)+1
44420 IF VI<10 THEN PRINT "MR. ":NAME$(VI):" IS HEALED ":DAM:" POINTS."
44430 IF VI>10 THEN PRINT "THE ":NOUN$(NNUM):" GETS ":DAM:" POINTS BACK!"
44440 IF VI<11 THEN
44450         IF HP(VI)<HPTOTAL(VI) THEN HP(VI)=HP(VI)+DAM
44460         IF HP(VI)>HPTOTAL(VI) THEN HP(VI)=HPTOTAL(VI)
44470        IF HP(VI)>=HPTOTAL(VI) THEN HP(VI)=HPTOTAL(VI)
44480         ENDIF
44490 IF NHITS(VI)>=NHITSII(VI) THEN GOTO 44510
44500 NHITS(VI)=NHITS(VI)+DAM
44510 RETURN
44520 REM **********************************************************
44530 REM ** NOW LETS DO MAGIC MISSILE
44540 IF NHITSII(VI)<2 AND VI>10 THEN
44550 PRINT "THE MISSILE AFFECTS NOTHING!"
44560 ENDIF
44570 DAM=0
44580 FOR J=1 TO INT(LEVEL(CNUM2)/2)+1
44590 DAM=DAM+INT(RND(0)*4)+1
44600 NEXT J
44610 PRINT "THE MISSILE DOES ":DAM:" POINTS OF DAMAGE!"
44620 NHITS(VI)=NHITS(VI)-DAM
44630 IF NHITS(VI)<1 AND VI<11 THEN CALL CDEAD
44640 IF NHITS(VI)<1 AND VI>10 THEN CALL MDEAD
44650 RETURN
44660 REM ***********************************************************
44670 REM *** SLEEP *** THE SANDMAN SAYS SLEEP! ***
44680 N=0
44690 PRINT "A GLOW SURROUNDS THE AREA."
44700 FOR J=1 TO 295
44710 IF J>10 THEN GOTO 44740
44720 IF J<11 THEN
44730         IF INT(RND(0)*19)+1<II(J) THEN GOTO 44890
44740         ENDIF
44750IF NCODE(J)=19 AND INT(RND(0)*99)+1<65 THEN GOTO 44890
44760 IF NCODE(J)=78 THEN GOTO 44890
44770 IF NHITSII(J)<2 THEN GOTO 44890
44780 IF INT(RND(0)*99)+1<20 THEN GOTO 44890
44790 IF NCODE(J)=71 OR NCODE(J)=82 THEN GOTO 44890
44800 IF NLOC(J)<>P THEN GOTO 44890
44810 IF NHITSII(J)>45 THEN GOTO 44890
44820 IF NCODE(J)=13 OR NCODE(J)=20 OR NCODE(J)=22 OR NCODE(J)=28 OR NCODE(J)=29 OR NCODE(J)=81 THEN GOTO 44890
44830 IF J=CNUM2 THEN GOTO 44890
44840 PRINT "A ":NOUN$(J):" GOES TO SLEEP."
44850 ASLEEP(J)=ASLEEP(J)+INT(RND(-1)*5)+2
44860 IF J<10 THEN ASLEEP(J)=1
44870 N=N+1
44880 IF N>LEVEL(CNUM2)+2 THEN J=999
44890 NEXT J
44900 IF N=0 THEN PRINT "BUT THE GLOW FADES AWAY AFFECTING NOTHING!"
44910 REM
44920 RETURN
44930 REM ***********************************************************
44940 REM *****####$$$*** SPIDER CLIMB
44950 PRINT "YOUR HANDS AND FEET BEGIN TO GLOW BRIGHTLY FOR A FEW SECONDS THEN"
44960 PRINT "IT FADES AWAY."
44970 SACT(CNUM2,SPNUM)=1
44980 SCOUNT(CNUM2,SPNUM)=0
44990 SGOAL(CNUM2,SPNUM)=2
45000 RETURN
45010 REM ****************************************************
45020 REM ** THIS IS THE LIGHT SPELL SUBROUNTINE
45030 PRINT "THE AREA AROUND YOU BECOMES LIT WITH A DIM GLOW."
45040 LSORCE(CNUM2)=1
45050 SACT(CNUM2,SPNUM)=1
45060 SGOAL(CNUM2,SPNUM)=(LEVEL(CNUM2)*3)+10
45070 SCOUNT(CNUM2,SPNUM)=0
45080 RETURN
45090 REM **********************************************************
45100 REM ******** SECOND  LEVEL  SPELLS  !!!!
45110 REM **********************************************************
45120 REM ******** FIRST LETS DO INVISIBLITY
45130 PRINT "YOU ARE NOW INVISIBLE!"
45140 GONE(CNUM2)=2
45150 RETURN
45160 REM ***********************************DETECT INVISIBILITY
45170 PRINT "THERE IS NOBODY INVISIBLE IN THIS VICINITY."
45180 RETURN
45190 REM *********************************************************
45200 REM **  IT IS TIME TO DO CONTINUAL LIGHT
45210 PRINT "THE SURROUNDING AREA BECOMES LIT WITH A BRIGHT GLOW "
45220 PRINT "EMANATING FROM AN UNKNOWN SOURCE."
45230 LSORCE(CNUM2)=1
45240 RETURN
45250 REM *******************************************************
45260 REM *** DIMENSION DOOR DOES RANODM THINGS.
45270 A1=0
45280 FOR J=1 TO LEVEL(CNUM2)
45290 A=INT(RND(0)*7)+1
45300 P=M(P,N)
45310 IF P<1 THEN P=PP
45320 IF P<1 THEN A1=A1+1
45330 PP=P
45340 NEXT J
45350 IF A1<LEVEL(CNUM2) THEN 
45360 PRINT "YOUR BODY HAS TRAVELLED INTO THE ASTRAL PLANE,AND RETURNED TO "
45370 PRINT "THE MATERIAL WORLD AT A DIFFERENT LOCATION."
45380 ENDIF
45390 RETURN
45400 REM *****************************************************
45410 REM ********************* 3 RD LEVEL SPELLS  ************
45420 REM *****************************************************
45430 IF SPNUM>11 THEN GOTO 45840
45440 REM ** LIGHTNING BOLT
45450 IF MLOC(NCODE(VI))<>1 AND VI>11 THEN
45460 PRINT "THE LIGHNING GROUNDS OFF TO THE GROUND."
45470 GOTO 45570
45480 ENDIF
45490 DAM=0
45500 FOR J=1 TO LEVEL(CNUM2)+1
45510 DAM=DAM+INT(RND(0)*5)+1
45520 NEXT J
45530 PRINT "IT TAKES ":DAM:" POINTS OF DAMAGE!"
45540 NHITS(VI)=NHITS(VI)-DAM
45550 IF NHITS(VI)<1 AND VI<11 THEN CALL CDEAD
45560 IF NHITS(VI)<1 AND VI>10 THEN CALL MDEAD
45570 RETURN
45580 REM *****************************************************
45590 REM ** LETS DO FIREBALL NEXT
45600 DAM=0
45610 PRINT " THERE IS A FIERY BLAST!"
45615 IF DRAGON=1 THEN A=10
45617 IF DRAGON<>1 AND FIREBALL.FLAG<>1 THEN A=6
45618 IF FIREBALL.FLAG<>1 THEN A=0
45620 FOR J=1 TO LEVEL(CNUM2)+A
45630 DAM=DAM+INT(RND(0)*5)+1
45640 NEXT J
45650 FOR J=1 TO 295
45660 IF J=CNUM2 THEN GOTO 45780
45670 IF NLOC(J)<>P THEN GOTO 45780
45680 IF MLOC(NCODE(J))<>1 THEN GOTO 45780
45690 IF J<11 THEN PRINT NAME$(J):" TAKES ":DAM:" POINTS OF DAMAGE!"
45700 IF APOINT(J)<1 THEN GOTO 45720
45710 PRINT "THE ":ADJECT$(APOINT(J)):" ":NOUN$(J):" TAKES ":DAM:" HIT POINTS DAMAGE."
45720 IF APOINT(J)<1 THEN PRINT "THE ":NOUN$(J):" TAKES ":DAM:" POINTS OF DAMAGE!"
45730 NHITS(J)=NHITS(J)-DAM
45740 IF NHITS(J)<1 THEN PRINT "IT DIES!"
45750 VI=J
45760 IF NHITS(J)<1 AND J<11 THEN CALL CDEAD
45770 IF NHITS(J)<1 AND J>10 THEN CALL MDEAD
45780 NEXT J
45790 IF FIREBALL.FLAG=1 THEN
45800     FIREBALL.FLAG=0
45810     GOTO 46570
45820 ENDIF
45830 RETURN
45840 REM ***********************************************************
45850 REM **
45860 REM ** LETS DO MOSTER SUMMON I
45870 REM *** %% $$ ## "" && '' (( )) && !! "" **
45880 PRINT "NOBODY HERES YOU!"
45890 RETURN
45900 REM **********************************************************
45910 REM ** LETS DO HASTE
45920 REM
45930 PRINT "YOU HAVE BEEN HASTED!"
45940 NUMTURN=NUMTURN-12-LEVEL(CNUM2)
45950 RETURN
45960 REM ***********************************************************
45970 REM ************NOW FOURTH LEVEL SPELLS ***********************
45980 REM ***********************************************************
45990 REM *** CHARM FIRE *** LETS GET PYRO!
46000 PRINT "YOUR HANDS BEGIN TO SPARK SLIGHTLY,YOU BEGIN TO FEEL "
46010 PRINT "RATHER STRANGE."
46020 SACT(CNUM2,SPNUM)=1
46030 SCOUNT(CNUM2,SPNUM)=0
46040       SGOAL(CNUM2,SPNUM)=2*LEVEL(CNUM2)
46050 RETURN
46060 REM *** REMOVE CURSE ***
46070 PRINT "WHO ARE YOU UNCURSING? (CHARACTERS NAME)":
46080 INPUT IN FORM "R":A$
46090 FOR J=1 TO 6
46100 IF NAME$(J)<>A$ THEN VI=0 ELSE VI = 1
46110 IF VI>0 THEN GOTO 46130
46120 NEXT J
46130 IF VI<1 THEN PRINT "INVALID CHARACTER!"
46140 IF VI<1 THEN NUMTURN=NUMTURN-1
46150 IF VI<1 THEN GOTO 46180
46160 CURSE(VI)=0
46170 PRINT "YE HATH BEEN HEALED! YEAH!"
46180 RETURN
46190 REM ** MONSTER SUMMONING II
46200 PRINT "STILL NOBODY HERES YOU!"
46210 RETURN
46220 REM ** ICE STORMS CAUSE PROBLEMS
46230 PRINT "THERE IS A BLINDING WHITE FLASH,THEN YOU ARE LEFT WITH A COLD CHILL."
46240 AN=0
46250 DAM=0
46260 REM ** FIND NUMBER OF DAMAGED VICTIMS **
46270 FOR J=1 TO 295
46280 IF NLOC(J)=P AND J<>CNUM2 THEN AN=AN+1
46290 NEXT J
46300 REM ** NEXT FIND DAMAGE TOTAL
46310 FOR J=1 TO LEVEL(CNUM2)+2
46320 DAM=DAM+INT(RND(0)*3)+1
46330 NEXT J
46340 REM ** INFLICT THE DAMAGE **
46350 FOR J=1 TO 295
46360 IF J=CNUM2 THEN J=J+1
46370 IF NLOC(J)<>P THEN GOTO 46490
46380 IF MLOC(NCODE(J))<>1 THEN GOTO 46490
46390 IF J<11 THEN PRINT NAME$(J):" TAKES ":INT(DAM/AN):" POINTS OF DAMAGE!"
46400 IF APOINT(J)<1 THEN GOTO 46420
46410 PRINT "THE ":ADJECT$(APOINT(J)):" TAKES ":INT(DAM/AN):" POINTS OF DAMAGE!"
46420 IF APOINT(J)<1 THEN PRINT "THE ":NOUN$(J):" TAKES ":INT(DAM/AN):" POINTS OF DAMAGE!"
46430 NHITS(J)=NHITS(J)-INT(DAM/AN)
46440 IF NHITS(J)<1 AND J<11 THEN PRINT "HE DIES!"
46450 IF NHITS(J)<1 AND J>10 THEN PRINT "IT DIES!"
46460 VI=J
46470 IF NHITS(J)<1 AND J<11 THEN CALL CDEAD
46480 IF NHITS(J)<1 AND J>10 THEN CALL MDEAD
46490 NEXT J
46500 RETURN
46510 REM ** CONJURE?...CONJURE E?...AHA! CONJURE ELEMENTAL!
46520 PRINT "WHOOOOOPS!"
46530 RETURN
46540 REM *** CONE OF ICE CREAM? NO! CONE OF COLD!
46550 RETURN
46560 NUMTURN=NUMTURN+1
46570 ENDF MSPELL
46580 DEFINE MDEAD
46590 REM *********************************************
46600 REM **
46610 REM **   THE MONSTER DIED
46620 REM **
46630 REM *********************************************
46640 NLOC(VI)=0
46650 EXPERIENCE(CNUM2)=EXPERIENCE(CNUM2)+MONEXP(NCODE(VI))+(NHITSII(VI)*3)
46660 ENDF MDEAD
46670 DEFINE CDEAD
46680 REM ************************************************
46690 REM **
46700 REM **    THE CHARACTER DIED,TOO BAD.
46710 REM **
46720 REM ************************************************
46730 FOR A=1 TO 295
46740 IF NLOC(A)=-VI THEN NLOC(A)=NLOC(VI)
46750 NEXT A
46760 Z=CNUM2
46770 CNUM2=VI
46780 S(VI)=0
46790 CALL QDONE
46800 CNUM2=Z
46810 IF CNUM2=VI THEN NUMTURN=INT(D(CNUM2)/4)
46820 ENDF CDEAD
46830 DEFINE SREGULAR
46840 REM ***********************************************
46850 REM ** THIS IS THE SPELL DURATION REGULATOR$$$$$$**
46860 REM ** TERMINATING SPELLS WHEN THE DURATION ENDS$**
46870 REM ** THIS SUBROUTINE USES THE FOLLOWING VARS $$**
46880 REM ** 
46890 REM **  SCOUNT(27)-->CURRENT TURN SPELLS ON
46900 REM **  SGOAL(27) -->MAX NUMBER OF TURNS
46910 REM **  SACT(27)  -->TELLS IF A CERTAIN SPELLS IS ACTIVATED
46920 REM **
46930 REM ***********************************************
46940 REM ** DO CLIMB WALLS REGULATOR FIRST!
46950 IF SACT(CNUM2,4)=1 THEN
46960 SCOUNT(CNUM2,4)=SCOUNT(CNUM2,4)+1
46970 IF SCOUNT(CNUM2,4)=SGOAL(CNUM2,4)+1 THEN
46980 IF GONE(CNUM2)=1 THEN
46990 PRINT "YOU FELL OFF THE WALL!"
47000 DAM=INT(RND(0)*5)+1
47010 NHITS(CNUM2)=NHITS(CNUM2)-DAM
47020 HP(CNUM2)=HP(CNUM2)-DAM
47030 IF NHITS(CNUM2)<1 THEN
47040 PRINT "YOU DIED."
47050 DEAD=-1
47060 CALL CDEAD
47070 DEAD=0
47080 NUMTURN=99
47090 GOTO 47420
47100 ENDIF
47110 PRINT "YOU TAKE ":DAM:" HIT POINTS OF DAMAGE!"
47120 ENDIF
47130 PRINT "YOUR CLIMB WALLS SPELL HAS WORN OFF."
47140 SACT(CNUM2,4)=0
47150 GONE(CNUM2)=0
47160 ENDIF
47170 ENDIF
47180 IF SACT(CNUM2,5)=1 THEN
47190 SCOUNT(CNUM2,5)=SCOUNT(CNUM2,5)+1
47200 IF SCOUNT(CNUM2,5)=SGOAL(CNUM2,5)+1 THEN
47210 IF P>87 AND P<672 THEN GOTO 47300
47220 IF P<43 THEN GOTO 47300
47230 A=0
47240 FOR J=1 TO 6
47250 IF LSORCE(J)=1 AND CLOC(P)=P THEN A=A+1
47260 NEXT J
47270 IF A>0 THEN GOTO 47300
47280 PRINT "EVERYTHING GROWS DIM ABOUT YOU."
47290 ENDIF
47300 SACT(CNUM2,5)=0,SGOAL(CNUM2,5)=0,SCOUNT(CNUM2,5)=0
47310 ENDIF
47320 REM
47330 IF SACT(CNUM2,14)=1 THEN
47340 SCOUNT(CNUM2,14)=SCOUNT(CNUM2,14)+1
47350 IF SCOUNT(CNUM2,14)=SGOAL(CNUM2,14)+1 THEN
47360 PRINT "SUDDENLY YOU FEEL A COLD SHIVER UP AND DOWN YOUR SPINE."
47370 SCOUNT(CNUM2,14)=0
47380 SGOAL(CNUM2,14)=0
47390 SACT(CNUM2,14)=0
47400 ENDIF
47410 ENDIF
47420 ENDF SREGULAR
47430 DEFINE GNOME
47440 REM **  GNOME  **
47450 REM **  CHECK FOR THINGS TO GET **
47460 REM ** FIRST, GOOD WEAPONS *
47470 FOR J=1 TO 295
47480 IF MLOC(NCODE(J))<>1 AND NDAM(J)>2 AND NLOC(J)=GP THEN
47490 IF NDAM(J)>NDAM(GWEP) THEN
47500 NLOC(J)=-276,GC=GC+1
47510 NLOC(GWEP)=GP
47520 GWEP=J
47530 GM=1
47540 ENDIF
47550 ENDIF
47560 NEXT J
47570 IF GM=1 THEN GOTO 48100
47580 REM * NEXT GET TREASURES *
47590 FOR J=1 TO 295
47600 IF NLOC(J)=GP THEN
47610 FOR J1=1 TO 30
47620 IF TTYPE(J1)=NCODE(J) THEN GOTO 47650
47630 NEXT J1
47640 GOTO 47700
47650 NLOC(J)=-276
47660 GM=1
47670 GC=GC+1
47680 ENDIF
47690 IF GM=1 THEN GOTO 48100
47700 NEXT J
47710 !!! """ ### $$$ %%% &&& ''' ((( )))  *** === !!! """ ### $$$ %%% 
47720 GOTO 47820
47730 REM *** COMBAT FOR TELEPHUS ***
47740 VI=J
47750 REM ** CHECK TO SEE IF CHARACTER IS HERE TO SEE COMBAT **
47760 FOR J=1 TO 6
47770 IF CLOC(J)=GP THEN G.VIC(J)=VI
47780 NEXT J
47790 GM=1
47800 REM ** JUMP TO COMBAT SUB **
47810 IF GM=1 THEN GOTO 48100
47820 REM ** CHECK  FOR  CHARACTERS
47830 A=0
47840 FOR J=1 TO 6
47850 IF CLOC(J)=GP THEN A=A+1 AND VI=J 
47860 NEXT J
47870 IF A<1 OR A>1 THEN GOTO 47910
47880 REM IF GMAD(VI)=0 AND SAID.HELLO=1 THEN GOTO 72620
47890 IF GMAD(VI)=1 THEN GOTO 48050
47900 IF GMAD(VI)=-1 THEN GOTO 47750
47910 REM ** MOVE THE DWARF **
47920 IF NLOC(172)=-276 THEN GTNUM1=6 ELSE GTNUM1=1
47930 FOR GTNUM=1 TO GTNUM1
47940 A=INT(RND(0 )*9)+1
47950 GP=M(GP,A)
47960 IF GP<1 THEN
47970 GP=GPP
47990 ENDIF
48000 NLOC(276)=GP
48010 NEXT GTNUM
48020 GM=1
48030 IF GM=1 THEN GOTO 48100
48040 REM *** FRIENDLY SECTION ***
48050 IF FRIEND.NO=1 AND GP>0 THEN
48060 GP=NLOC(FRIEND.NO)
48070 PRINT "THERE IS A FRIENDLY GNOME HERE."
48080 GOTO 48100
48090 ENDIF
48100 REM ** TELEPHUS IS A GNOME. YES, A GNOME.
48110 GM=0,D.ATT=0
48120 ENDF GNOME
48130 DEFINE EPRINT
48140 REM **************************************************
48150 REM **  
48160 REM **  THIS IS WHERE WE HAVE EXTRA OBJECT 
48170 REM ** DESCRIPTIONS. HOW NICE EH?
48180 REM **************************************************
48190 IF J=276 AND NLOC(J)=P THEN
48200 IF J=276 THEN PRINT "THERE IS A LITTLE GNOME WIELDING A ":NOUN$(GWEP):" HERE."
48210    IF J=276 THEN ALLPRINT(J)=1 AND ALLPRINT(NCODE(J))=1
48220 ENDIF
48230 ENDF EPRINT
48240 DEFINE EOBJECT
48250 REM **************************************************
48260 REM **
48270 REM **  IT IS ABOUT TIME WE DESCRIBE SOME OF THE OBJECTS
48280 REM **  OUR PLAYER(S) SEE.C.SEA.CEE.ETC.
48290 REM **
48300 REM **************************************************
48310 J=NNUM
48320 IF NLOC(J)<>P AND NLOC(J)<>-CNUM2 THEN GOTO 50110
48330 IF NCODE(J)=2 THEN
48340 PRINT "THE SWORD IS MADE OF FINELY WROUGHT BRONZE.I IS RATHER HEAVY,BUT IT IS"
48350 PRINT "OBVIOUS THAT IT DOES A TREMENDOUS AMOUNT OF DAMAGE."
48360 GOTO 50110
48370 ENDIF
48380 IF NCODE(J)=3 THEN
48390 PRINT "THE DAGGER IS A CRUDE VERSION OF A SHORTENED SCIMITAR.BUT VERY SHARP."
48400 GOTO 50110
48410 ENDIF
48420 IF NCODE(J)=4 THEN
48430 PRINT "THE BARTENDER IS A BIG MAN,BUT HE'S RATHER CHUBBY,AND DIRTY."
48440 PRINT "HE LAUGHS QUITE A BIT."
48450 GOTO 50110
48460 ENDIF
48470 IF NCODE(J)=5 THEN
48480 PRINT "SAURON IS A SHORT LITTLE ELF.NOT VERY GOOD LOOKING,BUT VERY WISE."
48490 PRINT "HE IS RUMORED TO BE A WIZARD OF GREAT POWER."
48500 GOTO 50110
48510 ENDIF
48520 IF NCODE(J)=6 THEN
48530 PRINT "THE WILD GNOME IS A RATHER HYPER LOOKING FELLOW.HE DOESN'T SEEM TO"
48540 PRINT "APPRECIATE YOUR PRESENCE AT ALL."
48550 GOTO 50110
48560 ENDIF
48570 IF NCODE(J)=7 THEN
48580 PRINT "THE GIRL IS VERY,VERY PRETTY.SHE WEARS A TUNIC THAT"
48590 PRINT "EXPOSES A GOOD DEAL OF HER ANATOMY.SHE WEARS A LOCKET "
48600 PRINT "AROUND HER NECK."
48610 GOTO 50110
48620 ENDIF
48630 IF NCODE(J)=8 THEN
48640 PRINT "THE BRASS SHIELD IS A LARGE WARPED OVAL PLATE OF BRONZE."
48650 PRINT "IT IS VERY STRONG FOR BRASS,AND VERY HEAVY."
48660 GOTO 50110
48670 ENDIF
48680 IF NCODE(J)=9 THEN
48690 PRINT "THE ARMOR IS PADDING PLUS INTERLOCKING MESH LINKS "
48700 PRINT "COVERING THE UPPER AND LOWER BODY.VULNERABLE AREAS HAVE DOUBLE PADDING."
48710 PRINT "THE WEIGHT MAINLY FALLS UPON SHOULDERS WHEN WORN."
48720 GOTO 50110
48730 ENDIF
48740 IF NCODE(J)=10THEN
48750 PRINT "THE MACE IS A CLUB-LIKE WEAPON MADE ALL OF METAL WITH A METAL HEAD."
48760 PRINT "THE HEAD CONTAINS SEVERAL OUTWARD JUTTING SPIKES."
48770 GOTO 50110
48780 ENDIF
48790 IF NCODE(J)=11 THEN
48800 PRINT "IT IS A SMALL ONE MAN ROWBOAT,IT SEEMS BARELY SEAWORTHY."
48810 PRINT "IT HAS SEVERAL INSCRIPTIONS WRITTEN ON IT IN SOME STRANGE LETTERING."
48820 GOTO 50110
48830 ENDIF
48840 IF NCODE(J)=12 THEN
48850 PRINT "THE WAND IS NEARLY TWO FEET IN LENGTH AND TWO INCHES WIDE."
48860 PRINT "ON THE SIDE ARE SOME STRANGE WRITINGS."
48870 GOTO 50110
48880 ENDIF
48890 IF NCODE(J)=13 THEN
48900 PRINT "SKELETONS ARE THE REMAINS OF DEAD(ONCE LIVING) CREATURES.LONG AGO "
48910 PRINT "SKELETONS WERE REPUTED TO BE ABLE TO STAND,AND WALK AGAIN AMONG THE"
48920 PRINT "THE LIVING AND WREAK HAVOC AND EVIL AT THE COMMAND OF A GREATER,MORE"
48930 PRINT "EVIL CREATURE(POSSIBLY A DEMON)."
48940 GOTO 50110
48950 ENDIF
48960 IF NCODE(J)=14 THEN
48970 PRINT "THE LAMP IS A TYPICAL OIL LAMP.MADE OF BRASS,IT STANDS ABOUT 2 FEET."
48980 PRINT "HIGH OFF OF THE GROUND.IT SEEMS TO HAVE PLENTY OF OIL INSIDE."
48990 ENDIF
49000 IF NCODE(J)=15 THEN
49010 PRINT "THE MAN HAS A WILD LOOK IN HIS EYES.HE IS UN-ARMORED,BUT APPEARS"
49020 PRINT "TO BE VERY MUSCULAR.HE IS UNCLEAN,AND HIS HAIR"
49030 PRINT "IS UNKEMPT.APPARENTLY HE DOESN7'T SHAVE."
49040 ENDIF
49050 REM ** 16 IS SPELL SO WE WILL IGNORE IT. SHATTERED! SHATTERED!
49060 IF NCODE(J)=17 THEN
49070 PRINT "GOBLINS RANGE FROM ORANGE IN COLOR TO BRICK RED.THEY DRESS IN DARK"
49080 PRINT "DRAB LEATHER CLOTHING.THEY ARE USUALLY SOMEWHAT UGLY,AND THEY ARE "
49090 PRINT "GENERALLY SHORT."
49100 ENDIF
49110 IF NCODE(J)=18 THEN 
49120 PRINT "ORCS LOOK PARTICULARLY DISGUSTING.THERE FACES RESEMBLE"
49130 PRINT "THAT OF A PIG,WITH ORANGE AND PURPLE HILIGHTS TO THEIR SICK PURPLE"
49140 PRINT "COMPLEXION.THEIR HAIR IS BLACK AND BRISTLY.THEY ARE UGLY,SLOPPY"
49150 PRINT "AND GENERALLY A NUISANCE TO SOCIETY."
49160 ENDIF
49170 IF NCODE(J)=19 THEN
49180 PRINT "TROLL'S ARE SOMEWHAT HUMANOID IN FORM,BUT THAT'S WHERE THE RESEMBLANCE"
49190 PRINT "ENDS.THE SLUMP OVER WHEN THEY WALK.THEIR SKIN IS A NAUSEATING"
49200 PRINT "MOSS GREEN COLOR.THEY GENERALLY HAVE TRASH STUCK ALL OVER"
49210 PRINT "THEM,AND THEY REEK OF AN AGELESS DUMPYARD."
49220 ENDIF
49230 IF NCODE(J)=20 THEN
49240 PRINT "ZOMBIES ARE MAGICALLY ANIMATED CORPSES.THEY SMELL LIKE DECAYING MEAT"
49250 PRINT "ZOMBIES GENERALLY HAVE FUNGUS OF SEVERAL VARIETIES GROWING ON THEM.THEY"
49260 PRINT "CARRY THE SCENT OF DEATH WHEREVER THEY GO."
49270 ENDIF
49280 IF NCODE(J)=21 THEN
49290 PRINT "MINOTAURS ARE HALF MAN AND HALF BULL CREATURES THAT ROME THE"
49300 PRINT "LABYRINTHES DEEP UNDERGROUND SEEKING HUMANS TO SLAY"
49310 PRINT "TO AVENGE THE DEATH OF THIER ANCESTOR,THE GREAT MINOTAUR,SON OF "
49320 PRINT "MINOS."
49330 ENDIF
49340 IF NCODE(J)=22 THEN
49350 PRINT "GHOULS ARE THOSE OF THE UNDEAD REALM.ONCE PEOPLE THE NOW STALK THE"
49360 PRINT "LANDS IN SEARCH OF LIVING FLESH TO FEED UPON. THEY HUNCH OVER"
49370 PRINT "WHEN THEY WALK.THEY HAVE VERY LONG,NAST FINGER NAILS WHICH THEY"
49380 PRINT "USE AS WEAPONS."
49390 ENDIF
49400 IF NCODE(J)=23 THEN
49410 PRINT "THE DIAMOND IS VERY LARGE,ABOUT HALF THE SIZE OF A BASKETBALL."
49420 PRINT "IT SEEMS TO GLOW FROM WITHIN VARIOUS COLORS IN AN EVER VARIATING PATTERN."
49430 PRINT "YOU FEEL A SUDDEN URGE TO PICK UP THE DIAMOND."
49440 ENDIF
49450 IF NCODE(J)=24 THEN
49460 PRINT "THE EMERALD IS ABOUT THE SIZE OF A FIST.IT IS UNCUT,BUT NATURALLY"
49470 PRINT "VERY PRETTY.IT IS DEEP GREEN IN COLOR,AND VERY SMOOTH FOR AN"
49480 PRINT "UNCUT EMERALD."
49490 ENDIF
49500 IF NCODE(J)=25 THEN
49510 PRINT "THE RUBY IS ABOUT THE SIZE OF AN APPLE.IT IS CUT,INDEED AIT IS"
49520 PRINT "IN THE SHAPE OF A HEART.IT IS VERY PRETTY AND VERY RED."
49530 ENDIF
49540 IF NCODE(J)=26 THEN
49550 PRINT "THE STATUETTE IS ABOUT 14 INCHES HIGH.IT IS OF A BIRD,A FALCON."
49560 PRINT "WHOEVER SCULPED THIS STATUETTE USED STRANGE"
49570 PRINT "METAL (IF IT IS METAL) BECAUSE IT IS EXTREMELY HEAVY."
49580 ENDIF
49590 IF NCODE(J)=27 THEN
49600 PRINT "OGRES ARE VERY TALL.THEY VARY IN COLOR FROM DULL BLACK TO "
49610 PRINT "BRIGHT YELLOW.THEY OFTEN HAVE LARGE WARTS ALL OVER THEIR BODY"
49620 PRINT "THAT ARE OF DIFFERENT COLORS.THEY DRESS IN WELL KEPT ANIMAL SKINS."
49630 ENDIF
49640 IF NCODE(J)=28 THEN
49650 PRINT "MUMMIES APPEAR TO BE HUMANS OR HUMANOIDS WRAPPED TIGHTLY IN BANDAGE."
49660 PRINT "THE ARE RUMORED TO BE UN-DEAD THOUGH."
49670 ENDIF
49680 IF NCODE(J)=29 THEN
49690 PRINT "WIGHTS ARE SEEMINGLY HUMANS DRESSED IN LONG DARK ROBES OR CAPES."
49700 PRINT      "THEY ARE VERY DARK AND MYSTERIOUS.THE HAVE LONG NAILS,AND TEETH."
49710 PRINT "THERE IS A SMELL OF DEATH AROUND THIS BEAST."
49720 ENDIF
49730 IF NCODE(J)=30 THEN
49740 PRINT "THE GIANT BEETLE IS MERELY A NORMAL BEETLE THAT HAS BECOME MUCH"
49750 PRINT "LARGER SOMEHOW.IT IS FOUR FEET LONG AND TWO FEET WIDE."
49760 ENDIF
49770 IF NCODE(J)=31 THEN
49780 PRINT "THIS GIANT BEETLE IS MERELY A NORMAL BEETLE THAT HAS GOTTEN"
49790 PRINT "LARGER THAN NORMAL SOMEHOW.IT IS TWO AND A HALF FEET LONG.IT HAS "
49800 PRINT "THREE PLACES ON THE TOP OF IT'S BODY WHERE SOME FORM OF FIRE MATERIAL"
49810 PRINT "GLOWS."
49820 ENDIF
49830 IF NCODE(J)=32 THEN
49840 PRINT "PRINT THE SNAKE IS VERY LARGE,GIANT IN FACT.ABOUT 12 OR MORE FEET LONG."
49850 PRINT "IT HAS A VERY PRETTY,MULTICOLORED, SKIN;HOWEVER IT ALSO HAS LARGE"
49860 PRINT "FANGS."
49870 ENDIF
49880 REM ** 33 IS POCKET.SO WE DON'T GIVE A SHIT.
49890 IF NCODE(J)=34 THEN 
49900 PRINT "DWARVES ARE JUST ABOUT 4 OR SO FEET TALL.THEIR HAIR IS BROWN."
49910 PRINT "THEIR SKIN IS TAN WITH RUDDY CHEEKS ON THEIR FACE."
49920 ENDIF
49930 IF NCODE(J)=35 THEN
49940 PRINT "THE UNICORN IS A GREAT WHITE STALLION."
49950 PRINT "IT WALKS GRACEFULLY ACROSS THE GRASS.THE UNICORN HAS A HORN ON THE BUTT"
49960 PRINT "OF IT'S NOSE.THE HORNS IS IVORY WHITE AND IT SWIRLS FROM"
49970 PRINT "ONE END TO ANOTHER.THE UNICORN KEEPS A GOOD DISTANCE FORM YOU AT ALL"
49980 PRINT "TIMES."
49990 ENDIF
50000 IF NCODE(J)=36 THEN
50010 PRINT "THE WOLF OBVIOUSLY RABID WITH HUNGER.YOU CAN SEE IT'S RIBS THROUGH"
50020 PRINT "IT'S SKIN AS IF ALL THEY WERE WAS BONES WITH SKIN"
50030 PRINT "DRAPED OVER THEM.THE DROOL AT THE SIGHT OF YOU AND THE BARE THEIR FANGS."
50040 ENDIF
50050 IF NCODE(J)=37 THEN 
50060 PRINT "THE SNAKES ARE SPECIAL ONES.THEY HAVE WINGS EXTENDING FROM THE TOP"
50070 PRINT "OF THE CENER OF THEIR BODY.THEY FLUTTER AROUND CLUMSILY AS IF THEY HAVE"
50080 PRINT "JUST LEARNED HOW TO USE THEM. BEING RATTLERS IN VARIETY,THEY RATTLE"
50090 PRINT "THEIR RATTLERS AND MAKE A TREMENDOUS NOISE."
50100 ENDIF
50110 ENDF EOBJECT
50120 DEFINE WEPDRAW
50130 REM ****************************************************
50140 REM **
50150 REM ** DRAW A WEAPON IN TO HAND (READY FOR COMBAT)
50160 REM **
50170 REM *********************************************************
50180 IF NNUM<1 THEN PRINT "DRAW WHICH WEAPON?"
50190 IF NNUM<1 THEN GOTO 50350
50200 E=-CNUM2
50210 CALL SEARCHP
50220 IF NLOC(NNUM)<>-CNUM2 THEN
50230 PRINT "YOU DON'T HAVE IT!"
50240 GOTO 50350
50250 ENDIF
50260 IF NDAM(NNUM)<3 THEN PRINT "YOU CANNOT DRAW THAT!"
50270 IF NDAM(NNUM)<3 THEN GOTO 50350
50280 IF GONE(CNUM2)=1 THEN
50290 PRINT "YOU MAY NOT DRAW A WEAPON WHILE HANGING ONTO A WALL.I SUGGEST"
50300 PRINT "THAT YOU GET DOWN FIRST."
50310 GOTO 50350
50320 ENDIF
50330 CWEP(CNUM2)=NNUM
50340 PRINT "OK."
50350 ENDF WEPDRAW
50360 DEFINE DDESC
50370 REM ***************************
50380 REM **
50390 REM ** TRANSFER TO EOBJECT FROM
50400 REM ** DESCRIBE VERB
50410 REM ***************************
50420 IF NNUM<1 THEN
50430 PRINT "WHAT DO YOU WANT ME TO ":VERB$(VNUM):"?"
50440 GOTO 50530
50450 ENDIF
50460 IF NLOC(NNUM)<>P AND NLOC(NNUM)<>-CNUM2 THEN
50470 PRINT "I CANNOT,AT THE MOMENT UNDERSTAND."
50480 GOTO 50530
50490 ENDIF
50500 J=NNUM
50510 PRINT "OK."
50520 CALL EOBJECT
50530 ENDF DDESC
50540 DEFINE BBACK
50550 REM *****************
50560 REM **BACK       ***
50570 REM *****************
50580 IF P=PP THEN
50590 PRINT "I DON'T REMEMBER HOW YOU GOT HERE."
50600 GOTO 50640
50610 ENDIF
50620 P=PP
50630 PRINT "OK."
50640 ENDF BBACK
50650 DEFINE LLIGHT
50660 REM ***************************
50670 REM **THIS IS WHERE WE LIGHT***
50680 REM **THINGS(E.G LAMP)*********
50690 REM ***************************
50700 IF NNUM<1 THEN 
50710 PRINT "LIGHT? I SEE NO LIGHT?"
50720 GOTO 50860
50730 ENDIF
50740 E=-CNUM2
50750 CALL SEARCHP   !!! FIND THE RIGHT LAMP!!!!
50760 IF NLOC(NNUM)<>-CNUM2 THEN
50770 PRINT "YOU ARE NOT CARRYING THE ":NOUN$(NNUM):"."
50780 GOTO 50860
50790 ENDIF
50800 IF NCODE(NNUM)<>14 THEN
50810 PRINT "I'M TERRIBLY SORRY,BUT YOU CANNOT LIGHT THAT."
50820 GOTO 50860
50830 ENDIF
50840 LSORCE(CNUM2)=1
50850 PRINT "OK."
50860 ENDF LLIGHT
50870 DEFINE RFMCHECK
50880 REM ****************************************************
50890 REM **
50900 REM **  RUN FROM MONSTER CHECK
50910 REM **
50920 REM **  CHECK TO SEE,WHEN HE LEAVES, IF A MONSTER WOULD
50930 REM **  LIKE TO ATTACK HIM
50940 REM ****************************************************
50950 FOR J=1 TO 295
50960 IF NLOC(J)=PP THEN
50970 IF MALIGN(J)=1 THEN D.ATT=1 ELSE D.ATT=0
50980 IF CWEP(CNUM)>0 AND INT(RND(-1)*99)+1<45 THEN D.ATT=1
50990 IF D.ATT=1 THEN
51000 I=CNUM2
51010 MR=J
51020 CALL MKILL
51030 ENDIF
51040 ENDIF
51050 NEXT J
51060 ENDF RFMCHECK
51070 DEFINE SELL.SUB
51080 REM ****************************
51090 REM * HERE PEOPLE CAN SELL THINGS
51100 REM * TO THE MERCHANT
51110 REM *****************************
51120 IF NNUM<1 THEN
51130         PRINT "SELL WHAT,SIRE?"
51140         GOTO 51360
51150         ENDIF
51160 IF P<>7 THEN
51170         PRINT "YOU ARE NOT IN THE STORE,MY FRIEND."
51180         GOTO 51360
51190         ENDIF
51200 E=-CNUM2
51210 CALL SEARCHP
51220 IF NLOC(NNUM)<>-CNUM2 THEN
51230         PRINT "YOU DO NOT HAVE IT!"
51240         GOTO 51360
51250         ENDIF
51260 PRINT "OK."
51270 X=INT(RND(0)**9)+1
51280 X=INT(.01*(X+15))
51290 X=(PRICE(NCODE(NNUM)))*X
51300 X1=PRICE(NCODE(NNUM))
51310 PRINT "IT IS WORTH ":X1-X:" GOLD."
51320 PRINT "THIS WILL BE ADDED TO YOUR TOTAL OF ":GOLD(CNUM2):" GOLD PIECES."
51330 PRINT "TO MAKE A TOTAL OF ":PRICE(NCODE(NNUM))+GOLD(CNUM2)-X:"."
51340 GOLD(CNUM2)=GOLD(CNUM2)+PRICE(NCODE(NNUM))-X
51350 NLOC(NNUM)=10000
51360 ENDF SELL.SUB
51370 DEFINE HOBBIT
51380 REM *****************
51390 REM * HOBBIT SUB    *
51400 REM *               *
51410 REM *****************
51420 IF INT(RND(-1)*99)+1<25 THEN GOTO 51570
51430 REM ** FIRST CHECK FOR CHARACTERS TO PICK-POCKET
51440 NHITS(227)=NHITS(227)+1
51450 FOR Z=1 TO 6
51460 IF NLOC(Z)=NLOC(G  ) THEN
51470 FOR I1=295 TO 1 STEP -1
51480         IF NLOC(I1)=-Z THEN
51490         HOBBIT.DID=1
51500         NLOC(I1)=-G
51510 IF INT(RND(-1)*99)+1<40 THEN PRINT "THE ":NOUN$(G):" JUST RIPPED OFF ":NAME$(Z):"."
51520         GOTO 51570
51530         ENDIF
51540 NEXT I1
51550 ENDIF
51560 NEXT Z
51570 ENDF HOBBIT
51580 DEFINE TRAP.SUB
51590 IF P=719 AND GONE(CNUM2)<>1 THEN
51600         PRINT "YOU FELL INTO A PIT!"
51610         A=INT(RND(0)*5)+1
51620         PRINT "YOU TOOK ":A:" PONTS OF DAMAGE!"
51630         NHITS(CNUM2)=NHITS(CNUM2)-A
51640         IF NHITS(CNUM2)<1 THEN 
51650                 PRINT "YOU DIED!"
51660                 VI=CNUM2
51670                 NLOC(CNUM2)=701,P=701,PP=701
51680                 CALL CDEAD
51690                 GOTO 51830
51700                 ENDIF
51710         PLOC(CNUM2)=701,CLOC(CNUM2)=701,P=701,PP=701,NUMTURN=99
51720         ENDIF
51730 IF P=698 THEN
51740         PRINT "AS YOU ENTER THE ROOM A FAINT GREEN MIST FILLS THE"
51750         PRINT "AIR ABOUT YOU.MAKING YOU VERY DROWSY."
51760 IF C(CNUM2)>17 OR INT(RND(0)*19)+1<9 THEN
51770         PRINT "HOWEVER,YOU RESIST THE SLEEPY TEMPTATION AND STAY AWAKE."
51780         GOTO 51830
51790                 ENDIF
51800 PRINT "YOU FELL ASLEEP."
51805 NUMTURN=NUMTURN+99
51810 ASLEEP(CNUM2)=1
51820 ENDIF
51830 ENDF TRAP.SUB
51840 REM ******************************
51850 REM *
51860 REM * INVOKE STUFF
51870 REM * INVOKE STUFF
51880 REM ******************************
51890 DEFINE INVOKE.SUB
51900 E=-CNUM2
51910 CALL SEARCHP
51920 IF NNUM<1 THEN
51930         PRINT "INVOKE WHAT?"
51940         GOTO 52210
51950         ENDIF
51960 IF NLOC(NNUM)<>-CNUM2 THEN
51970         PRINT "YOU HAVEN'T GOT IT!"
51980         GOTO 52210
51990         ENDIF
52000 IF NNUM=65 THEN
52010         FIREBALL.FLAG=1
52020         CALL MSPELL
52030         PRINT "THE EMERALD RETURNS!"
52040         NLOC(65)=71
52050         ENDIF
52060 REM ** INVOKE ITEM NUMER 62 GREEN EMERALD
52070 IF NNUM=62 THEN
52080 PRINT "OK"
52090 PRINT "YOU FALL ASLEEP."
52100 ASLEEP(CNUM2)=3
52110 ENDIF
52120 REM ** INVOKE ITEM NUMBER 220
52130 IF NNUM=220 THEN
52140         PRINT "THE AMULET FADES AWAY!"
52150         PRINT "YOUR STRENGTH IS 19!"
52160         S(CNUM2)=19
52170        D(CNUM2)=12
52180         NLOC(NNUM)=0
52190        CURSE(CNUM2)=1
52191 ENDIF
52200 IF NNUM=217 THEN
52205         PRINT "YOU ARE SWEPT INSIDE THE BLACK SAPHIRE,AMIDST DARK BLACKNESS."
52206        PRINT "YOU ARE NOW FLOATING IN A BLACK ABYSS."
52207        P=100,PP=100,CLOC(CNUM2)=100,PLOC(CNUM2)=100,NUMTURN=99
52208        ENDIF
52210 ENDF INVOKE.SUB
52220 DEFINE RES.SUB
52230 FOR I=1 TO 295
52240 IF NLOC(I)>0 THEN GOTO 52280
52250 IF MLOC(NCODE(I))<>1 THEN GOTO 52280
52260 NLOC(I)=INT(RND(0)*750)+1
52270 NHITS(I)=NHITSII(I)
52280 NEXT I
52290 ENDF RES.SUB
90000 REM *********************************************************
90020 REM **
90040 REM **  DATA FOR GNOME TREASURE PREFERENCE
90060 REM *********************************************************
90080 DATA 14,23,24,25,26,39,42,43,44,52
90100 DATA 53,54,55,56,57,58,59,61,62,63
90120 DATA 64,65,66,69,72,79,83,84,85,86
90140 REM **************************
90160 REM * SPELL DATA
90180 REM **************************
90200 DATA CURE MINOR WOUNDS,MAGIC MISSILE,SLEEP,CLIMB
90220 DATA LIGHT,INVISIBILITY,DETECT INVISIBILITY,LASTING LIGHT
90240 DATA ANIMATE DEAD,LIGHTNING BOLT,FIREBALL,CURE LIGHT WOUNDS,HASTE,FIRE CHARM
90260 DATA REMOVE CURSE,CURE SERIOUS WOUNDS,ICE STORM,ELEMENTAL,COLD CONE
90280 DATA MONSTER III,TELEPORT,TELEKENISIS,DISINTEGRATE
90300 DATA DEATH,IDENTIFY,MONSTER IV,REINCARNATION
90320 DATA 1,1,1,1,1,2,2,2,2,3
90340 DATA 3,3,3,4,4,4,4,5,5,5
90360 DATA 5,5,6,6,6,6,6
90380 REM *************
90400 REM * RANK DATA
90420 REM * FIGHTER,MAGE,THIEF
90440 REM ***************(***
90460 DATA VETERAN,WARRIOR,SWORDSMAN,HERO,SWASHBUCKLER,MYRMIDON,CHAMPION,SUPERHERO,LORD,LORD(10TH LEVEL),LORD(11TH LEVEL)
90480 DATA PRESTIDIGITATOR,EVOKER,CONJURER,THEURGIST,THAUMATURGIST,MAGICIAN,ENCHANTER,WARLOCK,SORCERER,NECROMANCER,WIZARD
90500 DATA ROGUE,FOOTPAD,CUTPURSE,ROBBER,BURGLAR,FILCHER,SHARPER,MAGSMAN,THIEF,MASTER THIEF,MASTER THIEF(11TH LEVEL)
90520 DATA NOVICE,INITIATE,BROTHER,DISCIPLE,IMMACULATE,MASTER,SUPERIOR MASTER,MASTER OF DRAGONS,MASTER OF THE NORTH WIND,MASTER OF THE WEST WIND,MASTER OF THE SOUTH WIND
90540 DATA MASTER OF THE EAST WIND,MASTER OF WINTER,MASTER OF AUTUMN,MASTER OF SUMMER,MASTER OF SPRING,GRAND MASTER OF FLOWERS
90560 REM **********(****(*****
90580 REM **********************
90600 REM * MONK'S DATA
90620 REM **********************
90640 REM ++ ARMOR CLASS ++
90660 DATA 10,9,8,7,7,6,5,4,3,3,2,1,0,-1,-1,-2,-3
90680 REM +++ NOW DAMAGE DATA +++
90700 DATA 4,4,6,6,7,8,9,12,12,13,13,16,17,20,24,30,32
90720 REM **************************
      