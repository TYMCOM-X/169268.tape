CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C
C			(RNIELSEN:28)WPLOT.FOR
C
C       THIS PROGRAM USES THE DATA FILE CREATED BY
C       WSTAT AND PLOTS DIFFERENT KINDS OF GRAPHS:
C
C               1 : SIMULTANEOUS USERS
C               2 : SESSION LENGTH DISTRIBUTION
C               3 : DISCONNECT TYPE DISTRIBUTION
C               4 : MIX OF TRAFIC
C               5 : ABNORMAL DISCONNECTIONS BY USER TYPE
C               6 : LOGIN RATE BY HOUR OF THE DAY
C               7 : AVERAGE HOLDING TIME BY USER TYPE
C               8 : CPS DISTRIBUTION
C
C 	THE HP7220 PLOTTER IS USED FOR THE GRAPHS.
C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC



C
C       DECLARATIONS AND INITIALISATIONS
C
        INTEGER LGTSEC(8,241),DSESS(8,100),DMIN(8,100),
     -DINP(8,100),DOUTP(8,100),DISCT(8,100),SUSER(8,1440),
     -HOUR(200),ABDIS(8,100),RESP,IUSER(1440),ILENG(241)
     -,IDIST(100),TSESS(100),TMIN(100),TINP(100),TOUTP(100)
     -,IABD(100),THOUR(24),IHOR(24)
        DOUBLE PRECISION FILNAM

C
C       GET THE DATA FILE NAME
C
        TYPE 10
10      FORMAT (1X,'THIS PROGRAM USES THE RESULTS OF WSTAT,
     -AND PLOT VARIOUS CURVES',//)

15      TYPE 20
20      FORMAT (1X,'ENTER DATA FILE NAME : ')

        READ (5,30,ERR=15) FILNAM
30      FORMAT (A10)

C
C       OPEN THIS FILE AND READ THE DATA
C

        OPEN (UNIT=21,DEVICE='DSK',FILE=FILNAM,
     -ACCESS='SEQINOUT',MODE='ASCII',ERR=5000)
        READ (21,50,ERR=5000,END=199) ILENGT,IDATE
50      FORMAT(1X,I1,1X,I6)

        DO 70 I=1,ILENGT
        DO 65 J=1,241
        READ (21,60,ERR=5000,END=199) LGTSEC(I,J)
        LGTSEC(8,J)=LGTSEC(8,J)+LGTSEC(I,J)
60      FORMAT (5X,I6)
65      CONTINUE

        DO 68 J=1,100
        READ (21,67,ERR=5000,END=199) DSESS(I,J),DMIN(I,J),DINP(I,J),
     -DOUTP(I,J),DISCT(I,J)
        DSESS(8,J)=DSESS(8,J)+DSESS(I,J)
        DMIN(8,J)=DMIN(8,J)+DMIN(I,J)
        DINP(8,J)=DINP(8,J)+DINP(I,J)
        DOUTP(8,J)=DOUTP(8,J)+DOUTP(I,J)
        DISCT(8,J)=DISCT(8,J)+DISCT(I,J)
67      FORMAT (1X,I6,1X,I8,1X,I11,1X,I11,1X,I6)
68      CONTINUE
70      CONTINUE

        DO  71 I=1,241
        LGTSEC(8,I)=LGTSEC(8,I)/ILENGT
71      CONTINUE

        DO 72 I=1,100
        DSESS(8,I)=DSESS(8,I)/ILENGT
        DMIN(8,I)=DMIN(8,I)/ILENGT
        DINP(8,I)=DINP(8,I)/ILENGT
        DOUTP(8,I)=DOUTP(8,I)/ILENGT
        DISCT(8,I)=DISCT(8,I)/ILENGT
72      CONTINUE


        DO 100 I=1,ILENGT
        DO 99 J=1,1440
        READ (21,80,ERR=5000,END=199) SUSER(I,J)
80      FORMAT (6X,I5)
        SUSER(8,J)=SUSER(8,J)+SUSER(I,J)
99      CONTINUE
100     CONTINUE

        DO 101 I=1,1440
        SUSER(8,I)=SUSER(8,I)/ILENGT
101     CONTINUE
        DO 120 I=1,168
        READ (21,110,ERR=5000,END=199) HOUR(I)
110     FORMAT (5X,I6)
        JJ=MOD(I,24)
        IF (JJ.EQ.0) JJ=24
        THOUR(JJ)=THOUR(JJ)+HOUR(I)
120     CONTINUE

        DO 125 I=1,24
        KK=24*7+I
        HOUR(KK)=THOUR(I)/ILENGT
125     CONTINUE


        DO 150 I=1,ILENGT
        DO 140 J=1,100
        READ (21,130,ERR=5000,END=199) ABDIS(I,J)
        ABDIS(8,J)=ABDIS(8,J)+ABDIS(I,J)
130     FORMAT (5X,I6)
140     CONTINUE
150     CONTINUE

        DO 151 I=1,100
        ABDIS(8,I)=ABDIS(8,I)/ILENGT
151     CONTINUE
C
C       DETERMINE WHICH PLOT THE USER WANTS
C

199     TYPE 200
200     FORMAT (/,1X,'DO YOU WANT THE LIST OF 
     -THE POSSIBLE PLOTS ? '$)
        READ (5,210,ERR=199) RESP
210     FORMAT (A1)
        IF (RESP.EQ.'Y') GOTO 300
        IF (RESP.EQ.'N') GOTO 320
        GOTO 199

300     TYPE 310
310     FORMAT (/,1X,'THE VARIOUS PLOTS ARE : ',/,/,
     -'  1) NUMBER OF SIMULTANEOUS USERS',/,
     -'  2) SESSION LENGTH DISTRIBUTION',/,
     -'  3) DISCONNECT TYPE DISTRIBUTION',/,
     -'  4) MIX OF TRAFIC',/,
     -'  5) ABNORMAL DISCONNECTIONS BY USER TYPE',/,
     -'  6) LOGIN RATE BY HOUR OF THE DAY',/,
     -'  7) AVERAGE HOLDING TIME BY USER TYPE',/,
     -'  8) CPS DISTRIBUTION BY USER TYPE')

320     TYPE 330
330     FORMAT(//,1X,'WHICH PLOT DO YOU WANT ',/,
     -'  (0 IF YOU DON''T WANT ANY)',/,1X,'?') 

        READ (5,340,ERR=320) RESP
340     FORMAT(I1)
        IF (RESP.EQ.0) GOTO 9000

        TESRES=RESP
        IF (ILENGT.EQ.1) IXD=1
        IF (ILENGT.EQ.1) GOTO 400



350     RESP=TESRES
        TYPE 360
360     FORMAT (/,1X,'WHICH DAY DO YOU WANT TO PROCESS ',/,
     -'   (AS YYMMDD; FOR THE TOTAL STATISTICS ENTER 8)',/,1X,'?')

        READ (5,370,ERR=350) IXD
370     FORMAT (I6)

        
C
C       START PLOTTING (SET THE PLOTTING AREA)
C
        IF (IXD.EQ.8) GOTO 400
        IXD=IXD-IDATE+1
400     CALL HP7220
        CALL PAGE(20.,16.)
        CALL NOBRDR
        CALL PHYSOR(2.5,2.5)


        IF (RESP.EQ.1) GOTO 500
        IF (RESP.EQ.2) GOTO 600
        IF (RESP.EQ.3) GOTO 700
        IF (RESP.EQ.4) GOTO 800
        IF (RESP.EQ.5) GOTO 900
        IF (RESP.EQ.6) GOTO 1000
        IF (RESP.EQ.7) GOTO 1100
        IF (RESP.EQ.8) GOTO 1200
        GOTO 320

C
C       SET THE PARAMETERS FOR THE 1ST PLOT
C       AND CALL THE RIGHT SUBROUTINE
C
500     DO 510 I=1,1440
        IUSER(I)=SUSER(IXD,I)
510     CONTINUE
        IDAY=IDATE+IXD-1

        IF (IXD.EQ.8) IDAY=IDATE
        IF (IXD.EQ.8) IXD=IDATE+ILENGT
        IDX=IXD
        CALL PLOT1(IDAY,IUSER,IDX)

        GOTO 3000
C
C       SET THE PARAMETERS FOR THE 2ND PLOT
C       AND CALL THE RIGHT SUBROUTINE
C

600     DO 610 I=1,241
        ILENG(I)=LGTSEC(IXD,I)
610     CONTINUE
        IDAY=IDATE+IXD-1

        IF (IXD.EQ.8) IDAY=IDATE
        IF (IXD.EQ.8) IXD=IDATE+ILENGT
        IDX=IXD
        CALL PLOT2(IDAY,ILENG,IDX)

        GOTO 3000

C
C       SET THE PARAMETERS FOR THE 3RD PLOT
C       AND CALL THE RIGHT SUBROUTINE
C

700     DO 710 I=1,100
        IDIST(I)=DISCT(IXD,I)
710     CONTINUE
        IDAY=IDATE+IXD-1

        IF (IXD.EQ.8) IDAY=IDATE
        IF (IXD.EQ.8) IXD=IDATE+ILENGT
        IDX=IXD
        CALL PLOT3(IDAY,IDIST,IDX)

        GOTO 3000


C
C       SET THE PARAMETERS FOR THE 4TH PLOT
C       AND CALL THE RIGHT SUBROUTINE
C

800     DO 810 I=1,100
        TSESS(I)=DSESS(IXD,I)
        TMIN(I)=DMIN(IXD,I)
        TINP(I)=DINP(IXD,I)
        TOUTP(I)=DOUTP(IXD,I)
810     CONTINUE
        IDAY=IDATE+IXD-1

        IF (IXD.EQ.8) IDAY=IDATE
        IF (IXD.EQ.8) IXD=IDATE+ILENGT
        IDX=IXD
        CALL PLOT4(IDAY,TSESS,TMIN,TINP,TOUTP,IDX)

        GOTO 3000


C
C       SET THE PARAMETERS FOR THE 5TH PLOT
C       AND CALL THE RIGHT SUBROUTINE
C

900     DO 910 I=1,100
        IABD(I)=ABDIS(IXD,I)
910     CONTINUE
        IDAY=IDATE+IXD-1
        IF (IXD.EQ.8) IDAY=IDATE
        IF (IXD.EQ.8) IXD=IDATE+ILENGT
        IDX=IXD

        CALL PLOT5(IDAY,IABD,IDX)

        GOTO 3000


C
C       SET THE PARAMETERS FOR THE 6TH PLOT
C       AND CALL THE RIGHT SUBROUTINE
C

1000    DO 1010 I=1,24
        JJ=24*(IXD-1)+I
        IHOR(I)=HOUR(JJ)
1010    CONTINUE
        IDAY=IDATE+IXD-1

        IF (IXD.EQ.8) IDAY=IDATE
        IF (IXD.EQ.8) IXD=IDATE+ILENGT
        IDX=IXD
        CALL PLOT6(IDAY,IHOR,IDX)

        GOTO 3000


C
C       SET THE PARAMETERS FOR THE 7TH PLOT
C       AND CALL THE RIGHT SUBROUTINE
C

1100    DO 1110 I=1,100
        TSESS(I)=DSESS(IXD,I)
        TMIN(I)=DMIN(IXD,I)
1110    CONTINUE
        IDAY=IDATE+IXD-1
        IF (IXD.EQ.8) IDAY=IDATE
        IF (IXD.EQ.8) IXD=IDATE+ILENGT
        IDX=IXD

        CALL PLOT7(IDAY,TSESS,TMIN,IDX)

        GOTO 3000


C
C       SET THE PARAMETERS FOR THE 8TH PLOT
C       AND CALL THE RIGHT SUBROUTINE
C

1200    DO 1210 I=1,100
        TMIN(I)=DMIN(IXD,I)
        TINP(I)=DINP(IXD,I)
        TOUTP(I)=DOUTP(IXD,I)
1210    CONTINUE
        IDAY=IDATE+IXD-1

        IF (IXD.EQ.8) IDAY=IDATE
        IF (IXD.EQ.8) IXD=IDATE+ILENGT
        IDX=IXD
        CALL PLOT8(IDAY,TMIN,TINP,TOUTP,IDX)



C       
C       RESET PARAMETERS AND THE PLOT
C

3000    CALL RESET('ALL')
        CALL ENDPL(0)

C
C       DETERMINATION OF THE STARTING POINT FOR ANOTHER PLOT
C

        IF (ILENGT.EQ.1) GOTO 4300

4000    TYPE 4100
4100    FORMAT (/,1X,'DO YOU WANT ANOTHER PLOT OF THIS KIND ?')
        READ (5,4200,ERR=4000) RESP
4200    FORMAT (A1)

        IF (RESP.EQ.'Y') GOTO 350
        IF (RESP.NE.'N') GOTO 4000
4300    TYPE 4400
4400    FORMAT (/,1X,'DO YOU WANT ANOTHER PLOT ?')
        READ (5,4500,ERR=4300) RESP
4500    FORMAT(A1)
        IF (RESP.EQ.'Y') GOTO 199
        IF (RESP.NE.'N') GOTO 4300
        GOTO 9000

5000    TYPE 8000
8000    FORMAT(1X,'***  ERROR  ****')


9000    CALL DONEPL
        STOP
             END
C
C       THIS SUBROUTINE PLOTS THE NUMBER OF SIMULTANEOUS USERS
C

 
        SUBROUTINE PLOT1(DAY,USERS,IXDP)

        INTEGER IXDP,DAY,USERS(1500),MAXUSE,HOUR,MIN,LXARAY(1500),
     -IMAX,HMAX,MMAX
        REAL    XARRAY(1500), YARRAY(1500)
        DATA HOUR/0/,MIN/0/
        DO 20  I=1,1440
           MIN = MIN+1
           IF (MIN.LT.60) GOTO 15
              HOUR = HOUR+1
              MIN  = 0
   15      IF(MIN.EQ.0)ENCODE(5,16,LXARAY(I)) HOUR
16      FORMAT(I2,':00')
           IF(MIN.NE.0) LXARAY(I) = ' '
           XARRAY(I) = I
        JJ=USERS(I)
           YARRAY(I) = FLOAT(JJ)
           IF (MAXUSE.LT.JJ) MAXUSE = JJ
        IF (MAXUSE.EQ.JJ) IMAX=I
   20      CONTINUE
        LXARAY(1)=' 0:00'
        HMAX=IMAX/60
        MMAX=MOD(IMAX,60)
        CALL YINTAX
        CALL XAXANG(90.0)
        CALL YAXANG(0.)
        CALL HEIGHT(0.3)
        CALL TITLE('NUMBER OF SIMULTANEOUS USERS$',100,
     -'TIME OF THE DAY (GMT)$',100,
     -'NUMBER OF SIMULTANEOUS USERS$',100,
     -17.,12.)
	CALL YTICKS(5)
        CALL XLABGR(LXARAY,1,1440,0.,1000.,8600.)
        CALL BASALF('L/CSTD')
        CALL MIXALF('STANDARD')
        CALL RLMESS('DAY : $',100,540.,6800.)
        IF (IXDP.GE.8) GOTO 30
        CALL RLINT(DAY,'ABUT','ABUT')
        GOTO 50

30      CALL RLMESS ('AVERAGE$',100,'ABUT','ABUT')
        CALL MESSAG('PERIOD OF $',100,4.,11.5)
        CALL INTNO(IXDP-DAY,'ABUT','ABUT')
        CALL MESSAG(' DAYS STARTING ON $',100,'ABUT','ABUT')
        CALL INTNO(DAY,'ABUT','ABUT')
50      CALL RLMESS('PEAK = $',100,100.,6200.)
        CALL RLINT(MAXUSE,'ABUT','ABUT')
        CALL RLMESS('  OCCURRED AT $',100,'ABUT','ABUT')
        CALL RLINT(HMAX,'ABUT','ABUT')
        CALL RLMESS(' :$',100,'ABUT','ABUT')
        CALL RLINT(MMAX,'ABUT','ABUT')
        CALL CURVE(XARRAY,YARRAY,1440,0)

        MIN=0
        HOUR=0
        MAXUSE=0


        RETURN
        END
C
C       THIS SUBROUTINE PLOTS THE SESSION LENGTH DISTRIBUTION
C

        SUBROUTINE PLOT2(DAY,LENGTH,IXDP)

        INTEGER IXDP,DAY,LENGTH(241)
        REAL  XARRAY(300), YARRAY(300)
        DO 20  I=1,61
        J=I
           XARRAY(J) = J-1
        JJ=LENGTH(I)
           YARRAY(J) = JJ
   20      CONTINUE
        DO 21 I=62,241
        J=I
        JJ=LENGTH(I)
        YARRAY(61)=YARRAY(61)+JJ
21      CONTINUE
C
C     COMMENCE PLOTTING.
        CALL INTAXS
        CALL YAXANG(0.0)
        CALL HEIGHT(0.3)
        CALL TITLE('SESSION LENGTH DISTRIBUTION$',100,
     -'AVERAGE LENGTH OF A SESSION (MINUTES)$',100,
     -'NUMBER OF SESSIONS$',100,
     -16.,12.)
	CALL YTICKS(5)
        CALL GRAF (0.,5.,60.,0.,50000.,300000.)
        CALL BASALF('L/CSTD')
        CALL MIXALF('STANDARD')
        CALL RLMESS ('DAY : $',100,22.,300000.)
        IF (IXDP.GE.8) GOTO 30
        CALL RLINT (DAY,'ABUT','ABUT')
        
        GOTO 50
        
30      CALL RLMESS ('AVERAGE$',100,'ABUT','ABUT')
        CALL MESSAG('PERIOD OF $',100,4.,11.5)
        CALL INTNO(IXDP-DAY,'ABUT','ABUT')
        CALL MESSAG(' DAYS STARTING ON $',100,'ABUT','ABUT')
        CALL INTNO(DAY,'ABUT','ABUT')

50      CALL CURVE(XARRAY,YARRAY,61,0)

        RETURN
        END
C
C       THIS SUBROUTINE PLOTS THE DISCONNECT TYPE DISTRIBUTION
C

        SUBROUTINE PLOT3(DAY,DISTYP,IXDP)

        INTEGER IXDP,DAY, DISTYP(100),TOT, LXARAY(20)
        REAL    Y1ARAY(20),Y2ARAY(20)
        DIMENSION IWORK(600),XARAY(20),IPKRAY(300),IVAL(20)
        LXARAY(1)=' '

        DO 10 I=1,100
        TOT=TOT+DISTYP(I)
10      CONTINUE

        INDX=1
        DO 20 I=1,100
        JJ=DISTYP(I)
        IF (JJ.EQ.0) GOTO20
        INDX=INDX+1
18      Y1ARAY(INDX)=0.0
        Y2ARAY(INDX)=(FLOAT(JJ)/FLOAT(TOT))*100.
        XARAY(INDX)=FLOAT(INDX)
        IVAL(INDX)=JJ
        K=I-1
        ENCODE(5,19,LXARAY(INDX))K
19      FORMAT (I2,'   ')
   20      CONTINUE
        IMAX=INDX+1
        DO 21 I=IMAX,20
        LXARAY(I)=' '
21      CONTINUE
C
C     COMMENCE PLOTTING.
        CALL XINTAX
        CALL YAXANG(0.0)
        CALL HEIGHT(0.3)
        CALL TITLE ('DISCONNECT TYPE DISTRIBUTION$',100,
     -'DISCONNECT TYPE$',100,
     -'PERCENTAGE$',100,
     -17.,12.)
	CALL YTICKS(5)
        CALL XLABGR(LXARAY,1,20,0.,10.,70.)
        CALL BASALF('L/CSTD')
        CALL MIXALF('STANDARD')
        CALL RLMESS ('DAY : $',100,8,70.)
        IF (IXDP.GE.8) GOTO 30
        CALL RLINT (DAY,'ABUT','ABUT')
        GOTO 50

30      CALL RLMESS('AVERAGE$',100,'ABUT','ABUT')
        CALL MESSAG('PERIOD OF $',100,4.,11.5)
        CALL INTNO(IXDP-DAY,'ABUT','ABUT')
        CALL MESSAG(' DAYS STARTING ON $',100,'ABUT','ABUT')
        CALL INTNO(DAY,'ABUT','ABUT')
50      NPNTS=INDX
        CALL BARSHD(XARAY,Y1ARAY,Y2ARAY,NPNTS,0.5,45.,0.1,1,IWORK,600)
        CALL RESET('HEIGHT')
        CALL HEIGHT(0.2)

        CALL ANGLE(90.)
        DO 100 I=2,INDX
        II=I
        CALL RLINT(IVAL(II),II,Y2ARAY(II)+2.)
100     CONTINUE
        CALL RESET('ANGLE')

        MAXLIN=LINEST(IPKRAY,450,50)
        CALL LINES(' 1 : HOST HAS GONE DOWN : ISIS SLOT CRASH$',IPKRAY,
     -               1)
        CALL LINES(' 2 : DROPPED BY HOST : NORMAL$',IPKRAY,2)
        CALL LINES(' 3 : DROPPED BY USER$',IPKRAY,3)
        CALL LINES(' 4 : HOST NOT AVAILABLE$',IPKRAY,4)
        CALL LINES(' 5 : SUB-HOST DOWN AT LOG ON$',IPKRAY,5)
        CALL LINES(' 6 : SUB-HOST SHUT AT LOG ON$',IPKRAY,6)
        CALL LINES(' 7 : OUT OF PORTS$',IPKRAY,7)
        CALL LINES(' 8 : OUT OF CHANNELS$',IPKRAY,8)
        CALL LINES(' 9 : TERMINAL DOES NOT MATCH AVAILABLE PORTS$',
     -                   IPKRAY,9)
        CALL LINES('10 : CIRCUIT ORIGINATION REJECTED$',IPKRAY,10)
        CALL LINES('11 : USER NAME REJECTED$',IPKRAY,11)
        CALL LINES('12 : ILLEGAL USAGE : FOREIGN ORIGIN$',IPKRAY,12)
        CALL LINES('13 : SPECIAL CAMP-ON DISCONNECT$',IPKRAY,13)
        CALL LINES('14 : NETWORK DISCONNECT$',IPKRAY,14)
        CALL LINES('15 : NODE CODE OUT OF DISPATCHER PORTS$',IPKRAY,15)
        CALL LINES('16 : ISIS SLOT OUT OF DISPATCHER PORTS$',IPKRAY,16)
        CALL LINES('17 : ISIS SLOT ZAPPED,HOST OUT OF PORTS$',IPKRAY,17)
        CALL LINES('18 : HOST NOT ANSWERING$',IPKRAY,18)
        CALL LINES('19 : HOST REJECTED CALLER$',IPKRAY,19)
        CALL LINES('20 : PROTOCOL VIOLATION$',IPKRAY,20)
        CALL LINES('21 : RESOURCE-LIMIT EXCEEDED$',IPKRAY,21)
        CALL LINES('22 : LOSS OF SYNCHRONIZATION$',IPKRAY,22)
        CALL LINES('84 : FORCED TERMINATION: NO UPDATES IN 6HRS$',
     -IPKRAY,23)
        CALL LINES('85 : FORCED TERMINATION: NO I/O IN 24 HRS$',
     -IPKRAY,24)
        CALL LINES('86 : FORCED TERMINATION: OVER 1MONTH SESSION$',
     -IPKRAY,25)
        CALL LSTORY(IPKRAY,25,10.,4.)

        TOT=0

        RETURN
        END
C
C       THIS SUBROUTINE PLOTS THE MIX OF TRAFIC
C
        SUBROUTINE PLOT4(DAY,ISESS,IMIN,IINP,IOUTP,IXDP)

        INTEGER IXDP,ISESS(100),IMIN(100),IINP(100),IOUTP(100)
     -,TSESS,TMIN,TCHAR,DAY
        REAL Y1ARAY(5),Y2ARAY(5),Y3ARAY(5),Y4ARAY(5)
        DIMENSION IWORK(600),XARAY(5),IVAL1(5),IVAL2(5),IVAL3(5)
        DOUBLE PRECISION LXARAY(5)
        
        DATA XARAY /1.,2.,3.,4.,5./
        DATA Y1ARAY /0.,0.,0.,0.,0./

        Y2ARAY(1)=0
        Y3ARAY(1)=0
        Y4ARAY(1)=0
        Y2ARAY(5)=0
        Y3ARAY(5)=0
        Y4ARAY(5)=0

        LXARAY(1)='          '
        LXARAY(2)='SESSIONS  '
        LXARAY(3)='HOURS     '
        LXARAY(4)='I/O :KCHRS'
        LXARAY(5)='          '

        DO 5 I=1,100
        TSESS=TSESS+ISESS(I)
        TMIN=TMIN+IMIN(I)
        TCHAR=TCHAR+IINP(I)+IOUTP(I)
5       CONTINUE

C
C       300 BAUD  (NETWORK ID - 1,...10,33-36,42)
C

        DO 6 I=2,11
        IVAL1(2)=IVAL1(2)+ISESS(I)
        IVAL1(3)=IVAL1(3)+IMIN(I)
        IVAL1(4)=IVAL1(4)+IINP(I)+IOUTP(I)
6       CONTINUE
        IVAL1(2) = IVAL1(2) + ISESS(34)+ISESS(35)+ISESS(36)+ISESS(37)+
     +       ISESS(43)
        IVAL1(3) = IVAL1(3) + IMIN(34)+IMIN(35)+IMIN(36)+IMIN(37)+
     +       IMIN(43)
        IVAL1(4) = IVAL1(4) + IINP(34)+IINP(35)+IINP(36)+IINP(37)+
     +       IINP(43)+ 
     +       IOUTP(34)+IOUTP(35)+IOUTP(36)+IOUTP(37)+IOUTP(43)
        Y2ARAY(2)=(IVAL1(2)/FLOAT(TSESS))*100.
        Y2ARAY(3)=(IVAL1(3)/FLOAT(TMIN))*100.
        Y2ARAY(4)=(IVAL1(4)/FLOAT(TCHAR))*100.
        IVAL1(3)=IVAL1(3)/60
        IVAL1(4)=IVAL1(4)/1000
C
C       1200 BAUD-9600 BAUD  (NETWORK ID - 12,16,17,19,20,44,48,51,52)
C

        IVAL2(2)=ISESS(13)+ISESS(17)+ISESS(18)+ISESS(20)+ISESS(21)+
     +           ISESS(45)+ISESS(49)+ISESS(52)+ISESS(53)
        IVAL2(3)=IMIN(13)+IMIN(17)+IMIN(18)+IMIN(20)+IMIN(21)+
     +           IMIN(45)+IMIN(49)+IMIN(52)+IMIN(53)
        IVAL2(4)=IINP(13)+IINP(17)+IINP(18)+IINP(20)+IINP(21)+
     +           IINP(45)+IINP(49)+IINP(52)+IINP(53)+
     +           IOUTP(13)+IOUTP(17)+IOUTP(18)+IOUTP(20)+IOUTP(21)+
     +           IOUTP(45)+IOUTP(49)+IOUTP(52)+IOUTP(53)
        Y3ARAY(2)=(IVAL2(2)/FLOAT(TSESS))*100.
        Y3ARAY(3)=(IVAL2(3)/FLOAT(TMIN))*100.
        Y3ARAY(4)=(IVAL2(4)/FLOAT(TCHAR))*100.
        IVAL2(3)=IVAL2(3)/60
        IVAL2(4)=IVAL2(4)/1000

C
C      BATCH  (NETWORK ID - 0,11,13,14,15,18,21,22,23,32,43,46,47,50,53)
C

        IVAL3(2)=ISESS(1)+ISESS(12)+ISESS(14)+ISESS(15)+
     -           I16)+ISESS(19)+ISESS(22)+ISESS(23)+ISESS(24)+
     -           ISESS(33)+ISESS(44)+ISESS(47)+ISESS(48)+ISESS(51)+
     -           ISESS(54) 
        IVAL3(3)=IMIN(1)+IMIN(12)+IMIN(14)+IMIN(15)+
     -           IMIN(16)+IMIN(19)+IMIN(22)+IMIN(23)+IMIN(24)+
     -           IMIN(33)+IMIN(44)+IMIN(47)+IMIN(48)+IMIN(51)+
     -           IMIN(54) 
        IVAL3(4)=IINP(1)+IINP(12)+IINP(14)+IINP(15)+
     -           IINP(16)+IINP(19)+IINP(22)+IINP(23)+IINP(24)+
     -           IINP(33)+IINP(44)+IINP(47)+IINP(48)+IINP(51)+
     -           IINP(54) +
     -           IOUTP(1)+IOUTP(12)+IOUTP(14)+IOUTP(15)+
     -           IOUTP(16)+IOUTP(19)+IOUTP(22)+IOUTP(23)+IOUTP(24)+
     -           IOUTP(33)+IOUTP(44)+IOUTP(47)+IOUTP(48)+IOUTP(51)+
     -           IOUTP(54) 
        Y4ARAY(2)=(IVAL3(2)/FLOAT(TSESS))*100.
        Y4ARAY(3)=(IVAL3(3)/FLOAT(TMIN))*100.
        Y4ARAY(4)=(IVAL3(4)/FLOAT(TCHAR))*100.
        IVAL3(3)=IVAL3(3)/60
        IVAL3(4)=IVAL3(4)/1000





        CALL YAXANG(0.)
        CALL HEIGHT(0.3)
        CALL TITLE('MIX OF TRAFFIC FOR THE NETWORK$',100,
     -1H ,1,
     -'PERCENTAGE$',100,
     -17.,12.)
        CALL XAXEND('NOENDS')
        CALL YAXEND('NOFIRST')
	CALL YTICKS(5)
        CALL XLABGR(LXARAY,2,5,0.,10.,100.)
        CALL BASALF('L/CSTD')
        CALL MIXALF('STANDARD')
        CALL RLMESS('DAY : $',100,2.5,100.)
        IF (IXDP.GE.8) GOTO 8
        CALL RLINT(DAY,'ABUT','ABUT')
        GOTO 9

8       CALL RLMESS('AVERAGE$',100,'ABUT','ABUT')
        CALL MESSAG('PERIOD OF $',100,4.,11.5)
        CALL INTNO(IXDP-DAY,'ABUT','ABUT')
        CALL MESSAG(' DAYS STARTING ON $',100,'ABUT','ABUT')
        CALL INTNO(DAY,'ABUT','ABUT')
9       CALL RESET('BASALF')
        CALL RESET('MIXALF')


        CALL BARSHD(4.3,74.,78.,1,0.25,45.,0.1,1,IWORK,600)
        CALL RLMESS('110-300 BPS$',100,4.4,76.)
        CALL BARSHD(4.3,68.,72.,1,0.25,0.,30.,1,IWORK,600)
        CALL RLMESS('1200-9600$',100,4.4,70.)
        CALL BARSHD(4.3,62.,66.,1,0.25,0.,0.1,1,IWORK,600)
        CALL RLMESS('BATCH$',100,4.4,64.)


        CALL ANGLE(90.)
        CALL RESET('HEIGHT')
        CALL HEIGHT(0.2)

        CALL BSHIFT(-0.75,0.)
        CALL BARSHD(XARAY,Y1ARAY,Y2ARAY,5,0.75,45.,0.1,1,IWORK,600)
        DO 10 I=2,4
        II=I
        CALL RLINT(IVAL1(II),II,Y2ARAY(II)+2.)
10      CONTINUE
        CALL BSHIFT(0.,0.)
        CALL BARSHD(XARAY,Y1ARAY,Y3ARAY,5,0.75,0.,30.,1,IWORK,600)
        DO 20 I=2,4
        II=I
        CALL RLINT(IVAL2(II),II,Y3ARAY(II)+2.)
20      CONTINUE
        CALL BSHIFT(0.75,0.)
        CALL BARSHD(XARAY,Y1ARAY,Y4ARAY,5,0.75,0.,0.1,1,IWORK,600)
        DO 30 I=2,4
        II=I
        CALL RLINT(IVAL3(II),II,Y4ARAY(II)+2.)
30      CONTINUE

        TSESS=0
        TMIN=0
        TCHAR=0
        DO 40 I=2,4
        IVAL1(I)=0
40      CONTINUE


        RETURN
        END
C
C       THIS SUBROUTINE PLOTS THE ABNORMAL DISCONNECTIONS BY USERS TYPE           
C
        SUBROUTINE PLOT5(DAY,ABDI,IXDP)

        INTEGER IXDP,DAY,ABDI(100),TABDI
        REAL Y1ARAY(5),Y2ARAY(5)
        DIMENSION IWORK(600),XARAY(5),IVAL1(5)
        DOUBLE PRECISION LXARAY(5)
        
        DATA XARAY /1.,2.,3.,4.,5./
        DATA Y1ARAY /0.,0.,0.,0.,0./

        Y2ARAY(1)=0.
        Y2ARAY(5)=0.

        LXARAY(1)='          '
        LXARAY(2)='110-300BPS'
        LXARAY(3)='1200-9600 '
        LXARAY(4)='BATCH     '
        LXARAY(5)='          '

        DO 5 I=1,100
        TABDI=TABDI+ABDI(I)
5       CONTINUE

C
C       300 BAUD  (NETWORK ID - 1,...10,33-36,42)
C

        DO 6 I=2,11
        IVAL1(2)=IVAL1(2)+ABDI(I)
6       CONTINUE
        IVAL1(2)=IVAL1(2)+ABDI(34)+ABDI(35)+ABDI(36)+ABDI(37)+ABDI(43)
        Y2ARAY(2)=(IVAL1(2)/FLOAT(TABDI))*100.
C
C       1200 BAUD-9600 BAUD  (NETWORK ID - 12,16,17,19,20,44,48,51,52)
C

        IVAL1(3)=ABDI(13)+ABDI(17)+ABDI(18)+ABDI(20)+ABDI(21)+
     -           ABDI(45)+ABDI(49)+ABDI(52)+ABDI(53)
        Y2ARAY(3)=(IVAL1(3)/FLOAT(TABDI))*100.

C
C      BATCH  (NETWORK ID - 0,11,13,14,15,18,21,22,23,32,43,46,47,50,53)
C

        IVAL1(4)=ABDI(1)+ABDI(12)+ABDI(14)+ABDI(15)+
     -           ABDI(16)+ABDI(19)+ABDI(22)+ABDI(23)+ABDI(24)+
     -           ABDI(33)+ABDI(44)+ABDI(47)+ABDI(48)+ABDI(51)+ABDI(54)
        Y2ARAY(4)=(IVAL1(4)/FLOAT(TABDI))*100.





        CALL YAXANG(0.)
        CALL HEIGHT(0.3)
        CALL TITLE('ABNORMAL DISCONNECTIONS BY USER TYPE$',100,
     -1H ,1,
     -'PERCENTAGE$',100,
     -17.,12.)
        CALL XAXEND('NOENDS')
        CALL YAXEND('NOFIRST')
	CALL YTICKS(5)
        CALL XLABGR(LXARAY,2,5,0.,10.,100.)
        CALL BASALF('L/CSTD')
        CALL MIXALF('STANDARD')
        CALL RLMESS('DAY : $',100,2.5,100.)
        IF (IXDP.GE.8) GOTO 8
        CALL RLINT(DAY,'ABUT','ABUT')
        GOTO 9

8       CALL RLMESS('AVERAGE$',100,'ABUT','ABUT')
        CALL MESSAG('PERIOD OF $',100,4.,11.5)
        CALL INTNO(IXDP-DAY,'ABUT','ABUT')
        CALL MESSAG(' DAYS STARTING ON $',100,'ABUT','ABUT')
        CALL INTNO(DAY,'ABUT','ABUT')
9       CALL RESET('BASALF')
        CALL RESET('MIXALF')



        CALL ANGLE(90.)
        CALL RESET('HEIGHT')
        CALL HEIGHT(0.2)

        CALL BARSHD(XARAY,Y1ARAY,Y2ARAY,5,0.75,45.,0.1,1,IWORK,600)
        DO 10 I=2,4
        II=I
        CALL RLINT(IVAL1(II),II,Y2ARAY(II)+2.)
10      CONTINUE

        IVAL1(2)=0
        TABDI=0


        RETURN
        END
C
C       THIS SUBROUTINE PLOTS THE LOGIN RATE BY HOUR OF THE DAY           
C
        SUBROUTINE PLOT6(DAY,IHLOG,IXDP)

        INTEGER IXDP,DAY,IHLOG(26),TIHLOG
        REAL Y1ARAY(26),Y2ARAY(26)
        DIMENSION IWORK(600),XARAY(26),IVAL1(26)
        
        DO 1 I=1,26
        XARAY(I)=FLOAT(I)
        Y1ARAY(I)=0.
1       CONTINUE

        Y2ARAY(1)=0.
        Y2ARAY(26)=0.


        DO 5 I=1,24
        TIHLOG=TIHLOG+IHLOG(I)
5       CONTINUE

        DO 6 I=2,25
        JJ=I-1
        Y2ARAY(JJ)=(IHLOG(JJ)/FLOAT(TIHLOG))*100.
        IVAL1(JJ)=IHLOG(JJ)
6       CONTINUE





        CALL YAXANG(0.)
        CALL HEIGHT(0.3)
        CALL TITLE('NUMBER OF LOGINS DURING EACH HOUR$',100,
     -1H ,1,
     -'PERCENTAGE$',100,
     -17.,12.)
        CALL XAXEND('NOENDS')
        CALL XINTAX
        CALL GRAF(0.,1.,25.,0.,1.,15.)
        CALL BASALF('L/CSTD')
        CALL MIXALF('STANDARD')
        CALL RLMESS('DAY : $',100,11.,15.)
        IF (IXDP.GE.8) GOTO 8
        CALL RLINT(DAY,'ABUT','ABUT')
        GOTO 9

8       CALL RLMESS('AVERAGE$',100,'ABUT','ABUT')
        CALL MESSAG('PERIOD OF $',100,4.,11.5)
        CALL INTNO(IXDP-DAY,'ABUT','ABUT')
        CALL MESSAG(' DAYS STARTING ON $',100,'ABUT','ABUT')
        CALL INTNO(DAY,'ABUT','ABUT')
9       CALL RESET('BASALF')
        CALL RESET('MIXALF')



        CALL ANGLE(90.)
        CALL RESET('HEIGHT')
        CALL HEIGHT(0.2)

        CALL BARSHD(XARAY,Y1ARAY,Y2ARAY,24,0.25,45.,0.1,1,IWORK,600)
        DO 10 I=1,24
        II=I
        CALL RLINT(IVAL1(II),II,Y2ARAY(II)+0.5)
10      CONTINUE
        TIHLOG=0

        RETURN
        END
C
C       THIS SUBROUTINE PLOTS THE AVERAGE HOLD TIME BY USER TYPE
C
        SUBROUTINE PLOT7(DAY,ISESS,IMIN,IXDP)

        INTEGER IXDP,ISESS(100),IMIN(100),DAY,TOTS,TOTM
     -,TSESS,TMIN
        REAL Y1ARAY(6),Y2ARAY(6)
        DIMENSION IWORK(600),XARAY(6)
        DOUBLE PRECISION LXARAY(6)
        
        DATA XARAY /1.,2.,3.,4.,5.,6./
        DATA Y1ARAY /0.,0.,0.,0.,0.,0./

        Y2ARAY(1)=0
        Y2ARAY(6)=0

        LXARAY(1)='          '
        LXARAY(2)='110-300BPS'
        LXARAY(3)='1200-9600 '
        LXARAY(4)='BATCH     '
        LXARAY(5)='NETWORK   '
        LXARAY(6)='          '

        DO 5 I=1,100
        TSESS=TSESS+ISESS(I)
        TMIN=TMIN+IMIN(I)
5       CONTINUE

C
C       300 BAUD  (NETWORK ID - 1,...,10,33-36,42)
C

        DO 6 I=2,11
        TOTS=TOTS+ISESS(I)
        TOTM=TOTM+IMIN(I)
6       CONTINUE
        TOTS=TOTS+ISESS(34)+ISESS(35)+ISESS(36)+ISESS(37)+ISESS(43)
        TOTM=TOTM+IMIN(34)+IMIN(35)+IMIN(36)+IMIN(37)+IMIN(43)
        Y2ARAY(2)=TOTM/FLOAT(TOTS)
C
C       1200 BAUD-9600 BAUD  (NETWORK ID - 12,16,17,19,20,44,48,51,52)
C

        TOTS=ISESS(13)+ISESS(17)+ISESS(18)+ISESS(20)+ISESS(21)+
     -       ISESS(45)+ISESS(49)+ISESS(52)+ISESS(53)
        TOTM=IMIN(13)+IMIN(17)+IMIN(18)+IMIN(20)+IMIN(21)+
     -       IMIN(45)+IMIN(49)+IMIN(52)+IMIN(53)
        Y2ARAY(3)=TOTM/FLOAT(TOTS)

C
C      BATCH  (NETWORK ID - 0,11,13,14,15,18,21,22,23,32,43,46,47,50,53)
C

        TOTS=ISESS(1)+ISESS(12)+ISESS(14)+ISESS(15)+
     -       ISESS(16)+ISESS(19)+ISESS(22)+ISESS(23)+ISESS(24)+
     -       ISESS(33)+ISESS(44)+ISESS(47)+ISESS(48)+ISESS(51)+ISESS(54)
        TOTM=IMIN(1)+IMIN(12)+IMIN(14)+IMIN(15)+
     -       IMIN(16)+IMIN(19)+IMIN(22)+IMIN(23)+IMIN(24)+
     -       IMIN(33)+IMIN(44)+IMIN(47)+IMIN(48)+IMIN(51)+IMIN(54)
        Y2ARAY(4)=TOTM/FLOAT(TOTS)
	
C
C       NETWORK
C
        Y2ARAY(5)=TMIN/FLOAT(TSESS)


        CALL YAXANG(0.)
        CALL HEIGHT(0.3)
        CALL TITLE('AVERAGE HOLD TIME BY USER TYPE$',100,
     -1H ,1,
     -'MINUTES$',100,
     -17.,12.)
        CALL XAXEND('NOENDS')
        CALL YAXEND('NOFIRST')
        CALL YINTAX
	CALL YTICKS(5)
        CALL XLABGR(LXARAY,2,6,0.,10.,60.)
        CALL BASALF('L/CSTD')
        CALL MIXALF('STANDARD')
        CALL RLMESS('DAY : $',100,3.,60.)
        IF (IXDP.GE.8) GOTO 20
        CALL RLINT(DAY,'ABUT','ABUT')
        GOTO 25

20      CALL RLMESS('AVERAGE$',100,'ABUT','ABUT')
        CALL MESSAG('PERIOD OF $',100,4.,11.5)
        CALL INTNO(IXDP-DAY,'ABUT','ABUT')
        CALL MESSAG(' DAYS STARTING ON $',100,'ABUT','ABUT')
        CALL INTNO(DAY,'ABUT','ABUT')
25      CALL BARSHD(XARAY,Y1ARAY,Y2ARAY,6,0.76,45.,0.1,1,IWORK,600)
30      CONTINUE

        TSESS=0
        TMIN=0
        TOTS=0
        TOTM=0

        RETURN
        END
C
C       THIS SUBROUTINE PLOTS THE CHARS PER SECOND DISTRIBUTION
C
        SUBROUTINE PLOT8(DAY,IMIN,IINP,IOUTP,IXDP)

        INTEGER IXDP,IMIN(100),IINP(100),IOUTP(100)
     -,TCHAR,TMIN,TIN,TOUT,DAY,TOTC,TOTM,TOI,TOTO
        REAL Y1ARAY(6),Y2ARAY(6),Y3ARAY(6),Y4ARAY(6)
        DIMENSION IWORK(600),XARAY(6),IPKRAY(300)
        DOUBLE PRECISION LXARAY(6)
        
        DATA XARAY /1.,2.,3.,4.,5.,6./
        DATA Y1ARAY /0.,0.,0.,0.,0.,0./

        Y2ARAY(1)=0
        Y3ARAY(1)=0
        Y4ARAY(1)=0
        Y2ARAY(6)=0
        Y3ARAY(6)=0
        Y4ARAY(6)=0

        LXARAY(1)='          '
        LXARAY(2)='110-300BPS'
        LXARAY(3)='1200-9600 '
        LXARAY(4)='BATCH     '
        LXARAY(5)='NETWORK   '
        LXARAY(6)='          '

        DO 5 I=1,100
        TMIN=TMIN+IMIN(I)
        TIN=TIN+IINP(I)
        TOUT=TOUT+IOUTP(I)
        TCHAR=TCHAR+IINP(I)+IOUTP(I)
5       CONTINUE

C
C       300 BAUDS  (NETWORK ID - 1,...,10,33-36,42)
C

        DO 6 I=2,11
        TOTM=TOTM+IMIN(I)
        TOTI=TOTI+IINP(I)
        TOTO=TOTO+IOUTP(I)
        TOTC=TOTC+IINP(I)+IOUTP(I)
6       CONTINUE
        TOTM=TOTM+IMIN(34)+IMIN(35)+IMIN(36)+IMIN(37)+IMIN(43) 
        TOTI=TOTI+IINP(34)+IINP(35)+IINP(36)+IINP(37)+IINP(43) 
        TOTO=TOTO+IOUTP(34)+IOUTP(35)+IOUTP(36)+IOUTP(37)+IOUTP(43) 
        TOTC=TOTC+IINP(34)+IINP(35)+IINP(36)+IINP(37)+IINP(43)+
     -            IOUTP(34)+IOUTP(35)+IOUTP(36)+IOUTP(37)+IOUTP(43) 

        Y2ARAY(2)=TOTI/(FLOAT(TOTM)*60.)
        Y3ARAY(2)=TOTO/(FLOAT(TOTM)*60.)
        Y4ARAY(2)=TOTC/(FLOAT(TOTM)*60.)
C
C       1200 BAUD-9600 BAUD  (NETWORK ID - 12,16,17,19,20,44,48,51,52)
C

        TOTM=IMIN(13)+IMIN(17)+IMIN(18)+IMIN(20)+IMIN(21)+
     -       IMIN(45)+IMIN(49)+IMIN(52)+IMIN(53)
        TOTI=IINP(13)+IINP(17)+IINP(18)+IINP(20)+IINP(21)+
     -       IINP(45)+IINP(49)+IINP(52)+IINP(53)
        TOTO=IOUTP(13)+IOUTP(17)+IOUTP(18)+IOUTP(20)+IOUTP(21)+
     -       IOUTP(45)+IOUTP(49)+IOUTP(52)+IOUTP(53)
        TOTC=IINP(13)+IINP(17)+IINP(18)+IINP(20)+IINP(21)+
     -       IINP(45)+IINP(49)+IINP(52)+IINP(53)+
     -       IOUTP(13)+IOUTP(17)+IOUTP(18)+IOUTP(20)+IOUTP(21)+
     -       IOUTP(45)+IOUTP(49)+IOUTP(52)+IOUTP(53)
        Y2ARAY(3)=TOTI/(FLOAT(TOTM)*60.)
        Y3ARAY(3)=TOTO/(FLOAT(TOTM)*60.)
        Y4ARAY(3)=TOTC/(FLOAT(TOTM)*60.)

C
C      BATCH  (NETWORK ID - 0,11,13,14,15,18,21,22,23,32,43,46,47,50,53)
C

        TOTM=IMIN(1)+IMIN(12)+IMIN(14)+IMIN(15)+
     -       IMIN(16)+IMIN(19)+IMIN(22)+IMIN(23)+IMIN(24)+
     -       IMIN(33)+IMIN(44)+IMIN(47)+IMIN(48)+IMIN(51)+IMIN(54)
        TOTI=IINP(1)+IINP(12)+IINP(14)+IINP(15)+
     -       IINP(16)+IINP(19)+IINP(22)+IINP(23)+IINP(24)+
     -       IINP(33)+IINP(44)+IINP(47)+IINP(48)+IINP(51)+IINP(54)
        TOTO=IOUTP(1)+IOUTP(12)+IOUTP(14)+IOUTP(15)+
     -       IOUTP(16)+IOUTP(19)+IOUTP(22)+IOUTP(23)+IOUTP(24)+
     -       IOUTP(33)+IOUTP(44)+IOUTP(47)+IOUTP(48)+IOUTP(51)+IOUTP(54)
        TOTC=IINP(1)+IINP(12)+IINP(14)+IINP(15)+
     -       IINP(16)+IINP(19)+IINP(22)+IINP(23)+IINP(24)+
     -       IINP(33)+IINP(44)+IINP(47)+IINP(48)+IINP(51)+IINP(54)+
     -       IOUTP(1)+IOUTP(12)+IOUTP(14)+IOUTP(15)+
     -       IOUTP(16)+IOUTP(19)+IOUTP(22)+IOUTP(23)+IOUTP(24)+
     -       IOUTP(33)+IOUTP(44)+IOUTP(47)+IOUTP(48)+IOUTP(51)+IOUTP(54)
        Y2ARAY(4)=TOTI/(FLOAT(TOTM)*60.)
        Y3ARAY(4)=TOTO/(FLOAT(TOTM)*60.)
        Y4ARAY(4)=TOTC/(FLOAT(TOTM)*60.)


C
C       NETWORK
C
        Y2ARAY(5)=TIN/(FLOAT(TMIN)*60.)
        Y3ARAY(5)=TOUT/(FLOAT(TMIN)*60.)
        Y4ARAY(5)=TCHAR/(FLOAT(TMIN)*60.)




        CALL YAXANG(0.)
        CALL HEIGHT(0.3)
        CALL TITLE('CHARS PER SECOND BY USER TYPE$',100,
     -1H ,1,
     -'CPS$',100,
     -17.,12.)
        CALL XAXEND('NOENDS')
        CALL YAXEND('NOFIRST')
        CALL YINTAX
	CALL YTICKS(10)
        CALL XLABGR(LXARAY,2,6,0.,10.,50.)
        CALL BASALF('L/CSTD')
        CALL MIXALF('STANDARD')
        CALL RLMESS('DAY : $',100,3.,50.)
        IF (IXDP.GE.8) GOTO 10
        CALL RLINT(DAY,'ABUT','ABUT')
        GOTO 15

10      CALL RLMESS('AVERAGE$',100,'ABUT','ABUT')
        CALL MESSAG('PERIOD OF $',100,4.,11.5)
        CALL INTNO(IXDP-DAY,'ABUT','ABUT')
        CALL MESSAG(' DAYS STARTING ON $',100,'ABUT','ABUT')
        CALL INTNO(DAY,'ABUT','ABUT')
15      CALL RESET('BASALF')
        CALL RESET('MIXALF')


        CALL BARSHD(5.2,45.,48.,1,0.25,45.,0.1,1,IWORK,600)
        CALL RLMESS('INPUT CPS$',100,5.3,46.)
        CALL BARSHD(5.2,39.,42.,1,0.25,0.,30.,1,IWORK,600)
        CALL RLMESS('OUTPUT CPS$',100,5.3,40.)
        CALL BARSHD(5.2,33.,36.,1,0.25,0.,0.1,1,IWORK,600)
        CALL RLMESS('TOTAL CPS$',100,5.3,34.)

        CALL BSHIFT(-0.75,0.)
        CALL BARSHD(XARAY,Y1ARAY,Y2ARAY,6,0.75,45.,0.1,1,IWORK,600)
        CALL BSHIFT(0.,0.)
        CALL BARSHD(XARAY,Y1ARAY,Y3ARAY,6,0.75,0.,30.,1,IWORK,600)
        CALL BSHIFT(0.75,0.)
        CALL BARSHD(XARAY,Y1ARAY,Y4ARAY,6,0.75,0.,0.1,1,IWORK,600)
        MAXLIN=LINEST(IPKRAY,300,34)
        CALL LINES('*********************************$',
     -IPKRAY,1)
        CALL LINES('*        * CPS * CPS * OUT* CPS *$',
     -IPKRAY,2)
        CALL LINES('* SPEED  *  IN * OUT * /IN*TOTAL*$',
     -IPKRAY,3)
        CALL LINES('*********************************$',
     -IPKRAY,4)
        CALL LINES('*<=300BPS*     *     *1:  *     *$',
     -IPKRAY,5)
        CALL LINES('*1200-9600*    *     *1:  *     *$',
     -IPKRAY,6)
        CALL LINES('*  BATCH *     *     *1:  *     *$',
     -IPKRAY,7)
        CALL LINES('* NETWORK*     *     *1:  *     *$',
     -IPKRAY,8)
        CALL LINES('*********************************$',
     -IPKRAY,9)

        CALL LSTORY(IPKRAY,9,0.2,7.)
        DO 50 I=2,5
        CALL RLREAL(Y2ARAY(I),1,1.83,41.-(2.*I))
        CALL RLREAL(Y3ARAY(I),1,2.2,41.-(2.*I))
        KK=Y3ARAY(I)/Y2ARAY(I)
        CALL RLINT(KK,2.85,41.-(2.*I))
        CALL RLREAL(Y4ARAY(I),1,3.05,41.-(2.*I))
50      CONTINUE



        TMIN=0
        TIN=0
        TOUT=0
        TCHAR=0
        TOTM=0
        TOTI=0
        TOTO=0
        TOTC=0

        RETURN
        END
   ' _<)