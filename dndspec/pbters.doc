






                            PBT.ERS












                               _b_y

                    BISYNC INTERFACE SECTION

                           TYMNET MDC
                 Network Technology Development
                          July 22, 1988






















McDonnell Douglas Corporation's proprietary rights  are  included
in the information disclosed herein.  The recipient, by receiving
this  document,  agrees  that  neither  this  document  nor   the
information  disclosed herein, nor any part thereof shall be used
or disclosed to others for manufacturing or for any other purpose
except  as  specifically  authorized  in writing by the McDonnell
Douglas Corporation.
















                                   CONTENTS


         1.  PBT130...........................................    1
             1.1   DEFINITIONS OF SYNTAX AND FORMAT...........    2
             1.2   MACROS TO DEFINE PARAMETERS FOR LINE.......    2
                   1.2.1    HSTPRT - Originating Host
                            Number............................    2
                   1.2.2    LINTYP - Change Host Line
                            Type..............................    3
                   1.2.3    LINE   - Line Address.............    3
                   1.2.4    LNID   - Line Identification
                            Number............................    3
                   1.2.5    CUNIT  - Control Unit
                            Address...........................    4
                   1.2.6    CUID   - Control Unit
                            Identification Number.............    4
                   1.2.7    DEVICE - Device Address...........    4
             1.3   SIGNAL CONTROL FOR NON-PRIMATIVE LINE......    5
                   1.3.1    SWITCH - SWITCH/LEASE line........    5
                   1.3.2    HANG   - Hang Logic...............    6
                   1.3.3    RTSCTS - Request/Clear-To-Send
                            Handshake Signal..................    6
                   1.3.4    DTRDSR - DTR/DSR handshake
                            signals...........................    7
             1.4   DEFINED PARAMETERS FOR DEVICE..............    8
                   1.4.1    TYPE   - Device Type..............    9
                   1.4.2    COLOR  - Color Capability.........    9
                   1.4.3    XPRNT  - Transparency.............    9
                   1.4.4    PRTTXT - Printer Label In Network
                            Service Screen....................   10
                   1.4.5    MENU   - Logon Menu...............   11
                   1.4.6    PVC    - Permanent Virtual
                            Circuit...........................   11
                   1.4.7    DEVID  - Device Identification
                            Number............................   12
                   1.4.8    NETKEY - Network Services
                            Key...............................   12
                   1.4.9    KKORKJ - Change Character
                            Set...............................   13
                   1.4.10   ERRMSG - DEFINE THE ERROR MESSAGE
                            FOR THE DEVICE....................   13
                   1.4.11   LNGMSG - MACRO DEFINES LANGUAGE
                            TYPE FOR THE DEVICE...............   14
             1.5   LOGON ELEMENTS.............................   14
                   1.5.1    NETSCR - Network Logon
                            Screen............................   15
                            1.5.1.1   ELEUNA - Network
                                      Username................   15
                            1.5.1.2   ELEHST - Host
                                      Number..................   16



                                  - i -











                            1.5.1.3   ELEPWD - Password.......   16
                            1.5.1.4   ELENPC - Project
                                      Code....................   16
                   1.5.2    ASCDSP - DSP Screen In ASCII
                            Mode..............................   17
                            1.5.2.1   ELEAPC - Project
                                      Code....................   17
                   1.5.3    NATDSP - DSP Screen In Native
                            Mode..............................   17
                            1.5.3.1   ELEARS - Destination
                                      Interface Address.......   18
                            1.5.3.2   ELECRM - CRM
                                      Number..................   18
                            1.5.3.3   ELEAPP - Application
                                      Identification..........   19
                            1.5.3.4   ELECUA - Destination
                                      Control Unit
                                      Address.................   19
                            1.5.3.5   ELEDVA - Destination
                                      Device Address..........   20
                            1.5.3.6   ELEXPR - Request For
                                      Transparency............   20
                            1.5.3.7   ELECOL - Request For
                                      Color...................   20
                            1.5.3.8   ELECHR - Element for
                                      Character Set...........   21
                   1.5.4    LOGSTR - Logon String.............   21
                   1.5.5    LOGMEN - Logon Menu...............   22
             1.6   CHANGING DEFAULT LINE HOST TYPE FOR THE
                   SLOT.......................................   23
                   1.6.1    DEFLIN - Define Default Host Line
                            Type..............................   23
             1.7   CHANGING LINE DEFAULT PARAMETERS FOR
                   SLOT.......................................   23
                   1.7.1    DEFSWT - default SWITCH/LEASE
                            line..............................   23
                   1.7.2    DEFHAN - Default Hang Logic.......   24
                   1.7.3    DEFRTS - Default RTS/CTS
                            Handshake Signals.................   24
                   1.7.4    DEFDTR - default DTR/DSR
                            handshake signals.................   25
             1.8   CHANGING DEFAULT LANGUAGE PARAMETERS FOR
                   SLOT.......................................   26
                   1.8.1    DEFLNG - DEFAULT SCREEN LANGUAGE
                            TYPE FOR THE SLOT.................   26
                   1.8.2    DEFERR - DEFAULT ERROR MESSAGE
                            LANGUAGE FOR SLOT.................   26
             1.9   CHANGING DEFAULT DEVICE PARAMETERS FOR
                   SLOT.......................................   27
                   1.9.1    DEFTYP - Default Device Type......   27




                                  - ii -











                   1.9.2    DEFCOL - Default Color
                            Capability........................   27
                   1.9.3    DEFXPR - Default Transparency
                            Capability........................   28
                   1.9.4    DEFMEN - Default Logon Menu.......   28
                   1.9.5    DEFPVC - Default PVC
                            Capability........................   28
                   1.9.6    DEFNET - Default Network Services
                            Key...............................   29
                   1.9.7    DEFCHR - Define Default Character
                            Set...............................   29
             1.10  MACROS TO CHANGE TERMINAL INTERFACE
                   PARAMETERS.................................   30
                   1.10.1   HNGDTR - Interval To Hold DTR
                            Down..............................   30
                   1.10.2   MONDSR - time interval to monitor
                            the DSR signal....................   30
                   1.10.3   NLOGIN - Time Interval For No Log
                            In................................   31
                   1.10.4   TMIACT - Time Interval To Check
                            Line Inactivity...................   32
                   1.10.5   SLWPOL - Activate Slow Poll
                            Logic.............................   32
                   1.10.6   SPOLTM - Time Interval For Slow
                            Poll..............................   33
                   1.10.7   NOPOLL -Timeout Interval For No
                            Response To Polling...............   33
                   1.10.8   PRESTM - Timeout Limit For
                            Response To The Polling...........   34
                   1.10.9   SRESTM - Timeout Limit For
                            Response To The Select............   34
                   1.10.10  DRESTM - Timeout Limit For
                            Response To The Text..............   35
                   1.10.11  ARESTM - Timeout Limit For
                            Response To The ACK...............   35
                   1.10.12  PVCTME - PVC Timer................   36
                   1.10.13  PVCOPN - Permanent Virtual
                            Circuit...........................   36
                   1.10.14  DSPSRN - Display DSP Screen.......   37
                   1.10.15  TWOPFK - Two PF Keys..............   38
                   1.10.16  PFMEU  - PF Key To Logoff And
                            Obtain MENU.......................   38
                   1.10.17  PFMEU1 - PF Key To Logoff And
                            Logon First Menu..................   39
                   1.10.18  PFMEU2 - PF Key To Logoff And
                            Logon 2nd Menu....................   39
                   1.10.19  PLTSUP - Interval For Average
                            Polling Cycle Log.................   40
                   1.10.20  MINXMT - Minimum Threshold To
                            Release For Transmit..............   40




                                 - iii -











                   1.10.21  MAXXMT - Maximum Threshold To
                            Release For Transmit..............   40
             1.11  DEFINE TERMINAL INTERFACE DEBUGGING
                   PARAMETERS.................................   41
                   1.11.1   NETCON - Network Console..........   41
                   1.11.2   STPCRSH - Halt After Crash........   43
                   1.11.3   IRINGSZ - IRING Size..............   43
                   1.11.4   ORINGSZ - RING Size...............   43
                   1.11.5   BUFLET  - Bufferlet Number........   43
                   1.11.6   CMDLNK  - Number Of Command
                            Link..............................   44
                   1.11.7   PTRACE  - Protocol Trace..........   44
                   1.11.8   RETCODE - Record Of Return
                            Codes.............................   45
                   1.11.9   RTRACE  - Receive Trace...........   45
                   1.11.10  PRTCON  - Print Tymfile
                            Configuration.....................   46
                   1.11.11  GENNIB -- Generate The NIB
                            File..............................   47
             1.12  MARCO'S TO ALLOW BOM TO CHANGE
                   CONFIGURATION VALUES.......................   47
                   1.12.1   MOTYM - DYNAMIC MODIFICATION
                            COMMANDS ALLOWED..................   48
                   1.12.2   STNU - DEFINE STORAGE FOR HISTORY
                            OF MODIFICATIONS..................   48
                   1.12.3   BOMPW - DEFINE PASSWORD TO ACCESS
                            SUB-MENU IN BOM...................   48
             1.13  WSF SUPPORT ...............................   49
             1.14  Structured-Field Format....................   49
                   1.14.1   Outbound Structured Fields........   50
                   1.14.2   Inbound Structured Fields.........   50
                   1.14.3   Write Structured Field Command
                            Support...........................   51
                   1.14.4   PBT Supports WSF Commands.........   51
                            1.14.4.1  PBT Does Not Support
                                      WSF Commands............   51
                   1.14.5   System Generation WSF.............   52
                            1.14.5.1  RPLTXT - Define
                                      Contents of Query Reply
                                      Response................   52
                            1.14.5.2  DEFRPL - Define Default
                                      Query Reply
                                      Response................   53
                            1.14.5.3  RPLSEQ - Associate
                                      Query Reply Resp with
                                      Device..................   53
                   1.14.6   PBT Canned Response to WSF
                            Command...........................   54

         2.  TBOM13...........................................   55
             2.1   General Functions..........................   56



                                  - iv -











                   2.1.1    Menu COMMAND......................   56
                   2.1.2    EXIT COMMAND......................   57
                   2.1.3    QUIT COMMAND......................   57
                   2.1.4    CODE COMMAND......................   58
                   2.1.5    STATUS COMMAND....................   60
                   2.1.6    ACCESS TO VIEW RING COMMAND.......   61
                   2.1.7    CRASH COMMAND.....................   62
             2.2   LINE CONTROL/STATUS FUNCTIONS..............   64
                   2.2.1    MODE COMMAND......................   64
                   2.2.2    QUERY LINE COMMAND................   65
                   2.2.3    QUERY CONTROL UNIT COMMAND........   66
                   2.2.4    QUERY DEVICE COMMAND..............   68
                   2.2.5    QUERY ONLINE DEVICES COMMAND......   70
                   2.2.6    RESET CONTROL UNIT ERROR COUNTS
                            COMMAND...........................   70
                   2.2.7    RESTART ERRORS COMMAND............   70
                   2.2.8    DISPLAY ERRORS COMMAND............   71
                   2.2.9    DISPLAY CONTROL UNITS NOT POLLED
                            COMMAND...........................   72
                   2.2.10   DISPLAY CONTROL UNITS NOT
                            RESPONDING COMMAND................   73
                   2.2.11   POLL CONTROL UNITS COMMAND........   73
                   2.2.12   DO NOT POLL CONTROL UNITS
                            COMMAND...........................   74
                   2.2.13   KILL CIRCUITS COMMAND.............   74
                   2.2.14   BUILD PVC CIRCUITS COMMAND........   75
                   2.2.15   START DEVICE OPERATION
                            COMMAND...........................   75
                   2.2.16   STOP DEVICE OPERATION
                            COMMAND...........................   76
                   2.2.17   QUERY/CHANGE INTERVAL OF REAL
                            TIME DISPLAY COMMAND..............   76
             2.3   NEGATIVE ACKNOWLEDGEMENT HANDLING..........   77
             2.4   SLOT CONFIGURATION.........................   78
                   2.4.1    DISPLAY LINE/SLOT CONFIGURATION
                            COMMAND...........................   78
                   2.4.2    QUERY/CHANGE REPORT TO
                            SUPERVISOR'S LOG..................   80
             2.5   QUEUE PROCESSOR............................   80
                   2.5.1    INPUT QUEUE.......................   81
                            2.5.1.1   Stop IN Q Process
                                      Command.................   81
                            2.5.1.2   Query Data on IN Q
                                      Command.................   81
                            2.5.1.3   Start IN Q Process
                                      Command.................   82
                   2.5.2    TRANSMIT QUEUE....................   83
                            2.5.2.1   Stop XMT Q Process
                                      Command.................   83
                            2.5.2.2   Query Data on XMT Q
                                      Command.................   83



                                  - v -











                            2.5.2.3   Start XMT Q Process
                                      Command.................   84
                   2.5.3    RECEIVE QUEUE.....................   85
                            2.5.3.1   Stop RCV Q Process
                                      Command.................   85
                            2.5.3.2   Query Data On RCV Q
                                      Command.................   85
                            2.5.3.3   Start RCV Q Process
                                      Command.................   86
                   2.5.4    OUTPUT QUEUE......................   86
                            2.5.4.1   Stop Output Q Process
                                      Command.................   86
                            2.5.4.2   Query Data on OUT Q
                                      Command.................   86
                            2.5.4.3   Start OUT Q Process
                                      Command.................   86
             2.6   SYSTEM GENERATIONS....................   87
                   2.6.1    DEFINE RETRY LIMIT FOR LINE
                            MACRO.............................   87
                   2.6.2    CHANGE RETRY LIMIT FOR LINE
                            MACRO.............................   87
                   2.6.3    DEFINE REAL TIME DISPLAY INTERVAL
                            MACRO.............................   87
                   2.6.4    DEFINE DSP ERROR REPORT TO HPAD
                            MACRO.............................   87
             2.7   TRACE FUNCTIONS............................   88
                   2.7.1    ENABLE CHARACTER PER SECOND TRACE
                            COMMAND...........................   88
                   2.7.2    DISPLAY CHARACTER PER SECOND
                            TRACE COMMAND.....................   89
                   2.7.3    ENABLE POLL RESPONSE TRACE
                            COMMAND...........................   89
                   2.7.4    DISPLAY POLL RESPONSE TRACE
                            COMMAND...........................   91
                   2.7.5    ENABLE TINE STAMP TRACE
                            COMMAND...........................   91
                   2.7.6    DISPLAY TIME STAMP COMMAND........   92
                   2.7.7    ENABLE RESPONSE TRACE
                            COMMAND...........................   93
                   2.7.8    DISPLAY RESPONSE TRACE
                            COMMAND...........................   94
                   2.7.9    ENABLE PROTOCOL TRACE
                            COMMAND...........................   95
                   2.7.10   DISPLAY PROTOCOL TRACE
                            COMMAND...........................   96
             2.8   ENABLE DATA TRACE COMMAND..................   97
                   2.8.1    DISPLAY DATA TRACE COMMAND........   97
                   2.8.2    DISABLE TRACE COMMAND.............   98
             2.9   RING TRACE COMMANDS........................   98
                   2.9.1    TRACE IRING COMMAND...............  101
                   2.9.2    TRACE ORING COMMAND...............  101



                                  - vi -











                   2.9.3    TRACE IRING AND ORING
                            COMMAND...........................  101
                   2.9.4    TRACE IRING AND ORING BY RPORT
                            COMMAND...........................  101
                   2.9.5    MODIFY TYMFILE PARAMETERS ON
                            LINE..............................  101
                            2.9.5.1   Modify Control Unit
                                      Address.................  102
                            2.9.5.2   Modify Device
                                      Address.................  102
                            2.9.5.3   Modify an Existing
                                      Logon String............  103
                            2.9.5.4   Modify an Existing
                                      Logon String Label......  103
                   2.9.6    INTRODUCTION INTO BERT'S
                            FUNCTIONS.........................  104
                            2.9.6.1   Support
                                      Considertions...........  105
                                      2.9.6.1.1   Test
                                                  Facilities..  105
                                      2.9.6.1.2   Test
                                                  Enviroment..  106
                                      2.9.6.1.3   Test
                                                  Patterns....  106
                                      2.9.6.1.4   Testing
                                                  Procedures..  107
                            2.9.6.2   Bisync Operations
                                      Monitor Commands........  107
                                      2.9.6.2.1   Query
                                                  Available
                                                  BERT
                                                  Commands....  107
                                      2.9.6.2.2   Select Sync
                                                  Line for
                                                  BERT........  107
                                      2.9.6.2.3   Select BERT
                                                  Test
                                                  Pattern.....  108
                                      2.9.6.2.4   Turn On
                                                  Data
                                                  Terminal
                                                  Ready.......  108
                                      2.9.6.2.5   Query State
                                                  of Data Set
                                                  Ready.......  109
                                      2.9.6.2.6   Turn Off
                                                  Data
                                                  Terminal
                                                  Ready.......  109





                                 - vii -











                                      2.9.6.2.7   Turn On
                                                  Request To
                                                  Send........  109
                                      2.9.6.2.8   Query State
                                                  of Clear To
                                                  Send........  109
                                      2.9.6.2.9   Turn Off
                                                  Request To
                                                  Send........  110
                                      2.9.6.2.10  Start
                                                  Executing
                                                  BERT........  110
                                      2.9.6.2.11  Stop
                                                  Executing
                                                  BERT........  110
                                      2.9.6.2.12  BERT      -
                                                  Show
                                                  Results of
                                                  BERT........  111
                                      2.9.6.2.13  Broadcast
                                                  or Send
                                                  Message to
                                                  Terminals...  112
                                      2.9.6.2.14  Reset BERT
                                                  Test
                                                  Results.....  112
                                      2.9.6.2.15  Query/Change
                                                  Output Mode
                                                  For
                                                  BERT........  113
                                      2.9.6.2.16  Query
                                                  Online
                                                  Devices.....  113
                            2.9.6.3   Execution Examples......  113

         3.  3270 REFERENCE MANUAL FOR PBT....................  118
             3.1   IBM ENVIRONMENT............................  118
                   3.1.1    IBM FAMILY........................  118
                   3.1.2    INFORMATON SYSTEMS................  118
                   3.1.3    3270 DEVICES......................  119
             3.2   3270 LINE DISCIPLINE.......................  122
                   3.2.1    GENERAL BSC BLOCK FORMAT..........  122
                   3.2.2    CATAGORIES OF COMMANDS............  123
                   3.2.3    POLL COMMAND 1....................  124
                   3.2.4    POLL COMMAND 2....................  125
                   3.2.5    SELECTION ADDRESSING COMMAND......  125
                   3.2.6    3270 OPERATIONS...................  126
             3.3   3270 TYMNET NETWORK SUPPORT................  134
                   3.3.1    HARDWARE LEVEL....................  134
                   3.3.2    NETWORK FACILITIES................  135
                   3.3.3    FEATURES..........................  138



                                 - viii -











             3.4   LOGON - LOGOUT PROCEDURES..................  143
                   3.4.1    GENERALITIES......................  143
             3.5   DIFFERENT CASES............................  148
             3.6   INTERFACES GENERATION......................  149
                   3.6.1    GENERATION LAYOUT.................  150
                   3.6.2    COMMAND FILES.....................  151
                   3.6.3    LAB...............................  152
             3.7   INTERNAL STRUCTURE.........................  153
                   3.7.1    LIBRARIES.........................  153
                   3.7.2    MODULES...........................  154
                   3.7.3    PROCESSES.........................  154
                   3.7.4    SEGMENTATION......................  156
             3.8   INTERFACES MONITORING and DEBUGGING........  157
                   3.8.1    GENERAL DDT COMMANDS..............  157
                   3.8.2    DATASCOPE TRACES..................  159
                   3.8.3    CRASH TABLES......................  159
                   3.8.4    BUFFER TRACES.....................  160
                   3.8.5    TROUBLESHOOTING...................  160
             3.9   CONFIGURATION..............................  161
                   3.9.1    FIGURES...........................  161
                   3.9.2    CONSTRAINTS.......................  162
             3.10  SCHEDULES..................................  163
             3.11  GLOSSARY...................................  164

         4.  DIAL-UP..........................................  166
             4.1   Overall diagram of dial-up system..........  166
             4.2   Control signals and status messages in
                   dial-up system.............................  167
                   4.2.1    Control signals...................  167
                   4.2.2    Status messages...................  167
             4.3   3270 Terminal Interface dial-up
                   support....................................  168
                   4.3.1    Requirements......................  168
                   4.3.2    Synchronous I/O Interface
                            Board.............................  170
                   4.3.3    The macros related to dial-
                            up................................  171
                   4.3.4    Generate the system...............  171
                   4.3.5    Bisync Operations Monitor
                            command...........................  172

         5.  BIT ERROR RATE TESTING...........................  173
             5.1   Support Considertions......................  173
                   5.1.1    Test Facilities...................  174
                   5.1.2    Test Enviroment...................  174
                   5.1.3    Test Patterns.....................  175
                            5.1.3.1   2047 Pattern............  175
                            5.1.3.2   Alternating
                                      Pattern.................  176
                   5.1.4    User Supplied Pattern.............  176
             5.2   Testing Procedures.........................  176



                                  - ix -











             5.3   Bisync Operations Monitor Commands.........  176
             5.4   Execution Examples.........................  177

         6.  WRITE STRUCTURED FIELD SUPPORT...................  181
             6.1   Structured-Field Format....................  181
             6.2   Outbound Structured Fields.................  182
             6.3   Inbound Structured Fields..................  182
             6.4   Write Structured Field Command
                   Support....................................  183
                   6.4.1    PBT Supports WSF Commands.........  183
                   6.4.2    PBT Does Not Support WSF
                            Commands..........................  183
             6.5   System Generation..........................  184
                   6.5.1    RPLTXT - Define Contents of Query
                            Reply Response....................  185
                   6.5.2    DEFRPL - Define Default Query
                            Reply Response....................  185
                   6.5.3    RPLSEQ - Associate Query Reply
                            Response with Device..............  185
             6.6   Bisync Operation Monitor - CONF
                   Command....................................  185
             6.7   PBT Canned Response to WSF Command.........  185

         7.  ENHANCEMENTS OF PIR #1894........................  187
             7.1   ENHANCEMENTS FOR MONITORING LINE
                   STATUS.....................................  187
             7.2   ENHANCEMENTS TO  START/STOP DEVICE.........  188
             7.3   ENHANCEMENTS FOR NODE/TIME DISPLAY.........  188
             7.4   ENHANCEMENTS FOR NAK HANDLING..............  188
             7.5   ENHANCEMENTS FOR SLOT CONFIGURATION
                   DISPLAY....................................  190
             7.6   MISCELLANEOUS ENHANCEMENTS.................  190
             7.7   QUEUE PROCESSOR............................  190
                   7.7.1    Input Queue.......................  191
                   7.7.2    Transmit Queue....................  191
                   7.7.3    RCV Queue.........................  191
                   7.7.4    OUT Queue.........................  192
                   7.7.5    SYSTEM GENERATIONS................  192
                   7.7.6    DEFRTY - Define Retry Limit for
                            Line..............................  192
                   7.7.7    BRETRY - Change Retry Limit for
                            Line..............................  192
                   7.7.8    DSPTIM - Define Real Time Display
                            Interval..........................  192
                   7.7.9    DSPERR - Define DSP Error Report
                            to HPAD...........................  192

         8.  TYMFILE..........................................  193
             8.1   3270 TERMINAL INTERFACE MESSAGES...........  193
             8.2   CURRENT ENGLISH VERSION OF DISPLAYED
                   MESSAGES...................................  193



                                  - x -











                   8.2.1    LOGON SCREEN......................  193
                   8.2.2    NETWORK SERVICE SCREEN............  194
                   8.2.3    DISPLAY SYSTEM PROTOCOL...........  194
                   8.2.4    ERROR MESSAGES GENERATED INTERNAL
                            TO SLOT...........................  195
             8.3   3270 HOST INTERFACE MESSAGES...............  196
             8.4   MESSAGES WHICH WILL BE LANGUAGE SELECTED
                   ARE........................................  196
             8.5   CURRENT ENGLISH VERSION OF DISPLAYED
                   MESSAGES...................................  196
                   8.5.1    HOST GENERATED HOST ERROR OR
                            INFORMATION MESSAGES..............  197
                   8.5.2    MESSAGES BETWEEN HOST AND HOST
                            INTERFACE.........................  197

         9.  Allow modification of addresses in NIB file......  199
             9.1   Tymfile modification.......................  199
                   9.1.1    New commands......................  199


                                APPENDICES



         I.  SAMPLE 3270 TERMINAL INTERFACE TYMFILE...........  202

        II.  BISYNC RCV RECEIVE CODES.........................  207

       III.  BISYNC XMIT RETURN CODES.........................  208

























                                  - xi -











                          1.  PBT130

When the terminal  interface PBT version 13  is   generated,  its
configuration must be  specified.  This requires  the identifying
numbers of BSC lines, control units, terminals, and printers.

       1. The  address  for  each  BSC line  and  the  control  unit
          addresses associated with each line must be specified.

       2. All devices  for each control  unit must be  defined.  The
          device address, type, buffer size, and assigned login menu
          must be given.


Control Unit and device addresses are in the EBCDIC poll  format.
If  the  configuration is changed, the terminal interface must be
regenerated with revised configuration information.  The detailed
configuration  of  the   terminal  interface  is specified in the
Tymfile.



































Page 1                PBTERS.DOC







PBT130                                         July 22, 1988



1.1  DEFINITIONS OF SYNTAX AND FORMAT

The following statements specify parameters for the  TYMNET  3270
Terminal  Interface  Tymfile:  macro,  ranging macro, equate, and
message text.

The following represent macro characteristics:

    o  A macro body cannot exceed 7665 characters.

    o  All macros may begin in column  one; indentation is recom-
       mended for clarity. More than one macro can be put
       on one line and separated by a semicolon.

    o  Macros to define line, control unit and device parameters can
       be omitted; a default value is assigned at this moment.

    o  Open parenthesis "(" immediately follows a name.

    o  Closed parenthesis ")" must follow  the last value without
       spaces.

    o  All characters for a message text must be specified.

    o  A colon (:)  on a line indicates a  comment (this comment,
       which is not read by the assembler, is optional).
       Semicolon (;) terminates the comment.

    o  Spaces within the parentheses are  not entered unless part
       of the value (as in message text).


1.2  MACROS TO DEFINE PARAMETERS FOR LINE

This section describes macros required to define  the  parameters
necessary for the generation of the Terminal Interface slot.

1.2.1  HSTPRT - Originating Host Number

Syntax : HSTPRT(host#)

Description :

This macro specifies the host number, in decimal, associated with
the  terminal  interface  for  accounting purpose.  Also, this is
used as host number for the slot which will come up as SHUT.

Example : HSTPRT(500)

The originating host number for this terminal interface is 500.




Page 2                PBTERS.DOC







PBT130                                         July 22, 1988



1.2.2  LINTYP - Change Host Line Type

Syntax : LINTYP(IBM/FUJITSU/HITACHI)

Default : Defined by the previous DEFLIN macro.

Description :

This macro defines the  line  type  indicated  in  the  arguement
field.   This macro must be used before configuration of the line
starts.

This macro can be used to configure the line type to be  any  one
of  the  above vendors to allow for multi-protocol support in the
slot.  This macro does not,  however,  change  the  default  line
type. This can be done only by using the macro DEFLIN(line-type).

Example: LINTYP(FUJITSU)
         The current line host type is FUJITSU.

1.2.3  LINE   - Line Address

Syntax : LINE(addr)

Default : Automatically assigned  by  the  code  for  IBM/FUJITSU
lines.

Description :

This macro specifies the current line address and  indicates  the
start  of  a  line  configuration.  This  address  is arbitrarily
assigned, but must be unique. The addresses are defined according
to  the  relative  number  of   the line being configured for the
entire  slot, and not the relative  number for the host type.

Example : LINE(40)

The address of current line is 40.


1.2.4  LNID   - Line Identification Number

Syntax : LNID(line id)

Default : Relative line number.

Description :

This macro defines the line identification number for the current
line.   The  line  ID  is  used  in TBOM to identify the line for
monitoring purpose while in USR mode.



Page 3                PBTERS.DOC







PBT130                                         July 22, 1988



Example : LNID(60)

The line identification number for the current line is 60.

1.2.5  CUNIT  - Control Unit Address

Syntax : CUNIT(addr)

Default : Automatically assigned by the code for IBM/FUJITSU.

Description :

This macro specifies the address of the  control  unit  which  is
attached to the line specified in the preceding LINE macro.

The  addresses   for   IBM   and   Fujitsu   are   the   specific
polling addresses, ie. 40, 0C1, 0C2 etc.

There is  only one set  of addresses for  each  control  unit  in
Hitachi format, which starts from 0C0, 0C1, etc.

Example : CUNIT(0C1)

The address of the current control unit is 0C1.

1.2.6  CUID   - Control Unit Identification Number

Syntax : CUID(CU ID Number)

Default : Control unit id assigned by program.

Description :

This macro defines the  identification  number  for  the  current
control  unit.  Like  the  line  ID,   CUID is used to specify an
user-defined ID for use in TBOM.

Example : CUID(20)

The identification number for the current control unit is 20.

1.2.7  DEVICE - Device Address

Syntax : DEVICE(addr)

Default : Automatically assigned by the code for IBM/FUJITSU.

Description :

This macro specifies the address of a device which is attached to
the  control  unit  specified  in  the  preceding CUADR macro and



Page 4                PBTERS.DOC







PBT130                                         July 22, 1988



indicates the start of a device configuration.

The  device addresses  for IBM  and Fujitsu  are  the   same   as
the general polling addresses for the control unit.

The   device   addresses   for   Hitahci   are   the     specific
polling addresses which start from 0A0, 0A1, etc.

Example : DEVICE(40)

The address of the current line is 40.

1.3  SIGNAL CONTROL FOR NON-PRIMATIVE LINE


There are  FOUR   macros  HANG, RTSCTS, SWITCH, AND  DTRDSR  used
to defined the parameters for the current line. These control the
line control signals rts,cts,dtr,and dsr. Use of these macro's is
limited  to  lines  which  support  those  signals. The lines are
2,3,6,7,10,11,14,and 15 for the micro engine.

1.3.1  SWITCH - SWITCH/LEASE line


Syntax: SWITCH(arg)

where arg = YES or NO.

Default: If this line is omitted, the default value is defined by
the DEFSWT macro.

Description:

This macro specifies whether the current line is a  dial-up  line
or  leased line. If the line is specified as a switched line, the
macros RTSCTS(YES) and HANG(YES) must be invoked to  specify  the
requirements of RTS/CTS handshake signals and hang logic for this
line.  If the current line  is  a  full-duplex  dial-up  switched
line,  the  macro  DTRDSR(YES)   must  be  invoked to specify the
requirements of the DTR/DSR handshake signals for this line.  The
value of the arguments are the following:

YES = the current line is a dial-up switched line.

NO  = the current line is leased line.

Example: SWITCH(YES)

The current line is a dial-up switched line.





Page 5                PBTERS.DOC







PBT130                                         July 22, 1988



1.3.2  HANG   - Hang Logic


Syntax: HANG(arg)

where arg = YES or NO.

Default:

If this macro is omitted, the default value  is  defined  by  the
previous DEFHAN.

Description:

This macro specifies whether the hang logic is  applied  to  this
line.   For the half duplex lines using modem, if a user hangs up
the telephone, the engine is  not  aware  of  the  disconnection;
therefore,  the  line  appears  busy  to other user's dialing-in.
Hang logic is a feature to tell whether the  line  is  connected.
With  this  feature  enabled, a timer checks for line inactivity,
and clears the line by lowering the DTR  signal  for  a  specific
time.   With  this feature disabled, the engine will not be aware
of the disconnection and the  line  will  appear  busy  to  other
users.   The  hang  logic  can also be applied to the full-duplex
lines using a modem in order to detect the line inactivity.

Example: HANG(YES)

The hang logic is applied to the current line.

1.3.3  RTSCTS - Request/Clear-To-Send Handshake Signal


Syntax: RTSCTS(arg)

where arg = YES or NO.

Default: If this macro is omitted, the default value  is  defined
by the DEFRTS macro.

Description:

This  macro  specifies  whether  RTS/CTS  handshake  signals  are
required  for the current line. This macro can be used for leased
line or  dial-up  lines.  If  "YES"  is  specified,  the  RTS/CTS
handshaking   will   be   performed  whenever  a  data  block  is
transmitted to the external system.  For a line supporting  dial-
up, the RTS/CTS handshake signals are definitely required. Please
refer  to  RS-232-C  document  for  descriptions  of  these   two
electrical   signals.    The  values  of  the  argument  are  the
following:



Page 6                PBTERS.DOC







PBT130                                         July 22, 1988



YES = RTS/CTS is required.

NO  = RTS/CTS is not required.

Example: RTSCTS(YES)

The current line requires the RTS/CTS handshake signals.


1.3.4  DTRDSR - DTR/DSR handshake signals


Syntax: DTRDSR(arg)

arg = YES or NO.

Default: If the macro is omitted, the default value is defined by
the previous DEFDTR macro.

Description:

This macro  specifies  whether  a  DTR/DSR  handshake  signal  is
required  for  the  current  line.  This  macro can be used for a
leased line or a dial-up line. If "YES" is specified, the DTR/DSR
handshaking  will be performed by the 3270 Terminal Interface and
the external system to inform each  other  whether  the  line  is
really  connected  or  not.   Also,  if the line is a full-duplex
line, the 3270 Terminal Interface  periodically  checks  the  DSR
signal  to  see whether the line is disconnected.  To support the
full-duplex switched line,  the  DTR/DSR  handshake  signals  are
definitely required.  Please refer to EIA RS-232-C document for a
description of these two electrical signals.

The values of the argument are the following:

YES = DTR/DSR is required.

NO  = DTR/DSR is not required.

Example: DTRDSR(YES)

The current line requires the DTR/DSR handshake  signal  and  the
DTR/DSR  handshaking  is performed by the 3270 Terminal Interface
and the external system.










Page 7                PBTERS.DOC







PBT130                                         July 22, 1988



1.4  DEFINED PARAMETERS FOR DEVICE

There are TEN macros (TYPE,  COLOR,  XPRNT,  PRTTXT,  MENU,  PVC,
NETKEY, KKORKJ, LNGMSG, AND ERRMSG) used to define the parameters
for the current device.

















































Page 8                PBTERS.DOC







PBT130                                         July 22, 1988



1.4.1  TYPE   - Device Type

Syntax : TYPE(C####/P####)

Default : Defined by the previous DEFTYP macro.

Description :

This macro specifies the device type  and  screen  size  of  each
device associated with the control unit and line.

The values of the argument are the following:

        C#### = CRT, where #### indicates the screen size
                in characters per screen, it can be the value
                480, 960, 1920, 2560, 3400, or 3564.

        P#### = Printer, where #### indicates the screen size
                in characters per screen, it can be the value
                480, 690, 1920, 2560, 3400, or 3564.


Example : TYPE(C960)

The device is a CRT with 960 characters per screen.

1.4.2  COLOR  - Color Capability

Syntax : COLOR(YES/NO)

Default : Defined by the previous DEFCOL macro.

Description :

This macro specifies whether a device can handle color.

The argument values are the following:

        YES = can handle color.
        NO  = can not handle color.

Example : COLOR(YES)

Device is capable of color display.

1.4.3  XPRNT  - Transparency

Syntax : XPRNT(YES/NO)

Default : Defined by the previous DEFXPR macro.




Page 9                PBTERS.DOC







PBT130                                         July 22, 1988



Description :

This macro specifies whether devices can handle transparency.

The values of argument are the following:

        YES = can handle transparency.
        NO  = can not handle transparency.

EXAMPLE : XPRNT(YES)

Device can operate in the transparency mode.

1.4.4  PRTTXT - Printer Label In Network Service Screen

Syntax : PRTTXT(text)

Default : No messages will be displayed for the printer device.

Description :

This macro specifies a text describing a printer on  the  network
services screen.

The values of the argument are the following:

        text =  A short description of the printer on the network
                services screen. The text can be entered as ASCII
                characters directly from the keyboard or EBCDIC hex
                prefixed with double quotes ". If BCD hex is used
                the device must be selected for kk with the LNGMSG
                macro.
        NONE =  For CRT devices, the description is not
                used on the network services screen.

Example : PRTTXT(BLUE PRINTER)

          ASCII CHARACTERS ENTERED FROM KEYBOARD.

          PRTXT("C2"D3"E4"C5)

          THIS IS TO ALLOW KATA KANA TO BE ENTERED AND DISPLAYED
          ON JAPANESE TERMINALS.

Current device is a printer.  "BLUE PRINTER" will be displayed on
the Network Service Screen to identifiy this printer device.








Page 10               PBTERS.DOC







PBT130                                         July 22, 1988



1.4.5  MENU   - Logon Menu

Syntax : MENU(label)

Default : Defined by the previous DEFMEN macro.

Description :

This macro specifies the label which refers to  a  set  of  logon
menus  that will allow this device to select the destination host
interface.

The value of the argument is the following:

        label = label defined in macro LOGMENU which
                refers to the logon menu for this device.

Example: MENU(MENU1)

The logon menu for the current device is MENU1 which will display
predefined  host selections when a user signs on TIF from an idle
terminal.

1.4.6  PVC    - Permanent Virtual Circuit

Syntax : PVC(YES/NO)

Default : Defined by the previous DEFPVC macro.

Description :

This macro specifies whether the device will be logged in with  a
PVC or not.

If defined as YES, then should the network circuit be broken  for
any reason, Terminal Interface will automatically try to re-build
the circuit via pre-defined stored logon elements.

There are some options that will specify how  to  rebuild  and  a
timer  to  control when to start the logon process, these will be
described later. The "MANUAL" logon element is  not  allowed  for
PVC configured devices.

The values of the argument are the following:

        YES = device is logged in with a PVC.
        NO  = device is not logged in with a PVC.

Example: PVC(YES)

Terminal Interface will keep the Network Circuit up all the time.



Page 11               PBTERS.DOC







PBT130                                         July 22, 1988



1.4.7  DEVID  - Device Identification Number

Syntax : DEVID(device identification number)

Default : Relative device number on the current control unit.

Description :

This macro specifies the user-defined identification  number  for
the  current  device.  This  device ID can be used in the TBOM to
identify certain devices for monitoring  purposes  while  in  USR
mode.

Example : DEVID(40)

The identification number for the current device is 40.

1.4.8  NETKEY - Network Services Key

Syntax : NETKEY(pf#/pa#/ENTER/CLEAR/OFF)

Default : Defined by the previous DEFNET macro.

Description :

This macro specifies the  PF  key  used  to  obtain  the  Network
Services Screen. Depending on the setting of macro TWOPFK, one or
two key strokes may be required to  invoke  the  Network  Service
Screen.

NSS is used to perform the following operations :

        1. Logon the printer device.
        2. Logoff the printer circuit.
        3. Logoff the CRT circuit.

The values of the arguments are the following:

        PF#   = PF1, PF2, PF3, PF4, PF5, PF6, PF7, PF8
                PF9, PF10, PF11, PF12, and
                the following for IBM/FUJITSU
                PF13, PF14, PF15, PF16, PF17, PF18, PF19,
                PF20, PF21, PF22, PF23, PF24 or
                the following for HITACHI
                HPF13, HPF14, HPF15, HPF16, HPF17, HPF18, HPF19,
                HPF20, HPF21, HPF22, HPF23, HPF24.
        PA#   = PA1, PA2
        CLEAR = CLEAR KEY
        ENTER = ENTER key.
        OFF   = DISABLE THE NETWORK SERVICE SCREEN




Page 12               PBTERS.DOC







PBT130                                         July 22, 1988



For further information  about  obtaining  the  network  services
screen, please refer to macros TWOPFK, PFMENU, PFMEU1 and PFMEU2.


The HEX values for the Hitachi PF keys are as follows:

        HPF13   :       71
        HPF14   :       72
        HPF15   :       73
        HPF16   :       74
        HPF17   :       75
        HPF18   :       76
        HPF19   :       77
        HPF20   :       78
        HPF21   :       79
        HPF22   :       0FA
        HPF23   :       0FB
        HPF24   :       0FC


Example : NETKEY(PF9)

The network services key for the current device is the PF9 key.

1.4.9  KKORKJ - Change Character Set

Syntax : KKORKJ(ENG/KANA/KANJI)

Default :  Defined by previous DEFCHR macro.

Description :

This macro  changes  the  character  set  for  the  device  being
defined.  It does not change the default character set as defined
by the previous DEFCHR macro.

Example : KKORKJ(KANA)

          This device supports the KATA KANA character set.

1.4.10  ERRMSG - DEFINE THE ERROR MESSAGE FOR THE DEVICE


SYNTAX: ERRMSG(ARG)

WHERE ARG = KK OR ENG

DESCRIPTION:

THIS MACRO DEFINES THE  ERROR  LANGUAGE  TYPE  FOR  THE  DEVICES.
ENG=ENGLISH  KK=KATA  KANA THIS MACRO FOLLOWS THE DEVICE MACRO IN



Page 13               PBTERS.DOC







PBT130                                         July 22, 1988



THE TYMFILE.  IF THE ERRMSG MACRO IS NOT DEFINED THE DEFERR MACRO
DEFINES THE LANGUAGE.

EXAMPLE:ERRMSG(KK)

THE LANGUAGE FOR THIS DEVICE WILL BE KATA KANA.

1.4.11  LNGMSG - MACRO DEFINES LANGUAGE TYPE FOR THE DEVICE


SYNTAX: LNGMSG(ARG)

WHERE ARG = KK OR ENG

DESCRIPTION:

THIS MACRO DEFINES THE SCREEN LANGUAGE TYPE FOR THE  DEVICE.  THE
MACRO  MUST FOLLOW THE DEVICE MACRO IN THE TYMFILE. IF THIS MACRO
IS NOT DEFINED THE DEFLNG MACRO DEFINES THE LANGUAGE.

EXAMPLE:LNGMSG(ENG)

THE LANGUAGE FOR THIS DEVICE WILL BE ENGLISH.

1.5  LOGON ELEMENTS

The user of a 3270 terminal may logon through  the  stored  logon
process.  In stored logon mode, the required login information is
defined in the tymfile and stored in memory.

Users can request the Network Logon Menu to be displayed just  by
pressing  the  ENTER  key on an idle terminal, which will wake up
the terminal interface and request a host selection menu be sent.

By positioning the  cursor  in  front  of  the  destination  host
desired,  pressing  the ENTER key tells the Terminal Interface to
start the circuit building process.

Once the logon is requested, the logon procedure is automatically
initiated.  An element is the basic part of a logon string.

There are two sets of elements that are required  by  the  stored
logon process :

        1. Network Logon Element.

           The username element is composed of the username,
           host number, password and an optional project code.

        2. DSP Menu Element.




Page 14               PBTERS.DOC







PBT130                                         July 22, 1988



           DSP(ASCII) consists of a Y which specifies an ASCII
           session and the project code.

           DSP(native) consists of a N followed by the characters
           answering the DSP screen.
           These characters include CRM number, destination interface
           address, application identification, destination control
           unit address, destination device address, a request for
           transparency and a request for color.


There are three macros NETSCR, ASCDSP and NATDSP used  to  define
these three types of elements.

1.5.1  NETSCR - Network Logon Screen

Syntax : NETSCR(label)

Description :

This macro indicates the start of the definition  of  an  element
that  would  request  a  network  circuit be built. Whenever this
Network Logon element is desired for certain login, referring  to
the "label" would provide the necessary information.

Example : NETSCR(ELE0)

The label for current element is "ELE0".

There are four macros ELEUNA, ELEHST, ELEPWD and ELENPC  used  to
define the characters in the current element.

1.5.1.1  ELEUNA - Network Username

Syntax: ELEUNA(string)

Description :

This macro defines an username  that's  being  validated  in  the
network where Terminal Interface is residing.

Example : ELEUNA(HELLO)

The username in current element is "HELLO".










Page 15               PBTERS.DOC







PBT130                                         July 22, 1988



1.5.1.2  ELEHST - Host Number

Syntax : ELEHST(host#)

Description :

This optional macro defines a host number, in decimal,  of  which
the destination host interface is defined.

If the username is home-based to a certain host number, then this
macro will not be required.

Example : ELEHST(900)

The host number in current element is 900.


1.5.1.3  ELEPWD - Password

Syntax : ELEPWD(password)

Description :

This macro defines a password for the current element.

It is optional only if the username has been validated such  that
the password is not required to complete the login.

Example: ELEPWD(WELCOME TO NTD)

The password in current element is "WELCOME TO NTD".

1.5.1.4  ELENPC - Project Code

Syntax : ELENPC(project code)

Description :

This macro defines a text required by the host for placement in a
special program or project when defined. The project code is sent
to the host before an ASCII session begins and is optional.

Example : ELENPC(3270 INTERFACE)

The project code in current element is "3270 INTERFACE".









Page 16               PBTERS.DOC







PBT130                                         July 22, 1988



1.5.2  ASCDSP - DSP Screen In ASCII Mode

Syntax : ASCDSP(label)

Description :

This macro indicates the start of the definition of an element to
establish a session that's in ASCII mode.

Example: ASCDSP(ELE2)

The label for the current element is "ELE2".  User can  use  ELE2
to refer to this element.

1.5.2.1  ELEAPC - Project Code

Syntax : ELEAPC(arg)

Description :

This macro defines a text required by the host for placement in a
special  program or project when defined.  It is sent to the host
before an ASCII session begins and is optional.

A project code should be specified when  accessing  an  interface
that supports both DSP and ASCII.

Example : ELEAPC(GOODBYE)

The project code for current element is "GOODBYE".

1.5.3  NATDSP - DSP Screen In Native Mode

Syntax : NATDSP(label)

Description :

This macro indicates the start of a definition of an element that
will specify a native mode enviroment with 3270 DSP protocol.

Example: NATDSP(ELE3)

The label for the current element is "ELE3".  User can  refer  to
ELE3 for an element that defines DSP logon strings  which will be
used in native mode enviroment.









Page 17               PBTERS.DOC







PBT130                                         July 22, 1988



There are seven macros (ELEARS, ELECRM, ELELNA,  ELECUA,  ELEDVA,
ELEXPR and ELECOL) used to define the current element.

1.5.3.1  ELEARS - Destination Interface Address

Syntax : ELEARS(arg)

Description :

This macro defines an optional destination interface  address  in
decimal. No more than 14 digits are allowed in this field.

The first four digits are always DNIC for Tymnet followed by  the
destination host interface number.

Example : ELEARS(31060901)

The destination interface address  is  31060901  in  the  current
element.

1.5.3.2  ELECRM - CRM Number

Syntax : ELECRM(CRM#)

Description :

This macro specifies the connection request mode number.

The values of the argument CRM# are the following:

        CRM1 =  fixed class "crm".  The physical control
                unit and device addresses must match those
                at the destination host.

        CRM2 =  specified class "crm".  Logon is targeted
                to a specific application identification,
                destination control unit address and
                destination device address.  If any one is
                omitted, the destination host interface
                will assign one for it on the basis of
                availability.  If all of them are omitted,
                the function is the same as CRM3.

        CRM3 =  nonspecified class "crm". The logon is
                targeted to any available device instead
                of a specific one.  User may, however,
                specify application identification,
                destination control unit address or
                destination device address.  If all of
                them are specified, the function is the
                same as CRM2.



Page 18               PBTERS.DOC







PBT130                                         July 22, 1988



        CRM4 =  associated device class.  The logon is
                targeted to an associated printer.
                Logon to printers using the network
                services screen in native mode.
                However, TYMNET users may use this
                CRM class to logon to other networks.
                The TYMNET 3270 host interface does provide
                CRM4 in release 10.00 but its function use
                is limited to CMT users.
Example : ELECRM(CRM3)

The connection request mode (CRM)  class  is  3  in  the  current
element.


1.5.3.3  ELEAPP - Application Identification

Syntax : ELEAPP(app)

Default : Assigned by HIF.

Description :

This  macro  specifies  the  application  identification  in  the
current element. This ID is in hex and is optional.

Example : ELEAPP(40)

The application identification is 40 in the current element.

1.5.3.4  ELECUA - Destination Control Unit Address

Synatx : ELECUA(addr)

Default : Assigned by HIF.

Description :

This macro specifies the destination  control  unit  address,  in
hex, in the current element. It is optional in CRM of 3.

Example : ELECUA(0C2)

The destination control  unit  address  is  0C2  in  the  current
element.









Page 19               PBTERS.DOC







PBT130                                         July 22, 1988



1.5.3.5  ELEDVA - Destination Device Address

Syntax : ELEDVA(addr)

Default : Assigned by HIF.

Description :

This macro specifies the destination device address, in  hex,  in
the current element.

Example : ELEDVA(0C1)

The destination device address is 0C1 in the current element.

1.5.3.6  ELEXPR - Request For Transparency

Syntax : ELEXPR(YES/NO)

Default : Defined by the DEFXRT or XPRT macro definitions.

Description :

This macro specifies a request for transparency  in  the  current
element.  If  user invokes macro ELECOR to request for the color,
then this macro  should  also  be  incorporated  to  request  for
transparency in current element.

The values of the argument are the following:

        YES =   user logins to a device that can
                operate in transparency mode.
        NO  =   user logins to a device that can
                not operate in transparency mode.

Example : ELEXPR(YES)

User  requests  to  login  to  a  device  that  can  operate   in
transparency  mode.  The request is actually assigned as default,
using this macro only for clarity.

1.5.3.7  ELECOL - Request For Color

Syntax : ELECOL(YES/NO)

Default : Defined by DEFCOL or COLOR macro definitions.

Description :

This macro specifies a request for color in the current element.




Page 20               PBTERS.DOC







PBT130                                         July 22, 1988



The values of the argument are the following:

        YES =   user logins to a device that can
                handle color.
        NO  =   user logins to a device that can
                not handle color.

Example : ELECOL(NO)

User requests to login to a device that can not handle color.  In
other words, user does not plan to use a color application.

1.5.3.8  ELECHR - Element for Character Set

Syntax : ELECHR(ENG/KANA/KANJI)

Default : Defined by the DEFCHR macro.

Description :

This macro is  used  after  the  macro   NATDSP  to  define   the
element  for  the  stored   logon process for the  character set.
This  element is used in the call establishment where  TIF  sends
the  Call  User Data field indicating   the  characteristics   of
the   network   circuit    to   be  established.  Other  elements
include Connect Request  Mode, Destination Interface Address, and
Applicationn ID, etc.

Example : ELECHR(KANA)

The network service circuit must support KATA KANA.

1.5.4  LOGSTR - Logon String

Syntax : LOGSTR(label,text,label1,label2,label3,label4,label5)

Description :

This macro specifies  a  series  of  logon  elements.  The  logon
strings required for completing the logon sequence are refered to
in this macro call in  the  order  that  will  be  asked  by  the
network.

The values of the argument are the following:

        label  = label to reference this logon string.
        text   = desired text describing this logon string.
                 this text will be displayed on the initial network
                 logon menu. The text can be entered as ASCII
                 characters directly from the keyboard or BCD hex
                 prefixed with double quotes ". If EBCDIC hex is used



Page 21               PBTERS.DOC







PBT130                                         July 22, 1988



                 the device must be selected for kk with the LNGMSG
                 MACRO.
        labeln = label to reference a element defined in macro NETSRN,
                 ASCDSP or NATDSP.

Example :

LOGSTR(STR0,MANUAL LOGON) :ASCII CHARACTERS ENTERED FROM KEYBOARD

A logon string "MANUAL LOGON" with the label  STR0,  no  elements
are required for manual logon.

LOGSTR(STR0,"D4"C2"D5"E4"C2"D3) :THIS IS TO ALLOW KATA KANA TO BE
ENTERED AND DISPLAYED ON JAPANESE TERMINALS.


LOGSTR(STR1,TO HOST 900,ELE1,ELE2)

Element STR1 defines text "TO HOST 900" that will show up on  the
network logon menu to describe the targeted host interface number
and two elements ELE1, ELE2 defined in macros NETSRN,  ASCDSP  or
NATDSP  will  be  used  as  the  logon characters for the circuit
building process through the network.

1.5.5  LOGMEN - Logon Menu

Syntax : LOGMEN(label,label1,label2,.....,label15)

Description :

This macro defines a set of logon strings for a particular  menu.
On  this  menu, only those elements that define the targeted host
interface can be selected by the terminal users.

The values of the argument are the following:

        label  = label to reference this logon menu.
        CONT   = indicate the continuation of the previous
                 LOGMENU macro.
        labeln = label to reference a logon string defined in
                 macro LOGSTR.

Example : LOGMEN(MENU1,STR1,STR2,STR3)

Logon menu MENU1 consists of three logon elements  labeled  STR1,
STR2, and STR3 which in terms define certain logon character sets
by the macro LOGSTR.







Page 22               PBTERS.DOC







PBT130                                         July 22, 1988



1.6  CHANGING DEFAULT LINE HOST TYPE FOR THE SLOT

The macro DEFLIN is used to change the host type  for  the  slot.
This macro must be used before the LINE marco.

1.6.1  DEFLIN - Define Default Host Line Type


Syntax : DEFLIN(line-type)

         where line-type is IBM/ FUJITSU/ HITACHI

Default : DEFLIN(IBM), or defined by previous DEFLIN macro.

Description :

This macro defines the default protocol type for  the  lines   in
the  slot.  The line-type can be  IBM or FUJITSU or HITACHI. This
macro must be used before the line configuration starts.

It is used  whenever a definition of  the line type  is   desired
or  when  the  line type  has been  changed by  the macro  LINTYP
and  a re- definition is intended to clarify the line type of the
subsequent lines that are to be configured.

If this macro is  omitted, the code will  automatically   default
to the host type of IBM.

Example: DEFLIN(HITACHI)

         The default line host type is HITACHI.


1.7  CHANGING LINE DEFAULT PARAMETERS FOR SLOT

There are FOUR macros DEFHANG, DEFRTS, DEFDTR, AND DEFSWT used to
change  the  default  for  line  parameters.  These macros can be
invoked anywhere in the TYMFILE.  The default is changed  at  the
point of invocation, and may be redefined at a later point. These
macro's require lines which support  rts,  cts,dtr,and  dsr.  The
lines  which  support those functions are line 2,3,6, 7,10,11,14,
and 15 of the engine.


1.7.1  DEFSWT - default SWITCH/LEASE line


Syntax: DEFSWT(arg)

        where arg = YES or NO.




Page 23               PBTERS.DOC







PBT130                                         July 22, 1988



Default: If this macro is omitted, the initial default
         value is "NO".

Description:

This macro defines the default for macro SWITCH(arg).  The values
of the argument  are the following:

            YES = the line is a dial-up switched line.
            NO  = the line is a leased line.
Example: DEFSWT(YES)

The default line type for each line is that the line is a dial-up
switched line from this point on.


1.7.2  DEFHAN - Default Hang Logic


Syntax: DEFHAN(arg)

        where arg = YES or NO.

Default: If this macro is omitted, the initial default
         value is "NO".

Description:

This macro defines the default for macro HANG(arg).   The  values
of the argument are the following:

             YES = enable the hang logic.
             NO  = disable the hang logic.
Example: DEFHAN(YES)

The default hang logic feature for each  line  is  disabled  from
this point on.


1.7.3  DEFRTS - Default RTS/CTS Handshake Signals


Syntax: DEFRTS(arg)

        where arg = YES or NO.

Default: If this macro is omitted, the initial default
         value is "NO".

Description:  This  macro   defines   the   default   for   macro
RTSCTS(arg).  The  macro  can be used for all lines which support



Page 24               PBTERS.DOC







PBT130                                         July 22, 1988



this signal. The line can be leased or dial-up. The macro  switch
must be used with dial-up lines.  The values of the arguments are
the following:

             YES = RTS/CTS is required.
             NO  = RTS/CTS is not required.
Example: DEFRTS(NO)

The default RTS/CTS handshake signals for each line is  that  the
line  does  not require RTS/CTS handshake signals from this point
on.

1.7.4  DEFDTR - default DTR/DSR handshake signals


Syntax: DEFDTR(arg)

        where arg = YES or NO.

Default: If this macro is omitted, the initial default
         value is "NO".

Description:

This macro defines the default for macro  DTRDSR(arg). The  macro
can be used for all lines which support this signal. The line can
be leased or dial-up.   The  values  of  the  argument   are  the
following:

             YES = DTR/DSR is required.
             NO  = DTR/DSR is not required.
Example: DEFDTR(NO)

The default DTR/DSR handshake signals for each line is  that  the
line  does  not require DTR/DSR handshake signals from this point
on.


















Page 25               PBTERS.DOC







PBT130                                         July 22, 1988



1.8  CHANGING DEFAULT LANGUAGE PARAMETERS FOR SLOT

There are two macros  DEFLNG  AND  DEFERR  which  allow  for  the
selection of the display in KATA KANA OR ENGLISH. The default for
language if not  specificed  is  ENGLISH.  These  macros  can  be
invoked anywhere in the TYMFILE. These macro's change the default
values per device.  The  default  is  changed  at  the  point  of
invocation,and may be redefined at a later point.

1.8.1  DEFLNG - DEFAULT SCREEN LANGUAGE TYPE FOR THE SLOT


SYNTAX: DEFLNG(ARG)

        WHERE ARG = ENG OR KK

DESCRIPTION:

THIS MACRO DEFINES THE DEFAULT SCREENS A CUSTOMER CAN SELECT  FOR
THE  SLOT.   DEVICE  ENGLISH  OR KATA KANA. ENG= ENGLISH,KK= KATA
KANA. IF THIS MACRO IS NOT SELECTED THE DEFAULT IS ENGLISH

EXAMPLE:DEFLNG(KK)

THE DEFAULT SCREEN IS KATA KANA.


1.8.2  DEFERR - DEFAULT ERROR MESSAGE LANGUAGE FOR SLOT


SYNTAX: DEFERR(ARG)

        WHERE ARG = KK OR ENG

DESCRIPTION:

THIS MACRO DEFINES THE DEFAULT FOR ALL THE MESSAGES FOR THE SLOT.
THE  CHOICES  ARE  KK=KATA KANA ENG=ENGLISH. IF THIS MACRO IS NOT
SELECTED THE DEFAULT IS ENGLISH.

EXAMPLE:DEFERR(KK)

        THE DEFAULT ERROR LANGUAGE IS KATA KANA











Page 26               PBTERS.DOC







PBT130                                         July 22, 1988



1.9  CHANGING DEFAULT DEVICE PARAMETERS FOR SLOT

There are EIGHT macros DEFTYP, DEFCOL,  DEFXPR,  DEFPRT,  DEFMEN,
DEFPVC,  DEFCHR  and DEFNET used to change the default values for
device parameters.

These macros can be invoked anywhere in the TYMFILE.

The default is changed at the point of  invocation,  and  may  be
redefined at a later point.

1.9.1  DEFTYP - Default Device Type

Syntax : DEFTYP(C####/P####)

Default : C1920.

Description :

This macro defines the default for macro TYPE(arg).

The values of the argument are the following:

        C#### = CRT, where #### indicates screen size
                in characters per screen, it can be the value
                480, 960, 1920, 2560, 3400, or 3564.
        P#### = Printer, where #### indicates screen size
                in characters per screen, it can be the value
                480, 690, 1920, 2560, 3400, or 3564.

Example : DEFTYP(C960)

The default device type is a CRT with the screen of 960.

1.9.2  DEFCOL - Default Color Capability

Syntax : DEFCOL(YES/NO)

Default : NO.

Description :

This macro defines the default for the macro COLOR(arg).

The values of the argument are the following:

        YES = can handle color.
        NO  = can not handle color.

Example : DEFCOL(YES)




Page 27               PBTERS.DOC







PBT130                                         July 22, 1988



The default color capability of the device is that the device can
handle color.

1.9.3  DEFXPR - Default Transparency Capability

Syntax : DEFXPR(YES/NO)

Default : NO.

Description :

This macro defines the default for macro XPRNT(arg).

The values of the argument are the following:

        YES = can handle transparency.
        NO  = can not handle transparency.

Example : DEFXPR(YES)

The default transparency capability of the  device  is  that  the
device can operate in the transparency  mode.


1.9.4  DEFMEN - Default Logon Menu

Syntax : DEFMEN(label)

Default : The first logon menu.

Description :

This macro defines the default for the macro MENU(label).

The value of the argument is the following:

        label = a label defined in macro LOGMENU which
                refers to the menu for this device.

Example : DEFMEN(MENU1)

The default logon menu is the menu with the label MENU1.

1.9.5  DEFPVC - Default PVC Capability

Syntax : DEFPVC(YES/NO)

Default : NO.

Description :




Page 28               PBTERS.DOC







PBT130                                         July 22, 1988



This macro defines the default for macro PVC(arg).

Example: DEFPVC(YES)

The default PVC capability of each device is that the  device  is
logged in with a PVC facility.

1.9.6  DEFNET - Default Network Services Key

Syntax : DEFNET(PF#/PA#/CLEAR/ENTER/OFF)

Default : PF4.

Description :

This macro defines the  default  programmable  function  key  for
macro NETKEY(arg).

The value of the augument are the following:

        PF#   = PF1, PF2, PF3, PF4, PF5, PF6, PF7, PF8
                PF9, PF10, PF11, PF12, and
                the following for IBM/FUJITSU
                PF13, PF14, PF15, PF16, PF17, PF18, PF19,
                PF20, PF21, PF22, PF23, PF24 or
                the following for HITACHI
                HPF13, HPF14, HPF15, HPF16, HPF17, HPF18, HPF19,
                HPF20, HPF21, HPF22, HPF23, HPF24.
        PA#   = PA1, PA2
        CLEAR = CLEAR KEY
        ENTER = ENTER KEY
        OFF   = DISABLE NETWORK SERVICE SCREEN



Example : DEFNET(PF10)

The default network services key is PF 10 key.


1.9.7  DEFCHR - Define Default Character Set



Syntax : DEFCHR(ENG/KANA/KANJI)

Default : DEFCHR(ENG)

Description :

This macro  defines the  character set  that will   be  used   by



Page 29               PBTERS.DOC







PBT130                                         July 22, 1988



the device after network circuit is built.

Character  set  of  ENG  means  the  session  has   no    special
characters.   Character  set   of KANA means the session uses the
additional special character set of KATA KANA. The character  set
of  KANJI  indicates  the  inclusion  of the KATA KANA characters
plus the KANJI characters.

This default character  set can be defined  on  a  device   basis
and can also be changed by the macro KKORKJ.

Example : DEFCHR(KANA)

          The special characters for KATA KANA will be used.

1.10  MACROS TO CHANGE TERMINAL INTERFACE PARAMETERS

1.10.1  HNGDTR - Interval To Hold DTR Down


Syntax: HNGDTR(t)

Where t = time in seconds.  The value of t  can be  any  positive
decimal value from 1 to 3600(1 hour).

Default: If this macro is omitted, the default is  1 second.

Decription:

This macro specifies the  time  interval  to  hold  DTR  down  to
disconnect the line  between the 3270 Terminal Interface and  the
modem.  The value of the argument is the following:

            t = the time interval to hold DTR down.
Example: HNGDTR(2)

The DTR signal will be held down for 2 seconds to disconnect  the
line.


1.10.2  MONDSR - time interval to monitor the DSR signal


Syntax: MONDSR(t)

where t = time in ticks(1 second=600 ticks). The value of  t  can
be any positive decimal value from 300 to 2160000(1 hour).

Default: If this macro is  omitted,  the  default  is  200  ticks
(one/third second).




Page 30               PBTERS.DOC







PBT130                                         July 22, 1988



Description:

This macro specifies the time interval to check for the status of
the DSR signal, if the line is a full-duplex switched line. For a
full-duplex switched line, the 3270 Terminal  Interface  monitors
the  status  of  the DSR signals periodically to tell whether the
line is connected or not.  To guarantee the line is connected  or
disconnected, the DSR will be checked more than once.  If the DSR
is detected up for four consecutively, the line will be  declared
up.  If the DSR is detected down for four consecutively, the line
will be declared down and the 3270 Terminal Interface  will  drop
the  DTR  signal  for  a  specific time, and then raise it again;
therefore, the line will not  appear  busy  to  the  other  users
dialing-in.  The value of the argument is the following:

t = the time interval to check the status  of the DSR signal.

Example: MONDSR(600)

The 3270 Terminal interface will check the status of the DSR
signal for each line every  600 ticks(1 second).

*       MONDSR should be 1/4 the value of HNGDTR time


1.10.3  NLOGIN - Time Interval For No Log In


Syntax: NLOGIN(t)

where t = time in minutes.   The  value  of  the  t  can  be  any
positive decimal value from 1 to 1440(24 hours).

Default: If this macro is omitted, the default is   2 minutes.

Description:

This macro specifies the time interval for the  user  to  log  in
after the full-duplex line between the Terminal Interface and the
Modem is connected.  When this time interval is expired and there
is  no  user logged in, the line will be disconnected by lowering
DTR.  The  value of the argument is the following:

t = the time interval for the user to log in after the line is
    connected.

Example: NLOGIN(3)

When the line is connected and there is no user logged in in 3 minutes,
the line will be disconnected.




Page 31               PBTERS.DOC







PBT130                                         July 22, 1988



* If TMIACT is used on the same line its value should be greater
  then NLOGIN


1.10.4  TMIACT - Time Interval To Check Line Inactivity



Syntax: TMIACT(t)

where t = time in seconds.  The value of t can  be  any  positive
decimal value from 1 to 86400(24 hours).

Default: If this macro is omitted, the default is  60 second.

Description:

This  macro  specifies  the  time  interval  to  check  the  line
inactivity  if  the  hang logic is applied to this line. Once the
line inactivity is detected,the DTR signal will be held down  for
a specific time to disconnect the line. To make sure the Terminal
Interface has enough time to send  the  polling  out,  this  time
interval  should be specified  at least twice as long as the time
interval for slow  poll.   The  value  of  the  argument  is  the
following:

                                                        tmiact
**************

t = the time interval to check the line inactivity.

Example: TMIACT(120)

The terminal interface checks the line inactivity every 120 seconds.

*        TMIACT must be greater then HNGDTR value and NLOGIN if
         line is full duplex dial-up.

1.10.5  SLWPOL - Activate Slow Poll Logic

Syntax: SLWPOL(t)

Default : 60 Seconds.

Description :

This macro specifies the time interval,  t  seconds  in  decimal,
without poll responses before the slow poll mode is activated.

Example : SLWPOL(90)




Page 32               PBTERS.DOC







PBT130                                         July 22, 1988



Terminal interface will start the  slow  poll,  if  there  is  no
response for 90 seconds since last response.

1.10.6  SPOLTM - Time Interval For Slow Poll


Syntax: SPOLTM(t)

where t = time in seconds.   The  value  of  the  t  can  be  any
positive decimal value from 1 to 3600(1 hour).

Default: If this macro is omitted, the default is 20 seconds.

Description:

This macro specifies the time interval between  the  slow  polls.
In 3270 Terminal Interface, if there is no response in a specific
time since last response,the slow poll mode  is  activated.   For
half-duplex  line  modem,  if the modem does not receive the data
from the engine in a specific time, the modem will disconnect the
line.   As  a  result,  the time interval for slow poll should be
shorter than the time interval for the line  being   disconnected
by the modem.  The value of the argument is the following:

t = the time interval for slow poll.

Example: SPOLTM(30)

The 3270 Terminal Interface issues a slow poll every 30 seconds.

1.10.7  NOPOLL -Timeout Interval For No Response To Polling

Syntax : NOPOLL(t)

Default : 60 seconds.

Description :

This macro specifies  the  time  interval  between  responses  to
polling before the terminal declares the control unit as inactive
and disconnects all circuits with devices on this control unit.

Example : NOPOLL(40)

40 seconds has passed since last poll response, then the  control
unit  is  declared  down  and  all  circuits with devices on this
control unit are disconnected.







Page 33               PBTERS.DOC







PBT130                                         July 22, 1988



1.10.8  PRESTM - Timeout Limit For Response To The Polling



Syntax: PRESTM(t)

where t = time in seconds.   The  value  of  the  t  can  be  any
positive decimal value from 1 to 3600(1 hour).

Default: If this macro is omitted, the default is 3 seconds.

Description:

This macro specifies the maximum time interval to  wait  for  the
response  to  the  polling.   The  value  of  the argument is the
following:

t = the timeout limit for the response to the polling.

Example: PRESTM(5)

After sending out the polling, the 3270 Terminal Interface  waits
for 5 seconds for the response.


1.10.9  SRESTM - Timeout Limit For Response To The Select


Syntax: SRESTM(t)

where t = time in seconds.   The  value  of  the  t  can  be  any
positive decimal value from 1 to 3600(1 hour).

Default: If this macro is omitted, the default is 3 seconds.

Description:

This macro specifies the maximum time interval to  wait  for  the
response  to  the  select.   The  value  of  the  argument is the
following:

t = the timeout limit for response to  the select.

Example: SRESTM(5)

After sending out the select, the 3270 Terminal  Interface  waits
for 5 seconds for the response.







Page 34               PBTERS.DOC







PBT130                                         July 22, 1988



1.10.10  DRESTM - Timeout Limit For Response To The Text


Syntax: DRESTM(t)

where t = time in seconds.   The  value  of  the  t  can  be  any
positive decimal value from 1 to 3600(1 hour).

Default: If this macro is omitted, the default is 3 seconds.

Description:

This macro specifies the maximum time interval to  wait  for  the
response  to  the  data  block.  The value of the argument is the
following:

t = the timeout limit for the response to the data block.

Example: DRESTM(5)

After sending out the data block,  the  3270  Terminal  Interface
waits 5 seconds for the response.


1.10.11  ARESTM - Timeout Limit For Response To The ACK


Syntax: ARESTM(t)

where t = time in seconds.   The  value  of  the  t  can  be  any
positive decimal value from 1 to  3600(1 hour).

Default: If this macro is omitted, the default is  60 seconds.

Description:

This macro specifies the maximum time interval to  wait  for  the
response  to  the  acknowledgement.  The value of the argument is
the following:

t = the timeout limit for response to the acknowledgement.

Example: ARESTM(80)

after  sending  out  the  acknowledgement,  the   3270   Terminal
Interface waits for  80 seconds for the response.








Page 35               PBTERS.DOC







PBT130                                         July 22, 1988



1.10.12  PVCTME - PVC Timer

Syntax : PVCTME(t)

Default : 300 seconds(5 MINS.).

Description :

This macro specifies the time interval for the PVC timer.  For  a
PVC device, a timer routine will check the device status and will
automatically initiate a logon procedure if this  device  is  not
logged in.

** WARNING A SHORT TIMER INTERVAL WILL CAUSE ADDITIONAL  OVERHEAD
FOR  THE  SUPERVISOR  IF  THE TERMINALS ARE POWERED OFF AT NIGHT.
CIRCUITS WILL BE ATTEMPTED AS LONG AS THE POWER  IS  OFF  ON  THE
HOST OR TERMINAL.

Example : PVCTME(120)

The PVC timer is activated every 120 seconds.

1.10.13  PVCOPN - Permanent Virtual Circuit

Syntax : PVCOPN(OPT1/OPT2/OPT3/OPT4/NONE)

Default : OPT3.

Description :

This macro specifies whether the device is logged in with a  PVC.
If the device is a PVC, the argument should specify the choice of
four schemes to  initiate  a  logon  for  a  PVC  that  has  been
disconnected.   Permanet  Virtual Circuit (PVC) for 3270 Terminal
Interface is simulated by performing an automatic logon procedure
without  user  intervention.   There is a timer routine that runs
periodically and checks whether a PVC defined device is ready  to
communicate.  If the device is ready to communicate, the Terminal
Interface sends the stored logon to the host and the  circuit  is
built.   The  connection  appears  as a PVC to the user.  The PVC
options (OPT1, OPT2, OPT3 and OPT4) allow flexibility in deciding
the  type  of  retry  mechanism.   In  describing these different
options, the interval for PVC timer defined in  macro  PVCTME  is
assumed to be five minutes.

The values of the argument are the following:

        OPT1 = once a circuit for a device which is logged in
               with a PVC is zapped, a circuit rebuilt is
               attempted within five minutes.




Page 36               PBTERS.DOC







PBT130                                         July 22, 1988



        OPT2 = once a circuit for a device which is logged in
               with a PVC is zapped, a circuit rebuilt is
               attemped at an average of five minutes, but
               an attempt may happened anytime from zero to
               ten minutes.

        OPT3 = once a circuit for a device which is logged in
               with a PVC is zapped, a circuit rebuilt is
               attempted after at least five minutes has passed,
               but at most ten minutes.

        OPT4 = once a circuit for a device which is logged in
               with a PVC is zapped, a circuit rebuilt is
               immediately attempted and subsequent retries
               are repeated every five minutes.


** WARNING A SHORT TIMER INTERVAL WILL CAUSE ADDITIONAL  OVERHEAD
FOR  THE  SUPERVISOR  IF  THE TERMINALS ARE POWERED OFF AT NIGHT.
CIRCUITS WILL BE ATTEMPTED AS LONG AS THE POWER  IS  OFF  ON  THE
HOST OR TERMINAL.

Example : PVCOPN(OPT4)

Once a circuit for a device which is logged  in  with  a  PVC  is
zapped, a circuit rebuilt is immediately attempted.

1.10.14  DSPSRN - Display DSP Screen

Syntax : DSPSRN(YES/NO)

Default : YES.

Description :

This macro specifies whether the DSP screen is displayed  in  the
logon  process.   With  this  feature  enabled, the DSP screen is
displayed in the logon process.  With this feature disabled,  the
DSP  screen is not displayed in the logon process and  connection
request mode (CRM) is automatically  assigned  to  3.  Then,  the
logon  is initiated and targeted to any available device which is
assigned by the destination host interface.  The  values  of  the
argument are the following:

        YES = DSP screen will be displayed.
        NO  = DSP screen will not be displayed.

Example : DSPSRN(NO)

The DSP screen will not be displayed in the logon process.




Page 37               PBTERS.DOC







PBT130                                         July 22, 1988



1.10.15  TWOPFK - Two PF Keys

Syntax : TWOPFK(YES/NO)

Default : NO.

Description :

This macro specifies whether the host  application  can  use  the
specified  network  services  screen  (NSS) key.  If yes, a 2-key
sequence is used to access the NSS and all PF keys are  available
to  the  host  application.   If not, a 1-key sequence is used to
access the NSS and the key for NSS is  unavailable  to  the  host
application.

The values of the argument are the following:

        YES = the NSS is obtained by pressing the network
              services key once, followed by any key other
              than the keys defined in macros NETKEY, PFMENU,
              PF1MEU and PF2MEU.  If the network services key
              is pressed twice, the AID associated with this
              key is sent to the host application.

        NO  = the NSS is obtained only by pressing the
              network services key once.  The network services
              key is not sent to the host or to the network.

Example : TWOPFK(NO)

The host application can not use the specified  network  services
key.   The  user  can  obtain  the  NSS  by  pressing the network
services key once.

1.10.16  PFMEU  - PF Key To Logoff And Obtain MENU

Syntax : PFMEU(pf-key)

Default : PF3.

Description :

This macro specifies the PF key used with  the  network  services
key  in  order  to  logoff  the  current circuit and get the menu
screen.

PFMEU can take arguement in any of the following key definitions:

         PF1,  PF2,  PF3,  PF4,  PF5,  PF6,  PF7,
         PF8,  PF9, PF10, PF11, PF12, PF13, PF14,
        PF15, PF16, PF17, PF18, PF19, PF20, PF21,



Page 38               PBTERS.DOC







PBT130                                         July 22, 1988



        PF22, PF23, PF24.
         PA1,  PA2,  PA3.
        CLEAR.
        ENTER.

Example : PFMEU(PF6)

The current circuit will be logged off and the menu  screen  will
be  displayed  on  the  screen  when the user presses the network
services key followed by the PF 6 key.

1.10.17  PFMEU1 - PF Key To Logoff And Logon First Menu

Syntax : PFMEU1(pf-key)

Default : PF1

Description :

This macro specifies the PF key used with network services key in
order  to  loggoff  the  current  circuit  and logon to the first
destination defined in menu screen.

The value of pf-key is the same as in PFMEU.

Example : PFMEU1(PF2)

When the user presses the network services key followed by the PF
2  key, the current circuit will be logged off and a circuit will
be logged on to  the  second  destination  defined  on  the  menu
screen.

1.10.18  PFMEU2 - PF Key To Logoff And Logon 2nd Menu

Syntax : PFMEU2(pf-key)

Default : PF2.

Description :

This macro specifies the PF key used with network services key in
order  to  logoff  the  current  circuit  and logon to the second
destination defined on the menu screen.  If there  is  no  second
logon  string  defined on the menu screen, the terminal interface
will send a write command to the user to unlock the keyboard  and
display "WRONG KEY...TRY AGAIN" on the screen.

The value of the pf-key is the same as in PFMEU.

Example : PFMEU2(PF5)




Page 39               PBTERS.DOC







PBT130                                         July 22, 1988



When the user presses the network services key followed by the PF
5  key, the current circuit will be logged off and a circuit will
be logged on to  the  second  destination  defined  on  the  menu
screen.

1.10.19  PLTSUP - Interval For Average Polling Cycle Log

Syntax : PLTSUP(t)

Default : 1440 minutes or 1 hour.

Description :

This macro specifies the time interval,  t  in  decimal  seconds,
which  terminal interface reports the average polling time to the
supervisor's log.  An operator may access this log via probe.

Example : PLTSUP(60)

Every 60 minutes the terminal interface will record  the  polling
time to the supervisor log.

1.10.20  MINXMT - Minimum Threshold To Release For Transmit

Syntax : MINXMT(n)

Default : Hexadecimal 30.

Description :

This macro defines the minimum  number  of  data  threshold(n  in
hexadecimal)  to  hold for transmit.  In 3270 terminal interface,
there is a "DYNAMIC BUFFER SIZE" feature that  according  to  the
condition of the transmission line, the number of SYNC insertions
and the number of un-transmitted data at the time ETX is seen are
minimized.   The  number  defined  in  this  macro is the minimum
number of un-transmitted data at the the time ETX is seen.

Example : MINXMT(20)

The minimum number of data threshold to release for  transmit  is
32 characters.

1.10.21  MAXXMT - Maximum Threshold To Release For Transmit


Syntax : MAXXMT(n)

Default : Hexadecimal 300.

Description :



Page 40               PBTERS.DOC







PBT130                                         July 22, 1988



This macro defines the maximum number of data threshold  to  hold
for  transmit.   In  3270 terminal interface, there is a "DYNAMIC
BUFFER SIZE" feature that  according  to  the  condition  of  the
transmission  line,  the number of SYNC insertions and the number
of un-transmitted data at the time ETX is seen are minimized.

The number defined in this macro is the  maximum  number  of  un-
transmitted data at the the time ETX is seen.

Example : MAXXMT(100)

The maximum number of data threshold to release for  transmit  is
256 characters.

1.11  DEFINE TERMINAL INTERFACE DEBUGGING PARAMETERS

1.11.1  NETCON - Network Console

Syntax: NETCON(arg)

where arg = YES or NO

Default: If this macro is missing, the default is NO

Description:

This macro specifies whether the Network Console can  access  the
Bisync  Operations Monitor (BOM) and issue commands to the (BOM).
The values of the argument are the following:

YES = the Network Console can access BOM.

NO  = the Network Console can not access BOM.

Example: NETCON(YES)

The Network Console can access BOM and issue commands to the BOM.

ACCESSING BOM THROUGH NETWORK CONSOLE

A new feature to allow the Network Console to communication  with
the  Extended  DDT was implemented in the 3270 Host Interface and
the 3270 Terminal Interface.   With  this  feature,  a  user  can
access  the  Bisync  Operation Monitors (BOM) through the Network
Console.  To access the BOM through the Network Console,  a  user
must log into the Network Console first.  Once the user is in the
main commmand level of the Network Console which is indicated  by
an  asterisk  prompt "*", the DDT session can be initiated by the
command "XDDT" (for Extended DDT) followed the kernel host number
and  the  slot  number  which  the  interface  resides.   If  the
connection is successful, the Network Console responds  with  the



Page 41               PBTERS.DOC







PBT130                                         July 22, 1988



prompt  "xddt>".   If  the connection is not successful, an error
message "Extended DDT unavailable" is displayed.  To terminate  a
DDT  session,  the  user can use one of the 3 commands: "RETURN",
"QUIT", "EXIT".  This returns the user to  to  the  main  command
level with an asterisk promp.  An example is given as follows:

Please log in: <user name>:<network console host>;<password>

>

Network Console - Version 3.02

name: <name>

password: <password>


4/29/86 18:16:20

* xddt host 555 slot 1

xddt>status

HBOM -- 3270PBH Bisync Operations Monitor

NODE  2062    SLOT  3    29Apr86 18:18:09

HOST#  STATUS  #PORTS  CIRCUITS

  25    ANSR      3       0

  26    ANSR      3       0

RESTARTS     LAST START      CIRCUITS

    1      24Apr86 19:34:25      0

     BUFFER             CMDLNK              MAPLNK

LEFT  USED  ZAPS   LEFT  USED   ZAPS   LEFT  USED  ZAPS

 316     3     0    314    17      0    102     0     0

xddt>return

*quit








Page 42               PBTERS.DOC







PBT130                                         July 22, 1988



1.11.2  STPCRSH - Halt After Crash

Syntax : STPCRSH(YES/NO)

Default : NO.

Description :

This macro specifies whether a slot will halt after the crash.

The values the of argument are the following:

        YES = the slot will halt after a crash.
        NO  = the slot will restart after a crash.

Example : STPCRSH(YES)

The slot will halt after a crash.

1.11.3  IRINGSZ - IRING Size

Syntax : IRINGSZ(n)

Default : 500 HEX Bytes.

Description :

This macro specifies the number of bytes, n in HEX, for the  ISIS
input ring.

1.11.4  ORINGSZ - RING Size

Syntax : ORINGSZ(n)

Default : 500 HEX Bytes.

Description :

This macro specifies the number of  bytes  for  the  ISIS  output
ring.

Example : ORINGSZ(1000)

The size of the ISIS input ring is 1000 bytes.

1.11.5  BUFLET  - Bufferlet Number

Syntax : BUFLET(n)

Default  : Based on the number of lines and ports.




Page 43               PBTERS.DOC







PBT130                                         July 22, 1988



Description :

This macro specifies the number of bufferlets allocated to a 3270
interface.  Each bufferlet currently holds 60 characters of data.
The number should be based on the number of lines associated with
the slot and the nature of the traffic in those lines.

The values of the argument n are the following:

NBBFLT+k = need k more bufferlets, where NBBFLT is the value
           based on the number of lines and ports assigned
           to the interface.

k        = need a fixed number k of bufferlets.

-1       = set to the maximum number of bufferlets possible.

Example : BUFLET(600)

This 3270 interface slot has 600 bufferlets allocated to it.

1.11.6  CMDLNK  - Number Of Command Link

Syntax : CMDLNK(n)

Default : Bufferlets number plus the number of devices.

Description :

This macro specifies the number (in decimal) of command links for
this interface.

The values of the argument n are the following:

NCMDLK+k = need k more command links, where NCMDLK is
           the value based on the number of bufferlets
           plus a minimum for the number of devices.

k        = need a fixed number k of command links.

Example : CMDLNK(NCMDLK+40)

The number of command links is the value based on the  number  of
bufferlets plus a minimum for the number of devices plus 40.

1.11.7  PTRACE  - Protocol Trace

Syntax : PTRACE(n) where n = a positive number  (in  hexadecimal)
or 0.

Default : 1, Protocol trace enabled



Page 44               PBTERS.DOC







PBT130                                         July 22, 1988



Description :

This macro  enables  the  protocol  trace.   The  protocol  trace
monitors  control  unit and terminal interface interaction at the
terminal interface.  The protocol trace table contains  a  series
of codes showing the interaction.

The possible values of the argument are the following:

        k = enable the protocol trace and allocate k multiples
            of 400-byte blocks for the protocol trace table.

        0 = disable protocol trace.

Example : PTRACE(2)

The protocol trace is enabled; the protocol trace table  has  800
bytes.

1.11.8  RETCODE - Record Of Return Codes

Syntax : RETCODE(YES/NO)

Default : NO.

Description :

This macro specifies whether the interface keeps a record of  the
number  of  occurrences  of  return  codes.   The  values  of the
argument are the following:

        YES = Slot will count occurrences of return codes.
        NO  = Slot will not count occurrences of return codes.

Example : RETCODE(YES)

The interface keeps a count of return codes.

1.11.9  RTRACE  - Receive Trace

Syntax : RTRACE(n,RVDTA,RGEMP,PRHAN,RVSTA,TMRCV,PTCOD)


Description :

This macro specifies the receive trace options which  applies  to
each line in the slot.

There are six trace options:

        1. trace a received-data character.



Page 45               PBTERS.DOC







PBT130                                         July 22, 1988



        2. trace a ring-empty index.
        3. trace a process-handling byte.
        4. trace operation-complete return code.
        5. trace the time required for data reception.
        6. trace the current received data.

These should be used only by technical  support  respresentatives
for debugging.

The values of the arguments are the following:

        n     = the number of 400-byte blocks allocated for
                the trace table.
        RVDTA = enables the received-data character trace,
                optional.
        RGEMP = enables the ring-empty trace,
                optional.
        PRHAN = ebables the process-handling byte trace,
                optional.
        RVSTA = enables the current received data trace,
                optional.
        TMRCV = enables the time required for data reception trace,
                optional.
        PTCOD = enables the operation-complete return code trace,
                optional.

Example : RTRACE(2,RGEMP,PTCOD,RVDTA)

800 bytes are allocated to  the  trace  buffer.   The  operation-
complete  return  codes  trace, the received-data character trace
and the ring-empty index trace are enabled.

1.11.10  PRTCON  - Print Tymfile Configuration


Syntax : PRTCON(YES/NO)

Default : YES.

Description :

This macro specifies whether the tymfile  configuration  will  be
displayed at the time you generate the system.

The values of the argument are the following:

        YES = the tymfile configuration will be displayed.
        NO  = the tymfile configration will not be displayed.

Example : PRTCON(NO)




Page 46               PBTERS.DOC







PBT130                                         July 22, 1988



The configuration defined in the tymfile will not be displayed at
the time you generate the system.

1.11.11  GENNIB -- Generate The NIB File

Syntax: GENNIB(YES/NO)

Default: NO.

Description: This macro defines whether  the  nib  file  will  be
generated  if there is an assembly error, undefined symbol error,
or configuration error during the system generation.   The  value
of the arguments are the  following:

YES = the nib file will be generated  if  there  is  an  assembly
error,  undefined  symbol error or configuration error during the
system generation.

NO  = the nib file will not be generated if there is an  assembly
error,  undefined  symbol error or configuration error during the
system generation.

Example:GENNIB(YES)

During the system generation, if  there  is  an  assembly  error,
undefined symbol error, or configuration error, the nib file will
still be generated.

1.12  MARCO'S TO ALLOW BOM TO CHANGE CONFIGURATION VALUES


Three new macros were added to allow a BOM user to change certain
parameters  without having to create a new tymfile and creating a
new nib file. CAUTION must  be  used  in  dealing  with  on  line
changes   as  problems  will  occur  which  will  make  the  slot
impossible to support.



   - define if the user is allowed to modify dynamically the
     following configuration parameters :
        CU address
        device address
        logon strings
        logon strings labels

   - define the maximum number of modification commands
     the  user wants to record.

   - define the password required while accessing sub-menu.




Page 47               PBTERS.DOC







PBT130                                         July 22, 1988



1.12.1  MOTYM - DYNAMIC MODIFICATION COMMANDS ALLOWED


Syntax : MOTYM(ARG).

         where ARG is YES or NO

Description :

This macro defines if  the  user  is  allowed  to  enter  dynamic
modification commands. If this macro is not selected, the default
value is NO.

Example : MOTYM(YES).

Dynamic modifications commands are allowed.


1.12.2  STNU - DEFINE STORAGE FOR HISTORY OF MODIFICATIONS


Syntax : STNU(ARG)

Where ARG is a number between 1 and 100

Default: The default value is 10.

Description :

This macro defines the number of dynamic modifications that  will
be  kept  in  a  "history"  buffer.  This buffer will be used for
troubleshooting purposes. This macro may not be  present  in  the
Tymfile if the previous one (MOTYM) is missing.

Example : STNU(10).

The history buffer will keep track of the last 10 modifications.



1.12.3  BOMPW - DEFINE PASSWORD TO ACCESS SUB-MENU IN BOM



Syntax : BOMPW(ARG).

where ARG is the string password required for accessing sub-menu.

Default: The default value is "TYMNET".

Description :



Page 48               PBTERS.DOC







PBT130                                         July 22, 1988



This macro defines the sub-menu password.  This  password  is  an
ASCII   string  .  The  password  cannot  contain  the  following
characters : CR LF " " "," .

Example : BOMPW(BUBNET)

The new password is bubnet.

1.13  WSF SUPPORT

This document describes the support for  Write  Structured  Field
commands by the 3270 Polled Bisync Terminal Interface.

The Write Structured Field command is a write command  that  does
not  contain  explicit  control  information  and is used to send
encoded data or control information in a variable form.

Currently, when the 3270 PBT receives a WSF command, it  forwards
the  message  to  the  control  unit.  If the control unit is not
configured to support WSF commands, a rejection is exchanged  and
the  transmission  is aborted resulting in the termination of the
network circuit.

WSF command support is being implemented to allow for SNA support
of  TSO  for the Japanese market.  PBT provides a canned response
to the WSF command for Control Units  that  do  not  support  WSF
commands but communicate with the SNA Host Interface and with TSO
on the Host.

Write Structured Field commands use binary data, data that  could
be  interpreted as bisync control characters, in the data stream.
As such,  the  commands  generally  need  to  be  transmitted  as
transparent  data.   All  devices  using  WSF  commands should be
configured for transparency unless it is certain that none of the
data in the fields are control characters.

1.14  Structured-Field Format

   ----------------------------------------------------------------
   | WSF | Structured Field | Structured Field | Structured Field |
   |  F3 |      1           |      2           |      n           |
   ----------------------------------------------------------------
         /                          /                           /                            /                             /                              -------------------------------
    |        |    |   Parameters  |
    | Length | ID |     and/or    |
    |        |    |      Data     |
    -------------------------------







Page 49               PBTERS.DOC







PBT130                                         July 22, 1988



1.14.1  Outbound Structured Fields

       ID     NAME
      ----    ----------------
        00    Reset Partition
     *  01    Read  Partition
                02 = Query
                03 = Query List
                6E = Read Modified All
                F2 = Read Buffer
                F6 = Read Modified
     *  03    Erase/Reset
        06    Load Programmable Symbols
     *  09    Set Reply Mode
        0B    Set Window Origin
        0C    Create Partition
        0D    Destroy Partition
        0E    Activate Partition
     *  40    Outbound 3270 DS
        41    SCS Data
        4A    Select Format Group
        4B    Present Absolute Format
        4C    Present Relative Format
    **  D0    File Transfer
      0F01    Set MSR Control
      0F0A    Modify Partition
      0F71    Outbound Text Header
      0FC1    Outbound Type 1 Text

  Note : *  Defined in IBM/USA and IBM/JAPAN/PC Manuals
         ** Defined in IBM/JAPAN/PC Manual Only


1.14.2  Inbound Structured Fields


       ID     Name
      ----    ---------------------

        80    Inbound 3270 DS
        81    Query Reply
              * 81  Usable Area
                83  Text Partition
                84  Alpha Partition
              * 85  Character Set
              * 86  Color
              * 87  Highlight
              * 88  Reply Modes
                8A  Field Validation
                8B  MSR Control
              * 8C  Field Outlining



Page 50               PBTERS.DOC







PBT130                                         July 22, 1988



                90  Format Presentation
              **91  DBCS(SO/SI)
                92  Save/Restore Format
              **95  DDM(Distributed Data Management)
                A0  Device Characteristics
                A1  RPQ Names
                A2  Data Stream
              * A6  Implicit Partitions
      0FB1    Inbound Text Header
      0FC1    Inbound Type 1 Text
      1034    Save/Restore Format Inbound

  Note : *  Defined in IBM/USA and IBM/JAPAN/PC Manuals
         ** Defined in IBM/JAPAN/PC Manual Only

1.14.3  Write Structured Field Command Support

The 3270 Polled Bisync Terminal Interface can  be  configured  to
support  Write Structured Field commands (i.e., the control units
connected to PBT support  WSF  commands)  or  configured  to  not
support  Write Structured Field commands (i.e., the control units
connected to PBT do no support WSF commands).  How PBT  processes
the  commands is determined by whether or not it is configured to
support WSF commands.

1.14.4  PBT Supports WSF Commands

If PBT is configured to support WSF commands, it forwards all WSF
commands directly to the control unit.  Under this configuration,
PBT only converts the DSP data into BSC format and forwards it to
the  control  unit.  The control unit either accepts the command,
if it supports WSF commands, or generates a Sense/Status code, if
it does not support WSF commands.

1.14.4.1  PBT Does Not Support WSF Commands

If PBT is not configured to support WSF commands, it examines the
structured  field  in  the  WSF command immediately following the
command code, F3 (hex), to determine if it is Read Partition with
Query  Operation.   For  Read Partition with Query Operation, the
Field Identifier is 01 (hex),  the  Partition  Identifier  is  FF
(hex), and the Type is 02 (hex).  Thus, the entire field would be
000501FF02 (hex).  For  WSF  commands  with  multiple  structured
fields, only the first field is examined.

When PBT receives a WSF command that is not Read  Partition  with
Query  Operation,  a  Sense/Status  code  of  Operation  Check is
returned to the Host PAD, the command is flushed, and the circuit
is  terminated.   The  Operations Check Sense/Status code is 40C1
for IBM and Fujitsu hosts and C0C2 for Hitachi hosts.  The  value
may be changed by placing the following statement in the Tymfile:



Page 51               PBTERS.DOC







PBT130                                         July 22, 1988



OPTION(IOPCHK,40C1)             :OP CHECK S/S IS 40C1 - IBM, FUJITSU
OPTION(HOPCHK,0C0C2)            :OP CHECK S/S IS C0C2 - HITACHI

If the WSF command is Read Partition with  Query  Operation,  the
predefined  Query  Reply  with Partitions is returned to the Host
PAD in DSP data format as if the CU has  acknowledged  the  query
and sent its characteristics.  The command is flushed.

The  Query  Reply  with  Partitions  is  defined  by  the  system
generation  process  and  PBT  does  not  examine  this response.
However, PBT does format the reply as a DSP Response.

If PBT is configured not  to  support  WSF  commands,  individual
control  units  can  be configured to support these commands (see
description of RPLSEQ  macro).   In  this  case  the  command  is
forwarded  directly to the control unit.  The control unit either
accepts the command, if it supports WSF commands, or generates  a
Sense/Status  code,  if  it  does  not support WSF commands.  The
Sense/Status code is forwarded by PBT to the Host PAD.

1.14.5  System Generation WSF

There are several macros required to  configure  and  define  the
support  capability  for  Write Structured Field commands in PBT.
PBT is defaulted  to  support  WSF  commands  so  that  the  code
required for WSF processing is not included in the interface when
not needed.  The support capability can be changed by the  DEFRPL
macro.

There are default replies for both CRTs and printers included  in
PBT.  The RPLTXT macro may be used to define an alternate default
reply or to define additional replies that may be associated with
individual control units on the interface.

1.14.5.1  RPLTXT - Define Contents of Query Reply
          Response

Syntax: RPLTXT(label,b0,b1,b2,...,b14)

Description: This macro defines the text for the Query Reply with
Partitions that PBT returns to the Host PAD when a WSF command is
received.  This macro can be used  to  define  alternate  default
replies or additional replies that are used on a per control unit
basis.

The RPLTXT macro takes 16 arguments, the first  being  the  label
for  the  text  string  or  the label, CONT, used to indicate the
continuation of the reply defined in the previous  RPLTXT  macro.
The  messages  may  be of any length provided there is sufficient
memory and they don't exceed 3270 BSC block size limitations.




Page 52               PBTERS.DOC







PBT130                                         July 22, 1988



Example:

RPLTXT(WSF1,00,07,81,88,00,01,02)

RPLTXT(WSF2,00,11,81,0A6,00,00,0B,01,00,05)
RPLTXT(CONT,00,01,80,50,00,18)


1.14.5.2  DEFRPL - Define Default Query Reply Response

Syntax: DEFRPL(label,type)

Description: Inclusion of the DEFRPL macro in the Tymfile defines
all  control  units as not supporting WSF commands.  As such, PBT
intervenes in the processing of WSF commands.  The arguments  are
optional.   If  no arguments are included in the macro statement,
the canned replies, as defined in  this  document,  are  sent  in
response to WSF commands of Read Partitions with Query Operation.
There are two canned replies, one for CRTs and one for printers.

Alternate default replies can be defined in the Tymfile using the
RPLTXT  macro.   To  define  alternate default replies, the label
associated with the reply is the first  argument  of  the  DEFRPL
macro  and  the device type, either CRT or PRINTER, is the second
argument.  An alternate default reply may be defined  for  either
CRTs,  printers, or both.  (Two DEFRPL macros must be included in
the Tymfile to define an alternate reply for  both  printers  and
CRTs.)

Example: DEFRPL

PBT is configured not to support  WSF  commands  and  the  canned
default  replies  are  sent  in  response to WSF commands of Read
Partitions with Query Operation.

Example: DEFRPL(WSFCRT,CRT)
         DEFRPL(WSFPRT,PRINTER)

PBT is configured not to support WSF commands and  the  alternate
default  replies  are  sent  in  response to WSF commands of Read
Partitions with Query Operation.  These replies  are  defined  by
the RPLTXT macro.

1.14.5.3  RPLSEQ - Associate Query Reply Resp with Device

Syntax: RPLSEQ(label,type)

Description: The RPLSEQ macro, used with the CUNIT macro, defines
the label whose text is used as a response to the WSF command for
devices on the current control unit.  The first argument,  label,
is  the  label  associated  with a reply as defined by the RPLTXT



Page 53               PBTERS.DOC







PBT130                                         July 22, 1988



macro.  The second argument, type,  is  either  CRT  or  PRINTER.
Replies  for  CRTs,  printers,  or  both  may be defined for each
control unit.  If the label, specified in the first argument,  is
not found during assembly time, an error message is displayed.

IF PBT is configured to not support  WSF  commands,  the  current
control  unit  maybe  be  configured to support these commands by
entering YES as the first argument  of  the  RPLSEQ  macro.   WSF
commands for devices associated with the current control unit are
passed directly to the control  unit.   The  second  argument  is
omitted  when the RPLSEQ macro is used to configure an individual
control unit to support WSF commands.  for the interface  support
WSF commands and others don't.


1.14.6  PBT Canned Response to WSF Command

The canned responses to a WSF Read Partition with Query Operation
and  the  response  to  a  WSF  Read  partition with query can be
selected under the label WSFRP1.

There is a reply for CRTs and a reply for printers.


The canned response for CRTs (in hex) that  is  returned  to  the
Host  PAD  indicates  that  the control unit does not support WSF
commands but the CRT does support Kanji.  The reply follows:


88001781810100005000180000652710006527100D1D1780002381858E000C180000
00000B00000000000000014C01228020F81818417F0172012C000A818C0000000000
00000B81910003018003020100078188000102000C81950000080008000101001681
86000800F4F100F200F300F400F500F600F700000D81870400F0F1F1F2F2F4F40011
81A600000B01000050001800500018

The canned response for printers (in hex) that is returned to the
Host  PAD  indicates  that  the control unit does not support WSF
commands but the printer does support Kanji (as sent by  IBM3283-
52 printer).  The reply follows:

88001781813100009E007F00000100F0000100F0142007B0001B818588001420040000
0007000000000000008020F81C20417F000681880001












Page 54               PBTERS.DOC







TBOM13                                         July 22, 1988



                          2.  TBOM13

The Bisync Operations Monitor (BOM) for PBT version  13.00  is  a
tool  that  monitors  and  controls features of the 3270 Terminal
Interface. The TBOM is  a  feature  of  both  the  standard  3270
Terminal  Interface  (EBCDIC)  and  the  Hong  Kong Shanghai Bank
(HSBC)  3270  Terminal  Interface  (ASCII).    There   are   some
differences  in  the  implementation  of  the TBOM in each of the
interfaces. These are described in this document.

To access  the  TBOM,  the  user  must  first  log  into  Dynamic
Debugging   Tool  (DDT).  DDT  is  a  generalized  debugging  and
monitoring tool that is part of ISIS, the TYMNET Engine operating
system.  To log into DDT, enter:

        USERNAME:KERNEL HOST NUMBER;PASSWORD

followed by a  Carriage  Return  <CR>  when  the  PLEASE  LOG  IN
message  is  displayed.  When prompted for the slot number, enter
the number of the slot  in  which  the  3270  Terminal  Interface
resides.   Then,  at  the prompt (*), access the TBOM from DDT by
entering the ?STAT command. Once in the  TBOM,  the  prompt  (:>)
indicates that the TBOM is ready to accept commands.

Command lines are terminated by a Carriage Return <CR>. Arguments
are separated by either a comma, space, line feed, or tab.

The Display Mode is terminated by a  Backslash().  The  backslash
returns the user to the Command mode.

Limited editing control is available for the TBOM.  Pressing  the
ESCAPE  key  aborts  the  current command line and returns to the
prompt (:>). Pressing the Control-W key (^W) discards the partial
token,  word  or  number,  that  is  already input.  Pressing the
Control-A  (^A)  and  Control-H  (^H)  keys  discards  the   last
character  of the token. This has the same effect as a backspace.
Pressing the Control-C (^C) key anytime  terminates  the  current
process  of  the  TBOM. Output is halted and the user is returned
from the TBOM to DDT.

The date is displayed as "ddmmmyy"; where dd is the day,  mmm  is
the month, and yy is the year (for example, 10APR84).

When reference is made to the relative  line,  control  unit,  or
device  number;  this  means  the order in which each of these is
defined in the interface Tymfile.  The first line that is defined
is  line  0, the second line that is defined is line 1, the third
line that is defined is line 2, and so on.






Page 55               PBTERS.DOC







TBOM13                                         July 22, 1988



2.1  General Functions


This  section  describes  the  commands  that   provide   general
information  about  the  monitor  and status of the 3270 Terminal
Interface.  This information includes which command functions are
available,  what the slot configuration is, and information about
slot crashes (if any occur).


2.1.1  Menu COMMAND


Syntax: MENU or ?

The Menu command prints the list of commands used for the TBOM.

(INSTRUCTION COMMAND)

Syntax: INS or INST

The Instruction command displays a list of editing characters and
explains  there  uses.  It  also  displays  the list of delimiter
characters.  The format of the output is as follows:
TBOM -- 3270PBT Bisync Operations Monitor
NODE    xxxx    SLOT    x       day/month/year   time of day

The following are the editing characters:

 o Escape (ESC)     - Aborts back to the command level.

 o Control-W (^W)   - Discards the partial token.

 o Control-A (^A)   - Discards the last character of the token
                      (same effect as a backspace).

 o Control-H (^H)   - Discards the last character of the token
                      (same effect as a backspace).

Valid delimiters are:

  o Line Feed (LF)

  o Horizontal Tab(HT)

  o Space (" ")

  o Comma (",")

  o Carriage Return ( <CR> ) - Terminates command line.




Page 56               PBTERS.DOC







TBOM13                                         July 22, 1988



2.1.2  EXIT COMMAND


Syntax: EXIT

The Exit  command  logs  the  user  out  of  the  3270PBT  Bisync
Operations Monitor and DDT.



2.1.3  QUIT COMMAND


Syntax: QUIT or Q or CONTROL C

The  Quit  command  exits  the  user  from  the  3270PBT   Bisync
Operations Monitor to the slots DDT.





































Page 57               PBTERS.DOC







TBOM13                                         July 22, 1988



2.1.4  CODE COMMAND


Syntax: CODE

The Code command displays the slot  description.  The  output  is
displayed as follows:

TBOM -- 3270PBT Bisync Operations Monitor
NODE  nnnn    SLOT  ss   ddmmmyy hh:mm:ss

3270 TERMINAL INTERFACE   VERSION xx.xx

SID xxx    KHOST xxx   ORGHST xxx   ASSM ddmmmyy hh:mm:ss

#LINE   #CU   #DEV   {ATM   PDP   VDU   TT   GTP   (UNK)}
  xx     xx    xxx   { xx    xx    xx   xx    xx     xx }
This display is interpreted as follows:

VERSION Version number as version.revision level. This
        is displayed in DECIMAL to be consistent with
        DDT and the SUPERVISOR.

ASSM    Date assembled in Greenwich Mean Time (GMT)
        "daymonthyear  hour:minute:second" format.

        Comment:
        Note that Greenwich Mean Time replaced now
        by Coordinated Universal Time (UTC)

SID     Slot identifier

KRNHST  Kernel host number

ORGHST  Origination host number (3270 slot host number for
        example, the host that originates network circuits)

#LINE   Number of lines

#CU     Number of control units

#DEV    Number of devices


ATM  -  Number of Automated Teller Machines (ATM)
        (applies only to the HSBC 3270 Terminal Interface)

PDP  -  Number of DEC PDP devices
        (applies only to the HSBC 3270 Terminal Interface)

VDU  -  Number of Video Display Units (VDU)



Page 58               PBTERS.DOC







TBOM13                                         July 22, 1988



        (applies only to the HSBC 3270 Terminal Interface)

TT   -  Number of Teller Terminals (TT)
        (applies only to the HSBC 3270 Terminal Interface)

GTP  -  Number of General Terminal Printers (GTP)
        (applies only to the HSBC 3270 Terminal Interface)

UNK  -  Number of devices of unknown type (displayed only to show
how
        many devices of unknown type there are)
        (applies only to the HSBC 3270 Terminal Interface)










































Page 59               PBTERS.DOC







TBOM13                                         July 22, 1988



2.1.5  STATUS COMMAND


Syntax: STATUS

The Status command displays the status of the slot. The format of
the output is displayed as follows
TBOM -- 3270PBT Bisync Operations Monitor
NODE  nnnn    SLOT  ss   ddmmmyy hh:mm:ss

HOST     RESTARTS     LAST START     CIRCUITS   PVC CIRCUITS
SHUT       xxxx    ddmmmyy hh:mm:ss    xxx           xxx

(GONE)

BUF LEFT   BUF USED   BUF ZAPS   CMDLNK LEFT  CMDLNK USED  CMDLNK ZAPS
  xxxx       xxxx       xxxx         xxxx        xxxx          xxxx
This display is interpreted as follows:

HOST         -  Indicates3270 terminal interface host status.  SHUT
                is normal status indicating that the slot is involved
                in an execution. At this time, the slot cannot be a
                circuit destination. A GONE status indicates that the
                slot is halted or not yet initialized.

RESTARTS     -  Number of restarts.

LAST START   -  Time of last start in Greenwich Mean Time (GMT),
                in a "daymonthyear  hour:minute:second" format.
                Comment:
                Note that Greenwich Mean Time replaced now by
                Coordinated Universal Time (UTC).

CIRCUITS     -  Number of circuits in use.

PVC CIRCUITS -  Number of PVC circuits currently being used.

BUF LEFT     -  Number of buffers left.

BUF USED     -  Number of buffers used.

BUF ZAPS     -  Number of circuit zaps, (circuits that are torn down),
                since the last restart that are due to insufficient
                buffers.

CMDLNK LEFT  -  Number of command links left. (Command links are
                descriptors. For a given device, they contain
                either error codes or the location and quantity of data
                that is stored in buffers.)

CMDLNK USED  -  Number of command links used.



Page 60               PBTERS.DOC







TBOM13                                         July 22, 1988



CMDLNK ZAPS  -  Number of circuit zaps due to insufficient command.
                links since the last restart

2.1.6  ACCESS TO VIEW RING COMMAND


Syntax: EXTDDT

The Access To View  Ring  command  allows  access  to  a  set  of
commands which allow viewing of the Input Ring (IRING) and Output
ring (ORING).  The menu accessed provides a description of  these
commands. The output is displayed as follows:

TBOM -- 3270PBT Bisync Operations Monitor
NODE  xxxx      SLOT  x         day/month/year  time

The following are the Extended DDT commands for the 3270
Terminal Interface:

DIR <address> - Real-time IRING display from <address>;
                otherwise, from the start of the ring.

DOR <address> - Real-time ORING display from <address>;
                otherwise, from the start of the ring.

DR            - Real-time display of both the IRING and ORING
                that stayes with one ring until the port number
                changes.

DRA           - Real-time display of the IRING and ORING
                alternating rings.























Page 61               PBTERS.DOC







TBOM13                                         July 22, 1988



2.1.7  CRASH COMMAND


Syntax: CRASH

The Crash command displays  information  about  the  most  recent
crash.   Because  the  Crash Count is initialized to one when the
slot is started, only Crash Count information is  displayed.  The
output is displayed as follows:

TBOM  --  3270PBT Bisync Operations Monitor
NODE  nnnn    SLOT  ss   ddmmmyy hh:mm:ss

CRASH COUNT  xxxx
TIME  mm/dd/yy  hh:mm:ss
FASTC  xxxxxxxx
CRASH POINT  xxxxxxxx
CRASH CODE  xx
PSW  xxxxxxxx

REGISTERS

xxxxxxxx  xxxxxxxx  xxxxxxxx  xxxxxxxx  xxxxxxxx  xxxxxxxxx
xxxxxxxx  xxxxxxxx  xxxxxxxx  xxxxxxxx  xxxxxxxx  xxxxxxxxx
xxxxxxxx  xxxxxxxx  xxxxxxxx  xxxxxxxx

STACK (LIFO)

xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx
xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx

JUMP INDEX  xxxx

JUMP TABLE

xxxxxxxx  xxxxxxxx  xxxxxxxx  xxxxxxxx
xxxxxxxx  xxxxxxxx  xxxxxxxx  xxxxxxxx
xxxxxxxx  xxxxxxxx  xxxxxxxx  xxxxxxxx
xxxxxxxx  xxxxxxxx  xxxxxxxx  xxxxxxxx

IRING POINTERS  xxxx  xxxx
IRSIZE  xxxx

IRING

xxxx  xxxx  xxxx  xxxx  xxxx  xxxx  xxxx  xxxx
xxxx  xxxx  xxxx  xxxx  xxxx  xxxx  xxxx  xxxx
xxxx  xxxx  xxxx  xxxx  xxxx  xxxx  xxxx  xxxx

ORING POINTERS  xxxx  xxxx
ORSIZE  xxxx



Page 62               PBTERS.DOC







TBOM13                                         July 22, 1988



ORING

xxxx  xxxx  xxxx  xxxx  xxxx  xxxx  xxxx  xxxx
xxxx  xxxx  xxxx  xxxx  xxxx  xxxx  xxxx  xxxx
xxxx  xxxx  xxxx  xxxx  xxxx  xxxx  xxxx  xxxx

This display is interpreted as follows:

CRASH COUNT  -  Number of times (in hexadecimal) that the slot
                has crashed  since loaded.  Crash count is initialized
                to one when the slot is first started.

TIME         -  Time of crash in GMT, in a
                "month/day/year  hour:min:sec" format.

FASTC        -  Time of crash in FASTC.  (FASTC, the system clock, is
                a 32-bit value that is incremented at a rate of
                600 times per second.)

CRASH POINT  -  Address of the next instruction at the time of the
                crash.

CRASH CODE   -  Crash code.  A list if standard ISIS crash codes
                follows:

            Crash Code     Significance
            ----------     ------------

                0          Power failure
                1          Manual restart
                0E         Parity error
                10         Dispatcher crash
                11         Illegal instruction
                12         Illegal SVC
                13         System crash
                14         Protection violation
                15         Non-recoverable device check
                16         Watch frog timer - a time-out


PSW           - Program status word at the time of the crash.

REGISTERS     - Register values (registers 0 - F) at the time of
                the crash.

STACK         - Entire stack Contents at the time of the crash, read
                out as Last In First Out (LIFO).

JUMP INDEX    - Index into the table of the last jump.

JUMP TABLE    - The jump trace table contains the address of the



Page 63               PBTERS.DOC







TBOM13                                         July 22, 1988



                preceding jumps. The jump trace table is valid only if
                the slot is restarted by technical support personnel
                with the jump trace enabled.

IRING POINTERS- Full and empty pointers for the IRING.

IRSIZE        - The size of the IRING (in bytes).

IRING         - The entire IRING (IRING is a ring buffer storing all
                of the messages received from the network to be read
                by the  slot).

ORING POINTERS- The full and empty pointers for ORING.

ORSIZE        - The size of the ORING (in bytes).

ORING         - The entire ORING (ORING is a ring buffer that stores
                all of the messages received from the slot to be sent
                to the network).

2.2  LINE CONTROL/STATUS FUNCTIONS


This section describes the commands that control and indicate the
current status of the lines, control units, and devices connected
to the slot. This includes the ability to start or stop polling a
control  unit  and  to break down specified circuits or groups of
circuits.



2.2.1  MODE COMMAND


Syntax: MODE aaa

Default: ADR

The Mode command sets  the  selection  mode,  where  aaa  is  the
desired  mode.   For  applicable  commands,  this  determines the
lines, control units,  and  devices  specified  by  the  relative
position  number,  address, or user defined ID.  The default mode
is ADR.  Modes cannot be mixed  within  a  single  command  line.
(The  user-defined  ID  is defined in the DEFLN, DEFCU, or DEFDEV
macro in the Tymfile.)  These modes are specified as follows:

REL  -  Relative position number

ADR  -  Address

USR  -  User defined ID



Page 64               PBTERS.DOC







TBOM13                                         July 22, 1988



If the Mode command is entered without  specifying  a  mode,  the
current  mode is displayed. The default mode, ADR, can be changed
by equating the label DFTMOD to the desired mode in the  Tymfile.
For example:

DFTMOD  EQ      REL          :REL is the default  mode  for  TBOM
commands



2.2.2  QUERY LINE COMMAND


Syntax: QLINE lna (mode is ADR) or QLINE  ln  (mode  is  REL)  or
QLINE

The  Query  Line  command  displays  line  status  for  the  line
specified, where ll is the line number.  If no line is specified,
the command displays the status of all the lines. The line number
entered may be the relative line number, the line address, or the
line ID; depending on the state of the Mode command. The  default
mode  is  line  address(ADR).  The  Query  Line command output is
displayed as follows:


TBOM -- 3270PBT Bisync Operations Monitor
NODE  nnnn    SLOT  ss   ddmmmyy hh:mm:ss

LINE   LADR   LID   SPRT   #CU   #DEV TYPE STATE  RTS  HNG   DSR
 xx     xx     xx    xx     xx    xx   x   xxxx    x    x     x

This display is interpreted as follows:

LINE -  Relative line number
LADR -  Line address as defined by the DEFLN macro in the Tymfile.
LID  -  Line ID number as defined by the DEFLN macro in the Tymfile.
SPRT -  Physical synchronous port to which the line is attached.
#CU  -  Number of control units per line.
#DEV -  Number of devices per line.
TYPE -  0 if the line is a leased line;
        1 if the line is a full-duplex switched line;
        2 if the line is a half-duplex switched line;
        ? indicates the line is a leased line.

STATE - One of the following five states:

     o  A OK message indicates that the DTR signal is raised and
        the user may dial in at this point.

     o  A READY message indicates that the line is connected and
        is ready for the user to log in.



Page 65               PBTERS.DOC







TBOM13                                         July 22, 1988



     o  An ACTIVE message indicates that the line is connected and
        the user is successfully logged into the host.

     o  An IDLE message indicates that there is no circuit in the
        current line and the DTR signal has been dropped in order to
        disconnect the line.

     o  A HANG message indicates that the DTR gignal has already been
        dropped, but the DSR signal is still high. In this situation,
        there could be some problems with the line or dial-up equipment
        and users are not allowed to dial in at this point.

        ?   indicates that the line is a leased line or unknown
            type.

RTS  -  1 if RTS/CTS required; 0 if not
HNG  -  1 if hang logic required; 0 if not (for dial-up lines)
DSR  -  ? if DTR/DSR is not required or not possible for this line;
        1 if DSR is high (indicates the line is functioning properly);
        0 if DSR is low (indicates the line is not functioning
          properly)


2.2.3  QUERY CONTROL UNIT COMMAND


Syntax: QCU ll,cc (mode is ADR) or QCU cun (mode is REL)

The Query  Control  Unit  command  displays  the  status  of  the
specified control unit, where ll is the line number and cc is the
control unit when  the  mode  is  ADR.  If  no  control  unit  is
specified,  the status of all control units on the line specified
is displayed.

The line and control unit number may  be  the  line/control  unit
address,  the  line/control unit ID, or the relative control unit
number (which may be entered by itself), depending on  the  state
of  the  Mode command. The default mode is ADR. The format of the
output is displayed as follows:

TBOM -- 3270PBT Bisync Operations Monitor
NODE  nnnn    SLOT  ss   ddmmmyy hh:mm:ss

CU CUADR CID #DEV   STATUS    PTO REXMT XERR XTOT NAKS RERR RTOT
xx  xx   xx   xx    ACTIVE    xxx  xxx  xxx  xxxx xxx  xxx  xxxx
                      (NO RESPONSE)
                        (NOPOLL)

This display is interpreted as follows:





Page 66               PBTERS.DOC







TBOM13                                         July 22, 1988



CU    - Relative control unit number.

CUADR - Control unit address, as defined by the DEFCU macro in
        the Tymfile.

CID   - Control unit ID number as defined in the DEFCU macro in
        the Tymfile.

#DEV  - Number of devices per control unit.

STATUS- Polling status of the control unit. (ACTIVE indicates that the
        terminal interface is polling and the the the control unit  is
        responding.  NO RESPONSE indicates that the terminal interface
        is polling and that the control unit is not responding. NOPOLL
        indicates that the terminal interface is not polling).

PTO   - Number of times (in hexidecimal) the control unit polled
        when it did not respond (count is always accumulated; cleared
        by the RESET command).

REXMT - Number of retransmissions (in hexidecimal) of data to control
        unit (count is always accumulated; cleared by the RESET
        command).

XERR  - Number of transmission errors (in hexidecimal) (Count is
        always accumulated; cleared by the RESET command).

XTOT  - Number of data blocks (in hexidecimal) transmitted. Both ETX
        and ETB blocks are included in the count, (which is always
        accumulated, but is cleared  by the RESET command).
        (Retransmissions are included in the count).

NAKS  - Number of negative acknowledgements (in hexidecimal) sent
        to the control unit (count is always accumulated; cleared
        by the RESET command).

RERR  - Number of receive errors detected (in hexidecimal)
        (count is always accumulated; cleared by the RESET command).

RTOT - Number of data blocks received (in hexidecimal). Both ETX
       and ETB blocks are included in the count (which is always
       accumulated, but cleared by the RESET command).












Page 67               PBTERS.DOC







TBOM13                                         July 22, 1988



2.2.4  QUERY DEVICE COMMAND


Syntax: QDEV ll,cc,dd (mode is ADR) or QDEV dvn (mode is REL)

The Query Device  command  displays  the  device  status  of  the
specified  device; where ll is the line number, cc is the control
unit, and dd is the device. If no device is specified, the status
of  all  devices  on the specified control unit is displayed.  In
the ADR mode or ID mode the command line is rejected, if the line
and/or control numbers are not entered.

The line, control unit, and device number may be the line/control
unit/device  address,  the  line/control  unit/device  ID, or the
relative device number which  may  be  entered  by  itself.  This
depends  on  the  state  of the Mode command. The default mode is
ADR. The format of the output is displayed as follows:
TBOM -- 3270PBT Bisync Operations Monitor
NODE  nnnn    SLOT  ss   ddmmmyy hh:mm:ss

DEV DADR DID  {TYPE } PVC COL XPR NKEY  DPRT  STATE    S/S  AP  CA  DA DH
xxx  xx  xxx  { VDU }  x   x   x   xx    xx    IDLE     xx  xx  xx  xx xx
                {(ATM)}                       (LOGIN)
                {(PDP)}                       (NATIVE)
                {(GTP)}                       (VIRTUAL)
                {(TT) }

This display is interpreted as follows:

DEV   -  Relative device number.

DADR  -  Device address as defined by the DEFDEV macro in the Tymfile.

DID   -  Device ID as defined by the DEFDV macro in the Tymfile.

TYPE  -  Device type (only for the HSBC 3270 Terminal Interface).

PVC   -  1 if permanent virtual circuit; 0 if not.

COL   -  1 if terminal has color capabilities; 0 if not.

XPR   -  1 if terminal can handle extended features (transparent);
         0 if it cannot handle extended features such as Value of
         Network Services Key (NKEY).

DPRT  -  Dispatcher port number (a 0 indicates there is no circuit
         for this device).

STATE -  State of the device as follows:

   o  IDLE - Indicates that no circuit exists for the specified device.



Page 68               PBTERS.DOC







TBOM13                                         July 22, 1988



   o  LOGIN - Indicates that terminal interface is building a circuit
              for the specified device.

   o  NATIVE - Indicates that circuit exists between terminal interface
               and a 3270 type host (through the 3270 Host Interface
               or X.25 interface that uses DSP).

   o  VIRTUAL - Indicates that a circuit exists between terminal
                interface and a ASCII-type host (a host that accepts
                ASCII character mode data streams).

S/S   -  Last sense/status half-word (in hexidecimal) received from
         the device.

AP    -  Application ID field from the circuit enable packet
         (the logical line address for the device at the host
         interface).  If the circuit is not built yet
         (which occurs during the Idle  or Logon mode),
         NA is displayed for device.

CA    -  Control unit address field from the circuit enable packet
         (the logical control unit address for the device at the host
         interface).  If the circuit is not built yet (which occurs
         during the Idle or Logon mode), NA is displayed for device.

DA    -  Device address field from the circuit enable packet
         (the logical device address for the device at the host
         interface).  If the circuit is not built yet
         (which occurs during the Idle or Logon mode),
         NA is displayed for device.

DH    -  Destination host field from the circuit enable packet
         (the destination host number for the device at the host
         interface).  If the circuit is not built yet
         (which occurs during the Idle or Logon mode),
         NA is displayed for device. HOME is displayed if it has a home
         host.

















Page 69               PBTERS.DOC







TBOM13                                         July 22, 1988



2.2.5  QUERY ONLINE DEVICES COMMAND


Syntax : ONLINE


The Query Online Devices command display  all  the  devices  that
have  logged  into the host interface. No arguements are required
for this command.

Example :

Please type MENU for help
:> ONLINE
The following is displayed:

TBOM -- 3270PBT Bisync Operations Monitor
NODE  2062    SLOT  2    24Apr86 22:11:12

DEV DADR DID PVC COL XPR NKEY DPRT STATE S/S  AP CA DA DH    ONLINE

 0  40    0  0   0   0   F4   10  NATIVE C240 40 C3 4F HOME 24Apr86 22:09:22


2.2.6  RESET CONTROL UNIT ERROR COUNTS COMMAND


Syntax:  RESET

The Reset Control Unit Error Counts command resets  to  zero  all
count  totals  of  errors, transmits and receives for all control
units. (These are the totals reported by the Query  Control  Unit
command.)



2.2.7  RESTART ERRORS COMMAND


Syntax:  RERR ll

The Restart Errors command resets the error counts and  specifies
the  line  for which error reporting is done. (Error reporting is
done by the Display Errors command.) The value ll  specifies  the
line,  and  is  interpreted  according to the current mode. If no
line is  specified,  the  Display  Errors  command  causes  error
information  for  the  entire slot to be displayed. (Error counts
accumulated for the Display Errors command are reset to zero.)






Page 70               PBTERS.DOC







TBOM13                                         July 22, 1988



2.2.8  DISPLAY ERRORS COMMAND


Syntax:  DERR n

The Display Errors command displays the  number  of  line  errors
that  occurr  in each hour for the past n hour(s) and the average
number of errors for that period.  The value of n can range  from
1 to 24.  If n is not specified only the average number of errors
and line exceptions for the  past  24  hours  is  displayed.  Any
errors  that  occur  in  the  most  recent  partial hour or other
partial hour are not included in the average.

A bin is maintained for each error type and  line  exception  for
each  hour in a 24-hour cycle.  At the beginning of the hour, the
bin is emptied. Then, each error occurring within  that  hour  is
recorded  in  the bin.  At the end of the hour, the process moves
to the next set of bins.  This process cycles continuously.   The
output is displayed as follows:
TBOM -- 3270PBT Bisync Operations Monitor
NODE  nnnn    SLOT  ss   ddmmmyy hh:mm:ss

LINE xx
 -SLOT-

HOUR   PTO   RE-TRAN  XERR   NAKS   RERR
 xx     xx     xx      xx     xx     xx
 xx     xx     xx      xx     xx     xx
 xx     xx     xx      xx     xx     xx
 xx     xx     xx      xx     xx     xx*

       xxx    xxx     xxx    xxx    xxx   TOTALS

AVERAGE PER HOUR

        xx     xx      xx     xx     xx
This display is interpreted as follows:

LINE -  Line number, per the current mode, for which  errors  are
reported  (ENTIRE SLOT indicates that errors are reported for all
lines).

HOUR -  Bin hour in UTC.

PTO - Number of times the control unit has been  polled  when  it
did not respond.

RE-TRAN - Number of retransmissions of data to the control unit.

XERR -  Total transmit errors.




Page 71               PBTERS.DOC







TBOM13                                         July 22, 1988



NAKS -  Number of Negative acknowledgements sent to  the  control
unit.

RERR -  Total receive errors.

* Indicates the partial hour that is included in the totals,  but
not included in the average.


2.2.9  DISPLAY CONTROL UNITS NOT POLLED COMMAND


Syntax: DNPLL

The Display Control Units Not Polled command displays a  list  of
all  the  control  units that are not being polled. The output is
displayed as follows:
TBOM -- 3270PBT Bisync Operations Monitor
NODE  nnnn    SLOT  ss   ddmmmyy hh:mm:ss

LINE    CU
 xx     xx
 xx     xx
This display is interpreted as follows:

LINE  -  Line number (per the current mode).

CU   -   Number of the control unit not  being  polled  (per  the
current mode).

























Page 72               PBTERS.DOC







TBOM13                                         July 22, 1988



2.2.10  DISPLAY CONTROL UNITS NOT RESPONDING COMMAND


Syntax: DNRSP

The Display Control Units Not Responding command displays a  list
of all control units that are not responding to polls. The output
is displayed as follows:
TBOM -- 3270PBT Bisync Operations Monitor
NODE  nnnn    SLOT  ss   ddmmmyy hh:mm:ss

LINE    CU
 xx     xx
 xx     xx
This display is interpreted as follows:

LINE -  Relative line number (per the current mode)

CU   -  Relative number(s) of the control unit(s)  that  are  not
responding to polls (per the current mode).


2.2.11  POLL CONTROL UNITS COMMAND


Syntax: POLL ll,cc

The Poll Control Units  command  functions  differently  for  the
standard  3270  Terminal  Interface  and  the  HSBC 3270 Terminal
Interface.

 o  For the standard 3270 Terminal Interface, the Poll command causes
    the specified control unit(s) to be polled when the host is
    polling; where ll is the line, and cc is the control unit.  If no
    control unit is specified, all the control units on the specified
    line are polled.

 o  For the HSBC 3270 Terminal Interface, the Poll command causes the
    specified control unit(s) to be polled when the host is polling;
    where ll is the line, and cc is the control unit.  If no control
    unit is specified, all the control units on the specified line
    are polled.

 o  The line and control unit number may be the line/control unit
    address or the line/control unit ID, or the relative control unit
    number (which may be entered by itself). This depends on the state
    of the Mode command.







Page 73               PBTERS.DOC







TBOM13                                         July 22, 1988



2.2.12  DO NOT POLL CONTROL UNITS COMMAND


Syntax: NOPOLL ll,cc

The Do Not Poll Control Units command functions  differently  for
the  standard  3270 Terminal Interface and the HSBC 3270 Terminal
Interface.  These differences are described as follows:

 o  For the standard 3270 Terminal Interface, the Nopoll command
    causes the specified control unit(s) not to be polled,  where
ll is
    the line, and cc is the control unit.  If no control unit is
    specified, the command halts polling of all the control units
on
    the specified line.

 o  For the HSBC 3270  Terminal  Interface,  the  Nopoll  command
causes
    the specified control unit(s) not to be polled; where  ll  is
the
    line, and cc is the control unit.   If  no  control  unit  is
specified,
    the command halts polling of all the  control  units  on  the
specified
    line. A Nopoll command from the TBOM has priority over resume
    polling commands received from the host.   Polling  does  not
resume
    until a Poll command is issued from the TBOM and the host is
    polling.

 o  The line and control unit number may be the line/control unit
    address, the line/control unit ID, or  the  relative  control
unit
    number (which may be entered by itself). This depends on  the
state
    of the Mode command.



2.2.13  KILL CIRCUITS COMMAND


Syntax: KILL ll,cc,dd

The Kill circuits command kills the specified  circuit(s);  where
ll is the line, cc is the control unit, and dd is the device.  If
no device is specified, the circuits to all the  devices  on  the
specified  control  unit  are  killed.  If  no  control  unit  is
specified, the circuits to all devices on the specified line  are
killed.   The line number must be specified.  For PVCs, automatic



Page 74               PBTERS.DOC







TBOM13                                         July 22, 1988



rebuild is prohibited.

The line, control unit, and device number may be the line/control
unit/device  address,  the  line/control  unit/device  ID, or the
relative device number (which may be  entered  by  itself).  This
depends on the state of the Mode command.



2.2.14  BUILD PVC CIRCUITS COMMAND


Syntax:  BUILD ll,cc,dd

The  Build  PVC  Circuits  command  rebuilds  the  specified  PVC
circuit(s)  killed  by the Kill command; where ll is the line, cc
is the control unit, and dd is  the  device.   If  no  device  is
specified,  the  circuits  to  all  the  devices on the specified
control unit are rebuilt.  If no control unit is  specified,  the
circuits  to  all devices on the specified line are rebuilt.  The
line number must be specified.

The line, control unit, and device number may be the line/control
unit/device  address,  the  line/control  unit/device  ID, or the
relative device number (which may be  entered  by  itself).  This
depends on the state of the Mode command.



2.2.15  START DEVICE OPERATION COMMAND

Syntax : STARTDEV lna [cua [dva]] or STARTDEV dvn


The Start Device Operation command,  followed  by  at  least  one
argument,   or   two   other  optional  arguments,  activate  the
operations of the device or group of devices that are  specified.
The  required arguments are lna (line address in ADR mode) or dvn
(device number in REL mode). If only lna is specified, or if  lna
and  cua  (the  control  unit address in ADR mode) are specified,
then all the devices defined in  the  designated  group,  devices
under the specified line, or devices under the specified line and
control unit are affected.

This command does  not  affect  the  devices  that  already  have
circuits.  Instead, for the devices that are in the Idle mode and
are deactivated by  the  Stop  Devices  command-users  can  login
again.

For Permanent  Virtual  Circuit  (PVC)-configured  devices,  this
command does not apply. The only command that can be used in this



Page 75               PBTERS.DOC







TBOM13                                         July 22, 1988



case is the  Build  command,  which  enables  the  PVC  logic  to
initiate the PVC login procedures.

2.2.16  STOP DEVICE OPERATION COMMAND

Syntax : STOPDEV lna [cua [dva]] or STOPDEV dvn


The Stop Device Operation command disables the operations of  the
device  or group of devices specified. Once stopped, users cannot
login. If an attempt to use the terminal is made  at  this  time,
the  message  CRT  PORT HAS BEEN DISABLED is displayed, informing
the user of the device status.

This command does not apply to  any  PVC-configured  devices.  If
users  try to log into a printer from the Network Service Screen,
the message PRINTER PORT HAS  BEEN  DISABLED  is  output  by  the
terminal interface to indicate the device status.

The Kill command can be used to terminate  the  circuit  for  any
device  desired;  however  only  the Build command can be used to
start device operations and  begin  the  login  process  for  PVC
devices.

Once the circuits are disconnected by the Kill  command,  devices
can  be  disabled by issuing the Stop Device command (for non-PVC
devices) and activated by issuing the Start Device command.


2.2.17  QUERY/CHANGE INTERVAL OF REAL TIME DISPLAY COMMAND

Syntax : DISPLAY [nn]

Default : 600 seconds, or 10 minutes.


The Query/Change Interval Of Real Time  Display  command  can  be
invoked,  while in TBOM to change the interval of real time node,
slot, and time display. The real  time  display  interval  starts
either  when  the  user  logs into the TBOM and no activities are
observed or after  executing  one  and  before  next  command  is
issued.  The  value  displayed  deviates 5 to 15 seconds from the
value entered. This is caused by the program.

The argument nn (in  decimal  seconds)  disables  the  real  time
display  if  set  to zero. If nn is not entered, then the current
interval of real time display is reported to the user.  The  user
can enter any nn value, ranging from 0 to 99999 (in decimal).






Page 76               PBTERS.DOC







TBOM13                                         July 22, 1988



2.3  NEGATIVE ACKNOWLEDGEMENT HANDLING

The current implementation  of  the  3270PBT  Terminal  Interface
eventually   terminates  the  network  circuits  when  the  error
recovery for handling Negative Acknowledgements (NAK) exceeds the
maximum number of retries allowed.

When PBT detects an error condition while either in the  transmit
or  receive state, it performs a retry operation by going through
error recovery several times. This is done only if the error  was
not  fatal.   For  fatal errors, the circuit is always terminated
without retries.

PBT logs the reason for the error and checks  against  the  retry
limit  during  each  retry. If PBT cannot recover from the errors
after   the   retry   limit   is   reached,   the   Host   Packet
Assembly/Dissembly  (HPAD)  is  informed  by the COMMAND/RESPONSE
ABORTED/UNDELIVERED message sent by the Display Systems  Protocol
(DSP).  In  this  DSP error message, PBT reports the coded reason
for the last error condition.

After receiving the DSP error message,  HPAD  sends  back  a  DSP
INVITATION  TO  CLEAR  message  which causes PBT to terminate the
network circuit for the device with the error conditions.

These enhancements to PBT allow the device to stay  connected  to
the host when PBT has a problem with line of the control unit. No
COMMAND/RESPONSE ABORTED/UNDELIVERED message is sent back to  the
HPAD.   However,  a  report  to  the  Supervisor's log is made to
monitor this condition with the network logger.

The network logger message is displayed as follows:

122:18:11:00

 NODE REPORT 2704 SLOT# 4 PBT TYPE 45 404040

122:18:12:06

In the logger message example, the TYPE 45 part  of  the  display
indicates  that a message from the control unit has been received
incorrectly, and that PBT responded with a NAK. In this case, the
error  retry  limit has been reached and the problem has not been
solved. The operator's interventions may  be  required  to  check
into  the  PBT  slot to monitor the error conditions of the line.
The Query Control Unit command can be used to query the status of
the control unit address indicated in the logger's message.

Note that with this enhancement, the message that  PBT  fails  to
deliver  either  to  the  host  or terminal is lost and cannot be
recovered. If the message comes from the the host, it is  locally



Page 77               PBTERS.DOC







TBOM13                                         July 22, 1988



acknowledged  by the host interface. If PBT fails to deliver this
message to the control unit, host  interface  is  not   notified.
Similarly,  if PBT fails to receive the response from the control
unit correctly, HIF is not  notified.

The Define Retry Limit for Line, Change Retry Limit for Line  and
Define  DSP  Error Report to HPAD Macros are introduced to define
or change the maximum  number  of  retries  and  to  disable  the
sending of the DSP error message to the HPAD.

2.4  SLOT CONFIGURATION

This section describes the commands that give  information  about
the status of the slot.

2.4.1  DISPLAY LINE/SLOT CONFIGURATION COMMAND

Syntax : CONF ln, CONF lna, or CONF


The  Display  Line/Slot  Configuration  command  issued  to  TBOM
displays  the  line  or  slot  configuration.  The parameter that
follows the command can be entered, depending on  what  the  mode
setting is. For relative mode operation, use relative line number
ln. For Line Address mode operations, use line address lna. If no
parameter  is  entered,  the  configuration of the entire slot is
displayed.

For  each  device,  the   output   of   the   Display   Line/Slot
Configuration  command  also indicates what the defined character
set and host type are  for  multi-protocol  support.  The  output
resulting is displayed as follows:

:>CONF

TBOM -- 3270PBT Bisync Operations Monitor
NODE  2062    SLOT  1    03Dec85 18:16:09


LINE  LADR  LID  #CU    HOST
  0    40    00    1    IBM

      CUN   CUADR  CID  #DEV
       0     040   000     2

            DEV    DADR  DID  DTYP   COL  XPR   CHAR
              0     040  000  C1920   N    N    ENGLISH
              1     0C1  001  P1920   N    N    ENGLISH

      CUN   CUADR  CID  #DEV
       0     0C1   001     2



Page 78               PBTERS.DOC







TBOM13                                         July 22, 1988



            DEV    DADR  DID  DTYP   COL  XPR   CHAR
              2     040  002  C1920   N    N    ENGLISH
              3     0C1  003  P1920   N    N    ENGLISH

LINE  LADR  LID  #CU    HOST
  1   0C1    01    2    IBM

      CUN   CUADR  CID  #DEV
       2     040   001     3

            DEV    DADR  DID  DTYP   COL  XPR   CHAR
              4     040  004  C1920   Y    N    ENGLISH
              5     0C1  005  C1920   N    N    ENGLISH
              6     0C2  006  P2560   N    N    ENGLISH

      CUN   CUADR  CID  #DEV
       3     0C1   003     2

            DEV    DADR  DID  DTYP   COL  XPR   CHAR
              7     040  007  C3440   N    N    ENGLISH
              8     0C1  008  C1920   N    N    ENGLISH

LINE  LADR  LID  #CU    HOST
  2   0C2    02    2    IBM

      CUN   CUADR  CID  #DEV
       4     040   004     3

            DEV    DADR  DID  DTYP   COL  XPR   CHAR
              9     040  009  C1920   Y    N    ENGLISH
             10     0C1  010  C1920   N    N    ENGLISH
             11     0C2  011  P2560   N    N    ENGLISH






















Page 79               PBTERS.DOC







TBOM13                                         July 22, 1988



2.4.2  QUERY/CHANGE REPORT TO SUPERVISOR'S LOG

Syntax : SUPLOG [YES/NO]


The Query/Change Report To Supervisor's Log command causes PBT to
turn  off/on  the  report  to  the  Supervisor's log. This report
informs the Supervisor of the activities  in  the  slot.  SUPLOG,
followed  by the NO argument, terminates the process: If followed
by the YES argument, it begins the process. The  user  can  query
the  action  by  issuing  SUPLOG without an argument. The default
action reports to the Supervisor's log.


2.5  QUEUE PROCESSOR

This section describes the commands that  stop  data  processing,
examine this data, and then release it for processing.

There are four queues in the terminal interface.  These  are  the
Input  Queue  (IN  Q), Transmit Queue (XMT Q), Receive Queue (RCV
Q), and Output Queue (OUT Q). These queues pass control and  data
messages between the Foreground (F/G) and Background (B/G).


         -------------------------------------------------------
        |                                                       |
 ---    |                                                       |
| C |   |                                                       |
| O |   |        -------           -------           -------    |
| N | --|-----> | RCV Q | ------> | OUT Q | ------> | ORING | --|->  N
| T |   |        -------           -------           -------    |    E
| R |   |                                                       |    T
| O |   |                                                       |    W
| L |   |                                                       |    O
|   |   |                                                       |    R
| U |   |        -------           ------           -------     |    K
| N | <-|------ | XMT Q | <------ | IN Q | <------- | IRING | <-|--
| I |   |        -------           ------           -------     |
| T |   |                                                       |
 ---    |                                                       |
        |                                                       |
        |                                                       |
         -------------------------------------------------------


When data is received from the control unit, F/G places it in the
RCV  Q where it is scanned and processed by the PBT's B/G. If the
input concerns the Network  Service  Screen,  some  data  may  be
generated  by the PBT's B/G and placed into the XMT Q so that F/G
can send it to the control unit.



Page 80               PBTERS.DOC







TBOM13                                         July 22, 1988



If the input is for the host, then the data is passed to the  OUT
Q  and converted into a DSP message in the B/G to be delivered to
the host interface.

When the host sends a command message to the host  interface,  it
arrives  from the network in the Input Ring (IRING) of the PBT in
DSP format.  The DSP message  decoder  either  acts  on  the  DSP
control   message  or  converts  the  DSP  data  message  into  a
bisynchronous format. It then places it in the IN Q, where it  is
passed  to  the  XMT  Q.  The  XMT  Q  then stores it until it is
transmitted to the control unit by the F/G.

The commands that control the queue processors are  described  in
the remainder of this section.

2.5.1  INPUT QUEUE

The commands that control the Input Queue processor are described
in this section.

2.5.1.1  Stop IN Q Process Command

Syntax : STOPIN dvn or STOPIN lna cua dva


The Stop IN Q Process command stops the IN Q processor,  so  that
data coming from the network or generated by the PBT is not moved
to the transmit queue to be transmitted.


2.5.1.2  Query Data on IN Q Command

Syntax : QINQ


The Query Data On IN Q command displays the contents of the IN  Q
for the device specified by the Stop IN Q Processcommand.

The format of the display is as follows:

BUFADR      CONTENTS
xxxxx  xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx
xxxxx  xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx

In the above display, BUFADR is the buffer address in memory from
which  the data is read. For the IN Q and XMT Q, the data that is
displayed does not conform to the  format  of  actual  data  read
directly  from memory. The output of this command is formatted so
that the data is not in reversed  Extended  Binary-Coded  Decimal
Interchange Code (EBCDIC).




Page 81               PBTERS.DOC







TBOM13                                         July 22, 1988



2.5.1.3  Start IN Q Process Command

Syntax : STARTIN


The Start IN Q Process command starts the processing of the IN  Q
for  the  device  stopped  by  the Stop IN Q Process command. The
terminal  resumes  normal  operations  after  the  processor   is
reactivated.













































Page 82               PBTERS.DOC







TBOM13                                         July 22, 1988



2.5.2  TRANSMIT QUEUE

The  commands  that  contol  the  Transmit  Queue  processor  are
described in this section

2.5.2.1  Stop XMT Q Process Command

Syntax : STOPXMT dvn or STOPXMT lna,cua,dva


The Stop XMT Q Process command  stops  the  XMT  Q  scanner  from
processing the data in the XMT Q for the specified device. If any
data remains in the queue it is not sent  to  the  control  unit.
This  command  may  interfere  with  the  normal operation of the
Bisync line. Sync (SYN) insertions or Temporary Text Delay  (TTD)
could  be  generated  by  the  PBT  F/G  until  more data is made
available from the B/G by the Start XMT Q Process command.

2.5.2.2  Query Data on XMT Q Command

Syntax : QXMTQ


The Query Data On XMT Q command queries and displays data on  the
XMT  Q  captured by executing the Stop XMT Q Process command on a
device.

The output is displayed as follows:

BUFADR      CONTENTS
xxxxx  xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx
xxxxx  xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx

In the above display, BUFADR is  the  buffer  address  where  the
contents  of  the  XMT  Q  are  stored for display. The output is
displayed in EBCDIC format: not in reversed EBCDIC format as data
is  normally  formatted  in  memory.  For  control  messages, the
output's format differs from the format shown  above.  The  words
CONTROL  MESSAGE  appear before the message itself. The codes for
the Query Data On XMT Q command are as follows:


   o   FFF9 - sense/status message (SS0/SS1 follows)
   o   FFFF - disconnect
   o   FFFE - record time
   o   FFFD - Yellow Ball
   o   FFFC - Orange Ball
   o   FFFB - send EOT
   o   FFFA - error
   o   FFF8 - Acknowledgement




Page 83               PBTERS.DOC







TBOM13                                         July 22, 1988



2.5.2.3  Start XMT Q Process Command

Syntax : STARTXMT


The Start XMT Q Process command restarts the XMT Q  scanner.  The
scanner  processes  XMT  Q  data  for  the  device  stopped  from
transmitting to the host by the Stop XMT Q Process command.  This
command  causes  terminal  operation to resume, if the Stop RCV Q
command is not executed yet.












































Page 84               PBTERS.DOC







TBOM13                                         July 22, 1988



2.5.3  RECEIVE QUEUE

The  commands  that  control  the  Receive  Queue  processor  are
described in this section.


2.5.3.1  Stop RCV Q Process Command

Syntax : STOPRCV dvn or STOPRCV lna,cua,dva


The Stop RCV Q Process command  stops  the  RCV  Q  scanner  from
processing  the data in the queue for the device specified by the
argument. Data captured on the queue is output from the host.  It
remains in the queue while the Start RCV Q Process command is not
executed. The captured data can be examined by the Query Data  On
RCV  Q  command.  Once the Stop RCV Q Process command is executed
and is in effect, the keyboard remains locked. (It remains locked
while the process is stopped and not processed by the host.)

2.5.3.2  Query Data On RCV Q Command

Syntax : QRCVQ


The Query Data on RCV Q command queries and displays data in  the
RCV  Q  captured by executing the Stop RCV Q Process command on a
device.

The output is displayed as follows:

BUFADR      CONTENTS
xxxxx  xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx
xxxxx  xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx xxxx


In the above display, BUFADR is the buffer  address  storing  the
contents  of the RCV Q that is to be displayed. The format of the
data output is the same as the format of the data in memory (that
is EBCDIC format).  The format of the output for control messages
differs from that shown above; the words CONTROL  MESSAGE  appear
before  the message itself. The codes for the Query Data On RCV Q
command are as follows:



   o   FFF9 - sense/status  message(SS0/SS1 follows)
   o   FFFF - disconnect
   o   FFFE - record time
   o   FFFD - Yellow Ball
   o   FFFC - Orange Ball



Page 85               PBTERS.DOC







TBOM13                                         July 22, 1988



   o   FFFB - Send EOT
   o   FFFA - error
   o   FFF8 - Acknowledgement



2.5.3.3  Start RCV Q Process Command

Syntax : STARTRCV


The START RCV Q  Process  command  restarts  the  RCV  Q  scanner
processing data stored in the queue. Data processing is restarted
the device stopped from transmitting to the terminal by the  Stop
RCV  Q  Process  command.  The Start RCV Q Process command causes
terminal operations to resume, providing the Stop XMT  Q  command
is not in effect.

2.5.4  OUTPUT QUEUE

The  commands  that  control  the  Output  Queue  processor   are
described in this section.

2.5.4.1  Stop Output Q Process Command

Syntax : STOPOUT dvn or STOPOUT lna cua dva


The Stop Output Q Process  command  stops  the  OUT  Q;  data  is
stopped and does not pass into the network from the control unit.
Once this command is executed, the keyboard appears  locked,  and
user data is preserved in memory for examination.

2.5.4.2  Query Data on OUT Q Command

Syntax : QOUTQ

See the Query Data On OUT Q Command.

2.5.4.3  Start OUT Q Process Command

Syntax : STARTOUT

See the Start RCV Q Process command.










Page 86               PBTERS.DOC







TBOM13                                         July 22, 1988



2.6  SYSTEM GENERATIONS

This section describes the additional macros needed to  configure
new enhancements for the PBT slot.

2.6.1  DEFINE RETRY LIMIT FOR LINE MACRO

Syntax : DEFRTY(n)

Default : 8 retries


This macro defines the maximum number of retries (n, in  decimal)
allowed  before  the  line  is  considered  bad. When the line is
considered bad, a report is made to the Supervisor.  If  enabled,
the Display Systems Protocol (DSP) error message is also reported
to  the  Host  Packet  Assembly/Disassembly  (HPAD).  The  number
defined  by  the  macro applies to the line being configured, and
other lines, if not changed by the Retry macro.

2.6.2  CHANGE RETRY LIMIT FOR LINE MACRO

Syntax : BRETRY(n)

This macro changes the maximum number of retries (n, in  decimal)
for  the  line  being  configured. This macro does not affect the
default number as defined by the  Define  Retry  Limit  For  Line
macro.

2.6.3  DEFINE REAL TIME DISPLAY INTERVAL MACRO

Syntax : DSPTIM(n)

Default : 10 minutes (in decimal)

This macro defines the time interval for the real-time display of
node, slot, and time information. The time is measured in seconds
(or minutes).


2.6.4  DEFINE DSP ERROR REPORT TO HPAD MACRO

Syntax : DSPERR(YES/NO)

Default : YES

This macro defines whether DSP error messages are reported to the
HPAD.  They  are  reported  when  error  conditions  are detected
between the terminal interface and the control unit.





Page 87               PBTERS.DOC







TBOM13                                         July 22, 1988



2.7  TRACE FUNCTIONS


This section  describes  the  commands  that  control  the  trace
functions  and  provide status information. Status information is
provided about traces of data flow, response time, and protocol.

Each trace has a duration that is both defaulted in the code  and
can  be explicitly stated when the trace is enabled (m represents
the duration of  the  trace  in  the  command  syntax).   If  the
duration  is  not  specified,  the default duration is used.  The
default can be changed by setting a label equal to a value in the
Tymfile.    The   appropriate   label  is  given  in  each  trace
description.  The maximum default value must fit in  a  half-word
and  be  equivalent  to  less than seven days.  All of the traces
degrade the efficiency of the system.

As an example, the default value (m) for the time  stamp  can  be
changed  by  setting  the  value  of STMPTM equal to the  desired
number of seconds in the Tymfile as follows:

                STMPTM  EQ      $A30

The example shown above sets the default value (m)  equal  to  30
seconds.




2.7.1  ENABLE CHARACTER PER SECOND TRACE COMMAND


Syntax: ECPS ll,m

Default duration: 60 minutes Label: CPSTM

This command enables the character/second test  for  the  next  m
minutes,  where ll is the specified line.  The value of ll can be
the line address, relative line number, or  the  user-defined  ID
(depending  on  the  current  mode). If no line is specified, the
character per second trace is enabled for the entire slot.  If  m
(the  number  of  minutes)  is  not specified, the test continues
either for the default duration or until halted  by  the  Display
Character  Per  Second  Trace  command  or  the  Disable command;
otherwise, the slot is restarted.

The character count, in Native mode or   Virtual  Terminal  mode,
includes  all  characters transferred across the Bisync line from
the Start of Text (STX) to the End of Transmission Block (ETB) or
End  of Text (ETX).  Leading sync characters, pad characters, and
the checksum are not included in the count.



Page 88               PBTERS.DOC







TBOM13                                         July 22, 1988



The character count does  not  include  data  transferred  during
login.  It also does not include messages originating at the 3270
Terminal Interface and transmitted to the terminal.



2.7.2  DISPLAY CHARACTER PER SECOND TRACE COMMAND


Syntax: DCPS

This  command   halts   and   displays   the   results   of   the
Character/Second  Test.  This test computes the average number of
characters per second throughput by the slot. The format  of  the
output is displayed as follows:
TBOM -- 3270PBT Bisync Operations Monitor
NODE  nnnn    SLOT  ss   ddmmmyy hh:mm:ss

LINE xx        DUR(min)
(ENTIRE SLOT)

CHARS/SEC xxxx    TOTAL CHARS xxxx    PER hh:mm:ss

This display is interpreted as follows:

LINE xx    -  The line on which the throughput is measured (per the
              current mode), or entire slot (if no line was specified).

DUR(min)   -  The duration of the trace, if not halted by the Display
              Charater Per Second Trace command or Disable command.

CHARS/SEC  -  The number of characters per second throughput by the
              slot or the specified line.

TOTAL CHARS - The total number of characters throughput by the line or
              slot for the specified period.

PER         - The amount of time the trace ran, in the "hours:min:sec"
              format.


2.7.3  ENABLE POLL RESPONSE TRACE COMMAND


Syntax:  EPR ll,cc,m

Default duration: 60 minutes Label: PRTM

This command enables the poll  response  trace  for  the  next  m
minutes;  where ll is the line, and cc is the control unit.  This
trace measures the average poll response time for  the  specified



Page 89               PBTERS.DOC







TBOM13                                         July 22, 1988



control  unit.   If  no  line  is  specified the poll response is
measured for all control units in the slot.   If  the  number  of
minutes (m), is not specified, the trace continues either for the
default duration or until halted by  the  Display  Poll  Response
Trace  command  or  the  Disable  command;  otherwise the slot is
restarted.

The line and control unit number can  be  the  line/control  unit
address,  the  line/control unit ID, or the relative control unit
number (which may be entered by  itself).  This  depends  on  the
state of the Mode command.

The Poll Response Trace Test keeps track only of  the  successful
polls.   If  the  control  unit does not respond, the time is not
accumulated and the poll is not used  in  computing  the  average
response time.






































Page 90               PBTERS.DOC







TBOM13                                         July 22, 1988



2.7.4  DISPLAY POLL RESPONSE TRACE COMMAND


Syntax:  DPR

This command halts and displays the results of the Poll  Response
Trace  Test. This test computes the average poll response for the
specified control unit. The format of the output is displayed  as
follows:

TBOM -- 3270PBT Bisync Operations Monitor
NODE  nnnn    SLOT  ss   ddmmmyy hh:mm:ss

CU xx    DUR(min) xx
(SLOT)

RESP(ms) xxx    POLLS xxxx    PER xx
This display is interpreted as follows:

CU    -   Control unit number (per the current mode).

DUR(min) The duration of the trace, if not halted by the  Display
Poll Response Trace command or Disable command.

RESP  -   Average poll response time (in milliseconds).

POLLS -   Number of poll responses in the period.

PER   -   The amount of time the trace ran, in the "hour:min:sec"
format.


2.7.5  ENABLE TINE STAMP TRACE COMMAND


Syntax: ESTAMP ll,cc,dd,m

Default duration: 5 minutes Label: STMPTM

The Enable Time Stamp Trace command enables the time stamp  trace
for  each  transaction  of  the  specified  device for the next m
minutes; where ll,cc, or dd is  the  specified  device  (per  the
current  mode). If m is not specified, the trace continues either
for the default duration or until  halted  by  the  Display  Time
Stamp   command   or  Disable  command;  otherwise  the  slot  is
restarted.

NOTE: This command is not valid for a device operating in Virtual
mode.





Page 91               PBTERS.DOC







TBOM13                                         July 22, 1988



2.7.6  DISPLAY TIME STAMP COMMAND


Syntax: DSTAMP

This command halts and displays the time stamp trace for the last
two  transactions of the specified device.  The time stamp values
are in Fast Clock (FASTC). FASTC, the system clock, is a  32  bit
value  that is incremented at a rate of 600 times per second. The
format of the output is displayed as follows:

TBOM -- 3270PBT Bisync Operations Monitor
NODE  nnnn    SLOT  ss   ddmmmyy hh:mm:ss

DUR(min) xx    PER hh:mm:ss

DEVxx   PORT NUMBER xx

                  LAST        PRIOR

RCV STX         xxxxxxxx    xxxxxxxx
RCV ETX         xxxxxxxx    xxxxxxxx
STX ORING       xxxxxxxx    xxxxxxxx
ETX ORING       xxxxxxxx    xxxxxxxx
STX IRING       xxxxxxxx    xxxxxxxx
ETX IRING       xxxxxxxx    xxxxxxxx
XMT SELECT      xxxxxxxx    xxxxxxxx
XMT STX         xxxxxxxx    xxxxxxxx
XMT ETX         xxxxxxxx    xxxxxxxx
XMT COMPLETE    xxxxxxxx    xxxxxxxx
DELAY(ms)       xxxx        xxxx

In the above display, the column labeled LAST is the time stamp for the
most recent transaction; the column labeled PRIOR is the transaction
that precedes the most recent transaction. The preceding display is
interpreted as follows:

DUR(min)    -   The duration (in minutes) of the trace, if not halted
                by the Display Time Stamp command or Disable command.

PER         -   The amount of time the trace ran, in the "hour:min:sec"
                format.

DEV         -   The device being traced (per the current mode).

PORT NUMBER -   The dispatcher port number that is associated with the
                device being traced.

RCV STX     -   Receive Start of Text (STX) of the incoming message by
                the Foreground.




Page 92               PBTERS.DOC







TBOM13                                         July 22, 1988



RCV ETX     -   Receive End of Text (ETX) of the incoming message by
                the Foreground.

STX ORING   -   The STX of an incoming message put into the Output Ring
                (ORING) by the Background.

ETX ORNG    -   The ETX of an incoming message put into the ORING by
                the Background.

STX IRING   -   The STX of an outgoing message read from the IRING by
                the Background.

ETX IRING   -   The ETX of an outgoing message read from the IRING by
                the Background.

XMT SELECT  -   The select is transmitted.

XMT STX     -   Transmit STX of an outgoing message to the terminal by
                the Foreground.

XMT ETX     -   Transmit ETX of an outgoing message to the terminal by
                the Foreground.

XMT COMPLETE -  Transmission is complete.

DELAY        -  Round trip delay, measured from the receipt of the STX
                to the transmission of STX (in milliseconds).


2.7.7  ENABLE RESPONSE TRACE COMMAND


Syntax: EREST ll,cc,dd,m

Default duration: 60 minutes

Label: RESTM

This command enables the Response Time  Test  for  the  specified
device for the next (m) minutes; where ll,cc, or dd is the device
number (per the  current  mode).  If  m  is  not  specified,  the
Response Time Test continues until one of the following occurs:

   o  the 60-minute default duration

   o  the Display Response Trace command is issued

   o  the Disable command is issued

   o  the slot is restarted




Page 93               PBTERS.DOC







TBOM13                                         July 22, 1988



This test records the receipt of the STX of an  incoming  message
by  the Foreground and the transmission of the STX of the message
to the terminal by the Foreground. The difference  between  these
two times is the response time for a given message.

The response  time  measurements  are  valid  only  for  messages
initiated  by  the  terminal;  they  are  not  valid for messages
initiated by the host.

NOTE:

The Enable Response Trace command  is  not  valid  for  a  device
operating in Virtual mode.



2.7.8  DISPLAY RESPONSE TRACE COMMAND


Syntax: DREST

This command halts the trace and displays  the  average  response
time  per  transaction (in milliseconds) for the period specified
by the Enable Response Trace command. The format of the output is
displayed as follows:
TBOM -- 3270PBT Bisync Operations Monitor
NODE  nnnn    SLOT  ss   ddmmmyy hh:mm:ss

DEV xx     DUR(min)

RESP AVE xxx    RESP # xxx    PER xxx
This display is interpreted as follows:

DEV       -     The specified  device  number  (per  the  current
mode).

DUR(min) - The duration of  the  trace  (if  not  halted  by  the
Display Response Trace command or Disable command).

RESP AVE  -     The average response time (in milliseconds).

RESP #    -     The number of transactions within the period.

PER       -     The duration of the trace (in minutes).










Page 94               PBTERS.DOC







TBOM13                                         July 22, 1988



2.7.9  ENABLE PROTOCOL TRACE COMMAND


Syntax: EPROT ll,m

Default duration: 10 minutes

Label: PROTTM

This command enables the protocol trace for  the  specified  line
for  the  next (m) minutes, where ll is the specified line number
(per the current mode). If m is not  specified,  the  trace  runs
until one of the following occurs:

   o  10 minutes (the default duration)

   o  the Display Protocol Trace command is issued

   o  the Disable command is issued

   o  the slot is restarted

































Page 95               PBTERS.DOC







TBOM13                                         July 22, 1988



2.7.10  DISPLAY PROTOCOL TRACE COMMAND


Syntax: DPROT

This command displays the protocol trace for the specified  line.
The protocol sequence is displayed as the interface processed it.
The format of the output is displayed as follows:

TBOM -- 3270PBT Bisync Operation Monitor
NODE  nnnn    SLOT  ss   ddmmmyy hh:mm:ss

LINE xx    DUR(min) xx    PER  hh:mm:ss

XMT:  DATA      RCV:  ACK0      SXEL
XMT:  DATA      RCV:  ACK1      SXMT
XMT:  EOT
This display is interpreted as follows:

LINE - Line number specified by Enable  Protocol  Trace  command,
(per the current mode).

DUR(min) - The duration (in minutes)of the trace, if  not  halted
by the Display Protocol Trace command or Disable command.

PER   -   The amount of time the trace ran in the  "hour:min:sec"
format.

XMT:  -   Transmit protocol (DATA,  ENQ,  EOT,  NAK,  TTD,  ACK1,
WACK, ACK0, RVI, or DISC)

RCV:  -   Receive protocol (Good Data ETX Block,  Good  Data  ETB
Block,  ENQ,  EOT,  NAK, DISC, ACK1, WACK, ACK0, RVI, TTD, Multi-
leaving ?, Data Abort, Lost Synchronization, Overrun, No  Initial
Bufferlet  Available,  Timeout Before Message Received, CRC Error
In Data Message, Lost Data Due to Unavailability  of  Bufferlets,
Unidentifiable Message, Forced Completion by Background).

xxxx  -   State table pointer for the preceding protocol sequence
(add  10000  hexadecimal to the value to yield the address of the
state table.

The following are examples of the descriptive words and meanings:

 o  SXSEL  - Waiting for response to the select poll sent by the PBT.

 o  SRINIT - We have sent either a general or specific poll message.
             We are expecting a response from the control unit.

 o  SRWACK - PBT's receiver is waiting for internal resources, and has
             sent WACKS to the control unit telling it to wait for a



Page 96               PBTERS.DOC







TBOM13                                         July 22, 1988



             positive acknowledgement before sending more data.

 o SRCV    - The control unit has sent 1st data block.  This state
             handles the reception of subsequent data blocks.

 o SXMT    - We have control of line(control unit acknowledged the
             select poll) and have sent a data block to the control
             unit.

 o SENQ    - Waiting for response to an abort message (ENQ) that was
             sent by the PBT.

 o SXTTD   - Waiting for response to a TTD (STX ENQ) that was sent by
             the PBT.


2.8  ENABLE DATA TRACE COMMAND


Syntax: EDAT ll,cc,dd,m

Default duration: 10 minutes

Label: DATTM

This command enables the data trace for the specified device  for
the  next  (m)  minutes;  where ll,cc, or dd is the device number
(per the current mode). The transmit and receive data is  traced.
Up  to the first ten characters of the message block, and the ETB
or ETX are saved. If the number of minutes is not specified,  the
trace  continues for the default duration, until the Display Data
Trace command is issued, until the Disable command is issued,  or
until the slot is restarted.

NOTE:

The Enable Data Trace command is not valid for a device operating
in Virtual mode.



2.8.1  DISPLAY DATA TRACE COMMAND


Syntax: DDAT

This command disables and displays the transmit data  trace.  For
the  standard  3270  Terminal Interface, the data is displayed in
EBCDIC. For  the  HSBC  3270  Terminal  Interface,  the  data  is
displayed  in  ASCII.  The  format  of the out[ut is displayed as
follows:



Page 97               PBTERS.DOC







TBOM13                                         July 22, 1988



TBOM -- 3270PBT Bisync Operations Monitor
NODE  nnnn    SLOT  ss   ddmmmyy hh:mm:ss

DEV  xx    DUR(min)  xx    PER  hh:mm:ss

XMT:  02xx xxxx xxxx xxxx xx03
RCV:  02xx xxxx xxxx xxxx xx03
XMT:  02xx xxxx xxxx xxxx xx03
This display is interpreted as follows:

DEV   -   The specified device number (per the current mode).

DUR(min) - The duration (in minutes) of the trace, if not  halted
by the Display Data Trace command or Disable command.

PER   -   The amount of time the trace ran, in the "hour:min:sec"
format.

XMT: -   The  first  ten  data  bytes  transmitted  to  terminal,
followed by ETB or ETX.

RCV:  -   The  first  ten  data  bytes  received  from  terminal,
followed by ETB or ETX.


2.8.2  DISABLE TRACE COMMAND


Syntax: DISABLE

The Disable command disables all enabled traces.



2.9  RING TRACE COMMANDS



This section describes the commands used to trace either or  both
of  the  Input and Output Rings between the slot and the network.
Placing the following statement in  the  Tymfile  determines  the
availability of the trace commands as follows:

RNGTRC EQ       1                    :1  =  Ring  Trace  Commands
available

If the preceding statement is not  used,  the  commands  are  not
available.

The output of the traces moves along with  the  events,  as  they
individually  come  in  or go out of the slot. Input Ring (IRING)



Page 98               PBTERS.DOC







TBOM13                                         July 22, 1988



and Output Ring (ORING) output is not related.

The format of the output of the ring trace commands  is  similar,
except  for  the  designation  of  the  Input or Output Ring. The
following is a sample output:

O 20004 RQR 0000 00
I 20508 DAT 001C 09C0 9480 0004 0012 C240  |...@......B@|
O 2000C HSR 0000 1000 12F7 001C 0000 0000 8034
I 20514 SIX 001C BF
O 2001C HSR 0000 1000 12F7 001C 0000 0000 8034
I 20518 DAT 001C 0CC0 9400 0007 0000 007D C150 03  |...@.......}AP. |
I 20538 NOS 001C A0
O 2007C HSR 0000 1000 12F7 001C 0000 0000 8034
I 2053C SND 001C A1
O 2008C HSR 0000 1000 12F7 001C 0000 0000 8034
I 20540 SIX 001C BF
I 20544 DAT 001C 0CC0 9400 0007 0000 017D C150 03  |...@.......}AP. |
I 20564 SIX 001C BF
I 20568 DAT 001C 0CC0 9400 0007 0000 027D C150 03  |...@.......}AP. |
The first character of the preceding output indicates whether the
trace  is that of an Input or Output Ring. The second field, a 5-
digit number, is the ring address where the message is read.  The
third  field  is an abbreviation of the ISIS message type. The 4-
digit number that follows the ISIS  message  type  is  the  RPORT
number  assigned  by  the dispatcher if a circuit has been built;
otherwise, a port 0 message is output. The first  2  bytes  after
the  RPORT  is  the  inter/intra message type defined in the ISIS
manual.  If a data message is found, the entire message indicated
by  the  count  is displayed. The last field of the data message,
enclosed by bars, is a translation of the data message  contents;
it is interpreted in ASCII.

Once a ring trace command  is  entered,  output  continues  until
another  character  is  entered.   The  backslash "/" is the best
character to use to halt the output.  If  the  backslash  is  not
used,  the commands continue to output the ring trace as the ring
indices are updated within the slot.

The ISIS message abbreviations are interpreted as follows:

        NDL  -  NEEDLE
        DAT  -  DATA
        DET  -  DETACH MESSAGE TYPE
        ZAP  -  DISCONNECT MESSAGE
        NOS  -  APPLY BACK-PRESSURE (NO SEND)
        SND  -  RELEASE BACK-PRESSURE (SEND)
        ICM  -  FLUSH OUTPUT (GOBBLER)
        BKG  -  FLUSH INPUT (BACK GOBBLER)
        BLK  -  DATA LOST IN THIS DIRECTION (BLACK BALL)
        GRY  -  DATA LOST IN OPPOSITE DIRECTION (GREY BALL)



Page 99               PBTERS.DOC







TBOM13                                         July 22, 1988



        EDE  -  ENTER DEFERED ECHO MESSAGE
        LDE  -  LEAVE DEFERED ECHO MESSAGE
        ETM  -  ENTER TRANSPARENCY MODE
        LTM  -  LEAVE TRANSPARENCY MODE
        GB   -  GREEN BALL
        RB   -  RED BALL
        YB   -  YELLOW BALL
        OB   -  ORANGE BALL
        BRK  -  BREAK DETECTED
        HNG  -  HANG UP
        QTP  -  QUERY TERMINAL PARAMETER
        STP  -  SET TERMINAL PARAMETER
        PSN  -  PSEUDO NEEDLE
        NLC  -  NORMAL LOGON CHAR
        NLS  -  NORMAL LOGON STATUS
        LOF  -  LOG ON FAILURE
        NCC  -  NORMAL CIRCUIT COMPLETE
        ADA  -  ADDENDUM TO ACCOUNTING
        SHG  -  SUPER-HANG UP
        TLM  -  SET TRANSMIT LIMIT
        EBK  -  END OF BREAK
        ZAK  -  ZAP ACK
        EAD  -  ENTER ALTERNATE OUTPUT DEVICE MODE
        LAD  -  LEAVE ALTERNATE OUTPUT DEVICE MODE
        ZAR  -  ZAP WITH REASON
        SIX  -  START INTERFACE INFORMATION EXCHANGE
        TIX  -  TERMINATE INTERFACE INFORMATION EXCHANGE
        RQR  -  RESTART REQUEST
        RST  -  RESTART INTERFACE
        NTO  -  NODE HAS BEEN TAKEN OVER
        REP  -  REPORT TO SUPERVISOR'S LOG
        RHS  -  REPORT HOST STATUS (OBSOLETE)
        RAC  -  REPORT ACCOUNTING
        TIM  -  GMT TIME
        RNP  -  REQUEST FOR NORMAL PSEUDO NEEDLE
        RAP  -  REQUEST AUX PSEUDO-NEEDLE
        PSR  -  PSEUDO-NEEDLE REJECTED
        HPA  -  HOST PORT AVAILABILITY
        HNA  -  HOST NOT ACCEPTABLE
        RHC  -  REPORT HOST COST
        NSU  -  NO SUPERVISOR
        ODN  -  1-DOWN TEXT
        RAH  -  REPORT ALL HOSTS
        HSR  -  HOST STATUS REPORT










Page 100              PBTERS.DOC







TBOM13                                         July 22, 1988



2.9.1  TRACE IRING COMMAND


Syntax : DIR adr

This command traces the IRING from the address indicated. If  the
address  is  not  given,  the  entire IRING is displayed from the
beginning up to where the indices stop.



2.9.2  TRACE ORING COMMAND


Syntax : DOR adr

This command displays the ORING from  the  address  indicated  to
where  the  indices  stop.  If  the address is not specified, the
entire ORING is displayed.



2.9.3  TRACE IRING AND ORING COMMAND


Syntax : DR

This command starts the trace of the  rings  from  the  beginning
address  to  the current pointer. The output displayed alternates
before the ORING and IRING messages.


2.9.4  TRACE IRING AND ORING BY RPORT COMMAND


Syntax : DRA

This command starts the trace of the  rings  from  the  beginning
address  of  the  IRING  and  ORING.   The command displays ORING
output until the RPORT number changes.  IT  then  displays  IRING
output  until  the  RPORT  number  changes.  The output displayed
continues to alternate as the RPORT numbers change.



2.9.5  MODIFY TYMFILE PARAMETERS ON LINE


These commands are allowed only after entering the CHPR  subfield
and  responding  to  the proper password as defined in the slot's
tymfile.  The commands which allow the  modification  of  tymfile



Page 101              PBTERS.DOC







TBOM13                                         July 22, 1988



parameters require that these devices not be in the active state.
The state for devices must be IDLE.  Parameter must match current
existing   parameter  in  the  slot.  Warning  messages  will  be
displayed if error conditions exist. The  MODE  must  be  address
(adr).


2.9.5.1  Modify Control Unit Address


Syntax: MCU LL,OLD-CC,NEW-CC

LL is the line address, OLD-CC is the old control  unit  address,
NEW-CC  is the hex control unit address which will take the place
of the existing control unit address.


The MCU command allows you  to  change  the  hex  address  of  an
existing  control  unit  address to another valid address control
unit address.  Duplicate control unit addresses attached  to  the
same line are not valid.

Example:

  MCU 0C1,40,0C2

Control unit address 40 on line 0C1 is being changed to 0C2.


2.9.5.2  Modify Device Address


Syntax: MDEV LL,CC,OLD-DD,NEW-DD

LL is the line address, CC is the control unit address OLD-DD  is
the  old  device  address, NEW-DD is the hex device address which
will take the place of the existing device address.

The MDEV command allows you to  change  the  hex  address  of  an
existing   device   address  to  another  valid  device  address.
Duplicate device addresses attached to the same control unit  are
not valid.

Example:

        MDEV 0C1,40,0C2,0C4

Device 0C2 on control unit  address  40  on  line  0C1  is  being
changed to 0C4





Page 102              PBTERS.DOC







TBOM13                                         July 22, 1988



2.9.5.3  Modify an Existing Logon String


Syntax: MLST


This command will modify the  existing  logon  strings  username,
host number, and password.


username :      The new one provided by the command will replace the
                existing one.
host number :   The destination host number will be changed for the
                current username.
password :      The password will be changed for the current username.

The user in a question and answer format is guided thru the
process of updating the logon string.


                -Please, enter old username:
                -Does it have a home host (y/n)? :
                -Please, enter old host number:
                -Please, enter new user name:
                -Does it have a home host (y/n)? :
                -Does it have a password (y/n)? :
                -Please, enter new host number:
                -Please, enter new password :
                -Please, enter it again :

Satisfactory completion results in a return to prompt command
in bom.

Notes:

      . The Password will not be echoed at the terminal.
      . The character set  authorized in a new login
        string is the same  permitted in the Tymfile.
      . The user is allowed to change a home hosted logon
        string to a non-home hosted string and to do the
        reverse function.




2.9.5.4  Modify an Existing Logon String Label


Syntax: MLAB

This commmand allows the changing of the descriptive label in the



Page 103              PBTERS.DOC







TBOM13                                         July 22, 1988



logon  statement  LOGSTR.  The old label must be defined before a
new label can be defined. The change is done in  a  question  and
answer  format.  The  new  label  length must equal the old label
length. No error message is indicated but the length is truncated
to the length of the old label.


        -Please, enter old logon string label:

        -Please, enter new logon string label:

  Note :

    The length of the new label must not exceed the previous one.


Example:

        please, enter old logon string label:TO HOST SNA

        please, enter new logon string label:TO BSC HOST

Note:

     The new label length must be less than or equal to  the  old
label length.


2.9.6  INTRODUCTION INTO BERT'S FUNCTIONS

This GED describes the specifications  for  the  enhancements  of
doing  Bit  Error  Rate  Testing  via  the  3270 Bisync Operation
Monitor.


The implemented BERT testing  is  compatible  with  the  existing
stand  alone sync line diagnostic package SLSYNC.  There are some
differences in the procedures and in  the  enviroment  where  the
utility is run.  The implemented BERT can co-exist with the other
lines that are not under  testing,  and  are  running  under  BSC
protocol.

Some notations are explained as follows.  In the command  syntax,
the  characters enclosed in the parentheses are optional, and are
not required to complete the meaning of the command.  However, if
the  characters  are  to  be entered for the sake of clarity, the
exact word must be used.

For the parameter  fields,  brackets  are  used  to  enclose  the
optional  arguements.   For multiple brackets, the inner brackets
represent  those  parameters  that  are  optional  only  if   the



Page 104              PBTERS.DOC







TBOM13                                         July 22, 1988



parameter enclosed by the outer brackets is entered.

2.9.6.1  Support Considertions

There are BOM commands to monitor the daily  performance  of  the
line  connections;  QLINE  queries the hardware configurations of
the line, QCU checks the transmission and receiving status of the
connections  between  PBT and the control units.  CONF is used to
query the device configuration of the slot on each drop.

If QCU  command  shows  errors  either  in  transmit  or  receive
operations,  or  for preventive maintenance purpose, BERT testing
is recommended to exercise the transmission media for reliability
test.

In  the  implementation,  the  normal  BSC  activities  must   be
maintained  as  usual  for  those  lines  that are not under BERT
process.

The signals DTR/DSR and RTS/CTS should also be  manipulatable  so
as   to   test   the  functionalities  of  the  modems,  and  the
synchrounous   controller   on   the   Engine.    However,    the
manipulations are limited to the non-primitive lines(explained in
the test facilities section).   ISIS  ignores  any  requests  for
manipulations on the primitive lines.

2.9.6.1.1  _T_e_s_t__F_a_c_i_l_i_t_i_e_s

If the Bit Error Rate Testing is run on the  existing  line,  the
facilities required are already in place.

For new  installations,  the  testing  involves  the  synchronous
controller  on  the  Engine,  the local modem, the communications
links(ie. Telco lines), and the remote modem.

This test can also be run  with  the  local  loopback  test  plug
connected to the sync cable, which comes out of the engine's back
pannel.

The sync lines supported by the engine sync card can  be  grouped
in  two  categories.  There are 16 sync lines per sync card, four
sync lines constitues one sync group, four groups in all for  one
sync card.

The first  two  lines  in  each  sync  group  are  classified  as
primitive  ports, and do not support DTR/DSR or RTS/CTS handshake
signals.  The last two lines in  each  group  are  classified  as
non-primitive  ports,  and  these  lines  can  be  configured for
DTR/DSR and/or RTS/CTS handshake signals if desired.

For  the  HDLC-simulated  micro  engines,  all  the  sync   lines



Page 105              PBTERS.DOC







TBOM13                                         July 22, 1988



configured  for  the  node can support DTR/DSR, RTS/CTS handshake
signals.

2.9.6.1.2  _T_e_s_t__E_n_v_i_r_o_m_e_n_t

BERT testing requires the line be looped back to the Engine,  and
this  can  be  achieved  by  either  placing  the  local modem in
AL(Analog Loopback) or DL(Digital Loopback) mode, or  the  remote
modem in AL or DL mode.

The local loopback of the Engine is done by connecting a  special
loop back test plug provided by FE.


  ---
 |   |     -----------
 | T |----| TEST PLUG |
 |   |     -----------
 |   |                      _______
 | I |                     |       |
 |   |            DIGITAL  | LOCAL | ANALOG LOOP-BACK
 |   |---------------------|       |--------------------
 | F |           LOOP-BACK | MODEM |                    |
 |   |                     |_______|                    |
 |   |                                                  |
  ---                                                   |
                                                        |
                                                        |
                                                        |
                                                        |
        ---                                             |
       |   |                 ________                   |
       |   |                |        |                  |
       | C |       DIGITAL  | REMOTE |                  |
       |   |----------------|        |------------------
       | U |      LOOP-BACK | MODEM  | ANALOG LOOP-BACK
       |   |                |________|
       |   |
        ---


2.9.6.1.3  _T_e_s_t__P_a_t_t_e_r_n_s

Three test patterns are provided.  One, and  only  one  of  these
patterns  must be specified before the BERT testing is allowed to
be started.  This is a special pattern, as the name implies, that
the  pattern  does  not  repeat  until  2047  decimal bits.  This
alternating pattern is generated as continuous stream of 5's, and
the  beginning  of the data stream is synchronized on the pattern
3231.  User must, when selecting this  test  pattern  generation,
supply  a  4-byte data pattern for the BOM to deliver to the line



Page 106              PBTERS.DOC







TBOM13                                         July 22, 1988



for testing.

2.9.6.1.4  _T_e_s_t_i_n_g__P_r_o_c_e_d_u_r_e_s

To perform  BERT,  target  line  must  be  idle  with  no  active
terminals  in  sessions with the host.  Bom commands are provided
to query the online devices, and to send messages to the users on
which the line will be brought out of service.

Test pattern must be specified, as well as the selection  of  the
line with BOM commands.

Once the line is clear with no users, place the modems  in  loop-
back mode as desired.  Exercise the BERT testing commands in BOM,
and monitor the test results.

The BERT testing can be conducted from either the local  site  or
the  remote control unit site, this depends on the availablity of
personnell to access the modems or the DTE equiptments.

2.9.6.2  Bisync Operations Monitor Commands

2.9.6.2.1  _Q_u_e_r_y__A_v_a_i_l_a_b_l_e__B_E_R_T__C_o_m_m_a_n_d_s

Syntax : ?BERT

This command displays a list of the commands  available  for  Bit
Error Rate Testing.  Short descriptions will be made for usage of
each command.

2.9.6.2.2  _S_e_l_e_c_t__S_y_n_c__L_i_n_e__f_o_r__B_E_R_T

Syntax : SEL(ECT) lna or SEL(ECT) lnn

SELECT command selects the bisync line desired for the bit  error
rate  testing.  The devices on the line will all be affected when
conducting the test.  Normal BSC protocol will not be  maintained
by the TIF, and terminals will be disabled.


This command requires one arguement for the line  desired  to  be
tested.   Depending  on the mode setting, lna is the line address
while in ADR mode, and lnn is the line  number  for  USR  or  REL
mode.

This command can be entered as SEL or the full word  SELECT,  and
followed by the line identifier.

After selection of the line number, the only way  to  enable  the
terminals to resume normal BSC operations is to stop BERT testing
by executing the command STOPBERT.



Page 107              PBTERS.DOC







TBOM13                                         July 22, 1988



2.9.6.2.3  _S_e_l_e_c_t__B_E_R_T__T_e_s_t__P_a_t_t_e_r_n

Syntax : PATTERN n or PAT n

This command selects the test pattern that will be sent  out  for
the bit error rate calculation.

The range of n is from 1 to 3.  Pattern of  1  defines  the  2047
test  data  pattern.   PATTERN  2  selects  alternating test data
pattern.  PAT 3 spefifies that BOM operator wants to  supply  the
test pattern.

The generation of patterns have been  described  in  the  earlier
section,  and  other  patterns  selected  will  generate an error
message.

Patterns, once selected, will not be changed during the course of
the  BERT  testing.   To  change the test pattern, one must issue
PATTERN command again.

If there is already a BERT running, executing this  command  will
generate an error message.

For user supplied pattern, command sequence PATTERN 2,  FFFF  and
5555  are not recommended.  FFFF are the line padding characters,
and 5555 is the alternating  pattern  that  can  be  selected  by
PATTERN comand.


2.9.6.2.4  _T_u_r_n__O_n__D_a_t_a__T_e_r_m_i_n_a_l__R_e_a_d_y

Syntax : DTRON

This command turns on the Data Terminal Ready lead on  the  synch
line  selected  by the command SELECT.  The signal stays on until
DTROFF command is executed.

This command is not valid for primitive lines, these lines do not
support DTR/DSR nor RTS/CTS signals.

An Error message is displayed when no line has been  selected  by
the SELECT command, or the line selected is a primitive line.  If
BERT testing is running, the use of this command is not allowed.

Execution of this command before the ?DSR command enables the DSR
lead  to  be  monitored again by the operating system, otherwise,
executing ?DSR before this command displays  the  state  of  last
update done by the operating system.






Page 108              PBTERS.DOC







TBOM13                                         July 22, 1988



2.9.6.2.5  _Q_u_e_r_y__S_t_a_t_e__o_f__D_a_t_a__S_e_t__R_e_a_d_y

Syntax : ?DSR

This command queries status of the Data  Set  Ready  signal.   It
must  be  executed  after the above command DTRON, otherwise, the
state of DSR is undefined and only the  last  updated  status  is
displayed  when  the  operating  system is stopped by the command
SELECT.

Again, since primitive lines do not support DSR signal, executing
?DSR for those lines generates an error message.

As many as  ?DSR can be executed after the  DTRON  command,  this
enables BOM operator to monitor the DSR status periodically.

2.9.6.2.6  _T_u_r_n__O_f_f__D_a_t_a__T_e_r_m_i_n_a_l__R_e_a_d_y

Syntax : DTROFF

This command turns off the Data Terminal Ready signal, which  has
already been turned on by the DTRON command.

Executing this command before DTRON command  generates  an  error
message.   Use  of this command when BERT test is running will be
rejected.

2.9.6.2.7  _T_u_r_n__O_n__R_e_q_u_e_s_t__T_o__S_e_n_d

Syntax : RTSON

This command turns on the Request To Send signal on the sync line
specified  by the SELECT command.  This command does not apply to
the primitive lines.

Executing this command prior to selection of the  line,  or  when
BERT testing is running, generates an error message.

Execution of this command enables the CTS lead  to  be  monitored
again  by  the operating system, otherwise, executing ?CTS before
this command displays the  state  of  last  update  done  by  the
operating system.

2.9.6.2.8  _Q_u_e_r_y__S_t_a_t_e__o_f__C_l_e_a_r__T_o__S_e_n_d

Syntax : ?CTS

This command queries the status of  the  signal  Clear  To  Send.
This  command  can  only  be  executed  after  the RTSON command,
otherwise, the state of  CTS  is  undefined  and  only  the  last
updated  status is displayed when the operating system is stopped



Page 109              PBTERS.DOC







TBOM13                                         July 22, 1988



by the command SELECT.

As many as ?CTS can be executed after RTSON command, this enables
the BOM operator to monitor the CTS status periodically.

Use of this command when BERT testing  is  running  with  RTS/CTS
handshake does not report the correct status.

2.9.6.2.9  _T_u_r_n__O_f_f__R_e_q_u_e_s_t__T_o__S_e_n_d

Syntax : RTSOFF

This command turns off the Clear To Send  signal  that  has  been
turned on by the command RTSON.  Execution of this comand without
prior RTSON command, or when BERT test is  running  generates  an
error message.


2.9.6.2.10  _S_t_a_r_t__E_x_e_c_u_t_i_n_g__B_E_R_T

Syntax : STARTBERT [RTS]

This  command  starts  up  the  bit  error  rate  testing.   Once
executed,  the line specified by SELECT command will be taken out
of service, and the test pattern  specified  by  PATTERN  command
will be sent out to the sync line.

As data is sent out, receiver starts to pick up data returned via
the loop back connection, and calculations are made to gather the
statistics of the line error rate.

This command is rejected if the BERT is already running.

The optional parameter  RTS  instructs  the  BOM  to  start  BERT
testing  with  RTS/CTS  handshaking.   If  this  parameter is not
entered, the default testing will aassume no RTS/CTS handshaking.

2.9.6.2.11  _S_t_o_p__E_x_e_c_u_t_i_n_g__B_E_R_T

Syntax : STOPBERT

This command stops the execution of the Bit Error  Rate  Testing.
The  Sync line used for BERT will be re-initialized to the normal
BSC protocol, and PBT resumes the polling state for each  control
unit.









Page 110              PBTERS.DOC







TBOM13                                         July 22, 1988



2.9.6.2.12  _B_E_R_T_______-__S_h_o_w__R_e_s_u_l_t_s__o_f__B_E_R_T

Syntax : BERT [n]

This command displays the results of the BERT testing.  It can be
followed  by  the  interval,  n,  such  that  the test results is
displayed continuously once every n seconds by BOM.

If n is not specified, this command displays results of the  last
BERT  test  executed.  If the command STOPBERT has been executed,
the results displayed by this command will stay the same for each
BERT  executed.   If  the  test  is still runing, which ever test
result that is recorded at the last run will be displayed.

BERT shows the progress of the testing for the specified  logical
unit.   If  line  is  not  selected  by  SELECT command, an error
message will be printed.  As shown below, the  output  shows  the
number of blocks received, the number and percentage of blocks in
error,  the  number  of   bits  received,  and  the  number   and
percentage  of  bits  in error.  If no blocks have been received,
output displays that no data has yet been received.

In addition, the BERT command prints out the relative line number
and  the  physical  sync line number currently under testing, the
data  pattern selected, and  the  status  of  the  test,  whether
running  or  stopped.   After  the  test  has been running for 10
seconds, the run time and line  speed  for  this  test  are  also
printed.

This data is stored separately for each  logical  unit  that  has
been tested, so that, after one logical unit has been tested, the
test stopped, and another logical unit tested, the results of the
tests  may  be  compared  simply  by selecting each logical unit,
without re-starting the test, and executing the BERT command.

The radix of the  output  numbers  depends  on  the  output  mode
setting.   This  setting can be queried or changed by the command
BERTMODE.

Output of the command is as follows:


please type MENU for help
:> BERT

TBOM -- 3270PBT Bisync Operations Monitor
NODE  2274    SLOT 4     11Jun86 21:20:00

RUN TIME:  00:02:44.  LINE SPEED=   4800 BPS.
BLOCKS RECEIVED: 00000024
BLOCK ERROR COUNT:  00000000 -  0%



Page 111              PBTERS.DOC







TBOM13                                         July 22, 1988



BITS RECEIVED:   00090190
BIT ERROR COUNT:    00000000 -  0%
LINE NUMBER : 0   SYNC LINE : 6
DATA PATTERN 2047
TEST IS RUNNING

please type MENU for help
:>



2.9.6.2.13  _B_r_o_a_d_c_a_s_t__o_r__S_e_n_d__M_e_s_s_a_g_e__t_o__T_e_r_m_i_n_a_l_s

Syntax : TALK [lnn] or TALK [lna [cua [dva]]]

TALK is used when a BOM operator wants to send  a  message  to  a
specific device or to broadcast messages to a group of devices on
a control unit or line.

While in REL mode, lnn indicates the relative line  number  where
the broadcast message will be delivered. All devices on this line
receive the message.

If the mode setting is ADR, lna,  cua,  and  dva  are  the  line,
control  unit, and device addresses respectively.  If only lna is
entered, the result is the same as in REL mode.  If lna  and  cua
are  entered,  all  the  devices  on  the  addressed control unit
receive  the  broadcast  message.  If  all  three  addresses  are
defined, BOM operator is talking to that device only.

If this command is executed without any  parameter,  the  message
from the operator will be sent to all the devices in the slot.

A Maximum of 80 characters, including the  termination  character
carriage  return,  are  allowed. The message will be displayed at
the bottom of the screen, the keyboard will be locked in order to
get  operator's  attention  and  unlock  the  keyboard  to resume
operation.

Once the line goes into BERT testing mode, BOM operator  can  not
issue  a  TALK  command to send messages to the terminals on that
line.  Executing this command under such condition will  generate
an error message.


2.9.6.2.14  _R_e_s_e_t__B_E_R_T__T_e_s_t__R_e_s_u_l_t_s

Syntax : RSTBERT

This command resets all  the  statistics  collected  by  previous
tests.



Page 112              PBTERS.DOC







TBOM13                                         July 22, 1988



This command can be executed even when the test is running, which
clears all the statistics for the previous tests and starts a new
sets of data.

2.9.6.2.15  _Q_u_e_r_y_/_C_h_a_n_g_e__O_u_t_p_u_t__M_o_d_e__F_o_r__B_E_R_T

Syntax : BERTMODE [DEC/HEX]

Default : BERTMODE HEX

BERTMODE is used to query or change current mode  of  output  for
the BERT command.

The parameter field can be DEC for selecting decimal numbers,  or
HEX for selecting hexadecimal number outputs.  If this command is
not followed by any parameter, the mode  of  the  current  output
format will be displayed.

The default output format is hexadecimal.


The following command is also included for  description  purposes
only.  This command has already been implemented.

2.9.6.2.16  _Q_u_e_r_y__O_n_l_i_n_e__D_e_v_i_c_e_s

Syntax : ONLINE

This  command  displays  all  the  devices  that  are   currently
connected to the host interface.

Please refer to the  BOM  document  for  a  description  of  this
command.

2.9.6.3  Execution Examples

The following is an example  of  the  sequence  for  doing  BERT.
Explanations  of  the  commands  are  presented at the end of the
sequence,  and  are  done  according  to  the   sequence   number
associated with each command.



:> ONLINE                       ...1

:> MODE REL                     ...2

:> TALK lnn or                  ...3

:> MODE ADR                     ...4




Page 113              PBTERS.DOC







TBOM13                                         July 22, 1988



:> TALK lna cua or              ...5

:> TALK lna cua dva             ...6

please type message below(maximum 79 characters), end with CR :

THIS LINE IS GOING DOWN, PLEASE LOG OFF. carriage return

:> ONLINE                       ...7

:> PATTERN n                    ...8

:> SELECT lna or                ...9

:> MODE REL                     ...10

:> SELECT lnn                   ...11

:> DTRON                        ...12

:> ?DSR                         ...13

:> RTSON                        ...14

:> ?CTS                         ...15

:> STARTBERT                    ...16



























Page 114              PBTERS.DOC







TBOM13                                         July 22, 1988



:> BERT                         ...17

:> BERT 1                       ...18

:> STOPBERT                     ...19

:> QCU cun                      ...20

:> QCU cun                      ...21


1. ONLINE

        This  command  queries  the  online   devices,   and   is
recommended  to  be  the  first command issued to ensure that the
line to be tested does not have  an  active  terminal.  The  line
where  the  devices  are  defined  can be obtained by the command
CONF.

2. MODE REL

        This  command  sets  the  arguement  input  mode  to   be
relative,  so  that  the  line  identifier  can be entered as the
relative number.

3. TALK lnn

        This command is executed when there are  terminals  found
to  be active on the line intended for BERT testing.  The message
typed in will be broadcasted to the terminals  specified  by  the
relative line number lnn.

4. MODE ADR

        By setting the ADR mode, BOM operator can send a  message
to  a  group  of  devices  on one line or a control unit, or to a
specific device.

5. TALK lna cua

        This command sends broadcast messages to the  devices  on
the  control unit specified by the line address lna, control unit
address cua.

6. TALK lna cua dva

        This command sends a message to the device  addressed  by
the  line  address  lna, control unit address cua, and the device
address dva.

7. ONLINE



Page 115              PBTERS.DOC







TBOM13                                         July 22, 1988



        This command is the same as 1.

8. PATTERN n

        This command selects the test pattern to be sent  out  to
the  sync line for the BERT testing. The value of n ranges from 1
to 3.

9. SELECT lna

        This command selects the line desired  for  BERT  testing
while in ADR mode.

10. MODE REL

        This command sets the parameter  input  mode  to  be  the
relative number.

11. SELECT lnn

        This command  selects  the  line  desired  for  the  BERT
testing.   The  line  identifier is accepted as the relative line
number by TBOM.

12. DTRON

        This command turns on the DTR signal, so that this signal
can be monitored on the line.

13. ?DSR

        This command queries the status of the DSR signal for the
connections of the line.

14. RTSON

        This command turns on the RTS signal so that  it  can  be
monitored on the line.

15. ?CTS

        This command queries the status of  CTS  signal  for  the
conections of the line.

16. STARTBERT

        This  command  starts  up  the  BERT  testing.    RTS/CTS
handshaking is not required.

17. BERT




Page 116              PBTERS.DOC







TBOM13                                         July 22, 1988



        This command displays the results of the BERT testing.

18. BERT 20

        This command instructs TBOM to display the  BERT  testing
results  once  every  20  seconds.  The display can be stopped by
hitting any key from the tty.

19. STOPBERT

        This command stops the BERT testing. Once  executed,  the
line  will resume the normal BSC protocol. TIF starts polling the
control units.

20. QCU cun

        This command queries the polling status  of  the  control
unit,  it  is  recommended to execute this command after the BERT
testing to ensure an operational enviroment.

21. QCU cun

        Same as 20.































Page 117              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



              3.  3270 REFERENCE MANUAL FOR PBT

3.1  IBM ENVIRONMENT



3.1.1  IBM FAMILY


Mainframes      : 370 (370/128,370/138,370/158,370/168)
                  303x (3031,3032,3033)
                  308x (3081,3083)

Mini-computers  : 43xx (4331,4341)
                  32
                  34
                  36
                  38
                  Series/1
                  8100 (with loop of devices)

Micro-computers : PC (most frames)
                  PC/XT
                  3270/PC (3270 emulation)
                  PC/AT

Front-end
Processor (FEP) : 3705-II/80
(Communication
Controller)             - 16 lines max
                        - 4 different channels (hosts)

                  3725

                        - 256 lines max
                        - 8 different channels (hosts)


3.1.2  INFORMATON SYSTEMS


3270 : Information display system

3730 : Distributed office communication system

3767 : Communication terminal

3770 : Data communication system

5250 : Information display system




Page 118              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



5280 : Distributed data system
       (diskette based system used for collecting, validating and
       storing a wide range of business applications)

5520 : Administrative system
       (system text processing combined with document management
       and document distribution capabilities)

6670 : Information distributor
       (word processing and data processing application system
       including hard printer)

3600 : Finance communication system
       (Used to control operations of financial institution)

3630 : Plant communication system
       (Used to collect, process and distribute information
       related to manufacturing operations). Based on punched
       hole badge system

3650 : Retail store system
       (Remote devices attached to sales analysis applications
       host)

3660 : Supermarket system
       (Used to improve supermarket operations)



3.1.3  3270 DEVICES



a/ CLUSTERS
   --------

3271 : Model 1/11 -    480 character buffer capacity
       Model 2/12 -    1920 character buffer capacity
                       Remote Cluster
                       Up to 32 stations
                       Up to 7200bps (BSC)
                       Up to 9600 bps (SDLC)
                       Add. features : ASCII

3272 : Model 1 -       480 character buffer capacity
       Model 2 -       960 character buffer capacity
                       Local cluster (non-SNA).
                       Up to 32 stations.
                       Add. feature : ASCII,Copy device-to-device

3274 : Model 1A/1B/1C/1D



Page 119              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



                       Up to 32 stations.
                       Up to 9600 bps (BSC or SDLC)

       Model 51C (Can be used in 8100 enviornment)
                       Up to 9600 (BSC or SDLC)
                       Add. feature : APL, Programed symbols,Ext.attr


              b/ CONTROL UNIT DISPLAY STATION
                 ----------------------------

3275 : Model 2/3 -     1920 character buffer capacity (BSC)
              12 -     1920 character buffer capacity (SDLC)
                       Up to 7.2 bps (model 2)
                       Up to 9.6 (model 12)
                       Speeds : 1200,2000,2400,4800 bps

3276 : Model 1/2/3/4 - Up to 7.2 Kbps (BSC)
       Mod 11/12/13/16 Up to 9.6 Kbps (SDLC)

       Model 2/12      1920 character buffer capacity
       Model 3/13      2560 character buffer capacity
       Model 4/14      3440 character buffer capacity
                       Add. feature : APL

8775 : Model 1/2 -      960 character buffer capacity (12*80)
       Model  11 -     1920 character buffer capacity (24*80)
               or      2560 character buffer capacity (32*80)
       Model  12 -      960 character buffer capacity
               or      1920 character buffer capacity
               or      2560 character buffer capacity
               or      3440 character buffer capacity (43*80)


       Up to 9.6 Kbps (remote)
       Up to 38.4 Kbps (local)



              c/ DISPLAY STATIONS
                 ----------------

3277 : Model 1 -      480 char   (12 x 40)
       Model 2 -      1920 char  (24 x 80)
                      Add. functions : Function keys, APL
                                       ASCII, Selector Light Pen

3278 : Model 1 -      960 char   (12 x 80)
       Model 2 -      1920 char  (24 x 80)
       Model 3 -      2560 char  (32 x 80)
       Model 4 -      3440 char  (43 x 80)



Page 120              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



       Model 5 -      3564 char  (27 x 132)
       Add. features : APL, Light pen, Prog. symbols,
                       Magnetic card reader

3279 : Color Display Station

       BASE :  4 colors (white, red, blue and green)
       Model 2A -      1920 char
       Model 3A -      2560 char

       EXTENDED : 7 colors
       (white, red, blue, green, pink, yellow, turquoise)
       Extended highlighting (reverse video, blink, underscore).
       APL character set
       Model 2B -      1920 char
       Model 3B -      2560 char



3178 : Similar to 3278 but less expensive

3179 : Color Display Station (7 color)


                d/ PRINTERS
                   --------

3284 : Model 1 -        480 char buffer / 40 cps 132 char/ lines
       Model 2 -        1920 char buffer
       Model 3 -        No character buffer
                        Add. feature : APL, Dual-case EBCDIC

3286 : Model 1 -        480 char buffer / 66 cps
       Model 2 -        1920 char buffer
                        Add. feature : APL, Dual-case EBCDIC

3287 : Model 1 -        480/960/1920 char, 80 cps 132 char/lines
       Model 2 -        480/960/1920 char, 120 cps 132 char/lines
       Model 1C -       Bidirectional - 4 color printing
                        80 cps (with one color)
       Model 2C -       Bidirectional - 4 color printing
                        120 cps (with one color)
                        Add. feature : Alarm, Dual-case, APL, Prog.
                        Symbols extended print buffer, X-print error




              e/ LINE PRINTERS
                 -------------




Page 121              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



3288 : Model 2 -      120 cps
                      Add. feature : X-print error

3289 : Model 1     -  155 cps
       Model 2/3/4 -  400 cps
                      4K character buffer capacity
                      Add. feature : ASCII, Alarm, X-print
                      error, katakana

3262 : Model 3 -      48 character set : 650 lpm
                      64     "         : 467 lpm
                      84     "         : 364 lpm
                      128    "         : 250 lpm

       Model 13 -     40 character set : 325 lpm
                      64     "         : 230 lpm
                      94     "         : 180 lpm
                      128    "         : 125 lpm


3268 : Model 1 -      Attached to mini-computer 8100 : 340 cps
       Model 2 -      Connected to CU 3274/3276




3.2  3270 LINE DISCIPLINE



3.2.1  GENERAL BSC BLOCK FORMAT



NON-TRANSPARENT MODE.

S S S S                           E  B B P
Y Y Y T            D.A.T.A        T  C C A
N N N X                           X  C C D

32   02                           03     FF (HEX)


                  E B           E B
     BLOCK 1      T C  BLOCK 2  T C
                  B C           B C


TRANSPARENT MODE.





Page 122              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



S S S D S                     D E B B P
Y Y Y L T       D.A.T.A       L T C C A
N N N E X                     E X C C D




NOTE :
----           - Two "SYN" character minimum

               - "BCC" generated by the hardware

               - Dynamic switch from NON-TRANSPARENT to TRANSPARENT
                 mode



3.2.2  CATAGORIES OF COMMANDS




Poll
----

        - General     Poll

        - Specific    Poll


Selection Addressing or Selecting
--------------------


3270 Operations
---------------

        - WRITE
        - READ
        - CONTROL



ORDERS           2 kinds
------
        - Used to position, define and format data written in the
          buffer, to erase selected unprotected data field and to
          reposition the cursor.

        - Specify the printer format




Page 123              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



3.2.3  POLL COMMAND 1




PURPOSE :       Polling sequences are selection sequences used
                specifically to obtain pending status at a device.
                General polls request status from all devices.
                This command examines each attached device in sequence
                to determine if a status/sense or manually entered
                command is waiting to be transferred to the FEP.
                Each message is followed by the address of the
                device from which it originated.


General Poll Format

        3270 CU Poll Address
        3270 CU Poll Address
        7F   (hex)
        7F   (hex)

Example : Polling on CU : C1

        ---------------------------------------------------------
        | S | S | P | E | S | S | CU | CU | 7F | 7F | ENQ | PAD |
        | Y | Y | A | O | Y | Y |Add |Add |    |    |     |     |
        | N | N | D | T | N | N |    |    |    |    |     |     |
        ---------------------------------------------------------

        32   32  FF  37  32  32  C1   C1   7F   7F   2D    FF


        Normal answers to GENERAL POLL :

        - EOT   : No operator action has occured and Status/Sense
                operation is not pending.

        - Status/sense : If status/sense information is pending, this
                 information is sent to the FEP.


        - READ MODIFIED/ SHORT READ : If and operator action has
                occurred that requires reading by the FEP and
                status/sense is not pending, Read Modified
                command is performed.








Page 124              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



3.2.4  POLL COMMAND 2




PURPOSE :        Same as general poll.
                 Specific poll sequence requests status from a
                 particular device.
                 This command addresses the 3270 Cluster and one device
                 to determine if a status/sense message or a manual
                 entered message is awaiting transfer.
                 This transfer is automatically done once the specific
                 poll is detected.


Specific Poll : Format
----------------------

       3270 CU Poll Address

       3270 CU Poll Address

       Device Address

       Device Address

Example : Polling on CU : C1, Device C2

        -------------------------------------------------------------
        | S | S | P | E | S | S | CU  | CU  | DEV | DEV | ENQ | PAD |
        | Y | Y | A | O | Y | Y | Add | Add | Add | Add |     |     |
        | N | N | D | T | N | N |     |     |     |     |     |     |
        -------------------------------------------------------------

         32  32  FF  37  32  32   C1    C1    C2    C2    2D    FF

        Answer : ---> same as GENERAL POLL




3.2.5  SELECTION ADDRESSING COMMAND




PUROPOSE :       Selects a 3270 CU and an attached device for
                 subsequent operations (WRITE/READ/CONTROL)






Page 125              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



Format :
-------

        3270 CU Address

        3270 CU Address

        Device Address

        Device Address



NOTE :
----

        Same format as specific poll, but different
        hex representation for CU (cluster).


Example : Selection Addressing on CU : C1 device C2

        -------------------------------------------------
        |  S  |  S  | CU  | CU  | DEV | DEV | ENQ | PAD |
        |  Y  |  Y  | Add | Add | Add | Add |     |     |
        |  N  |  N  |     |     |     |     |     |     |
        -------------------------------------------------

         32     32    E1    E1    C2    C2    2D    FF


        Normal answer :

        - ACK : Address successfully received

        - WACK : (Wait for Acknowledment) : Device busy

        - RVI : (Reverse Interrupt) : Pending status waiting



3.2.6  3270 OPERATIONS




WRITE                               CU<======== DATA ==== FEP
-----

       - Write




Page 126              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



       - Erase/Write

       - Erase/Write alternate (3274/3276 only)


READ                                CU ===== DATA =======> FEP
----

       - Read buffer

       - Read modified

       - Read modified all (3274-1A/1C, 3276-11/12/13/14 only0


CONTROL
-------

       - Copy

       - Select RM/RB/RMP/RBY/WRT

       - Erase all unprotected (fields)

       - Status/sense

       - NOP (No Operation)


Orders
******
              SF      Start Field
              SBA     Set Buffer Address
              IC      Insert Cursor
              PT      Program Tab
              RA      Repeat to Address
              EUA     Erase Unprotected Address



WRITE
-----

       - Used to load, format and erase device buffer area.

       - Data blocks and orders transferred from host to CU.


Three kinds of WRITE commands :

       ---> Write :  Used to modify existing buffer data.



Page 127              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



       ---> Erase/Write:  Used to erase the device buffer
                          before the write operation.

       ---> Erase/Write alternate : Idem erase/write.
                          Can handle expanded print capacity mode.

Format
------

        SYN
        SYN
        SYN
        STX
        ESC                    Data link framing
------------------------------------------------

        WRITE code
------------------------------------------------

        WCC  (Write Control Character)
------------------------------------------------

        DATA and ORDERS
------------------------------------------------

        ETX
        BCC
        BCC
        PAD                     Data link framing


        WCC      Write Control Character

        Bit 0   :        * (determined by bit 2 through 7)
        Bit 1   :        1 (reserved)
        Bit 2/3 :        Printed-out format (132/40/64/80 char/lines)
        Bit 4   :        Start print (at completion of a WRITE)
        Bit 5   :        Sound alarm
        Bit 6   :        Keyboard restore (lock "1" / unlock "0")
        Bit 7   :        Reset MDT bits (Modified Data Tag)

        Normal answer;

        - ACK   : Operation successfully completed

        - WACK  : Device busy



READ
----



Page 128              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



      - Used to transfer 3270 buffer data, keyboard key data, status
        info from the cluster to the FEP (or host).

Three kinds of READ commands :
----------------------------

       ---> Read buffer ;  All data transferred.

              - from buffer address 0
              - from current buffer address.




Format
------

        SYN
        SYN
        SYN
        STX                  Data link framing
----------------------------------------------
        CU Address
----------------------------------------------
        Device Address
----------------------------------------------
        AID   (Attention Identifier)
----------------------------------------------
        Cursor Address(SBA)
----------------------------------------------
        Order (SF)
        Attribute character
        User DATA
----------------------------------------------
        Order (SF)
        Attribute char
        User DATA
----------------------------------------------
        TEX
        BCC
        BCC
        PAD




           ---> Read modified : All modified unprotected fields set by
                the MDT (*) bit are transferred from the CU to the FEP.
                (NULL characters are not transmitted)

                      - from buffer address 0



Page 129              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



                      - from current buffer address.


       ---> Read Modified ALL : (Used with SNA/SDLC enviornment)
Format
------
       SYN
       SYN
       SYN
       STX
--------------------------------------
       CU Address
--------------------------------------
       Device Address
--------------------------------------
       READ MODIFIED code
--------------------------------------
       AID
       Cursor address  /      Read heading
--------------------------------------
       Order (SBA)
       Attribute Add+1  >     First modified field
       DATA            /
--------------------------------------
       Order (SBA)
       Attribute Add+1  >      Second modified field
       DATA            /
--------------------------------------
       ETX
       BCC
       BCC
       PAD


       ---> SHORT READ : If CLEAR/PA key is depressed, only AID
                         is transferred to main storage.

       ---> TEST REQUEST READ : If SYS REQ key, this 3270 command is
                                executed

Format
------
              SOH
              %
              /
              STX
---------------------------------------------------
              DATA (without AID and cursor address)
---------------------------------------------------

MDT (*) : Modified Data Tag (Bit Array)



Page 130              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



          Each bit set represents a modifies unprotected field

       Normal answer :

       - ACK : read operation acknowledged
               Data transfer is initiated




PURURPOSE :       To initiate certain CU/device operations not involved
----------        with data transfer

CONTROL           Causes certain printer and display operations.
-------

        ---> COPY : Used to transfer buffer data from one device
                    to another device attached to the same CU>
                    The selected device is the "to" device.


Format
------
        SYN
        SYN
        STX
        ESC
-----------------------------------------------------
        COPY code
-----------------------------------------------------
        CCC  (Copy Control Character)
-----------------------------------------------------
        "FROM" device address
-----------------------------------------------------
        ETX
        BCC
        BCC
        PAD


        ---> SELECT : Immediate command (3272, 3274-1B only)
                      Device to CU buffer transfer.

               RM     Read modified (performed before READ MODIFIED)
               RB     Read Buffer (performed before READ BUFFER)
               RMP    Read Modified Position (performed before WRITE
                                              and READ MODIFIED )
               RBP    Read Buffer Position (performed before WRITE
                                              and READ BUFFER)
               WRT    Write (performed before WRITE)




Page 131              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



        --->   EAU :  Erase All Unprotected
                      - clear all unprotected fields
                      - reset MDT bits
                      - unlock keyboard
                      - reposition the cursor


               CCC   Copy Control Character

               Bit 0 :       *
               Bit 1 :       1
               Bit 2/3:      Printout format
               Bit 4 :       Start Print
               Bit 5 :       Sound alarm
               Bit 6/7:      Ttpe of data to be copied

      Normal answer :

      Same as WRITE operation



       ---> Status/sense :     (3272/3274-1B only)

                       0       CR      COMMAND REJECT
                       1       IR      INTERVENTION REQUIRED
                       2       BOC     BUS OUT CHECK
                       3       EC      EQUIPMENT CHECK
                       4       DC      DATA CHECK
                       5       US      UNIT SPECIFY
                       6       CC      CONTROL CHECK
                       7       OC      OPERATION CHECK


       CR      :       Set if INVALID COMMAND recieved

       IR      :       Set if addressed device is UNAVAILABLE
                       or NOT READY (device switched off)

       BOC     :       Set if BAD PARITY detected on data during
                       CU-device transfer

       EC      :       Set if DEVICE ERROR

       DC      :       Set if BAD PARITY detected on data during
                       CU-device transfer

       US      :       Set if DEVICE ERROR

       CC      :       Set if TIME-OUT condition detected




Page 132              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



       OC      :       Set if received COMMAND can't be executed
                       (Invalid Buffer Address, bad chained command.)



       ---> NOP :      No operation. To retrieve pending status.



ORDERS
------

PURPOSE :              End-user data formatting
-------


START FIELD : SF (2 bytes).    Hex : 1D

        Allows identification and notifies the CU that the next byte
        is an attribute character.


SET BUFFER ADDRESS : SBA (3 bytes).   Hex : 11

        Specifies new buffer address from which WRITE operations
        are to start or to continue.

INSERT CURSOR : IC (1 Byte).   Hex : 13

        Repositions the cursor to the location specified by the current
        buffer address.


PROGRAM TAB : PT (1 Byte).     Hex : 05

        Advances the current buffer address to the address of the next
        unprotected field.


REPEAT TO ADDRESS : RA (4 bytes).   Hex ; 3C

        Repeats special character (NULL, space) from the current
        buffer position to the address specifies with this order.


ERASE UNPROTECTED TO ADDRESS : EUA (3 bytes).

        Inserts NULLs in all unprotected buffer character locations
        from the current address to the end.
        If stop address = current address ==> all unprotected locations
                        in the buffer are erased.



Page 133              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



        If stop address < current address ==> the EUA operation wraps
                        from the bottom row of the buffer to the top
                        row.





3.3  3270 TYMNET NETWORK SUPPORT



3.3.1  HARDWARE LEVEL




       . 3270 protocol is working on Synchronous/Bisynchronous ports:
       Sync port :     TC,RC,TD,RD,RTS
       Bisync port :   TC,RC,TD,RD,RTS,CTS,DTR,DSR

       . Sync/Bisync ports can be attached to :
               Universal CROSS-OVER
               MODEM

       . RTS/CTS handshake :
       The 3270 is a half-duplex protocol. Before sending data,
       the DTE must raise its 'RTS', waits for 'CTS', sends data and
       lowers its 'RTS'. Once this transmission is finished, the DCE
       can proceed in the same way.
       For the Full-Duplex modem especially, we can raise 'RTS' and
       wait for 'CTS' answer at the line set-up. That's it.
       ---> Finally, in such cases, we don't need to wait for the
       turn around time (modem stabilization).


       . The 3270 Level 1 handling respects the V.24 recommendations.
       ---> So, we have DTR/DSR handshake between DTE and DCE (if
            needed) and then RTS/CTS handshake (if needed)


       . Either LEASED and SWITCHED lines can be defined

       --->  Leased  : No DTR/DSR handshake is required
                       DTR is always provided by the Sync/Bisync port.

       --->  Switched lines : DTR/DSR handshake required


       . On SYNC port, the RTS signal is always in high position.




Page 134              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



3.3.2  NETWORK FACILITIES




        POLLING
        #######

The CU (or terminal controller) acts as a master addressing each
terminal in turn. If the terminal has data pending, it sends the data
in response. If there is no data pending, the terminal acknowledges
the poll.

The CU buffers the data received for later transmission to the host.
The front end processor (FEP) acts as a master to the CU. When polled
by the FEP< the CU sends any buffered data.

Multiple CU's can be connected to the same multidrop line. The line
acts as a broadcast medium where the poll from the FEP is seen by all
the controllers, but responded to only by the one addressed.

To replace the leased line between the FEP and CU with the Tymnet
Network requires special treatment of polls. It is undesirable to pass
the polls from the host through the network since this would generate
network traffic and hence costs. Also, due to the nature of packet
networks such as Tymnet, the transmission of polls would cause a
variable added delay.

So the network can process POLLING LOCALLY.

At the terminal end, the 3270 TI acts as a master polling the
terminals. When data is sent by a terminal, this data is forwarded
through the network to the 3270 HI.

At the FEP end, the 3270 HI responds to all polls. Data that has
arrived from the terminals is forwarded to the host in response to the
next poll of that terminal address.

In summary, in a native 3270 configuration the host FEP polls the
terminals based on the knowledge of the configuration of the terminals
and CU. The network 3270 HI emulates the configuration expected by the
host FEP. In the same way, the 3270 TI polls the devices and CU where
they are attached. These CU's consider the 3270 TI as a FEP.


NOTE :
----

               Polling is locally running before any virtual circuit
               is built.




Page 135              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



               Polling is a foreground process.



        NATIVE MODE
        ###########

With this mode, a (or several) CU is attached to a PBT. On the host
side, the host FEP is connected to the PBH. Both interfaces are smart
interfaces. Hence, IIX dialect is used between PBT and PBH.


The PBT polls the CU('s) on each line with a GENERAL POLL. At the
end of each polling cycle, the PBT checks for data messages to be sent
to the terminals. If a message is waiting, a SELECT operation is sent
to the corresponding terminal.


TEXT MESSAGES from the terminal are queued by the PBH for transmission
to the host. More than one test message may be queued for a device.


STATUS MESSAGES from the terminal are also queued until they are
forwarded to the host in response to a poll.


The COPY operation also generates status messages if the specified
printer is busy or unavailable. The state "unavailable" may be
generated if the terminal is not on the same CU as the printer.


GENERAL and SPECIFIC polls are answered on the basis of text and
status information present in the PBH. If more than one text message
is queued for a device, the first one is transmitted in response to
the poll.


WRITE operations are acknowledged immediately by the PBH and are passed
through the network.


READ operation from the host are not acknowledged by the PBH. Instead,
the request is passed directly to the PBT. The PBH must wait until a
response is received from the PBT. The response is returned by the
PBH to the host.


The PBH assigns a circuit to a polling address recognized by the host
computer and returns a message placing the PBT in the native mode.
When a 3270 terminal is logged into the PBH no TRANSLATION or
REFORMATTING functions are performed on text messages sent to or



Page 136              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



received from the host computer.


STATUS conditions detected at the terminal are reported to the host
computer as received. Serious errors at the terminal cause
disconnection of the network circuit and the device appears unavailable
to the host.



       ERRORS and RECOVERY
       ###################

Handled by the following control characters :


NAK     (READ/WRITE command)
        - wrong BCC
        on ETB : retransmission from last STX to ETB
        on ETX : retransmission from last STX to ETX


EOT     (all commands) invalid 3270 command
        - control character missing
        - command for unavailable device (printer powered off, busy)
        - T/O
        - parity error


RVI     Response to poll command --> Terminate polling sequence
        Response to selection addressing
                - Device unavailable
                - Device not ready (out of paper)
                - Device - CU transfer unsuccessful


TIMEOUT         Different timers in Tymnet can handle the time-out.
-------

        T/O for polling        ---> circuit zapped

        T/O for inactivity at the terminal      ---> circuit zapped

        T/O logon period       ---> logon again


One of the attributes of the bisynchronous protocol used with 3270
terminals is the error detection.
Data is sent in records with a checksum appended for error
detection.




Page 137              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



If an error is detected in a received record by the CU this
record is refused (NAK sent back by the CU).

The FEP will respond by retransmitting the record until a positive
acknowledgment (ACK) is sent back by the CU.
This process is true in the opposite direction.



3.3.3  FEATURES




       PVC : Permanent Virtual Circuit
       ###############################


Normally at logon time, a terminal builds a virtual circuit through
the network from the PBT to the PBH by sending the following login
string :

====>           USERNAME:destination HOST number;password

This virtual circuit is a SVC (Switched Virtual Circuit ).

The network 3270 interface can offer the user a dedicated connection
to a host in the network with a PVC (Permanent Virtual Circuit). In
this case, once the device is powered on a PVC will be built to the
destination host.

All parameters for this PVC building must be set at generation time.
In fact, the network is perceived from the end-user's point of view as
a leased line.

The PVC function is a feature of the PBT itself.
It is completely handled by the slot itself.

Incase of circuit shutdown, the PVC is automatically rebuilt
(depending on different timers) through the network to the previously
targetted host port.


NOTE :
----


===>   No way to initiate a PVC from the host to the terminal.

===>   No data is lost and no action to be done by the end-user.




Page 138              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



ADVANTAGE : No logon sequence expected from the end-user

        ===> NETWORK FULLY TRANSPARENT


DRAWBACK : One targetted host port only

       ===> NO MULTTARGETTING




        EDF :  EARLY DATA FORWARDING
        ############################


The need to verify checksums before using the data can cause an
unfortunate delay.


Transmission of a 2000 character screen over a 9.6 kbps line, for
example, requires 1.7 seconds, not counting protocol overhead. Since
the receiver does not know the validity of the data until the checksum
has arrived at the end of the record, he must wait the full 1.7 sec
before using the first data byte.


This 3270 delay is exaggerated by the presence of a PDN (Public Data
Network).


When a host sends a 2000 character screen on a 9.6 kbps connection
between the FEP and the PBH, a delay of 1.7s is introduced. So, the
PBH buffers the entire record waiting to verify the checksum. Once
received correctly, the chatacter message can start travelling
through the network. This throughput delay is variable, but let us
assume it to be 0.5s.

Once received at the PBT side, the 2000 character screen can again be
sent over a 9.6 kbps line to the CU adding another 1.7s of delay.

This series of delays produce almost 4s of delay (1.7+1.7+.5=3.9s)



=====> To reduce the delay caused by a network, Tymnet introduced
       the concept of EDF (Early Data Forwarding).


In fact, once data has started to arrive from the FEP, the PBH starts
to pass that data through the network while waiting for the last



Page 139              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



chatacter of the record to arrive.


When the data arrives at the PBT side, its transmission to the CU is
begun, even though not all data for the record is present.


In this way, the two bisynchronous transmission times can be partially
overlapped.


Using our estimate of 0.5s network transmit delay, this would produce
a total delay of 2.2s compared to a leased line delay of 1.7s


               Leased line                : 1.7 s
               With network (without EDF) : 4   s
               With network (with EDF)    : 2.2 s




RECOVERY
--------


The above description of EDF is valid if the data is always received
correctly. Indeed, the checksum is correct most of the time, so the
steady condition is good, but what happens if the checksum shows
incorrect data?


The bisynchronous protocol allows a FORWARD ABORT INDICATION.
This is a special character that instructs the receiver to treat the
current record as if the checksum indicated an error.


If a checksum error is detected by the PBH and data was already sent
through the network, then any data still in the PBH is discarded and a
forward abort indication is sent through the network. The forward
abort is passed by the PBT and the previously received data is
discarded by the CU.



===>    No need for a similar feature in the opposite transmission
        sense ( CU ==> FEP ).
        In this case, up to 256 charaters per block can be sent.






Page 140              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



                TGP     TYMNET GATEWAY PROTOCOL
                ###############################



A terminal or host interface can communicate through one or several
Tymnet Gateways. This facility allows the user to have a
terminal/host interface in one network and the host/terminal in a
separate network.





                TRANSPARENCY MODE(EBCDIC 3270 CU ONLY)
                ######################################


The transparent mode allows transmission of data messages containing
any list patterns, including the control characters used by the 3270
protocol.


With this feature, special terminals can be supported :

        - color terminals (4 colors) ---> 3279 mod 2

        - extended color terminals (7 colors) ---> 3279 mod 3

        - APL character set

        - extended highlighting

        - programmed symbols





               VIRTUAL MODES
               #############


Virtual Terminal Mode : VTM
---------------------------


A 3270 terminal connected to a PBT (3270 TI) is used instead of a
normal ASCII or teletype-compatible terminal to access asynchronous
network hosts.




Page 141              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



The 3270 terminal is normally attached to a PBT while the host FEP is
connected to a Tymcom. This Tymcom slot is a dumb slot; therefore, no
IIX dialect is invoked in such an environment.

A connection with this configuration can be done either to an ASCII
computer or network services (i.e., Probe and so on).

In VTM, the terminal interface (PBT) performs several functions
locally. The PBT appears to the host computer as a standard full
duplex ASCII terminal. These functions are :

        - EBCDIC (3270 terminal) to ASCII (host) conversion
        - display formatting
        - keyboard control

===>   No printer is supported with this virtual mode.




                CMT     CHARACTER MODE TRANSLATOR
                #################################


The purpose of CMT is quite similar to the Virtual Host Mode feature
except :

        . CMT is a seperate slot from PBT/PBH

        . CMT supports up to 6 kinds of terminals now, which are

                VT100 (DEC)
                SCANSET
                ADM-3A
                TELEVIDEO 920/925
                HAZELTINE 1500
                DISPLAYPHONE

           These terminals are character mode oriented only (no block
           mode supported as of today).

         . CMT can access x.25/x.75 slots via DSP IIX dialect.


ASCII character mode terminals may access 3270 host computers through
the 3270 character mode terminal (CMT) emulator.


The CMT 3270 emulator supports terminals operating in character mode,
which allows less intelligent terminals to communicate with a PBH.
Furthermore, the first printer support has been released for VT 100



Page 142              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



terminals.


The ASCII terminal is attached to a CONSAT. A first circuit is built
once the CMT access is performed. A second one is built from the CMT to
PBH once the IBM access is done.


The communication between the CONSAT and CMT is based on the normal
mode (no IIX dialect). The communication between the CMT and PBH slot
is based on DSP dialect (both are smart interfaces). The CMT slot can
be located :


        - in the same node as the CONSAT is
        - in the same node as the PBH is
        - in a seperate node

depending on the criteria (response time, echo...).




3.4  LOGON - LOGOUT PROCEDURES






3.4.1  GENERALITIES




Once the polling is established on both sides, the first menu received
by the device is:

                ---------------
         --->   | MENU SCREEN |
                ---------------

If a STORED LOGON string is selected, no other screen appears (the
STORED LOGON string allows automatic logon).

If MANUAL logon is selected, the second menu is displayed:

                ----------------------
        --->    | BASIC LOGON SCREEN |
                ----------------------




Page 143              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



Upon successful logon the user is placed in ASCII mode if a dumb or
ASCII host is reached. When a gateway is reached and the username is
not a Trnasparent Gateway Username, the following menu is displayed :

                ------------------------
         --->   | GATEWAY LOGON SCREEN |
                ------------------------

When a 3270 host is reached from a PBT or through an x.25/x.75 host,
the following screen is used :

                --------------------
         --->   | DSP LOGON SCREEN |
                --------------------


Stored logon
------------

The stored logon mechanism is provided in the current PBT. This
implimentation allows the user to choose among multiple destination
addresses using descriptions for those destinations that are familiar
to the user.


PVC : Permanent Virtual Circuit
-------------------------------

If the PBT is configured for a PVC, the menu screen will not appear.
The logon process is done automatically, as defined during the
configuration of the PBT. For PVC defined terminals, the flexibility
to access various hosts no longer exists.



Menu screen
###########


By striking any key on the keyboard, this menu is displayed. This
menu seperates a list of one-line descriptions of possible
destinations:


        ACTION : Position the cursor to the desired line
                 Strike the ENTER key.

If you select MANUAL, you enter the MANUAL logon procedure. The BASIC
LOGON SCREEN is displayed.

If one of the STORED LOGON strings is selected, the AUTOMATIC



Page 144              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



LOGON procedure is entered. Then the logon string as defined at
generation time and embedded in the PBT will be sent to the
supervisor, checked and an SVC will be built through the network.

In case of failure, a brief error text is displayed and the user is
given the option of selecting another choice or repeating the same one.


Basic logon screen
##################


The user enters his username and may specify a host number by entering
a colon. The host number immediately follows the colon.


Depending on the options defined at validation time, the username
does not need to enter a host number if the home host is the host
desired. After that, the password is entered without echo. Finally the
ENTER key is pressed to send this data.

When the logon attempt is successful, the cursor is positioned at the
top left corner of the screen. At this time the circuit is built. The
CLEAR, ENTER, PF and PA keys can then be used.

Summary :

        A) USERNAME : USERNAME:host number (TAB)
        B) PASSWORD : PASSWORD
        C) 'ENTER'
          USERNAME:TNSM:180
          PASSWORD ..........
          'ENTER'


Gateway logon screen
####################

To fill this screen, the process is the same as defined in the BASIC
LOGON SCREEN.



DSP logon screen
################

The menu aims at defining :  ---> 3270 - x.25 connection
                             ---> CONNECTION REQUEST MODE


A) DO YOU WANT TO USE ASCII MODE ?



Page 145              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



This question appears when accessing an x.25/x.75 interface supporting
both ASCII and DSP.
The user should enter Y(yes) for ASCII Mode
                      N(no)  for DSP Mode


B) CONNECTION REQUEST MODE (CRM)

The CRM allows the PBH to select the right last port : this is
called the MAPPING PROCESS.

In fact, the PBH contains terminal ports, printer ports color support
ports...and so on.
So, depending on the CRM value, the PBH will assign and select a port
on the FEP (FEP port definition matches the PBH one's) according to
the PBT request.


The CRM has three values :
------------------------

1) ONE TO ONE SELECTION

The user desires to log in to the logical CU and device address
that corresponds exactly to the physical addresses.

Note : The user may specify the application identifier.
----


2) SPECIFIC SELECTION

The user desires the exact application identifier, CU address
and Device address as specified in the next three fields.


3) FREE (or DYNAMIC) SELECTION

The user will select the first available port on the host side,
starting from the bottom to the top.





C) APPLICATION IDENTIFIER
-------------------------

Represents the destination line address

DESTINATION CONTROL UNIT



Page 146              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



------------------------

Represents the Cluster address (host port address)

DESTINATION DEVICE ADDRESS
--------------------------

Represents the port address on the FEP.

The three above values must be entered :

either in  GRAPHIC character
or     in  ASCII
but not in EBCDIC


Ex :                EBCDIC           ASCII          GRAPHIC
--                  ---------------------------------------
Line address :       40               20             space
CU address :         C2               42               B
Device address :     C5               45               E


D) DO YOU WANT EXTENDED ATTRIBUTES ? (Y/N)

"Y" is needed for highlighting, programmable characters, APL char. set

E) DO YOU WANT COLOR ? (Y/N)

"Y" is needed for color terminal


NSS : Network Services Screen
#############################

When the 3270 terminal user successfully logs into the 3270 Host, he is
operating in NATIVE MODE.

In native mode, the NSS: Network Services Screen is used to perform :

                - TERMINAL LOGOUT functions
                - PRINTER Control functions
                - NETWORK LOGOUT functions

A specific key is dedicated to the network services functions when the
interface is generated (see SYSGEN).

Any PF (Program Function) or PA (Program Attention) key may be
specified as a network services key.

The NSS format has been altered to supply more information on the



Page 147              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



status of printers available and to identify a printer in more familiar
terms for the user.

To choose a printer, the user simply placs the cursor next to the
desired printer number and strikes the 'ENTER' key.




3.5  DIFFERENT CASES

                         CASE #1
                         -------

                 (NATIVE - SVC - TERM - AUTO)

LOGON :
-----

         ---> MENU Screen displayed
              ----
         ---> Positions the cursor to the right message identifying the
              destination
         ---> Press 'ENTER'
         ---> You are logged in your Host application
              (WELCOME screen from the Host application)


LOGOUT
------

         ---> Call NSS (press 'PF4', 'ENTER')
         ---> NSS message: CRT IS CURRENTLY LOGGED IN
         ---> Press 'PF1'
         ---> NSS Message : CRT IS CURRENTLY NOT LOGGED IN
         ---> Press 'CLEAR,ENTER'
         ---> MENU screen displayed




                         CASE   #2
                         ---------

             (NATIVE - PVC - TERM - AUTO)

LOGON      The logon process is done automatically.
-----      The only action to do is to check the circuit
           built with the NSS





Page 148              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



LOGOUT
------

          ---> Call NSS ('PF4', 'ENTER')
          ---> NSS message : CRT IS CURRENTLY LOGGED IN
          ---> Press 'PF1'
          ---> NSS message : CRT IS CURRENTLY NOT LOGGED IN
          ---> Press 'CLEAR, ENTER'
          ---> MENU screen displayed

          Note : Depending on a timer, the PVC will be rebuilt
                 automatically (default value after 5 minutes)





                         CASE   #3
                         ---------

                 ( VHM - SVC - TERM - MAN)

LOGON
-----

       ---> Enter USERNAME, host number, password, project
            (only the 2 first fields of the PC). The password and
            PC are separated by a semicolon.


LOGOUT
------

       ---> The disconnection key depends on the type of terminal
            used. IBM 3101 ---> Enter "SHIFT F12"

       ---> The 'PLEASE LOG IN' message is displayed.





3.6  INTERFACES GENERATION











Page 149              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



3.6.1  GENERATION LAYOUT




In order to prepare codes to be loaded in the Tymnet Engine (mini or
micro), the following procedure should be used :



                a - Create input files
                b - Run assembly
                c - Create output files

a - Input files
---------------

TYMFILE : Contains all macros representing customer's configuration.

       PBT TYMFILE :   Definition of all devices, clusters, lines
                       with their respective addresses.
                       Definition of logon procedures, MENUS, security
                       accesses.


       PBH TYMFILE :   Definition of addressable ports matching FEP
                       generation.
                       Definition of security access.


       CMTI TYMFILE :  Definition of logon procedures, MENUS and
                       security accesses.
                       Definition of terminals types used.


COMMAND FILE : Contains NAD commands in order to automatically produce
               object file (NIB file).


SOURCE CODE :  Contains all LIBRARIES and MODULES which compose the
               PRODUCT source code. These files reside on PDP-10
               (SOURCE) directory. Different files are :

               INIT FILE (.I) :       ALL MACROS definitions
                                      ALL DEFAULT values

               SOURCE FILE (.R) :     ALL source instructions
                                      structured into modules and
                                      libraries

               PATCH FILE (.P) :      Optional file containing all



Page 150              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



                                      patch instructions to fix bugs.


b - Assembly
------------

NAD (Node Assembler Debugger) is our PDP-10 system tool to assemble all
files, modules and libraries defined in the command file in order to
produce the object (or NIB) file.



c - Output files
----------------

NAD produces at the ind of assembly an object file whose name is NIB
file (NAD IMAGE BINARY). This file can be either :

        - directly loaded in an ISIS slot
        - bound with other slots to prepare a complete engine code


Moreover, depending on certain parameters defined in the command files,
a file containing CROSS Reference table can be generated by NAD.



3.6.2  COMMAND FILES


        TITLE   3270 TERMINAL INTERFACE, VERSION 5.03
        SUBTTL

;;Parameters for listing file
LIST L,F,X,-R

;;Init File PBT for  5.03 (Baseline M)
;@(SOURCE)PBT05.I03

;;TYMFILE
;@PBT.T02

;;SOURCE file for PBT 5.03 (Baseline M)
:@(SOURCE)PBT05.R03

;;PATCH file for PBT 5.03 (Baseline M)
;@(SOURCE)PBT05.P03

;;NIB file creation
1;FPBT.N02




Page 151              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



;;Segment 'E' (or CTA) copied in NIB file
SEGE,SESIZE;P

;;Segment '0' (DATA) copied in NIB file
SEG0,S0SIZE;P

;;Segment '1' (CODE) copied in NIB file
SEG1,S1SIZE;P

;;Segment '4' (DCB) copied in NIB file (Data Control Block)
SEG4,S4SIZE;P

;;Segment '5' (MENUS) copied in NIB file
SEG5,S5SIZE;P

;;Symbols copied in NIB file
%P

;;Exit NAD
%Q





3.6.3  LAB




A. Explanation of PBT CMD/TYM files

                LB2047.C01
                LB2047.T01

B. Modification.

        ---> Restrict access to OnTyme only for all terminals
             attached to the second line

        ---> Cypher WELCOME password

        ---> Define a 3274 with one 3278 on a newline with access
             to all menus

                Line Add   : C2 (B)
                CU Add     : 40 (space) (3274)
                Device Add : 40 (space) (3278)

C. Explanation of CMTI CMD/TYM files




Page 152              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



                LB2047.C03
                LB2047.T03

D. Modification.

        ---> Define 12 users instead of 5

        ---> Remove header

        ---> Remove 1st menu screen : Terminal Type Screen

        ---> Allow access to TEST username





3.7  INTERNAL STRUCTURE



3.7.1  LIBRARIES




Main libraries generally used in Tymnet codes are as follows:

START.LIB---->ISIS ASSEMBLY SWITCH DEFINITIONS.
                Used for defining SVC names, registers functions,
                location of codes, data, buffers, patches within
                segment rings and buffers based addresses.
                Note : 1st library assembled.

TRACE.LIB---->ENGINE HARDWARE TRACES ROUTINES.

TIMOUT.LIB--->STANDARD TIMEOUT ROUTINES.

FRING.LIB---->ISIS RINGS HANDLING ROUTINES.
                Routines for storing or extracting data from
                IRING/ORING and for updating pointers.

CONVRT.LIB--->BINARY TO DEC/HEX CONVERSION ROUTINES.

CRASH.LIB---->SOFTWARE AND HARDWARE CRASH HANDLING PACKAGES.

BBFLET.LIB--->BIG BUFFERLETS POOL.

FRNTND.LIB--->ISIS FRONT-END INTERFACE.

(STAUS.LIB)->EXTENDED DDT COMMANDS (BOM)



Page 153              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



PATCH.LIB---->PATCH INSTRUCTIONS DEFINITION.

FINISH.LIN---->CONTROL TABLE AREA ALLOCATION AND DIAG.
                Assembly errors message, segment size definition.





3.7.2  MODULES


cf. slides




3.7.3  PROCESSES




ISIS divides job processes into three processes all of which are broken
down into hierarchical levels.

These three processes are:

        - FOREGROUND
        - BACKGROUND
        - DDT's (Dynamic Debugging Tool)

Every slot contains these three processes.



A. FOREGROUND

Scheduled to execute every 25 msec (milleseconds). Time is allocated
in clockticks (1 tick = 1/600 sec, 1,666 msec called FASTC).

The minimum for a FOREGROUND process is 2 ticks, and for every 3
logical units, there is an additional tick of execution time.

Note : There are only 16 ticks of execution time available for the
       entire machine. The KERNEL uses 1 tick, leaving 15 for
       the remaining slots (15 x 1,666 msec = 25 msec).

The FOREGROUND is used to control external devices, to handle lines
(for example transfers data from the input buffer to the background).
The FOREGROUND must answer very fast and is used very often.




Page 154              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



B. BACKROUND

This process is the workhorse of the machine which performs the major
effort of the interface. BACKROUND is allocated 5 msec of CPU time,
but is scheduled on execution chain, round robin, after execution they
go to the end of the list.

These timeslices can be interrupted by the FOREGROUND process.

Note : In a wellbalanced machine BACKROUND jobs will get
       100 shots at the CPU and execute only 8 msec.

A job can dismiss at any time during its timeslice. In this case a new
timeslice is then created for the next job.


C. DDT

Dynamic Debugging Tool can be loaded into throughout the network to:

        - control
        - modify
        - debug
        - reload a slot

As with the BACKROUND, DDT also receives 50 msec timeslices, but will
only use the time needed which is generally less than 10 msec.



SLOT PROCESS RULES
------------------

        1. KERNEL will step in when it gets an interrupt,
           taking the CPU time it needs to service the
           interrupt, then it will give the CPU back to
           the process that has been interrupted.

        2. If the slot is running only one process, it can
           only be BACKROUND or DDT.


SUMMARY
-------


                       When            How long        Control
-------------------------------------------------------------------
INTERRUPTS             Any time        No limit         No
-------------------------------------------------------------------
FOREGROUND             Every 25 msec   Ft               Yes



Page 155              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



-------------------------------------------------------------------
BACKROUND              Next in queue   50 msec          Yes
-------------------------------------------------------------------
DDT (Services)         Each command    50 msec          Yes
-------------------------------------------------------------------





3.7.4  SEGMENTATION




The MEMORY MANAGEMENT is provided by the MAC (MEMORY ACCESS
CONTROLLER). The MAC provides 2 major functions:

        - relocation
        - protection

The relocation permits any of the interface programs available to be
loaded into any slot on the machine, without any need to modify the
program. The relocation also permits any combination of slots loaded
into a single engine.

The protection prevents any slot from crashing the ISIS operating
system or any of the other slots in the machine if the software in
that slot fails.

Mac segmentation
----------------

Each slot is divided into 16 segments numbered from 0 to F. Each
segment uses up to 64 K. This means that 1 slot could use the total
amount of physical memory which is 1 megabyte.

This involves the relocation process. The software addresses (VIRTUAL
ADDRESSES) are relocated to real addresses (PHYSICAL ADDRESSES).

Segment 0 uses virtual addresses 00000 - 0FFFF
Segment 1 uses virtual addresses 10000 - 1FFFF
Segment 2 uses virtual addresses 20000 - 2FFFF
--------------------------------------------------
--------------------------------------------------
Segment E uses virtual addresses E0000 - EFFFF
Segment F uses virtual addresses F0000 - FFFFF

The user has no access control over segments E and F. Segment E maps
into the beginning of the user's physical address area UNCONDITIONALLY!




Page 156              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



Segment F is located in the KERNEL and shared by all slots.

Segment E is the slot's CTA (Central Table Area), which contains all
neccessary descriptors to describe the running configuration of the
slot as
         - pointers to variables
         - memory layout

Segment 0 is the DATA area. This segment contains the constants.

Segment 1 is the CODE area. It is the program itself.

Segment 2 contains rings.

Segment 3 and others are generally buffers.

Note : for PBT, segment 5 contains the menu.

Segment 4 contains DCB (Device Control Block)




3.8  INTERFACES MONITORING and DEBUGGING




3.8.1  GENERAL DDT COMMANDS




For remote access, the following commands are a good sampling of what
you will find useful.

1. H - halt slot

2. E - execute slot

3. R <address>, <byte count of read> <cr> - read from engine memory
   specified number of bytes starting at specified address

4. Z - logoff, responds with "logging off?" and a second Z is required
       to complete the logoff

5.  - reset DDTm, used to recover from an error condition

6. | <slot #> - switch to another slot (if it is available)





Page 157              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



                       ------------------


The following question mark commands all require a carriage return to
terminate:


a. ?MAC - outputs table that displays the slot's current MAC
          configuration

b. ?SLOT - outputs current slot number

c. ?VERN - output ISIS and slot's code version numbers

d. ?BT - outputs current background PSD

e. ?FT - outputs current foreground PSD

f. ?BRR R,N - outputs the current values of the running backround
              registers. This is approximate. R is the beginning
              register number and N is the total number of registers
              you wish displayed.
              Example : to read all the registers, type ?BRR 0,10 (hex)

g. ?FRR R,N - outputs the current values of running foreground
              registers. Same arguments as above.

h. ?CT - outputs a table of dispatcher circuits attached to that slot
         and the other end including the RPORT numbers at both ends.

i. ?USE - outputs a table of the dispatcher ports currently active,
          and the maximum (decimal) number of characters that the
          dispatcher needs to buffer in each direction.

j. ?HOST - outputs a table of the hosts declared to the Supervisor
           from that slot, the host state (gone!, down!, shut, and
           answered), the total number of dispatcher ports for that
           slot, and the number of ports in use.

k. ?WHO - outputs a table for each slot showing the current DDT
          status of that slot, and the two most recent usernames to
          log into that slot's DDT. This provides a short history of
          who may have been making changes.

l. ?STAT - connects you to an extended DDT function you may have
           running in your slot. For example, XRAY or XCM.

m. ?PORT - lists all current DDT users.

n. ?HANG - destroys the DDT circuit for the port specified. This is
           necessary when a partial DDT circuit remains upon



Page 158              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



           disconnect. Until the remnant is destroyed, users will not
           be able to access that slot.

o. ?TIME - outputs current system time (time elapsed since node was
           last loaded).

p. ?HIST - all diagnostic messages in the node system diagnostic queue
           will be displayed, starting with the oldest.

q. ?CPU - a "snapshot" of the fast clock and the appropriate local
          clocks is performed, then DDT dismisses for approximately
          one second. The elapsed time is calculated, converted to a
          percentage, and displayed. Further, the total "span"
          (number of bytes processed) of the dispatcher input and
          output rings is displayed.

r. ?LU - outputs a list of logical units and the associated device
         type and unit number.


(NOTE : the ?BRR and ?FRR commands are to be used with caution,
especially when reading a string of registers. The program may be
dismissed in the middle of the read, and after it has picked up the
following registers reflect a different point in time than those
already displayed. This command can be useful if the slot is in a loop
or frozen.)






3.8.2  DATASCOPE TRACES


cf slides




3.8.3  CRASH TABLES


cf slides










Page 159              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



3.8.4  BUFFER TRACES


cf slides





3.8.5  TROUBLESHOOTING




a) Monitoring
-------------

b) Procedures
-------------
BOM/DDT/NCCF

Events

Slot crash

        DUMP the slot (with LOADII)
        RESTART the slot (*E DDT command)
        RELOAD the slot (if RESTART is inefficient)

Cannot login.  Check :

        PBT menus displayed (polling)
        Error messages displayed (which one)
        Login string correct (validation)
        Mapping correct (CRM? Color port?)
        PVC?
        PBH answered?
        Out of ports?
        Logon time-out?
        New slot, new IBM device?

Cicuit zapped.

       Logout message displayed (no traffic?)
       Timers (IACTIM, POLT3)
       Bad CRC (too many NAK's ---> datascope traces?)

No polling.

       Modem signals (switched/leased)
       Synchronous port? (exchange)



Page 160              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



       FEP line active?

Slow response time.

        Retransmission (NAK)
        Network load (?CPU)
        Number of circuits built (BOM)





3.9  CONFIGURATION



3.9.1  FIGURES




                       PBT
                       ###


Memory   Configuration                    Automatic logon
Size     Line(s)    Device(s)   Element   (stored)


66       1          1
81       1          9           6         4
85       2          9           6         4
124      3          27          13        15
204      3          255         13        15




                       PBH
                       ###

Memory   Line(s)    Port(s)     Buffer    Mapped
Size                            Screen    Ports


122      1          1
148      1          6           2         5
160      2          7           2         10
166      3          19          4         10
235      5          255         4         10




Page 161              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



                       CMT
                       ###


Memory size     Simultaneous            Terminal type
                   User

30K                 1                           1
54                  5                           2

===> 30K (base)
   +  4Kmultaneous user (w/o printer)
   +  5Kmultaneous user (w/ printer)
   +  2Kerminal type

Limitations (PBT/PBH)

       ---> Up to 255 devices / slot
       ---> Up to 16 lines / slot
       ---> Up to 16 CU / lines
       ---> Up to 32 devices / CU (depending on the type of CU)
       ---> Up to 8 or 10 simultaneous users



3.9.2  CONSTRAINTS




         ---> ASCII 3270 TERMINALS NOT SUPPORTED

         ---> CU3275 in dial-up with contention mode NOT SUPPORTED

         ---> 3270 command test request key NOT SUPPORTED

         ---> Special features (i.e. APL) NOT FULLY SUPPORTED

         ---> IBM 3101 numeric fields NOT SUPPORTED

         ---> CMT NO MANUAL LOGON
                  NO PVC












Page 162              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



3.10  SCHEDULES



PBT/PBH

        ---> Complete redesign of the PBT/PBH tymfile

        ---> New  BOM  version

        ---> Disconnection procedure improvements

        ---> Additional information on NSS

        ---> Commands sent to applications at end of session

        ---> Recovery of transaction screen

        ---> DSP logon removed



CMT

        ---> Printer support

        ---> MANUAL LOGON option

        ---> CMT Operations Monitor

        ---> Additional terminals supported :

                 - HP Series 262X/December 84

                 - ADM11 Support (Printer ADM #1178)

                 - ADDS Viewpoint 60

                 - VT200 Support (and family)

                 - DASHER (Data General)













Page 163              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



3.11  GLOSSARY



OS/VS1        Operating System/Virtual Storage 1

MVS           M Virtual Storage

DOS/VS        Disk Operating System/Virtual Storage

DOS/VSE       Disk Operating System/Virtual Storage Extended

VM/3270       Virtual Machine/370

VM/CMS        Virtual Machine/Conversational Management System

RJE           Remote Job Entry

JSE2          Job Entry System 2

NJE           Network Job Entry

POWER/VS      IBM POWER running under VSE

NTO           Network Terminal Option

NCCF          Network Communication Controller Facility

NPDA          Network Programs Diagnostic Application

IMS/VS        Information Managment System

CICS/VS       Customer Information Control System

TSO           Time Sharing Option

VSPC          Virtual Storage Personal Computing

DPPX          Data Programming Process Executive

SDLC          Synchronous Data Link Control

BSC           Bisynchronous Characters

ACF/NCP/VS    Advanced Communications Function for the Network Control
              Program. A program product that provides communication
              controller support for single-domain and multiple-domain
              data communication.

ACF/TCAM      Advanced Communication Function for the
              Telecommunications Access Method. A program that provides



Page 164              PBTERS.DOC







3270 REFERENCE MANUAL FOR PBT                  July 22, 1988



              single-domain data communications capability and,
              optionally, mulitple-domain capability.

ACF/VTAM      Advanced Communication Function for the Virtual
              Telecommunications Access Method. A program product that
              provides single-domain data communication capability and,
              optionally, multiple-domain capability.

ACF/VTAME     Advanced Communications Fuction for VTAM Entry. A program
              product that provides single-domain and multiple-domain
              capability for an IBM 4331 that may include communication
              adapters.










































Page 165              PBTERS.DOC







DIAL-UP                                        July 22, 1988



                          4.  DIAL-UP


     This document describes the   support  of  dial-up  function
for  3270  BSC  Terminal Interface.  With this function, the user
may log in to the IBM host  through the   telephone  line.   This
document  is   divided  into four sections.  The first section is
introduction, which  discusses the purpose of this document.  The
second  section gives the  overall diagram of the dial-up system.
The third  section  deals  with   signals  exchanged  during  the
dial-up  processing  and the messages  generated by  the IBM 3274
Control Unit during  the dial-up processing.  The  last   section
of  this  document   gives  the  details   of  the  requirements,
external macros and TYMFILE configuration of the dial-up system.



4.1  Overall diagram of dial-up system


       -----------
      | TELEPHONE |
       -----------
           |
           |
           |
       ---------         -----  TELEPHONE  -----         -------
      | MODEM   |-------| NCU |-----------| NCU |-------| MODEM |
       ---------         -----     LINE    -----         -------
          |                                               |
          |                                               |
          |                                               |
      ---------   ------                                ---------
     | CONTROL | | IBM  |                              |  3270   |
     |  UNIT   | |  PC  |                              |TERMINAL |
      ---------   ------                               |INTERFACE|
         |                                             | ENGINE  |
         |                                              ---------
         |
      --------
     |TERMINAL|
     |   OR   |
     |PRINTER |
     | DEVICE |
      --------









Page 166              PBTERS.DOC







DIAL-UP                                        July 22, 1988



4.2  Control signals and status messages in dial-up system



4.2.1  Control signals


    -----------
   | TELEPHONE |
    -----------
        |
        |
        |
      -------   CML   -----              -----   CI     -------
     |       |------>|     | TELEHPONE  |     |------->|       | DCD
     | MODEM |<------| NCU |<---------->| NCU |<-------| MODEM |---->
     |       |  DSC  |     |   LINE     |     |  CML   |       | DSR
   ->|       |--     |     |            |     |     -> |       |---->
  |   -------   |     -----              -----     |    -------
 D|   ^    |C   |D                                D|     ^  |C
 T|  R|    |T   |S                                T|    R|  |T      |
 R|  T|    |S   |R                                R|    T|  |S      |D
  |  S|    v    |                                  |    D|  v       |S
  |  ---------  |                                  |   ---------    |R
  --| CONTROL |<-                                   --|  3270   |<--
    |  UNIT   |                                       |TERMINAL |
     ---------                                        |INTERFACE|
        |                                             | ENGINE  |
        |                                              ---------
        |
     --------
    |TERMINAL|
    |   OR   |
    |PRINTER |
    | DEVICE |
     --------



4.2.2  Status messages


     The followings  table shows the  status  messages  generated
by  the  IBM  3274 Control  Unit  that may  be  displayed on  the
IBM 3278/3279 terminal during the  dial-up   processing.   Please
refer to  relevant IBM documentations for the descriptions of the
status messages generated by the different IBM devices.

 ---------------------------------------------------------------------
| INDICATOR |      CAUSE          |       EFFECT        |    ACTION   |
|---------------------------------------------------------------------|



Page 167              PBTERS.DOC







DIAL-UP                                        July 22, 1988



|   X  <    |LINE IS CONNECTED.   |LINE IS CONNECTED.   |WAIT FOR A   |
|           |TIME IS REQUIRED     |USER MAY LOG IN TO   |POLL SEQUENCE|
|           |FOR THE SYSTEM TO    |HOST AFTER THE       |RECEIVED.    |
|           |PERFORM A FUNCTION.  |SYSTEM IS UP.        |             |
|---------------------------------------------------------------------|
| --/-- 501 |DATA-SET-READY (DSR) |LINE IS DISCONNECTED.|CHECK MODEM  |
|           |SIGNAL FROM THE MODEM|COMMUNICATION IS     |USER MAY     |
|           |HAS DROPPED.         |INHIBITED.           |RE-DIAL.     |
|---------------------------------------------------------------------|
| --/-- 502 |CLEAR-TO-SEND (CTS)  |COMMUNICATION IS     |CHECK MODEM. |
|           |SIGNAL FROM THE MODEM|INHIBITED.           |             |
|           |IS MISSING.          |                     |             |
|---------------------------------------------------------------------|
| --/-- 530 |WRITE TIMEOUT CAUSED |COMMUNICATION IS     |CHECK MODEM. |
|           |BY:                  |INHIBITED.           |             |
|           |A. MODEM CLOCKING    |                     |             |
|           |   IS MISSING, OR    |                     |             |
|           |B. CTS HAS DROPPED.  |                     |             |
|---------------------------------------------------------------------|
| --/-- 532 |LINE IS CONNECTED    |COMMUNICATION IS     |CHECK 3270   |
|           |BUT APPROXIMATELY    |INHIBITED.           |TERMINAL     |
|           |20 SECONDS HAVE      |                     |INTERFACE.   |
|           |ELAPSED WITHOUT      |                     |VERIFY THE   |
|           |THE DETECTION OF     |                     |OPERATIONAL  |
|           |SYN CHARACTERS ON    |                     |STATUS OF THE|
|           |THE LINE.            |                     |COMMUNICATION|
|           |A VALID POLL OR      |                     |NETWORK.     |
|           |SELECTION-ADDRESSING |                     |             |
|           |SEQUENCES IS EXPECTED|                     |             |
|           |FROM 3270 TERMINAL   |                     |             |
|           |INTERFACE.           |                     |             |
 ---------------------------------------------------------------------
        " < "   : refer to the clock symbol in the status line.
        "--/--" : refer to the lightening symbol in the status line.



4.3  3270 Terminal Interface dial-up support



4.3.1  Requirements


     (a) The dial-up support is specified per line.

     (b) In order to detect whether the full-duplex line between
the engine and the modem is connected, the 3270 Terminal Interface
checks the status of DSR periodically. Therefore, one of the pin
from the modem must be wired into the DSR pin (pin 6) of the
engine synchronous port to indicate the line status.



Page 168              PBTERS.DOC







DIAL-UP                                        July 22, 1988



                         CABLE
  ---  TD(pin 2)                             TD(pin 2) ---
 |   |<-----------------------------------------------|   |
 |   | RD(pin 3)                             RD(pin 3)|   |
 |   |----------------------------------------------->|   |
 |   | RTS(pin 4)                           RTS(pin 4)|   |
 |   |<-----------------------------------------------|   |
 | M | CTS(pin 5)                           CTS(pin 5)| E |
 | O |----------------------------------------------->| N |
 | D | DSR(pin 6)                                     | G |
 | E |-------------->                       DSR(pin 6)| I |
 | M | DCD(pin 8)      ------------------------------>| N |
 |   |-------------->                                 | E |
 |   | DTR(pin 20)                         DTR(pin 20)|   |
 |   |<-----------------------------------------------|   |
 |   | TCX(pin 15)                         TCX(pin 15)|   |
 |   |<-----------------------------------------------|   |
 |   | RCX(pin 17)                         RCX(pin 17)|   |
 |   |----------------------------------------------->|   |
 |   | RND(pin 7)                           RND(pin 7)|   |
 |   |------------------------------------------------|   |
  ---                                                  ---


     (c)  For  full-duplex  line,  the  DTR/DSR  handshaking   must  be
performed before the line is connected or disconnected.

     (d) For switched line,  the RTS/CTS handshaking must  be performed
before data is transmitted.

     (e) If the line is a full-duplex line, the 3270 Terminal Interface
monitors the status of DSR  periodically.  If the DSR signal is  up, it
means that  the line between  the Terminal Interface  and the  modem is
connected.  If the DSR signal is down, it means that  the communication
was  broken and  the Terminal  Interface must  drop the  DTR  signal to
disconnect the line.

     (f) For the full-duplex line,  if the DSR signal is  detected down
during  the  session,  the  3270 Terminal  Interface will  zap  all the
circuits on the current line  and disconnect this line by  lowering the
DTR signal.

     (g)  For  the  full-duplex line,  the  Terminal  Interface  zaps a
circuit  between the  Terminal Interface  and the  Host  Interface, the
Terminal Interface checks whether this device is the only active device
on the current  line.  If it is,  the Terminal Interface will  keep the
line up for a specific  time to allow the users logging-in.   When this
time interval is expired and  the user has not logged in,  the Terminal
Interface will disconnect the line by lowering DTR.

     (h) For  the full-duplex  line, if the  line between  the Terminal



Page 169              PBTERS.DOC







DIAL-UP                                        July 22, 1988



Interface and the modem is connected, and there is no circuit built for
the  devices in  the  current line  in  a specific  time,  the Terminal
Interface will disconnect the line by lowering the DTR.

     (i)  A hang  logic is  applied to  the switched  line in  the 3270
Terminal Interface to support the dial-up.  With this feature,  a timer
checks for the line inactivity and clears the line by lowering  the DTR
signal.

     (j)  During  the  system initialization  time,  the  3270 Terminal
Interface turns the DTR on to allow the user's dialing-in.  If the line
is a  half-duplex line, the  Terminal Interface periodically  sends the
polling to the  Control Unit in order  to accept the  user's dialing-in
and logging-in.  Because the  hang logic is applied to  the half-duplex
line, the 3270 Terminal Interface  can be aware of the  line inactivity
and disconnect the line by lowering the DTR signal.

     (k) For  the switched  line, if there  is no  response to  the (i)
polling, (ii) select, (iii)  text and (iv) acknowledgement sent  by the
Terminal Interface during the assigned interval, the Terminal Interface
will  do  the  recovery.   If the  recovery  fails,  the  line  will be
disconnected by lowering the DTR.

     (l) After the 3270 Terminal  Interface drops the DTR signal  for a
specific time to disconnect the line, the Terminal Interface  must turn
on the DTR signal to allow the incoming dial-up.

     (M) for 208b half duplex modems of equal type the macro DTRDSR
will function and allow for proper modem operation.


4.3.2  Synchronous I/O Interface Board


     The Synchronous I/O board serves as an interface between  a TYMNET
engine and  up to  16 synchronous lines.   On this  board there  are 16
synchronous ports which are divided into 4 groups:


               Group 1      Group 2      Group 3      Group 4

                 0            4            8            12
                 1            5            9            13
                 2            6           10            14
                 3            7           11            15

     Only  two  ports  in  each group have  provisions  for   DTR
(Data-  Terminal-Ready),  DSR (Data-Set-Ready),  RTS (Request-to-
Send)  and CTS (Clear-to-Send).  These ports are 2, 3,  6, 7, 10,
11,  14  and   15.   The  other   8   ports   do   not   have the
provision  for  DTR,  DSR  and CTS.   Furthermore;  the  RTS   is



Page 170              PBTERS.DOC







DIAL-UP                                        July 22, 1988



always held high  on these ports.  Those lines supporting dial-up
must have the  provision for DTR, DSR, RTS  and CTS.   Therefore,
only  8  ports in synchronous I/O interface board can  be used to
support dial-up.   A second Synchronous  I/O Interface board  can
be installed in the Engine to support the dial-up.


4.3.3  The macros related to dial-up


 (DEFRTS - default RTS/CTS handshake signals)
 (RTSCTS - RTS/CTS handshake signals)
 (DEFDTR - default DTR/DSR handshake signals)
 (DTRDSR - DTR/DSR handshake signals)
 (DEFSWT - default SWITCH/LEASE line)
 (SWITCH - SWITCH/LEASE line)
 (DEFHAN - default hang logic)
 (HANG - hang logic)
 (TMIACT - time interval to check line inactivity)
 (HNGDTR - the time interval to hang DTR down)
 (MONDSR - time interval to monitor the DSR signal)
 (NLOGIN - time interval for no log in)
 (SPOLTM - time interval for slow poll)
 (PRESTM - timeout limit for response to the polling)
 (SRESTM - timeout limit for response to the select)
 (DRESTM - timeout limit for response to the text)
 (ARESTM - timeout limit for response to the ACK)

4.3.4  Generate the system



     (a)  The  3270  Terminal  Interface   TYMFILE   should    be
defined  correctly.    If  the   line  is   a  full-duplex  line,
macros SWITCH(YES), DTRDSR(YES), RTSCTS(YES) and HANG(YES) should
be  defined  in  the  TYMFILE  to   specify  the  requirements of
RTS/CTS  handshake  signals, DTR/DSR handshake  signals and   the
hang   logic for  this  full-duplex switched line.   If the  line
is a  half-duplex line,   the   macros  SWITCH(YES),  DTRDSR(NO),
RTSCTS(YES),  and  HANG(YES)  should be defined in the TYMFILE to
specify the requirements of RTS/CTS handshake  signals  and  hang
logic for this half-duplex line.

     (b) Before generating  the  system,  the   field  CC  should
check  the  engine  TYMFILE to make  sure those synchronous ports
which  are  defined  as  the  switched  lines  in  3270  Terminal
Interface  have  the provision for DTR, DSR, RTS  and CTS.  Also,
at  system initialization time,  an ISIS I/O control SVC  is used
to  query  whether the line is  supporting DTR, DSR, RTS and CTS.
If it is not, the 3270 Terminal Interface  slot will  be  crashed
with the crash code "20".



Page 171              PBTERS.DOC







DIAL-UP                                        July 22, 1988



     (c) During the SYSGEN  processing,  if  the  user  specifies
the  line as a switched line, then  the RTS/CTS handshake signals
and  hang logic must  be included.   If the   line  is   a  full-
duplex   line,   the  DTR/DSR handshake  signals  are  also  must
be  included.     If  the  RTS/CTS handshake signals  are missing
for  a  switched   line,  an   error  message "***ERROR...RTS/CTS
HANDSHAKE SIGNALS ARE REQUIRED BY LINE ##"  will be displayed  on
the  terminal.  If the hang logic is missing for a switched line,
an error message "***ERROR...  THE HANG LOGIC IS REQUIRED BY LINE
##"  will be displayed on the terminal.  If either kind of  these
errors occurred, the NIB file will not  be generated at  the  end
of  SYSGEN and an  error  message "ASSEMBLY  ERROR,  NO NIB  FILE
GENERATED"  will be displayed on the terminal.


4.3.5  Bisync Operations Monitor command


     The  BOM  (Bisync  Operations   Monitor)  is  a   tool   for
monitoring  and  controlling the  features of  the 3270  Terminal
Interface.   The QLINE (Query Line) command in  the  BOM  can  be
used  to query the status  of a specific line.
































Page 172              PBTERS.DOC







BIT ERROR RATE TESTING                         July 22, 1988



                  5.  BIT ERROR RATE TESTING



    This   section   describes   the   specifications   for   the
enhancements  of doing Bit Error Rate Testing via the 3270 Bisync
Operation Monitor.

    This enhancement was initiated by the PIR#  1221  for   South
Western  Bell  Private  Network,   and  to be implemented  in the
latest  release of 3270 Polled Bisync Terminal Interface.

    The implemented BERT testing is compatible with the  existing
stand alone sync line diagnostic package SLSYNC.  There are  some
differences in the procedures and in  the  enviroment  where  the
utility  is   run.   The  implemented BERT can co-exist with  the
other lines that are  not under testing, and  are  running  under
BSC protocol.

    Some notations are explained  as follows.   In  the   command
syntax,   the   characters  enclosed   in  the  parentheses   are
optional, and  are not required  to  complete   the   meaning  of
the command.   However,  if the characters are to  be entered for
the  sake of clarity, the  exact word must be used.

    For   the   parameter   fields,   brackets   are   used    to
enclose the optional  arguements.   For  multiple  brackets,  the
inner  brackets represent  those parameters  that  are   optional
only   if   the  parameter  enclosed  by  the  outer  brackets is
entered.



5.1  Support Considertions



    There are  BOM commands  to monitor  the   daily  performance
of   the   line    connections;   QLINE   queries   the  hardware
configurations  of the line,  QCU  checks  the  transmission  and
receiving   status    of   the  connections  between  PBT and the
control units.  CONF is used  to query the  device  configuration
of the slot on each drop.

    If  QCU  command  shows  errors   either   in   transmit   or
receive  operations,   or  for   preventive  maintenance purpose,
BERT  testing is receommended to exercise the transmission  media
for reliability test.

    In the implementation, the  normal  BSC  activities  must  be
maintained  as  usual  for  those  lines  that are not under BERT



Page 173              PBTERS.DOC







BIT ERROR RATE TESTING                         July 22, 1988



process.

    The   signals   DTR/DSR   and    RTS/CTS   should   also   be
manipulatable  so  as   to  test   the  functionalities   of  the
modems,  and   the  synchrounous  controller  on    the   Engine.
However,   the  manipulations  are   limited to the non-primitive
lines(explained in  the  test  facilities section).  ISIS ignores
any requests for manipulations on the primitive lines.



5.1.1  Test Facilities


    If the  Bit Error Rate   Testing  is  run   on  the  existing
line, the facilities required are already in place.

    For   new   installations,   the   testing    involves    the
synchronous  controller  on  the  Engine,  the  local  modem, the
communications links(ie.  Telco lines), and the remote modem.

    This  test can  also  be run  with  the local  loopback  test
plug  connected   to  the   sync cable,  which comes  out of  the
engine's back pannel.

    The sync lines supported by  the  engine  sync  card  can  be
grouped  in  two  categories.   There  are 16 sync lines per sync
card, four sync lines constitues one sync group, four  groups  in
all for one sync card.

    The first two lines in each  sync  group  are  classified  as
primitive   ports,  and  do   not  support  DTR/DSR   or  RTS/CTS
handshake  signals.   The  last  two  lines  in  each  group  are
classified  as  non-primitive  ports,  and  these  lines  can  be
configured  for  DTR/DSR  and/or  RTS/CTS  handshake  signals  if
desired.

    For  the  HDLC-simulated   micro  engines,  all   the    sync
lines  configured  for  the  node  can  support  DTR/DSR, RTS/CTS
handshake signals.



5.1.2  Test Enviroment



    BERT testing  requires  the  line   be  looped  back  to  the
Engine,  and  this can  be achieved by  either placing the  local
modem  in AL(Analog Loopback) or DL(Digital  Loopback)  mode,  or
the remote modem in AL or DL mode. If the line is not looped back



Page 174              PBTERS.DOC







BIT ERROR RATE TESTING                         July 22, 1988



it will cause a communications check,  resulting  in  irreparable
damage.

    The local loopback of the  Engine is done  by  connecting   a
special loop back test plug provided by FE.

   ---
  |   |     -----------
  | T |----| TEST PLUG |
  |   |     -----------
  |   |                      _______
  | I |                     |       |
  |   |            DIGITAL  | LOCAL | ANALOG LOOP-BACK
  |   |---------------------|       |--------------------
  | F |           LOOP-BACK | MODEM |                    |
  |   |                     |_______|                    |
  |   |                                                  |
   ---                                                   |
                                                         |
                                                         |
                                                         |
                                                         |
         ---                                             |
        |   |                 ________                   |
        |   |                |        |                  |
        | C |       DIGITAL  | REMOTE |                  |
        |   |----------------|        |------------------
        | U |      LOOP-BACK | MODEM  | ANALOG LOOP-BACK
        |   |                |________|
        |   |
         ---



5.1.3  Test Patterns



    Three  test patterns  are provided.   One, and  only one   of
these  patterns  must   be specified before  the BERT testing  is
allowed  to be started.



5.1.3.1  2047 Pattern


    This is a special pattern,  as the name  implies,  that   the
pattern does not repeat until 2047 decimal bits.





Page 175              PBTERS.DOC







BIT ERROR RATE TESTING                         July 22, 1988



5.1.3.2  Alternating Pattern


    This alternating pattern is generated as a continuous  stream
of  5's, the data stream may show up in the scope as a continuous
stream of A's


5.1.4  User Supplied Pattern


    The user must, when selecting this test  pattern  generation,
supply  a  4-byte data pattern for the BOM to deliver to the line
for testing.



5.2  Testing Procedures


    To perform BERT, the target line must be idle with no  active
terminals  in  sessions with the host.  Bom commands are provided
to query the online devices, and to send messages to the users on
which the line will be brought out of service.

    The test pattern must be specified, as well as the  selection
of the line with BOM commands.

    Once the line  is clear with no  users, place the modems   in
loop-  back  mode as desired.  Exercise the BERT testing commands
in BOM, and monitor the test results.

    The BERT testing  can be conducted  from   either  the  local
site  or  the  remote  control unit  site,  this depends  on  the
availablity of  personnell  to  access  the  modems  or  the  DTE
equiptments.




5.3  Bisync Operations Monitor Commands



 (?BERT     - Query Available BERT Commands)

 (SELECT    - Select Sync Line for BERT)

 (PATTERN   - Select BERT Test Pattern)

 (DTRON     - Turn On Data Terminal Ready)



Page 176              PBTERS.DOC







BIT ERROR RATE TESTING                         July 22, 1988



 (?DSR      - Query State of Data Set Ready)

 (DTROFF    - Turn Off Data Terminal Ready)

 (RTSON     - Turn On Request To Send)

 (?CTS      - Query State of Clear To Send)

 (RTSOFF    - Turn Off Request To Send)

 (STARTBERT - Start Executing BERT)

 (STOPBERT  - Stop Executing BERT)

 (BERT      - Show Results of BERT)

 (TALK      - Broadcast or Send Message to Terminals)

 (RSTBERT   - Reset BERT Test Results)

 (BERTMODE  - Query/Change Output Mode For BERT)

 (ONLINE    - Query Online Devices)



5.4  Execution Examples


    The following is an example of the sequence for doing BERT,
explanations of the commands are presented at the end of  the sequence,
and  are done  according to  the sequence  number associated  with each
command.

 :> ONLINE                       ...1

 :> MODE REL                     ...2

 :> TALK lnn or                  ...3

 :> MODE ADR                     ...4

 :> TALK lna cua or              ...5

 :> TALK lna cua dva             ...6

 please type message below(maximum 79 characters), end with CR :

 THIS LINE IS GOING DOWN, PLEASE LOG OFF. carriage return

 :> ONLINE                       ...7



Page 177              PBTERS.DOC







BIT ERROR RATE TESTING                         July 22, 1988



 :> PATTERN n                    ...8

 :> SELECT lna or                ...9

 :> MODE REL                     ...10

 :> SELECT lnn                   ...11

 :> DTRON                        ...12

 :> ?DSR                         ...13

 :> RTSON                        ...14

 :> ?CTS                         ...15

 :> STARTBERT                    ...16

 :> BERT                         ...17

 :> BERT 1                       ...18

 :> STOPBERT                     ...19

 :> QCU cun                      ...20

 :> QCU cun                      ...21


1. ONLINE

    This command queries the online devices, and is recommended  to be
the first command issued to ensure that the line to be tested  does not
have any active terminals. The line where the devices are defined can
be obtained by the command CONF.

2. MODE REL

    This command sets the arguement input mode to be relative, so that
the line identifier can be entered as the relative number.

3. TALK lnn

    This  command is executed when there is a terminal found to be
active on  the line intended  for BERT testing.   The message  typed in
will be  broadcasted to  the terminals specified  by the  relative line
number lnn.

4. MODE ADR

    By setting the ADR mode, BOM operator can send a message to a group



Page 178              PBTERS.DOC







BIT ERROR RATE TESTING                         July 22, 1988



of devices on one line or control unit, or to a specific device.

5. TALK lna cua

    This command sends a broadcast message to the devices on the
control unit specified by the line address lna, control unit address
cua.

6. TALK lna cua dva

    This command sends a message to the device  addressed by  the line
address lna, control unit address cua, and the device address dva.

7. ONLINE

    This command is the same as 1.

8. PATTERN n

    This command selects the test pattern to be sent out to the
sync line for the BERT testing. The  value of n ranges from 1 to 3.

9. SELECT lna

    This command selects  the line desired  for BERT testing  while in
ADR mode.

10. MODE REL

    This  command sets  the parameter  input mode  to be  the relative
number.

11. SELECT lnn

    This command selects the  line desired for the BERT  testing.  The
line identifier is accepted as the relative line number by TBOM.

12. DTRON

    This command turns on the  DTR signal, so that this signal  can be
monitored on the line.

13. ?DSR

    This  command  queries  the  status  of  the  DSR  signal  for the
connections of the line.

14. RTSON

    This command turns on the  RTS signal so that it can  be monitored
on the line.



Page 179              PBTERS.DOC







BIT ERROR RATE TESTING                         July 22, 1988



15. ?CTS

    This command queries the  status of CTS signal for  the conections
of the line.

16. STARTBERT

    This command starts up  the BERT testing.  RTS/CTS  handshaking is
not required.

17. BERT

    This command displays the results of the BERT testing.

18.  BERT 20

    This command instructs TBOM to display the BERT testing results
once every 20 seconds.  The display can be stopped by hitting  any key
from the tty.

19.  STOPBERT

    This command stops the BERT testing. Once executed, the  line will
resume the normal BSC protocol. TIF starts polling the control units.

20. QCU cun

    This command queries the polling status of the control unit, it is
recommended to execute this command after the BERT testing to ensure an
operational enviroment.

21. QCU cun

      Same as 20.




















Page 180              PBTERS.DOC







WRITE STRUCTURED FIELD SUPPORT                 July 22, 1988



              6.  WRITE STRUCTURED FIELD SUPPORT


This document describes the support for  Write  Structured  Field
commands by the 3270 Polled Bisync Terminal Interface.


The Write  Structured Field command  is  a  write   command  that
does  not  contain  explicit  control information  and is used to
send  encoded data or control information in a variable form.


Currently, when  the   3270  PBT  receives  a   WSF  command,  it
forwards the message to the control unit.  If the control unit is
not  configured to support WSF commands, a rejection is exchanged
and  the  transmission is aborted resulting in the termination of
the network circuit.


WSF command support  is  being  implemented  to   allow  for  SNA
support  of  TSO  for the Japanese market.  PBT provides a canned
response to the WSF command  for  Control  Units  that   do   not
support    WSF   commands  but  communicate  with  the  SNA  Host
Interface and with TSO on the Host.


Write Structured  Field commands  use  binary  data,   data  that
could  be  interpreted  as bisync control characters, in the data
stream.  As such, the commands generally need to  be  transmitted
as  transparent  data.   All devices using WSF commands should be
configured for transparency unless it  is   certain   that   none
of the  data  in  the  fields  are control characters.



6.1  Structured-Field Format


  ----------------------------------------------------------------
  | WSF | Structured Field | Structured Field | Structured Field |
  |  F3 |      1           |      2           |      n           |
  ----------------------------------------------------------------
        /                         /                          /                           /                            /                             -------------------------------
   |        |    |   Parameters  |
   | Length | ID |     and/or    |
   |        |    |      Data     |
   -------------------------------







Page 181              PBTERS.DOC







WRITE STRUCTURED FIELD SUPPORT                 July 22, 1988



6.2  Outbound Structured Fields


       ID     NAME
      ----    ----------------
        00    Reset Partition
     *  01    Read  Partition
                02 = Query
                03 = Query List
                6E = Read Modified All
                F2 = Read Buffer
                F6 = Read Modified
     *  03    Erase/Reset
        06    Load Programmable Symbols
     *  09    Set Reply Mode
        0B    Set Window Origin
        0C    Create Partition
        0D    Destroy Partition
        0E    Activate Partition
     *  40    Outbound 3270 DS
        41    SCS Data
        4A    Select Format Group
        4B    Present Absolute Format
        4C    Present Relative Format
    **  D0    File Transfer
      0F01    Set MSR Control
      0F0A    Modify Partition
      0F71    Outbound Text Header
      0FC1    Outbound Type 1 Text

   Note : *  Defined in IBM/USA and IBM/JAPAN/PC Manuals
         ** Defined in IBM/JAPAN/PC Manual Only



6.3  Inbound Structured Fields


       ID     Name
      ----    ---------------------

        80    Inbound 3270 DS
        81    Query Reply
              * 81  Usable Area
                83  Text Partition
                84  Alpha Partition
              * 85  Character Set
              * 86  Color
              * 87  Highlight
              * 88  Reply Modes
                8A  Field Validation



Page 182              PBTERS.DOC







WRITE STRUCTURED FIELD SUPPORT                 July 22, 1988



                8B  MSR Control
              * 8C  Field Outlining
                90  Format Presentation
              **91  DBCS(SO/SI)
                92  Save/Restore Format
              **95  DDM(Distributed Data Management)
                A0  Device Characteristics
                A1  RPQ Names
                A2  Data Stream
              * A6  Implicit Partitions
      0FB1    Inbound Text Header
      0FC1    Inbound Type 1 Text
      1034    Save/Restore Format Inbound

    Note : *  Defined in IBM/USA and IBM/JAPAN/PC Manuals
           ** Defined in IBM/JAPAN/PC Manual Only



6.4  Write Structured Field Command Support



The 3270 Polled Bisync Terminal Interface can be  configured   to
support Write Structured Field commands  (i.e., the control units
connected to PBT support  WSF  commands)  or  configured  to  not
support  Write Structured Field commands (i.e., the control units
connected to PBT do  no support WSF commands).  How PBT processes
the  commands is determined by whether or not it is configured to
support WSF commands.


6.4.1  PBT Supports WSF Commands


If  PBT is  configured to  support WSF   commands,  it   forwards
all  WSF  commands  directly  to  the   control unit.  Under this
configuration, PBT only  converts the  DSP data  into BSC  format
and   forwards  it   to  the  control   unit.  The  control  unit
either  accepts the  command,  if it supports  WSF  commands,  or
generates  a  Sense/Status  code,  if  it  does  not  support WSF
commands.


6.4.2  PBT Does Not Support WSF Commands


If  PBT  is   not  configured   to  support   WSF  commands,   it
examines  the  structured  field  in the  WSF command immediately
following  the command code,  F3  (hex), to  determine  if  it is
Read   Partition   with  Query  Operation.   For  Read  Partition



Page 183              PBTERS.DOC







WRITE STRUCTURED FIELD SUPPORT                 July 22, 1988



with  Query  Operation,   the  Field Identifier is 01 (hex),  the
Partition  Identifier  is  FF  (hex),  and the Type is 02  (hex).
Thus, the entire  field would  be   000501FF02  (hex).   For  WSF
commands  with  multiple structured fields, only the  first field
is examined.


When PBT receives a WSF  command that is not Read Partition  with
Query  Operation,  a  Sense/Status   code  of Operation  Check is
returned  to the Host PAD,  the  command  is   flushed,  and  the
circuit  is  terminated.  The Operations Check Sense/Status  code
is 40C1  for IBM and  Fujitsu hosts and C0C2 for  Hitachi  hosts.
The  value  may be changed by  placing the following statement in
the Tymfile:


OPTION(IOPCHK,40C1)             :OP CHECK  S/S  IS  40C1  -  IBM,
FUJITSU  OPTION(HOPCHK,0C0C2)             :OP CHECK S/S IS C0C2 -
HITACHI


If   the   WSF   command   is   Read   Partition    with    Query
Operation,   the  predefined  Query  Reply  with  Partitions   is
returned to the Host  PAD in DSP data format as  if  the  CU  has
acknowledged  the  query  and   sent  its  characteristics.   The
command is flushed.


The Query  Reply with  Partitions  is  defined   by  the   system
generation  process   and  PBT  does not  examine this  response.
However,  PBT does format the reply as a DSP Response.


If PBT is  configured not to  support WSF  commands,   individual
control  units  can be configured  to support these commands (see
description of RPLSEQ macro).   In  this  case   the  command  is
forwarded  directly   to  the  control  unit.  The  control  unit
either  accepts the  command,  if it supports  WSF  commands,  or
generates  a  Sense/Status  code,  if  it  does  not  support WSF
commands.  The Sense/Status code is forwarded by PBT to the  Host
PAD.



6.5  System Generation


There are several macros  required to configure and  define   the
support  capability   for  Write  Structured  Field  commands  in
PBT.   PBT  is defaulted to  support WSF commands   so  that  the
code  required   for  WSF  processing   is  not  included  in the



Page 184              PBTERS.DOC







WRITE STRUCTURED FIELD SUPPORT                 July 22, 1988



interface when  not   needed.   The  support  capability  can  be
changed by the DEFRPL macro.


There are default replies for  both CRTs  and  printers  included
in  PBT.   The  RPLTXT  macro  may be used to define an alternate
default reply or to define  additional  replies   that   may   be
associated  with individual control units on the interface.


6.5.1  RPLTXT - Define Contents of Query Reply Response

6.5.2  DEFRPL - Define Default Query Reply Response

6.5.3  RPLSEQ - Associate Query Reply Response with Device



6.6  Bisync Operation Monitor - CONF Command


Users are  able to determine,  via the BOM,  whether the  control
units   connected   to  PBT   are  configured   to  support   WSF
commands.   The CONF command  displays   the   configuration   of
the   entire   slot   and  thus indicates whether or not a  given
control unit is configured in  PBT as supporting WSF commands.


The output of the CONF command indicates for each  control   unit
whether  it  is  configured  to support WSF commands.   A Y under
the  WSF heading indicates the associated control  unit  supports
WSF commands.  A N under the WSF heading indicates the associated
control unit does  not support WSF commands.



6.7  PBT Canned Response to WSF Command



The  canned  responses  to  a   WSF  Read  Partition  with  Query
Operation  are  stored  in  PBT.  There is a reply for CRTs and a
reply for printers.


The canned response for CRTs (in hex) that  is  returned  to  the
Host  PAD  indicates  that the control unit  does not support WSF
commands  but the CRT does support Kanji.  The reply follows:


88001781810100005000180000652710006527100D1D0780002381858E000C1800



Page 185              PBTERS.DOC







WRITE STRUCTURED FIELD SUPPORT                 July 22, 1988



0000000B00000000000000014C01228020F81818417F0172012C000A818C000000
000000000B81910003018003020100078188000102000C81950000080008000101
00168186000800F4F100F200F300F400F500F600F700000D81870400F0F1F1F2F2
F4F4001181A600000B01000050001800500018


The canned response for printers (in hex)  that  is  returned  to
the  Host  PAD  indicates that the control  unit does not support
WSF  commands but the printer does  support Kanji  (as   sent  by
IBM3283-52  printer).  The reply follows:


88001781813100009E007F00000100F0000100F0142007B0001B81858800142004
00000007000000000000008020F81C20417F000681880001








































Page 186              PBTERS.DOC







ENHANCEMENTS OF PIR #1894                      July 22, 1988



              7.  ENHANCEMENTS OF PIR #1894


    This section describes the enhancements proposed by the PIR #
1894, submitted by South Western Bell.

    PIR# 1894 has been broken down into three  phases,  and  this
section only defines the scope of the enhancements in phase 1.

       The enhancements for phase 1 includes the following:

         o Query status on one line in the slot.

         o Start or stop device on a line.

         o Constant display of node, slot, date, and time
           information while logged into BOM.

         o Put a threshold on the NAK counter so that
           circuits will not be terminated when error retry
           has exceeded the allowable count.
           Tymnet Supervisor will be informed of the error.

         o Display the configuration of the slot.

     There are also some  other  enhancements,  not  proposed  in
the PIR, that   are   extermely   helpful   for   troubleshooting
and  problem determinations, ie. queue processor commands.

     Part of the output from the BOM  has  been  edited  for  the
clarity of explanation,  so  spacing  of  the output  may  differ
from   the  exact  display,  however,  it  does  not  affect  the
functionality of the BOM.

     Brackets  in  the   arguement   fields   indicate   optional
parameters that may or may not be required.



7.1  ENHANCEMENTS FOR MONITORING LINE STATUS


     This  section  describes   the   commands,  except   ONLINE,
that have already been implemented in TBOM version 5.05.


 (QLINE  - Query Line Status)

 (QCU - Query Control Unit Status)

 (QDEV - Query Device Status)



Page 187              PBTERS.DOC







ENHANCEMENTS OF PIR #1894                      July 22, 1988



 (ONLINE - Query Online Devices)




7.2  ENHANCEMENTS TO  START/STOP DEVICE



     This section describes the commands to start or  to  stop  a
device or a group of devices.

     There are two other commands, namely KILL and  BUILD,  which
have  already  been  implemented  to  perform  similiar  type  of
functions, but under different enviroment or mode.

     Explanations  will  be  made  in  the  description  of  each
command.

 (STARTDEV - Start Device Operation)

 (STOPDEV - Stop Device Operation)




7.3  ENHANCEMENTS FOR NODE/TIME DISPLAY


 (DISPLAY - Query/Change Interval of Real Time Display)



7.4  ENHANCEMENTS FOR NAK HANDLING



    The  current  implementation    of   PBT    will   eventually
terminate  the  network  circuits  when  the   error recovery for
handling NAK  exceeds the maximum number of retry allowed.

    When PBT detects an error condition either  in  transmit   or
receive  state,  it  retries  by going through error recovery for
several  times if the error condition is not  fatal.   For  fatal
conditions,   the  circuit  will  always  be  terminated  without
retries.

    PBT  logs the  error  reason and  checks against  the   retry
limit  during  each   retry.  If  PBT   can not recover  from the
errors  after the retry   limit  is   reached,  HPAD    will   be
informed  by   the  DSP Command/Response Aborted/Undelivered.  In



Page 188              PBTERS.DOC







ENHANCEMENTS OF PIR #1894                      July 22, 1988



this  DSP error  message, PBT reports the  reason  code  for  the
last error condition.

    After  receiving the  DSP  error message,  HPAD  sends   back
a  DSP  "Invitation  To  Clear" message  which will cause  PBT to
terminate the network circuit  for  the  device  with  the  error
conditions.

    The enhancements will  allow the device   to  stay  connected
to the host when  PBT is  having line problems  with the  control
unit, and no Command/Response Aborted/Undelivered  message   will
be  sent back  to the HPAD. However, a report to the Supervisor's
Log will be made so that this condition can be monitored  by  the
network logger.

    The network loggers message looks like the following:

        122:18:11:00

    NODE REPORT 2704 SLOT# 4 PBT TYPE 45 404040

        122:18:12:06


    In the above  example, type 45 indicates  that  there  is   a
message from the control  unit that is incorrectly  received, and
that  PBT has been responding with  NAK. Error retry   limit  has
been  reached without success.

    Operator's interventions  may be   required  to   check  into
the  PBT  slot to monitor  the error conditions of  the line. QCU
commands can be used  to  query  the  status   of  the  indicated
control unit address  in the logger's message.

    With this enhancement, the message that PBT fails to  deliver
either  to  the  host  or to the terminal will be lost and not be
recovered.  If the message comes from the the host,  it  will  be
acknowledged locally by the HIF, and if PBT fails to deliver this
message  to  the  control  unit,  HIF  will  not   be   notified.
Similiarily, for the response from the control unit, if PBT fails
to receive it correctly, HIF will not be notified.

    Macros  DEFRTY,  BRETRY,   AND  DSPERR   are  introduced   to
define  or change the maximum  number of retries, and  to disable
sending  the DSP error message to the HPAD.









Page 189              PBTERS.DOC







ENHANCEMENTS OF PIR #1894                      July 22, 1988



7.5  ENHANCEMENTS FOR SLOT CONFIGURATION DISPLAY



    The command CONF can be  used to  display  the  configuration
of the line desired or for the entire slot.

    The output of CONF will also indicate for  each  device   the
defined character set as well as the host type for multi-protocol
support.


 (CONF - Display Line/Slot Configuration)



7.6  MISCELLANEOUS ENHANCEMENTS


 (SUPLOG - Query/Change Rerport to Supervisor's Log)




7.7  QUEUE PROCESSOR



    This section describes  the commands that are   used  in  the
BOM  to stop processing of the data, examine the data and release
the  data for processing.

    There are four queues in the terminal  interface,  namely  IN
Q,  XMT  Q,  OUT  Q, and RCV queue,   that are being used to pass
control   as  well  as  data  messages  between  Foreground   and
Background.


          -------------------------------------------------------
         |                                                       |
  ---    |                                                       |
 | C |   |                                                       |
 | O |   |        -------           -------           -------    |
 | N | --|-----> | RCV Q | ------> | OUT Q | ------> | ORING | --|->  N
 | T |   |        -------           -------           -------    |    E
 | R |   |                                                       |    T
 | O |   |                                                       |    W
 | L |   |                                                       |    O
 |   |   |                                                       |    R
 | U |   |        -------           ------           -------     |    K
 | N | <-|------ | XMT Q | <------ | IN Q | <------- | IRING | <-|--



Page 190              PBTERS.DOC







ENHANCEMENTS OF PIR #1894                      July 22, 1988



 | I |   |        -------           ------           -------     |
 | T |   |                                                       |
  ---    |                                                       |
         |                                                       |
         |                                                       |
          -------------------------------------------------------


    When data is  received from the control  unit,  F/G  puts  it
in  the  RCV Q where it will be scanned and processed by PBT B/G.
If  the input concerns the Network Service Screen, some data  may
be  generated   by  PBT B/G and be put in  the XMT Q so that  F/G
can send it to  the control unit.

    If the input is for the host,  it will be passed to  the  OUT
Q  and  be converted into DSP messages in the B/G to be delivered
to  the Host Interface.

    When the host sends a command message to  the  HIF,  it  will
come  from the network  in the IRING  of the  PBT in DSP  format.
The  DSP message decoder will either act  upon  the  DSP  control
messages or convert the DSP data messages into Bisync formats and
put them in the IN Q, where  they  are  moved  to  XMT  Q  awaits
transmission to the control unit by F/G.



7.7.1  Input Queue


 (STOPIN   - Stop IN Q Process)
 (QINQ - Query Data on IN Q)
 (STARTIN - Start IN Q Process)


7.7.2  Transmit Queue


 (STOPXMT - Stop XMT Q Process)
 (QXMTQ - Query Data On XMT Q)
 (STARTXMT - Start XMT Q Process)


7.7.3  RCV Queue


 (STOPRCV  - Stop RCV Q Process)
 (QRCVQ - Query Data On RCV Q)
 (STARTRCV - Start RCV Q Process)





Page 191              PBTERS.DOC







ENHANCEMENTS OF PIR #1894                      July 22, 1988



7.7.4  OUT Queue


 (STOPOUT  - Stop Output Q Process)
 (QOUTQ - Query Data on OUT Q)
 (STARTOUT - Start OUT Q Process)


7.7.5  SYSTEM GENERATIONS


   This section describes the necessary additions of  macros   in
order to configure the PBT slot for new enhancements.


7.7.6  DEFRTY - Define Retry Limit for Line



7.7.7  BRETRY - Change Retry Limit for Line



7.7.8  DSPTIM - Define Real Time Display Interval



7.7.9  DSPERR - Define DSP Error Report to HPAD


























Page 192              PBTERS.DOC







TYMFILE                                        July 22, 1988



                          8.  TYMFILE


        THE INTENT OF THIS PROJECT IS TO PROVIDE THE CAPABILITY IN
     THE 3270 HOST AND TERMINAL INTERFACE FOR TRANSMITTING MESSAGES
     TO THE TERMINALS AND HOST IN KATA KANA.

        TO ALLOW THE SELECTION OF LANGUAGES, CHANGES WILL BE REQUIRED
     IN THE HOST AND TERMINAL INTERFACE SOFTWARE. ALL MESSAGES
     CURRENTLY LOCATED IN DIFFERENT MODULES WILL BE RELOCATED IN
     A SINGLE MODULE. A DUPLICATE MESSAGE IN KATA KANA WILL BE
     CODED. CHANGES IN THE TYMFILE WILL ALLOW FOR SELECTION OF
     THE LANGUAGE ON A DEVICE BASICS.


8.1  3270 TERMINAL INTERFACE MESSAGES



         a) ALL USER MESSAGES GENERATED BY THE TERMINAL INTERFACE WILL
            BE DISPLAYED IN THE SELECTED LANGUAGE BY DEVICE. MESSAGES
            GENERATED OUTSIDE OF THE SLOT INTERFACE WILL BE DISPLAYED
            IN THE LANGUAGE IT WAS RECEIVED IN. THESE INCLUDE
            SUPERVISOR ERRORS AND ALL NETWORK INFORMATION MESSAGES, BUT
            NOT LIMITED TO THESE.

         b) ALL COMMANDS AND MESSAGES GENERATED BY THE BISYNC
            OPERATIONS MONITOR WILL BE IN ENGLISH. THESE ARE TYMNET
            FIELD COMMUNICATION DIAGNOSTIC TOOLS AND AS SUCH NOT
            MENT FOR CUSTOMER USE. ALL MACRO ERROR MESSAGES WILL
            ONLY BE DISPLAYED IN ENGLISH.

         c) MESSAGES WHICH WILL BE LANGUAGE SELECTED ARE:

            LOGON SCREEN MESSAGES
            NETWORK SERVICE SCREEN MESSAGES
            DISPLAY SYSTEM PROTOCOL MESSAGES
            ERROR MESSAGES GENERATED INTERNAL TO SLOT



8.2  CURRENT ENGLISH VERSION OF DISPLAYED MESSAGES



8.2.1  LOGON SCREEN


        SELECT LOGON PROCEDURE

        DO YOU WISH TO USE ASCII MODE?



Page 193              PBTERS.DOC







TYMFILE                                        July 22, 1988



        DO YOU WANT COLOR?

        PLEASE LOGIN

        USERNAME:

        PASSWORD:



8.2.2  NETWORK SERVICE SCREEN


        NODE:####.  SLOT: #.  LINE: #.  CU ADR: #  DEV ADR:  .


        NETWORK SERVICES

        CLR   RETURN TO CONVERSATION

        PF1   LOG OFF CRT

        PF2   LOG ON PRINTER

        PF3   LOG OFF PRINTER

        POSITION CURSOR TO SELECT PRINTER

        NO.  ADR  STAT   LABEL



8.2.3  DISPLAY SYSTEM PROTOCOL


        CONNECTION REQUEST MODE:

        DESTINATION INTERFACE ADDRESS:

        APPLICATION IDENTIFIER:

        DESTINATION DEVICE ADDRESS:

        DO YOU WANT EXTENDED ATTRIBUTES?










Page 194              PBTERS.DOC







TYMFILE                                        July 22, 1988



8.2.4  ERROR MESSAGES GENERATED INTERNAL TO SLOT


                LOGGED OUT

                TYPE USER NAME

                TYPE PASSWORD

                LOGON IN PROGRESS

                LOGON FAILED

                USERNAME ERROR DURING STORED LOGON

                PASSWORD ERROR DURING STORED LOGON

                BAD STORED DSP ELEMENT - LOGON ABORTED

                PLEASE SEE YOUR REP

                BAD BUD

                CIRCUIT BUSY

                HOST NOT AVAILABLE

                HOST OUT OF PORTS

                HOST DOWN

                HOST SHUT

                TRY AGAIN IN 2 MINUTES

                ACCESS NOT PERMITTED

                NO HOST SPECIFIED

                BAD HOST NUMBER

                MUD ERROR

                PVC LOGON IN PROGRESS

                CRT IS CURRENTLY LOGGED IN

                IDLE

                BUSY




Page 195              PBTERS.DOC







TYMFILE                                        July 22, 1988



                CRT IS CURRENTLY NOT LOGGED IN

                WRONG KEY...TRY AGAIN

                DEVICE NOT LOGGED IN

                CURSOR IN WRONG POSITION FOR SELECTION

                SOMEONE ELSE IS LOGGING PRINTER

                PRINTER IS ALREADY LOGGED IN



8.3  3270 HOST INTERFACE MESSAGES


         a) ALL USER MESSAGES GENERATED BY THE HOST INTERFACE WILL
            BE DISPLAYED IN THE SELECTED LANGUAGE BY DEVICE. MESSAGES
            GENERATED OUTSIDE OF THE SLOT INTERFACE WILL BE DISPLAYED
            IN THE LANGUAGE IT WAS RECEIVED IN. THESE INCLUDE
            SUPERVISOR ERRORS  AND ALL NETWORK INFORMATION MESSAGES,
            BUT NOT LIMITED TO THESE.

         b) ALL COMMANDS AND MESSAGES GENERATED BY THE BISYNC
            OPERATIONS MONITOR WILL BE IN ENGLISH. THESE ARE TYMNET
            FIELD COMMUNICATION DIAGNOSTIC TOOLS AND AS SUCH NOT
            MENT FOR CUSTOMER USE.


8.4  MESSAGES WHICH WILL BE LANGUAGE SELECTED ARE.


         a) USER ERROR MESSAGES OR INFORMATION TYPE MESSAGES
            GENERATED BY THE HOST INTERFACE FOR
            COMMUNICATION WITH THE TERMINAL USER.

         b) GREETING MESSAGES GENERATED BY THE HOST
            INTERFACE FOR COMMUNICATION WITH THE HOST
            APPLICATION PROGRAM.



8.5  CURRENT ENGLISH VERSION OF DISPLAYED MESSAGES.










Page 196              PBTERS.DOC







TYMFILE                                        July 22, 1988



8.5.1  HOST GENERATED HOST ERROR OR INFORMATION MESSAGES

      CURRENT ENGLISH VERSION.

                LOGON ABORTED,PLEASE TRY AGAIN

                CANNOT MATCH REQUESTED DEVICE TYPE

                INVALID HOST NUMBER

                CANNOT MATCH REQUESTED ADDRESSES

                CANNOT FIND DEVICE SUPPORTING (OR NOT SUPPORTING)
                TRANSPARENCY

                CANNOT FIND A COLOR (OR A NON-COLOR)DEVICE

                CANNOT FIND A POLLED DEVICE...HOST LINE DOWN

                CANNOT FIND AN AVAILABLE DEVICE

                USERNAME INVALID FOR AVAILABLE DEVICE

                WAIT ONE MINUTE AND TRY AGAIN

                CANNOT FIND AVAILABLE ASSOCIATED DEVICE

                SPACE SHORTAGE...CANNOT CONNECT

                INVALID USERNAME(LUD)...CANNOT CONNECT

                MAP COUNT TOO LOW...TRY AGAIN LATER




8.5.2  MESSAGES BETWEEN HOST AND HOST INTERFACE

     ALL OF THESE ARE DEFINED IN THE TYMFILE BY MACRO DEFINITION.

                GREETING MESSAGE TO THE HOST AT CONNECT TIME

                        MACRO GREET.

                DISCONNECT MESSAGE  TO  THE  HOST  AT  LOGOFF  OF
DEVICE

                        MACRO DISCON.

                ZAP MESSAGE TO THE HOST INTERFACE FROM THE HOST
                TO DISCONNECT THE USER.



Page 197              PBTERS.DOC







TYMFILE                                        July 22, 1988



                        MACRO ZAP.





















































Page 198              PBTERS.DOC







Allow modification of addresses in NIB file    July 22, 1988



      9.  Allow modification of addresses in NIB file




 This is the PIR 1814 which  provides  the  users  with  new  BOM
functions :

   - modify the CU and device addresses defined in Tymfile.

   - modify Logon strings (PBT only) and Logon string Labels
     (PBT only).

- The present document describes the changes that  were  done  in
order to handle those new features and give a description of each
of them.


- It must be read along with the General External Design.




9.1  Tymfile modification


Three new macros were added :

   - one to define if the user is allowed to modify dynamically the
     following configuration parameters : CU address, device address,
     logon strings and logon strings labels in PBT.

   - another to define the maximum number of modification commands the
     user wants to record.

   - one to define the password required while accessing sub-menu.


9.1.1  New commands



(MOTYM command)
(STNU command)
(BOMPW command)









Page 199              PBTERS.DOC







                                               July 22, 1988























                           APPENDICES


These are the crash codes returned and the location of the nearest
label associated with that crash.

Crash   Nearest         Localize        Crash Reason
Code    Label           Module

20      DSR030                          LINE CANNOT SUPPORT DTR/DSR
44      ICRASH                          DROP DTR SVC CRASH
44      HHNCRA                          RAISE DTR SVC CRASH
60      INDCR           FRNTND          NO ACTIVATION ROUTINE
60      INCN1           FRNTND          NO DCB WAS ASSIGNED
                                        NO STATE TABLE WAS ASSIGNED
                                        NO ACTIVATION ROUTINE WAS
                                        ASSIGNED
61      ACTIVN                          ILLEGAL PORT 0 MSG OR NEEDLE
61      POM30                           ILLEGAL PORT 0 MSG OR NEEDLE
61      SPECL           FRNTND          INVALID PORT 0 MESSAGE
62      INVAL           FRNTND          INVALID MESSAGE
63      INPUT3          FRNTND          INVALID PORT NUMBER,WHICH HAS
                                        BEEN
                                        ACTIVE TO RECEIVE THE NEEDLE
81      PBCRAS                          NO BIG BUFFERLET
81      GBCRA0          BSCSXM          NO BIG BUFFERLET
81      PUTCR           MAIN            NO BIG BUFFERLET
81      BCRASH          MAIN            NO BIG BUFFERLET FOR CREATING
                                        BISYNC FRAME,CALLED BY PUTBX
81      PBCRSH          MAIN            NEXT BUFFER ADDRESS NOT FOUND
82      GETCRA          MAIN            ATTEMPTED TO GET DATA FROM



Page 200              PBTERS.DOC







                                               July 22, 1988



                                        EMPTY   BUFFER
83      NXTSC                           NO NEXT ELEMENT FOR STORED
                                        LOGON
84      GCL01           CMDLST          COMMAND LINK LIST LOCKED FOR
                                         'GET'  PROCESS
84      GCL1            CMDLST          SAME AS ABOVE
85      PCL             CMDLST          COMMAND LINK LIST LOCKED FOR
                                         'PUT'  PROCESS
86      SRVCRA          BSCSRV          SVC ERROR,TRY TO CONNECT INPUT
                                        TWICE
                                        FOR RECEIVE PROCESS
86      DSR020          BSCDTR          QUERY SYNC ATTRIBUTE SVC ERROR
86      DSR020          BSCDTR          CONNECT INPUT SVC ERROR
86      DTR220          BSCDTR          SAME
87      BSXCRA          BSCSXM          SVC ERROR,TRY TO CONNECT INPUT
                                        TWICE
                                        FOR TRANSMIT PROCESS
88      BSXWRT          BSCSXM          ILLEGAL TRANSMIT OP CODE
88      BSXWCR          BSCSXM          TRANSMIT LIST TOO SMALL
89      BSCD02                          ILLEGAL BUFFER CHARACTER COUNT
8D      DA.R11                          RAN OUT OF UNBUSY LINKS
8D      DA.X11                          RAN OUT OF UNBUSY LINKS
90      DATI20                          UNKNOWN IIX MSG(IF TSTSW=1)
90      IZOCRA                          QUERY I/O SVC FAILED
91      DSPCR                           ILLEGAL CUD IIX MSG
97      IZPVCR          MAIN            NO ELEMENT FOR PVC LOGON
98      CLBUG           CMDLST          BUG IN COMMAND LIST USAGE
99      CLFULL          CMDLST          COMMAND LINK HAS NO FREE LINK
0F      TPT2            TIMEOUT         TIMEOUT FREE LIST EXHAUSTED
D0      BUFERR          BBUFER          BIG BUFFERLET LISTS LOCKED WHEN
                                         'GET'
D0      PBB20           BBUFER          BIG BUFFERLET LISTS LOCKED WHEN
                                         'PUT'
FF      PCRASH          BSCPTP          BISYNC LINE CRASH




















Page 201              PBTERS.DOC







SAMPLE 3270 TERMINAL INTERFACE TYMFILE         July 22, 1988



          I.  SAMPLE 3270 TERMINAL INTERFACE TYMFILE



        SUBTTL  3270 BISYNC TERMINAL INTERFACE VERSION 9.0
:
                PRTCON(YES)
:
                HSTPRT(4959)
:
: DEFINE DEFAULT VALUES FOR LINE PARAMETERS
:
        DEFLIN(HITACHI)                 :all lines default to hitachi
        DEFDTR(NO)                      :DTR/DSR NOT REQUIRED
        DEFSWT(NO)                      :LINES ARE LEASED
        DEFHAN(NO)                      :DISABLE HANG LOGIC FOR LINES
        DEFRTS(NO)                      :RTS/CTS NOT REQUIRED
:
: define default values for DEVICE
:
        DEFTYP(C1920)                   :1920 CHARACTER TERMINAL
        DEFMEN(MEN0)                    :LOGON MEN0 IS DISPLAYED
        DEFNET(PF4)                     :NETWORK SERVICE KEY IS PF4
        DEFCOL(NO)                      :DEVICE DOES NOT SUPPORT COLOR
        DEFXPR(NO)                      :TRANSPARENCY NOT SUPPORTED
        DEFPVC(NO)                      :NONE PVC DEVICE
        DEFLNG(KK)                      :LANGUAGE IS KATA KANA
        DEFERR(KK)                      :LANGUAGE IS KATA KANA

:       DEFINE DEFAULT SLOT PARAMETERS

        TMIACT(3600)                    :INACTIVITY TIMEOUT IS 1 HR
        HNGDTR(1)                       :DROP DTR FOR 1 SEC
        MONDSR(300)                     :MONITOR DSR EVERY 1/2 SEC
        NLOGIN(5)                       :DISCONNECT LINE AFTER 5 MINUTE
                                                :OF NO LOGIN
:
:        DEFINE BOM PARAMETERS HERE

        DEFRTY(10)                      :DEFAULT REFAULT RETRY LIMIT
        DSPERR(NO)                      :DON'T SEND DSP ERROR MSG
                                        :TO HPAD
        DSPTIM(5*60)                    :5 MINUTES

:        LINE 1 TYPE IBM, 2 WIRE DIAL-UP WITH INACTIVITY SELECTED

             LINTYP(IBM)
                LINE(040) ;SWITCH(YES);HANG(YES);RTSCTS(YES)
                   CUNIT(40)
                     DEVICE(040);
                       DEVICE(0C1); TYPE(P1920)



Page 202              PBTERS.DOC







SAMPLE 3270 TERMINAL INTERFACE TYMFILE         July 22, 1988



                         PRTTXT(1ST PRT ON CU 040);
                       KKORKJ(ENG)

                   CUNIT(0C1)
                     DEVICE(040);
                       KKORKJ(ENG);
                        LNGMSG(ENG)
                        ERRMSG(ENG)

                     DEVICE(0C1); TYPE(P1920)
                         PRTTXT(1ST PRT ON CU 0C1)
                      KKORKJ(ENG);
                LNGMSG(ENG)     :THIS PRINTER PRTXT MSG WILL DISPLAYED
                                :IN ASCII TO EBC HEX

:       LINE 1 ,HITACHI LINE,4-WIRE DIAL-UP WITH INACTIVITY SELECTED

                LINE(0C1);SWITCH(YES);HANG(YES);RTSCTS(YES)
                        DTRDSR(YES)

                  CUNIT(0C0)

                    DEVICE(0A0);
                      XPRNT(NO); COLOR(NO); KKORKJ(KANJI);
                      MENU(MEN4);

                    DEVICE(0A1); TYPE(P1920)
                         PRTTXT(1ST PTR W COLOR & XPRN)
                LNGMSG(ENG)     :DO ASCII TO EBC CONVERSION WITH
                                :PRTTXT TEXT

                      XPRNT(NO); COLOR(NO); KKORKJ(KANJI)
                      MENU(MEN4);

                    DEVICE(0A2);
                      KKORKJ(KANA); MENU(MEN5);

                    DEVICE(0A3);
                LNGMSG(KK)                      :NECESSARY IF TEXT IS
                                                :DEFINED IN HEX
                        TYPE(P1920)
                PRTTXT("D7"D9"C9"D5"E3"C5"D9)   :TEXT IS EBCDIC HEX
                      KKORKJ(KANA); MENU(MEN5)

             : LINE 2 ,HITACHI,LEASE,RTS/CTS NECESSARY

             DEFMEN(MEN4)

               LINE(0C2) ; RTSCTS(YES)
                 CUNIT(0C0)
                   DEVICE(0A0);



Page 203              PBTERS.DOC







SAMPLE 3270 TERMINAL INTERFACE TYMFILE         July 22, 1988



                     MENU(MEN4)
                   DEVICE(0A1); TYPE(P1920)
                         PRTTXT(PRT 0A1 ON CU 0C0)
                     MENU(MEN4);LNGMSG(ENG)
                   DEVICE(0A2);
                     MENU(MEN5);
                   DEVICE(0A3); TYPE(P1920)
                        PRTTXT(PRT 0A3 ON CU 0C0)
                     MENU(MEN5);LNGMSG(ENG)
        : LINE 3 ,FUTJITSU, LEASED LINE

             LINTYP(FUJITSU)     : CHANGE LINE TYPE TO FUJITSU

             DEFMEN(MEN0)       : USE MENU0 FOR NETWORK LOGON
               LINE(0C3)
                 CUNIT(40)
                   DEVICE(40);
                     KKORKJ(ENG);
                   DEVICE(0C1);TYPE(P1920)
                         PRTTXT(PRINTER 0C1 ON CU 040)
                     KKORKJ(ENG);LNGMSG(ENG)

                 CUNIT(0C1)
                   DEVICE(040)
                   DEVICE(0C1); TYPE(P1920)
                         PRTTXT(PRINTER 0C1 ON CU 0C1)
                        LNGMSG(ENG)
:
:        DEFINE FIRST ELEMENT FOR NETWORK LOGON STRING
:         USER NAME : ANYNAME
:         HOST #    : ANYHOST
:         PASSWORD  : ANYPSWD
:
            NETSCR(ELE0)
               ELEUNA(ANYNAME); ELEHST(ANYHOST); ELEPWD(ANYPSWD);
:
:       DEFINE NETWORK LOGON USER NAME, HOST #, AND PASSWORD
:
            NETSCR(ELE1)
               ELEUNA(ANYNAME); ELEHST(ANUHOST); ELEPWD(ANUPSWD);
:
          NETSCR(ELE2)
              ELEUNA(ANYNAME); ELEHST(ANYHOST); ELEPWD(ANYPSWD);
:
                     NETSCR(GATEW)
                             ELEUNA(C)
                     NETSCR(DEMO)
                             ELEUNA(DEMOUSN)
:
:        DEFINE ELEMENT FOR DSP TARGETING
:         CRM IS 3 FOR HOST TO SELECT THE DEVICE ASSIGNMENT



Page 204              PBTERS.DOC







SAMPLE 3270 TERMINAL INTERFACE TYMFILE         July 22, 1988



:
                     NATDSP(DSP0)
                             ELECRM(3); ELEARS(31064955);
:
:       CRM : 2
:       Destination Interface Address(Called Address) : 31064955
:        Destination Control Unit Address : 0C1
:        Destination Device Address : 040
:        Character Set : 4              : KATAKANA.
:
                     NATDSP(DSP1)
                       ELECRM(2); ELEARS(31064955); ELEAPP(40);
                       ELECUA(040); ELEDVA(040); ELECHR(4);
                       ELEXPR(YES); ELECOL(YES);

:        HITACH DSP LOGON
:        CRM : 2
:       Destination Interface Address : 31064955
:        Application Identifier(Destination Line Address): 040
:        Destination Control Unit Addre : 0A0
:        Destination Device Address : 0A0
:        Destination Character Set : 5  :  KANJI
:        Request Transparent Device.
:        Request Color capable Device
:
                     NATDSP(DSP2)
                       ELECRM(2); ELEARS(31064955); ELEAPP(40);
                       ELECUA(0C0); ELEDVA(0A0); ELECHR(5);
                       ELEXPR(YES); ELECOL(YES);
:
:        HITACH DSP LOGON

                     NATDSP(DSP3)
                      ELECRM(2); ELEARS(31064955); ELEAPP(0C1);
                      ELECUA(0C0); ELEDVA(0A0); ELECHR(4);
:
:        HITACH DSP LOGON
:
                    NATDSP(DSP4)
                       ELECRM(2); ELEARS(31064955); ELEAPP(0C2);
                       ELECUA(0C0); ELEDVA(0A0); ELECHR(4);
:
:       DEFINE ELEMENT FOR TRANSPARENT DSP LOGON MENU
:
                     NATDSP(DSP5)
                             ELECRM(3); ELEARS(31064956);
:
:        DEFINE LABELS AND LOGON ELEMENTS FOR LOGON MENUS
:
            LOGSTR(DEMOTSO,TO DEMO HOST THRU GATEWAY,GATEW,DEMO,DSP0)
            LOGSTR(STR0,HOST 4855 CRM 3,ELE0,DSP0)



Page 205              PBTERS.DOC







SAMPLE 3270 TERMINAL INTERFACE TYMFILE         July 22, 1988



            LOGSTR(STR1,HOST 4955 CRM 3,ELE1,DSP0)
            LOGSTR(STR2,HOST 4955 CRM 2,ELE1,DSP2)
            LOGSTR(STR3,HOST 4956 CRM 3,ELE2,DSP0)
            LOGSTR(STR4,HOST 4956 CRM 2,ELE2,DSP1)
:
            LOGSTR(STR5,HOST 4955 CRM 3 WITH XPR,ELE1,DSP5)
            LOGSTR(STR6,HOST 4956 CRM 3 WITH XPR,ELE2,DSP5)
            LOGSTR(STR7,TELENEX ON LINE 0C1,ELE1,DSP3)
            LOGSTR(STRM,MANUAL)
            LOGSTR(STR8,TELENEX ON LINE 0C2,ELE1,DSP4)
            LOGSTR(STR9,"D4"C1"D5"E4"C1"D3"F0"F1)
:
:        LOGON MENU FOR SELECTIONS
:
            LOGMEN(MEN0,DEMOTSO,STR0,STR1,STR2,STRM)
            LOGMEN(MEN3,STR5,STR7,STR8,STRM)
            LOGMEN(MEN4,STR5,STR6,STR7,STR8,STRM)
:
:        TRANSPARENT DEVICE LOGON
:
            LOGMEN(MEN5,STR5,STR6,STR7,STR8,STRM)
:
:       DISPLAY LOGIN STRING IN KATA KANA
:
                     LOGMEN(MEN6,STR9)
:
STPCRSH(YES)
MOTYM(YES)                      :ALLOW MODIFICATION OF TYMFILE ON-LINE
STNU(4)                         :STORE UP TO FOUR MODIFICATION OF
                                :TYMFILE DONE ON-LINE IN MEMORY.
BOMPW(PASSWORD)                 :PASSWORD WHICH ALLOWS  ENTRY INTO CHPR
                                :ROUTINE






















Page 206              PBTERS.DOC







BISYNC RCV RECEIVE CODES                       July 22, 1988



              II.  BISYNC RCV RECEIVE CODES


The following is a list of the internal bisync receive codes
as display in certain commands such the SCOPE command.

0       rcdatx          good data etx received
1       rcdatb          good data etb received
2       rcenq           enq received
3       rceot           eot received
4       rcnak           nak received
5       rcdisc          dle,eot (disconnect signal)received
6       rcack1          ack1 received
7       rcwack          wack received
8       rcack0          ack0 received
9       rcrvi           rvi received
A       rcttd           ttd(stx,enq) received
B       rcmbid          multi-leaving bid (soh,enq)
C       rcdabt          data abort(enq,eot,nak in text)
D       rclsyn          lost synchronization
E       rcovrn          overrun(more data than bufferlets specified)
F       rcnrom          no initial bufferlet available
10      rctmot          timeout before msg received
11      rcbadd          crc error in data message
12      rclost          lost data due to inavailability of bufferlet
13      rcunid          unidentifiable msg
14      rcfcom          forced completion by background



























Page 207              PBTERS.DOC







BISYNC XMIT RETURN CODES                       July 22, 1988



             III.  BISYNC XMIT RETURN CODES


The following bisync operation codes are used to send data.

0       xcdata          send data
1       xcenq           send enq
2       xceot           send eot
3       xcnak           send nak
4       xcttd           send ttd
5       xcack1          send ack1
6       xcwack          send wack
7       xcack0          send ack0
8       xcrvi           send rvi
9       xcdisc          send disconnect(dle,eot)







































Page 208              PBTERS.DOC





  @pD