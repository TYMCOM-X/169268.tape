                                                                January 6, 1988








            @      @@@@   @@@@@  @@@@@@        @@@@@  @@@@@@ @@@@@ 
            @     @    @ @        @  @        @       @      @    @
            @     @    @ @   @@   @  @        @   @@  @@@    @    @
            @     @    @ @    @   @  @        @    @  @      @    @
            @@@@@  @@@@   @@@@@  @@@@@@       @@@@@  @@@@@@ @@@@@@ 


                                    LOG II
                                 SPECIFICATION
                                      AND
                            GENERAL EXTERNAL DESIGN


                            Author:  Omar A. Serang
                          NETWORK TECHNOLOGY DIVISION
                                January 6, 1988










     ********************************************************************
     ***                  PROPRIETARY INfORMATION                     ***
     ***                                                              ***
     ***  MDC-TYMNET's proprietary  rights are included  in the       ***
     ***  information disclosed herein.  The recipient, by receiving  ***
     ***  this document,  agrees that neither this document nor  the  ***
     ***  information disclosed herein nor any part thereof shall be  ***
     ***  reproduced  or  transferred to other documents or used  or  ***
     ***  disclosed  to  others for manufacturing or for  any  other  ***
     ***  purpose  except as specifically authorized in  writing  by  ***
     ***  MDC-TYMNET.                                                 ***
     ********************************************************************










                                Logon Processing II                       LOGII
                                                                January 6, 1988







                                 TABLE OF CONTENTS

    Section                                                                Page



    1.   Specifications                                                       1
      1.1   Objectives                                                        1
      1.2   Requirements                                                      2
      1.3   SWBT Requirements                                                 2
      1.4   Current Logon Session Summary                                     3
         1.4.1    Detailed Discussion of Normal Logon                         3
         1.4.2    Detailed Discussion of Auxiliary Logon                      9

      1.5   ADRII Logon Syntax                                               11


    2.   New Logon Information                                               12
      2.1   Origination Address - OADR                                       13
      2.2   Reverse Charge - RCHG                                            15
      2.3   Options List                                                     16
      2.4   Username                                                         17
      2.5   Specified Destination List - SDL                                 18
      2.6   Resultant Destination Address - RDA                              19
      2.7   Target Selection and Qualification                               19
      2.8   Extension                                                        20


    3.   Major Functional Descriptions                                       21


    4.   LOGII Logon Session                                                 23
      4.1   LOGII Logon Session Summary                                      23
         4.1.1    LOGII Parsed and Unparsed Logon                            25
         4.1.2    Detailed Discussion of LOGII Normal Logon                  27
         4.1.3    Detailed Discussion of LOGII Auxiliary Logon               32

      4.2   LOGII Message Philosophy - MOs - X.409                           35
      4.3   ISIS Circuit Request Message - ICRM                              40
         4.3.1    ICRM Required Message Objects                              41
         4.3.2    ICRM Supplemental Message Objects                          42

      4.4   Early Circuit Reject - ISIS - ECRI                               47
         4.4.1    ECRI Supplemental Message Objects                          49

      4.5   ISIS Circuit Request Supplement - ICRS                           50
         4.5.1    ICRS Supplemental Message Objects                          51


                                Logon Processing II                       LOGII
                                                                January 6, 1988


      4.6   Node Code Circuit Request Message - NCRM                         57
         4.6.1    NCRM Required Message Objects                              58
         4.6.2    NCRM Supplemental Message Objects                          60

      4.7   Respond/Reject Circuit Request Message - RCRM, RCRI              66
         4.7.1    RCRM Required Message Objects                              68
         4.7.2    RCRM Supplemental Message Objects                          69
         4.7.3    RCRI Required Message Objects                              75
         4.7.4    RCRI Supplemental Message Objects                          76

      4.8   Assign Logon Port - ASLP                                         83
      4.9   Command Channel Needle - CCN                                     84
         4.9.1    CCN Required Message Objects                               85

      4.10  Node Code Needle - NCN                                          100
         4.10.1   NCN Overview and Compatibility Issues                     100
         4.10.2   NCN Form and Usage                                        105
         4.10.3   NCN Head Message Objects                                  106
         4.10.4   NCN Body Message Objects                                  109

      4.11  Logon Success Indication - LGSC                                 123
         4.11.1   LGSC Required Message Objects                             124
         4.11.2   LGSC Supplemental Message Objects                         125

      4.12  ISIS Needle - ISN                                               127
         4.12.1   ISN Required Message Objects                              128
         4.12.2   ISN Supplemental Message Objects                          133


    5.   LOGII Error Log Messages                                           137


    6.   LOGII related Accounting Data                                      138


    7.   X.409 Tutorial                                                     141
      7.1   The Standard Representation                                     142
         7.1.1    Identifier                                                143
         7.1.2    Length                                                    144
         7.1.3    Contents                                                  144
         7.1.4    Example Elements                                          145

      7.2   The Standard Notation                                           146
         7.2.1    Type Definition                                           147
         7.2.2    Built-in Types                                            148
            7.2.2.1     Primitive Elements Built-in Types                   148
            7.2.2.2     Constructor Elements Built-in Types                 149


    8.   Example of X.409 Type Representation Interpretation                150


    9.   LOGII X.409 MESSAGE TYPE REPRESENTATION                            153

                                Logon Processing II                       LOGII
                                                                January 6, 1988


    10.  LOGII X.409 IDENTIFIER SUMMARY...ALPHABETICAL                      170


    11.  LOGII X.409 IDENTIFIER SUMMARY...NUMERICAL                         172


    12.  ACRONYM DEFINITIONS                                                174















































                                Logon Processing II                       LOGII
    Specifications                                              January 6, 1988






                                1 -  Specifications







                                  1.1  Objectives


         The MUDII Reformat and X.121/Hostnames Addressing (ADRII) projects are
    designed to provide a comprehensive, extremely flexible symbolic addressing
    mechanism  for  TYMNET   networks.   The  features  provided   by  symbolic
    addressing  are  not offered  by  TYMNET's competition  and  can  provide a
    definitive market  advantage.  The  General External  Designs of  MUDII and
    X.121/Hostnames  Addressing  are documented  in  MD2GED.DOC  and ADRII.GED.
    MD2GED.DOC completely describes  the format and  philosophy of the  new MUD
    which is the foundation for the ADRII and this LOGII design,  and ADRII.GED
    describes the syntax and interpretation of logon requests.

         The SouthWestern Bell Telephone (SWBT) contract specifications require
    the  basic  features provided  by  the MUDII  Reformat  and X.121/Hostnames
    Addressing project, but also require features in addition to these designs.
    Many  of these  requirements  are logical  extensions of  the  new features
    provided  by  these  designs,  and  are  also  extremely  valuable  in  the
    marketplace.

         In  order to  take full  advantage of  the symbolic  addressing design
    features, it is  necessary to send new  information to the  Supervisor with
    the circuit request, and to send new information from the Supervisor to the
    originating  and  terminating   interfaces  with  the  needle.    This  new
    information  could  possibly  have  been  incorporated  into   the  current
    mechanism  of  logon  session,  but  the  implementation  would  have  been
    inflexible and unclear.

         This specification provides a Logon Session II (LOGII)  protocol which
    redefines  the  TYMNET  logon  session  mechanism,  providing  a  flexible,
    expandable set of messages  to pass the logon session  related information.
    The design  also takes  into account  deployment issues,  since IT  will be
    deployed over a long period in the Public Network.









    LOGII                       Logon Processing II                           1
    Specifications                                              January 6, 1988


                                 1.2  Requirements


         The LOGII messages will define the logon session, including all of the
    ISIS  dispatcher  messages, all  of  the Node  Code  to  Supervisor command
    channel messages, all of the  Supervisor to Node Code messages, and  all of
    the inter-Node Code messages that are required for a logon  session.  LOGII
    messages  will  eliminate  current  size  restrictions  on  command channel
    messages and needles.

         The Supervisor, Node Code and ISIS will utilize the LOGII  messages to
    perform logon sessions, providing new logon related  features.  Originating
    and  terminating  interface  slots  will  utilize  the  new  messages  when
    requesting  and   terminating  circuits,  taking   advantage  of   the  new
    information provided.

         The Supervisor will  maintain the LOGII  capability of the  Node Code,
    the  ISIS kernel  and  all interface  hosts by  receiving  the intelligence
    status of the Node Code and ISIS at takeover time, and the status  of hosts
    at host status change time.

         A deployment  scheme will allow  gradual deployment of  interfaces and
    ISIS/Node Code, and  will provide a  mechanism for backlevel  interfaces to
    provide LOGII information to the Supervisor as part of the logon string.

         TMCS will be modified to recognize new Error Log messages generated by
    the LOGII design, and MERLIN will be modified to insure ISIS and  Node Code
    LOGII compatibility at NIB file bind time.






                              1.3  SWBT Requirements


         The  SWBT   requirements  are  currently   in  the   negotiations  and
    clarifications stage.  The current  state of the technical  requirements is
    most  clearly  delineated   by  the  contract  technical   review  document
    (OSERANG:39)SWBREV.DOC in conjunction  with the SWBT "contract"  memo dated
    January 8, 1987 (says 1986 but should be 1987).












    LOGII                       Logon Processing II                           2
    Specifications                                              January 6, 1988


                        1.4  Current Logon Session Summary


         Currently a Logon Session begins when an interface slot sends either a
    pseudo-needle  request or  auxiliary circuit  request to  the Node  Code on
    dispatcher port (RPORT) zero.  The  Node Code assigns a dispatcher  port in
    logon mode to the  interface slot for further logon  session communications
    and informs the interface slot  that the port has been assigned  by sending
    it a pseudo-needle on the  newly assigned port.  If a  pseudo-needle cannot
    be sent, the interface  slot is informed with  a type 9 "unable  to provide
    pseudo-needle" message  on RPORT 0.   While the port  is in logon  mode the
    interface slot may send  only zappers, backpressure indications,  and logon
    characters on the port.

         The pseudo-needle  or aux  circuit request is  translated by  the Node
    Code to a command channel normal or aux circuit request and is sent  to the
    Supervisor for the logon  port.  The Supervisor communicates with  the port
    throughout the logon session using a variety of messages to  prompt, inform
    or  reject  the port.   These  logon responses  are  sent  across TYMNET-II
    gateways  using  IIX,  for communications  with  circuits  originating from
    another network.

         The originating Node  Code sends normal/aux circuit  request messages,
    and subsequent logon messages, only  upon detection of a terminator  in the
    logon string.   The Supervisor  and Node  Code maintain  a request/response
    handshake; the Node  Code always waits for  a response to the  last message
    sent before sending any more.

         The Supervisor sends the resulting needle to the originating Node Code
    which informs the originating ISIS Kernel and interface slot of the circuit
    build success,  taking the port  out of logon  mode.  The needle  is passed
    through the network, completing the circuit to the destination interface.

         The needle is currently limited  to one TYMNET-II packet size  so each
    passthrough  node  code  contains  the entire  needle  in  a  buffer.  This
    prevents pieces of needles from being gobbled by zappers, and  needles tend
    to reach the destination being  followed by zappers, if any.  A  needle may
    currently be disrupted by a link/node failure or buffer zap on the node the
    needle was transitting.





                1.4.1  Detailed Discussion of Normal Logon

         Currently, the Node Code plays a special role in the  circuit building
    process, since  it is  the Node  Code which  decides when  to send  a logon
    request message to  the Supervisor, based  upon detection of  certain logon
    characters received from the originating interface.  Once the pseudo-needle
    request and pseudo-needle have been exchanged between the interface and the
    Node Code, a connection is  established between the interface and  the Node


    LOGII                       Logon Processing II                           3
    Specifications                                              January 6, 1988


    Code.  The interface sends single logon characters to the Node Code in type
    B3 Dispatcher messages sent on the newly assigned RPORT.

         The Node  Code buffers logon  characters, counting them  and searching
    for a semi-colon ";" or carriage return terminator, or an escape character.
    Logon request  messages are sent  to the Supervisor  by the Node  Code upon
    detection of either of these conditions.  The Node Code is also responsible
    for generating a logon port zapper in response to any 9F disconnect message
    that is sent by the interface for the port in logon mode.

         If the interface sends more than 48 characters without a terminator or
    escape, the Node Code responds with a half-duplex hang code  (B8), followed
    by  a  message  string   "too  many  login  characters,  please   see  your
    representative",  and  ended  with  a  full-duplex  hang  code  (AF).   The
    interface reads  the text string  and hang characters  and responds  with a
    circuit disconnect code (9F),  which clears the Dispatcher  connection from
    the interface slot to the Node Code.  Note that in this case, no message is
    sent to the Supervisor.

         If the interface  sends an Escape character  in the logon  request the
    Node Code detects it, discards all characters from the logon  buffer except
    control characters and the actual escape, and sends a logon request message
    to  the Supervisor.   The Supervisor  responds to  the escape  character by
    sending the Node Code  a type 0D talk  to logon terminal message,  which is
    translated by the Node Code and  sent to the interface slot as  message B4,
    code E1, requesting that the interface empty its input and  output buffers,
    turn echo on, and  ask the user to  "please login".  In the  example shown,
    the escape  is detected  before any  terminator.  If  a previous  escape or
    terminator had already caused the 0F message to be sent, a 0E  logon string
    continuation message would be sent in place of the 0F message shown.

         If the interface sends a  9F disconnect message for trt  in logon
    mode, and the Node Code not yet sent the initial 0F logon  request message,
    the logon port is relinquished by the Node Code, and no message is  sent to
    the Supervisor.  If the 9F is  received by the Node Code after  the initial
    logon  message  has been  sent,  a zapper  character,  03, is  sent  to the
    Supervisor  in an  0E logon  string continuation  message.   The Supervisor
    clears all internal resources related to this logon port and sends the Node
    Code a logon  zapper acknowledgement message  0F8D, which informs  the Node
    Code that the  port is available for  re-use.  This mechanism  prevents the
    Node  Code from  re-using a  port number  which the  Supervisor  regards as
    already being in logon mode.












    LOGII                       Logon Processing II                           4
    Specifications                                              January 6, 1988



              B3 LOGON CHARACTERS, >48 CHARS W/O TERMINATOR
    INTERFACE ----------------------------------------------> NODE CODE
       |                                                          |
       |      B8, "too many login chars, please see rep", AF      |
       |     <-----------------------------------------------------
       |
       |      9F - DISCONNECT
       ----------------------------------------------------->



              B3 LOGON CHARACTER, ESCAPE
    INTERFACE ----------------------------------------------> NODE CODE
                                                                  |
             ------------------------------------------------------
             |
             |
             |  0F LOGON REQUEST, WITH CONTROL AND ESCAPE CHARS
             ----------------------------------------------------> SUPERVISOR
                                                                        |
                                                                        |
              0D CODE E9, EMPTY I/O BUFFERS, ECHO ON "please login"     |
    NODE CODE <----------------------------------------------------------



                9F DISCONNECT SENT AFTER FIRST TERMINATOR
    INTERFACE ---------------------------------------------------> NODE CODE
                                                                       |
                0E WITH 03 LOGON STRING CHARACTER                      |
    SUPERVISOR <--------------------------------------------------------
        |
        |       0F8D LOGON ZAPPER ACKNOWLEDGEMENT
        ---------------------------------------------------------> NODE CODE



















    LOGII                       Logon Processing II                           5
    Specifications                                              January 6, 1988


         If the first special character the Node Code detects is  a terminator,
    the  buffered logon  characters are  sent to  the Supervisor  in a  type 0F
    message, with terminator ";"  or CR included.  The Supervisor  analyzes the
    logon  characters and  responds in  a variety  of ways  depending  upon the
    situation.

         If the username specified by the logon characters is not found  in the
    MUD, the Supervisor responds with message 0D code 8A which is translated by
    the Node Code into the corresponding  B4 code 82 message, which is  sent to
    the slot requesting that the interface clear its input buffer  and indicate
    "error, type username".

         If  no characters  were  sent before  the  ";" or  CR  terminator, the
    Supervisor responds  with a  0D0C message to  prompt "username",  which the
    Node Code forwards to the interface as message B404.

         If the username, terminated by either  ";" or CR, is found in  the MUD
    and does not require a password, the Supervisor will build the  circuit (as
    long as there is a host to  build to) and respond with a needle.   The same
    condition  occurs  if  a  valid, accessible  host  number,  or  host number
    suffixed  with  non-numeric  characters  is  also  included  following  the
    username.

         If the host number specified  in the logon string is  invalid (greater
    than  the  largest allowable  host  number), the  Supervisor  responds with
    message 0D9D  requesting the  input buffer be  cleared and  indicating "bad
    host".   The  Node  Code  sends  the  corresponding  B492  message  to  the
    interface.

         If  the valid  username is  terminated with  a ";"  and a  password is
    required, the Supervisor responds with 0D08, "continue", and the  Node Code
    sends the corresponding B400 message to the interface.  The  same condition
    occurs if  a valid, accessible  host number, or  host number  suffixed with
    non-numeric characters is also included following the username.

         If  the  found  username  is terminated  with  CR  and  a  password is
    required, the Supervisor responds with 0D0D, "password", and the  Node Code
    sends the corresponding B405 message to the interface.  The  same condition
    occurs if  a valid, accessible  host number, or  host number  suffixed with
    non-numeric characters is also included following the username.














    LOGII                       Logon Processing II                           6
    Specifications                                              January 6, 1988



               B3 LOGON CHARACTERS, FIRST ";" OR CR TERMINATOR
     INTERFACE ----------------------------------------------> NODE CODE


                0F LOGON REQUEST, WITH LOGON CHARS AND TERMINATOR
     NODE CODE ---------------------------------------------------> SUPERVISOR
                                                                         |
                USERNAME NOT FOUND, ";" OR CR TERMINATOR                 |
              <-----------------------------------------------------------
                0D8A, CLEAR I BUFFER, "error, type username"             |
                                                                         |
                                                                         |
                NO CHARACTERS DETECTED BEFORE ";" OR CR TERMINATOR       |
              <-----------------------------------------------------------
                0D0C, "username"                                         |
                                                                         |
                                                                         |
                USERNAME FOUND, NO PW REQUIRED, ";" OR CR TERMINATOR,    |
                HOST OR HOST-ALPHA VALID AND ACCESSIBLE                  |
              <-----------------------------------------------------------
                COMPLETE THE CIRCUIT, NEEDLE SENT                        |
                                                                         |
                                                                         |
                HOST > MAXHST, OR PRECEDED WITH NON-NUMERIC CHARACTER    |
              <-----------------------------------------------------------
                0D9D, CLEAR I BUFFER, "bad host number"                  |
                                                                         |
                                                                         |
                USERNAME FOUND, PW REQUIRED, ";" TERMINATOR              |
                HOST OR HOST-ALPHA VALID AND ACCESSIBLE                  |
              <-----------------------------------------------------------
                0D08, "continue"                                         |
                                                                         |
                USERNAME FOUND, PW REQUIRED, CR TERMINATOR               |
                HOST OR HOST-ALPHA VALID AND ACCESSIBLE                  |
              <-----------------------------------------------------------
                0D0D, "password"


         In the cases above that a password is required and requested, password
    logon characters are sent from the interface and buffered by the  Node Code
    until  a  second  terminator  is  detected.   Upon  detecting   the  second
    terminator,  the  Node  Code  sends  the  password  characters,   with  the
    terminator, to the Supervisor in a type 0E message.









    LOGII                       Logon Processing II                           7
    Specifications                                              January 6, 1988


         If the  password is invalid  and terminated by  either ";" or  CR, the
    Supervisor responds with message 0D8B, which is translated by the Node Code
    to  the  corresponding  B483  message  which  is  sent  to  the  interface,
    requesting  a  clear  of  the  input  buffer  and  indicating  "error, type
    password".

         If the password  is valid, the  Supervisor responds by  completing the
    circuit, and sends a needle.

         Note that an Escape character will start the entire logon cycle again,
    though all communications  to the Supervisor will  be sent in a  0E message
    since the 0F message is only sent once for a particular logon session.

              B3 LOGON CHARACTERS, SECOND ";" OR CR TERMINATOR
    INTERFACE ----------------------------------------------> NODE CODE


                0E LOGON REQUEST, WITH LOGON CHARS AND TERMINATOR
     NODE CODE----------------------------------------------------> SUPERVISOR
                                                                         |
                PASSWORD INVALID, ";" OR CR TERMINATOR                   |
              <-----------------------------------------------------------
                0D8B, CLEAR I BUFFER, "error, type password"             |
                                                                         |
                                                                         |
                VALID PASSWORD, ";" OR CR TERMINATOR                     |
              <-----------------------------------------------------------
                COMPLETE THE CIRCUIT, NEEDLE SENT


























    LOGII                       Logon Processing II                           8
    Specifications                                              January 6, 1988


                1.4.2  Detailed Discussion of Auxiliary Logon

         The process of Auxiliary Logon  is much simpler than the  Normal Logon
    session described above.  The  auxiliary logon session is initiated  by the
    interface  sending  a  complete,  single  message  auxiliary  logon request
    message, type  08, with  the entire  set of  information necessary  for the
    logon  request,  including the  logon  string.   If  the  Node  Code cannot
    process  the auxiliary  circuit request,  an early  circuit  reject message
    (type 09) is sent to the interface.

         The Node Code buffers the login string and appends a CR terminator (if
    neither a semi-colon  ";" or CR terminator  was present in the  string sent
    from the  interface slot), and  responds to the  slot with  a pseudo-needle
    message  B2.   An  auxiliary  circuit request,  type  10,  is  sent  to the
    Supervisor, indicating the logon port number, but without the logon string.

         The Supervisor responds to  the auxiliary circuit request with  a type
    0E message, indicating  either an error  condition, or requesting  the Node
    Code to send  the login string.  Any  error condition condition  message is
    translated  into  the  corresponding  B5  message  which  is  sent  to  the
    interface, followed by a 9F message to disconnect the logon circuit.

         If the Supervisor requests the login string, it is sent from  the Node
    Code's  buffers in  a type  0E logon  string message,  always  containing a
    terminator.  The Supervisor responds with a needle or indicates an error in
    a  type  0E  message,  which  is  translated  by  the  Node  Code  into the
    corresponding B5 message which is  sent to the interface, followed by  a 9F
    message to disconnect the logon circuit.

         Note that the Auxiliary Logon session is comprised of, at most,  a two
    stage session, since any error response from the Supervisor always leads to
    the discontinuation of the logon session.  If a zapper (03  data character)
    or ESC character is encountered within the 0E logon string for an auxiliary
    circuit  request,  the  request is  rejected,  indicating  a  bad auxiliary
    request message format.



















    LOGII                       Logon Processing II                           9
    Specifications                                              January 6, 1988




              08, AUXILIARY LOGON REQUEST, W/ LOGON CHARACTERS
    INTERFACE ----------------------------------------------------> NODE CODE
                                                                        |
              09 EARLY LOGON REJECT                                     |
              <----------------------------------------------------------

              08, AUXILIARY LOGON REQUEST, W/ LOGON CHARACTERS
    INTERFACE ----------------------------------------------------> NODE CODE
                                                                        |
              B2, PSEUDO NEEDLE                                         |
              <----------------------------------------------------------
                                                                        |
                                                                        |
              -----------------------------------------------------------
              |
              | 10, AUXILIARY CIRCUIT REQUEST, WITHOUT LOGON CHARS
              ----------------------------------------------------> SUPERVISOR


               0E, ERROR CODE NON ZERO
    NODE CODE <---------------------------------------------------- SUPERVISOR
        |
        |      B5, ERROR CODE, 9F
        |---------------------------------------------------------> INTERFACE


               0E, ERROR CODE ZERO
    NODE CODE <---------------------------------------------------- SUPERVISOR
        |
        |      0E, LOGON CHARACTERS WITH TERMINATOR
        |---------------------------------------------------------> SUPERVISOR
                                                                        |
               0E, ERROR CODE NON ZERO                                  |
    NODE CODE <----------------------------------------------------------
        |
        |      B5, ERROR CODE, 9F
        |---------------------------------------------------------> INTERFACE


               0E, LOGON CHARACTERS WITH TERMINATOR
    NODE CODE ----------------------------------------------------> SUPERVISOR
                                                                        |
                                                                        |
               NEEDLE                                                   |
    NODE CODE <----------------------------------------------------------
        |
        |      B6, SUCCESSFUL LOGON
        |---------------------------------------------------------> INTERFACE




    LOGII                       Logon Processing II                          10
    Specifications                                              January 6, 1988


                              1.5  ADRII Logon Syntax


         A new  logon syntax  is documented in  the ADRII  GED, to  provide the
    logon string  fields for  symbolic addressing  Name and  LOGII information.
    The fields  in the logon  syntax are the  Options List field,  the Username
    field, the Destination  List field, the  Extension field, and  the Password
    field.  An ADRII syntax logon string may be present in a LOGII or non-LOGII
    circuit request.

         The  Options  List  field is  bracketed  by  parentheses  and contains
    symbolic data to inform the Supervisor of circuit request options,  such as
    throughput class or reverse charge request.  For LOGII, the Options List is
    used instead of imbedded control characters within the portion of the logon
    string prior to the  first terminator, and control characters  within LOGII
    requests  have  no special  significance  (with one  exception).   The last
    option  encountered sequentially  within the  logon request  has precedence
    over any  conflicting option specification  specified earlier in  the logon
    request  string.   Control  characters  retain  their  current significance
    within non-LOGII circuit requests.

         One control  character is  valid and has  significance within  a LOGII
    request, the control-W.  A control-W within a LOGII logon string causes the
    Supervisor to ignore any characters within the current ADRII field prior to
    the control-W.

         The Username field may contain a regular username or an X.121 username
    of the form "- DNIC + NTN".

         The Destination  List field  contains a  sequence of  Destination List
    items separated by preceding colons ":" and each item may be a host number,
    a  subhost number,  a  "host.subhost" number  combination, a  list  of host
    and/or host.subhost numbers seperated by commas ",", a hostname, an X.121 4
    digit DNIC specifying an RPOA, or a full X.121 IDN address (DNIC+NTN).

         The Extension field is bracketed by square brackets "[ ]" and contains
    data which is to be sent  to the destination interface (used for  X.25 Call
    User Data).   Any data  except the terminating  "]" may  be present  in the
    Extension field.  Non-printable characters are represented using  the quote
    sign  to  precede  an  ASCII  hexadecimal  byte  value,  the  quote  itself
    represented by a double quote "".

         The  Password  field   follows  the  semi-colon  or   carriage  return
    terminator (indicating the end of the first part of the logon  string), and
    may contain any character.   Passwords are required for some  usernames, in
    order to guarantee that the user is authorized to logon with that username.








    LOGII                       Logon Processing II                          11
    New Logon Information                                       January 6, 1988






                            2 -  New Logon Information


         In order to  support the SWBT  contract requirements and  to implement
    important similar features in  the Public Network, the  Origination Address
    and  other information  must be  transferred with  the circuit  request and
    needle,  necessitating  changes  in  the  Supervisor,  ISIS,  Node  Code  /
    Supervisor  Base  /  T-II  Gateway,  and  interfaces  which  originate  and
    terminate calls.   References to  the Node  Code in  this document  imply a
    reference to the  Supervisor Base and the  T-II Gateway code as  well since
    the codes are tightly coupled to the Node Code.

         The  interface   slots  which  request   circuits  will   provide  new
    information with the circuit request: Reverse Charge indication (RCHG), and
    Origination  Address  (OADR).  The  RCHG  indication will  be  used  by the
    Supervisor in  Access Profile  Intersection (APX)  processing and  the OADR
    will  be  retained  by  the  Supervisor  for  transmission  to  the circuit
    termination,  or for  use as  a username  with logon  requests that  do not
    specify a username.

         When the Supervisor sends the needle to the origination, which will be
    threaded through the network to the termination, it will  optionally append
    the OADR, the RCHG resultant indication, Target Selection and Qualification
    information,  the Specified  Destination  List (SDL,  always  present), the
    Resultant Destination Address (RDA),  and the Extension, to the  needle for
    ultimate reception by the terminating interface.

         Fundamental to this design is the ability of the Node Code and ISIS to
    pass  this new  information to  and from  the Supervisor  with  the circuit
    request and  the needle.  A  new mechanism will  be installed in  ISIS, the
    Node  Code and  the  Supervisor to  transit this  information  in flexible,
    expandable, backward compatible messages.  The interface slots will use the
    new mechanism for logon sessions, and will benefit from the new information
    contained therein.  Unmodified  circuit originating interfaces may  take of
    advantage of a subset of the benefits provided, since the user, or PVC call
    setup, can use the options field of the logon string to pass  LOGII related
    information to the Supervisor as logon characters.

         It  is highly  desirable to  allow new  needle information  to transit
    older  versions  of Node  Code  as  a regular  needle,  providing  a viable
    deployment mechanism.  In this  way only originating and  terminating ISIS,
    Node Code and  interface slots would necessarily  be modified to  take full
    advantage of LOGII features and information.  Also highly desirable  is the
    removal of the size limitations on the current needle, since there  will be
    an increasing amount  of LOGII related data  being sent with the  needle as
    new features  are added in  the future.  In  the very distant  future, this
    will also allow for node lists with more entries than currently allowable.



    LOGII                       Logon Processing II                          12
    New Logon Information                                       January 6, 1988


         In  summary,  the  new inbound  information,  Origination  Address and
    Reverse Charge indication will be  sent to the Supervisor with  the circuit
    request  from  the   originating  interface.   The  OADR,   resultant  RCHG
    indication, Target Selection  and Qualification information,  the Specified
    Destination  List, the  Resultant Destination  Address, and  the Extension,
    will  be  sent  from  the Supervisor  to  the  terminating  interface.  The
    Supervisor,  ISIS, Node  Code, and  originating and  terminating interfaces
    will be able  to forward and interpret  this information using  a flexible,
    variable length message format.  Of prime importance is the ability  of the
    LOGII needle  to pass  through previous  release Node  Codes transparently,
    with the new information appended to the needle.






                          2.1  Origination Address - OADR


         In  any  particular  network,  Origination  addresses  are  externally
    administered  according  to  a  desired  numbering  plan,   although  X.121
    addressing is recommended for X.25 interface compatibility.  Every physical
    or  logical port  that originates  a call  has an  interface  provided OADR
    associated with  it.  An  OADR may be  associated with  more than  a single
    port, or a single port may have more than one OADR associated with it.

         The CONSAT generates the OADR using an assembled in  translation table
    which maps the logical port  number to an Origination Address.   This table
    is also used to translate from the OADR to the logical port number for call
    backs  to an  OADR.  X.25,  X.28 and  X.75 interfaces  use the  Calling DTE
    Address from the call request packet to derive a TYMNET definition OADR.

         The  originating interfaces  send the  OADR with  the  circuit request
    through ISIS  to the  Node Code,  which transmits  this information  to the
    Supervisor as a Message Object  (MO) appended to the circuit  request.  The
    Supervisor uses the DNIC in the  OADR as the destination DNIC if  there was
    no DNIC specified in the destination field and if the OADR is in X.121 form
    thus containing  a DNIC (as  in the case  of SWBT  abbreviated addressing).
    The Supervisor uses its  own assembled in DNIC if  there is no DNIC  in the
    destination field  nor the  OADR.  If a  logon request  does not  contain a
    Username, the Supervisor uses the OADR as the username, and  logon requests
    without Username or OADR are rejected.

         In future implementations, the Supervisor may use the OADR as  part of
    the access validations process, allowing call blocking based upon  OADR, at
    the Supervisor.  This presents an OADR validity issue, since all  OADRs are
    administered  on the  slot level.   Anyone capable  of loading  a  slot can
    specify an OADR of any  form, and gateways can presumably have  valid OADRs
    in any form since they originate outside the native network.  The design as
    specified in this  document assumes that whatever  OADR is provided  to the
    Supervisor with the circuit request  is used by the Supervisor  to possibly


    LOGII                       Logon Processing II                          13
    New Logon Information                                       January 6, 1988


    block the  call, and then  just sent to  the destination interface,  as is.
    The international standards specifications  for X.25/75 do not  specify any
    validity or  authorization checks  on the  OADR, although  several networks
    either check the  form of the  OADR, perform end  to end validation  of the
    OADR, or centrally generate the OADR.

         In order to provide OADR  verification, it would be possible  to store
    all OADR prefixes  on the Sup disk  on a host by  host basis, and  have the
    Supervisor generate the OADR from  the disk file host entry prefix  and the
    host  provided  physical port  number.   This would  still  not  handle the
    problem of verification of OADR as provided by Value Added passthroughs and
    gateways since  they provide  OADRs as  indicated to  them by  the original
    circuit.

         Until there  is some method  of securing OADRs  based upon  a specific
    hardware  identifier, or  some encryption  method, the  currently described
    mechanism  is satisfactory.   In the  future, when  methods  of identifying
    actual hardware at the Supervisor are provided, the OADR can be verified by
    the Supervisor against a hardware serial number.

         The  OADR  is  provided  by the  originating  interface,  sent  to the
    Supervisor with  the call request,  and then sent  back to  the originating
    Node Code on  the command channel,  appended to the  needle as an  MO.  The
    originating  Node  Code informs  the  requesting port  of  successful logon
    through ISIS and converts the  command channel needle message to  a network
    needle  which  is passed  through  the network  bound  for  the terminating
    interface, carrying with  it the OADR MO.   The terminating Node  Code then
    assigns  a  free dispatcher  port  and  sends the  incoming  needle  to the
    dispatcher  in  ISIS  needle   format,  still  including  the   OADR.   The
    terminating interface receives the OADR with the needle from the dispatcher
    and may use it as appropriate to the slot.

         In future implementations, Value Added Passthrough interfaces  such as
    MUX, Menu Server  or Character Mode Terminal  will record the OADR  from an
    incoming needle and supply that value as an outbound OADR for call requests
    for that user.   T-II Gateways will  pass the original  Origination Address
    along in a similar manner.  The terminating interface may utilize  the OADR
    as appropriate, and may translate or discard the OADR.
















    LOGII                       Logon Processing II                          14
    New Logon Information                                       January 6, 1988


                            2.2  Reverse Charge - RCHG


         Each host has two Reverse  Charge bits associated with it in  the Host
    Tables  as reported  to  the Supervisor  by  the Host  slot.   Every Access
    Profile Entry (APE) in the MUD has two (RCHG) bits associated with  it when
    the entry  is being used  as a Username  profile and two  for use  when the
    entry is being used as a Destination name profile.  The meaning of the bits
    is the same in all cases:

                Reverse Charge bits - XY
                X = 0, reject caller charged calls
                X = 1, accept caller charged calls
                Y = 0, reject reverse charged calls
                Y = 1, accept reverse charged calls


         A circuit request may be placed as a reverse charged call by including
    the appropriate  specifications in  the logon string  options field,  or by
    including  the appropriate  MO  within the  LOGII logon  request,  and this
    affects the Supervisor's processing of Access Profile Intersection (APX) to
    determine a list of possible circuit destinations.

         The APX logic skips Access  Profile Entries (APEs) which do  not match
    the  Reverse  Charge  requirements   of  the  calling  Username,   and  the
    destination name  (hostname or X.121,  if present).  When  acceptable, APEs
    are intersected to yield possible destination hosts, and any hosts which do
    not match  the Reverse Charge  requirements (in the  Host table  entry) are
    rejected  as  possible destinations.   Based  upon the  call  request, Host
    table, Username and Hostname Reverse Charge status, the  Supervisor rejects
    a  circuit request  or  sends a  RCHG/non-RCHG indication  appended  to the
    needle bound for the circuit origination.  Note that interfaces  using non-
    LOGII logon sessions may specify the RCHG option as part of the ADRII logon
    string, and the reverse charge indication  is sent in bit 9 of  the current
    needle user flags halfword.

         The  RCHG information  is  sent from  the Supervisor  appended  to the
    needle as a MO and travels to the terminating interface in a similar manner
    as the aforementioned OADR MO.

         The host reverse charge status is reported to the Supervisor in either
    a type 1A host status message,  or in the type 19 takeover  response.  Host
    status message  1A contains a  byte of status  following the  message type.
    Bits 4 and 5 of this byte indicate the reverse charge status.  If bit  4 is
    reset,  caller  charged calls  are  accepted, if  reset  caller  charged is
    rejected.  If  bit 5 is  set reverse charged  calls are accepted,  if reset
    reverse charged  is rejected.   The type 19  takeover response  contains an
    entry for each host reported at takeover time.  There is a 16  bit expanded
    host status field prior to each host number.  Bits 1 and 2 of this halfword
    indicate the reverse charge status, with the same interpretation as for the
    type 1A host status message.



    LOGII                       Logon Processing II                          15
    New Logon Information                                       January 6, 1988


                                 2.3  Options List


         The Options List  is a new  ADRII logon string  field, and is  used to
    specify logon request options  such as throughput class and  reverse charge
    request.   In  a  LOGII  logon request,  options  are  requested  either by
    specifying  the appropriate  syntax within  the logon  string  Options List
    field, or by including the appropriate Option indication MO appended to the
    LOGII  circuit  request.   For non-LOGII  requests,  logon  options  may be
    specified within the  logon string Options List  field, or with any  of the
    existing  control  characters   that  are  currently  interpreted   by  the
    Supervisor.  The control-W character is used in LOGII and non-LOGII circuit
    requests to  indicate to the  Supervisor that any  characters prior  to the
    control-W in the same logon string field, are to be ignored.  The control-W
    is implicitly excluded from the following discussion.

         The characters  that are currently  interpreted by the  Supervisor are
    "^A", "^B", "^C", and "^D"  (indicating throughput classes of 64,  128, 512
    and 2048  cps, respectively),  and "^H", "^I",  and "^V",  indicating half-
    duplex,  interactive and  batch circuit  requests, respectively.   The "^H"
    character  causes  the  Supervisor to  include  a  "half-duplex" indication
    within the  needle flags, and  the "^I" and  "^V" request  path computation
    based upon either an interactive or batch quality of the desired circuit.

         Since these control characters will have no meaning in LOGII requests,
    interfaces upgrading to LOGII must handle these control  characters locally
    and  translate  them  into  their  corresponding  LOGII  indications.   The
    existing control characters can each be translated into an inbound MO which
    is sent to  the Supervisor with the  LOGII request.  For example,  when the
    CONSAT interface upgrades to LOGII, the options handling will take place as
    follows:

         Any control  characters entered by  the user must  be detected  by the
    CONSAT,  as well  as  any ESC  or  logon string  terminator  characters.  A
    detected ESC character  is translated by the  CONSAT into an  inbound RESET
    LOGON SESSION MO which is sent to the Supervisor, and terminator characters
    ";" and CR, cause the CONSAT to send a complete logon string or password to
    the Supervisor in a LOGII initial or subsequent circuit request.  The RESET
    indication will cause  the Supervisor to  discard any data  associated with
    this logon session, except for Circuit Characteristic Type  and Origination
    Address (which do  not change within a  logon session), so the  CONSAT also
    resets any indications received prior to the ESC.

         Control  characters  that  are  handled  locally  by  the  CONSAT  are
    interpreted and discarded.  Any of the seven Supervisor interpreted control
    characters  indicated  above,  are  translated  into  the   appropriate  MO
    indication, and  the actual  control characters  are discarded.   Any other
    control characters entered by the user, that are not locally  or Supervisor
    interpreted,  are included  within  the logon  string as  entered.   If the
    Supervisor receives a half-duplex indication,  either as an input MO  or as
    an Options List item in the logon string, the first logon response  sent to
    the interface (either needle or prompt), contains a half duplex indication,


    LOGII                       Logon Processing II                          16
    New Logon Information                                       January 6, 1988


    to inform the originating interface that the port has requested half-duplex
    status.

         The  Options List  items are  contained, separated  by commas,  in the
    first ADRII logon string field,  which is bracketed by "(   )".   The items
    take either of two forms, a "token" or a "token=value" syntax.   Tokens and
    values may  be one to  eight characters, and  any legal  options characters
    beyond eight characters  are simply ignored,  thus allowing users  to enter
    full  descriptive tokens,  (of which  only the  first eight  characters are
    interpreted).  The existing  Supervisor interpreted control  characters and
    their corresponding Options List logon string syntax are shown below:

    Capital letters indicate characters required for token interpretation.

    CONTROL CHARACTER       OPTIONS LIST ITEM SYNTAX
    -----------------       ------------------------
           A                    TClass=A
           B                    TClass=B
           C                    TClass=C
           D                    TClass=D
           H                  Hdx, or Halfdupl
           I                    Interact
           V                  Batch or Volume








                                   2.4  Username


         Although  the  Username  is  not  information  that  is  new  with the
    introduction of  LOGII, there are  still some considerations  regarding its
    usage.  The Username  may be sent to  the Supervisor in parsed  or unparsed
    form and will be  appended to the resultant  needle in a similar  manner as
    the aforementioned OADR and RCHG MOs, whether received by the Supervisor in
    parsed  or  unparsed  form.   The  inbound  username,  in  both  forms,  is
    translated, before being  sent out with  the needle, to  handle "control-W"
    indications, strip the high order bit and convert to upper case,  to remove
    nulls, all control characters (01 - 1A), and the ESC (1B), FS (1C), GS(1D),
    RS (1E), US (1F) and DEL (7F) characters.










    LOGII                       Logon Processing II                          17
    New Logon Information                                       January 6, 1988


                       2.5  Specified Destination List - SDL


         The Specified Destination List is a sequence of two ASCII strings each
    containing  a destination  item, the  first item  being the  first  or only
    destination specified in the logon request, the second item  indicating the
    ultimate destination  of the  circuit request.   The ":"  colon destination
    delimiter is  not present in  the SDL since  the separation  of destination
    items  delineates  the  separate  destination  specifications.  Destination
    items may be either:

           - a host number
           - a subhost number
           - a "host.subhost" number combination
           - a list of host and/or host.subhost numbers seperated
             by commas ",",
           - a hostname
           - an X.121 4 digit DNIC specifying an RPOA
           - a full X.121 IDN address (DNIC+NTN)
           - the active Supervisor identifier,
           - a node number kernel host identifier.


         This information is sent from the Supervisor appended to the needle as
    an MO and travels to the  terminating interface in a similar manner  as the
    aforementioned items (OADR and RCHG indications).

         The SDL  may also be  sent in as  a MO appended  to the  logon request
    eliminating the  need for  interfaces to form  a syntactic  SDL in  a logon
    string, and the need  for the Supervisor to  parse it.  Whether the  SDL is
    sent to the Supervisor in parsed  form, or the Supervisor forms the  SDL by
    parsing logon  characters, the  SDL outbound  from the  Supervisor contains
    certain translations and standardizations.  The inbound SDL or logon string
    Destination List may have items that are subject to  Supervisor translation
    prior to interpretation.

         The following translations take place at the Supervisor before the SDL
    is sent out  with the needle: Abbreviated  form X.121 addresses  (NTN only)
    are expanded to the full IDN  by prefixing with the DNIC from the  OADR (if
    present)  or  the  Supervisor's  default  DNIC.   X.121  address  indicator
    prefixes are converted to the  TYMNET standard X.121 prefix, the  dash "-",
    so  that  SWBT  addresses  of the  form  "1DNIC+NTN"  are  converted  to "-
    DNIC+NTN".  Any logon request Destination List characters that  are ignored
    by the Supervisor are  not present in the  outbound SDL, such as  "(", ")",
    "+", "-"  and blank  characters imbedded  within an  NTN (as  specified for
    SWBT).  The inbound SDL, in both parsed and unparsed forms,  is translated,
    before being sent out  with the needle, to handle  "control-W" indications,
    strip the  high order bit,  to remove nulls,  all control characters  (01 -
    1A), and  the ESC  (1B), FS  (1C), GS(1D), RS  (1E), US  (1F) and  DEL (7F)
    characters.




    LOGII                       Logon Processing II                          18
    New Logon Information                                       January 6, 1988


                     2.6  Resultant Destination Address - RDA


         The Resultant  Destination Address  is the  Hostname or  X.121 address
    that was last used as the MUD access name to yield a Resultant Destination,
    (a set  of numeric  host(s) used for  possible destination  selection).  In
    future implementations, the logon string may contain a host name which maps
    to  a  MUD  entry that  contains  a  hostname as  an  Access  Profile Entry
    destination. This APE destination hostname maps to another MUD entry with a
    set of  host or group  numbers in an  APE destination  specification.  This
    second  (final) host  name is  considered to  be the  Resultant Destination
    Address and is  sent by the Supervisor  with the needle to  the originating
    Node Code.  An RDA will only be present if a MUD entry contains  a symbolic
    destination specification in the APE.  This is not currently  supported, so
    no RDA indication will be made for now.

         This information is sent from the Supervisor appended to the needle as
    an MO and travels to the  terminating interface in a similar manner  as the
    aforementioned items (OADR and RCHG indications).






                      2.7  Target Selection and Qualification


         For X.25 compatibility the terminating interface needs to know whether
    the  call  was routed  to  a  secondary destination.   This  occurs  if the
    Supervisor found an origination and flags match within a particular APE yet
    had to proceed to look for another origin match in a subsequent  APE, since
    it was not possible  to route the call to  a destination in the  first APE.
    The first  APE that contains  an origin and  flags match is  considered the
    primary  target APE.   In addition  the Supervisor  will also  indicate the
    reason that the re-direction occurred,  as indicated by any and  all failed
    hosts  within  the  primary  target  APE  (or  subsequent  APEs  if further
    redirection  occurs).  Valid  redirection reasons  include Host  Down, Host
    Shut, No Such  Host, No Host Ports,  Reverse Charge call barred,  Sent Paid
    call barred, Host is originate only, systematic redirection, or  no network
    path to Host.  Systematic redirection  is defined to be the case  where the
    primary Username APE produces  no intersections with the  Destination APEs,
    but may have a different interpretation in the future.  The Supervisor will
    also indicate whether  or not multiple  targets were considered  in routing
    the call.

         This information is sent from the Supervisor appended to the needle as
    a MO and travels  to the terminating interface  in a similar manner  as the
    aforementioned items (OADR and RCHG indications).





    LOGII                       Logon Processing II                          19
    New Logon Information                                       January 6, 1988


                                  2.8  Extension


         The Extension field may be sent to the Supervisor in the  logon string
    following  the Destination  List field  (i.e. data  within  square brackets
    "[...]" after the circuit request destination field), or may be sent  in as
    a MO appended to the  logon request eliminating the need for  interfaces to
    form a syntactic Extension  field in a logon  string, and the need  for the
    Supervisor to parse it.  Whether the Extension is sent to the Supervisor in
    parsed  form,  or  the  Supervisor forms  the  Extension  by  parsing logon
    characters,  the Extension  outbound from  the Supervisor  contains certain
    translations.

         The Extension field  may contain any  data character except  the right
    hand bracket  which terminates  the Extension  field.  Since  the Extension
    field utilizes the  quote " character  to precede ASCII  representations of
    hexadecimal digits (an actual  quote character being represented  by double
    quotes  ""),  any  quote   preceded  characters  are  converted   to  their
    corresponding  hexadecimal  values,  and double  quotes  are  replaced with
    single  quotes,  in the  outbound  Extension.  The  only  other translation
    taking place is the stripping of the high order bit of each character.

         The Extension  can be  used to  pass X.25/X.75  "Call User  Data" from
    X.25/X.75 call originations  to terminations.  This  is not to  be confused
    with Sub host  addressing, which will remain  functionally the same  as the
    current implementation.

         This information is sent from the Supervisor appended to the needle as
    an MO and travels to the  terminating interface in a similar manner  as the
    aforementioned items (OADR and RCHG indications).
























    LOGII                       Logon Processing II                          20
    Major Functional Descriptions                               January 6, 1988






                        3 -  Major Functional Descriptions


         The transfer from the originating interface to the Supervisor of:

            - the Origination Address (OADR)
            - the Reverse Charge (RCHG) indications


         and  the  subsequent  Supervisor  processing  and  transfer  from  the
    Supervisor to the terminating interfaces of:

            - the OADR,
            - the RCHG indication,
            - the Specified Destination List (SDL),
            - the Resultant Destination Address (RDA, if present),
            - the Extension information, if present,


         is divided into four major processing categories:


                - LOGII Logon Session
                - LOGII related Error Log messages
                - LOGII related Accounting data
                - LOGII Supervisor Processing


         The LOGII Logon Session re-defines the messages which transfer circuit
    requests from  the originating  interface to  the Supervisor,  and messages
    which transfer the needle or logon response/rejects from the  Supervisor to
    the terminating interface.

         LOGII Logon Session Functional Descriptions:

         - LOGII Logon Session Summary
         - LOGII Message Philosophy - MOs, X.409
         - ISIS Circuit Request Message - ICRM, ICRS
         - Early Circuit Reject for ISIS - ECRI
         - Node Code Circuit Request Message - NCRM
         - Respond/Reject Circuit Request Message - RCRM, RCRI
         - Assign Logon Port - ASLP
         - Command Channel Needle - CCN
         - Node Code Needle - NCN
         - Logon Success Indication - LGSC
         - ISIS Needle - ISN




    LOGII                       Logon Processing II                          21
    Major Functional Descriptions                               January 6, 1988


         The LOGII related Error  Log messages section describes the  Error Log
    messages posted by the Supervisor, and interpreted by TMCS, as a  result of
    Supervisor LOGII message processing.

         The  LOGII related  Accounting data  section describes  the Accounting
    message used by the Supervisor to include LOGII Accounting related  data in
    the Accounting preamble for the logon.

         The Supervisor processing is presented in a separate  Supervisor LOGII
    General Internal Design document, LG2GID.DOC.












































    LOGII                       Logon Processing II                          22
    LOGII Logon Session                                         January 6, 1988






                             4 -  LOGII Logon Session


         The LOGII Logon Session completely redefines the messages  and message
    sequence used to build  TYMNET Normal and Auxiliary circuits.   An overview
    and  detailed  explanation  of the  LOGII  message  sequence  is presented,
    followed by a detailed presentation of the LOGII message structures.






                         4.1  LOGII Logon Session Summary


         There  are  new messages  defined  for  ISIS, the  Node  Code  and the
    Supervisor that allow the  flexible, efficient transfer of  Circuit Request
    and  Needle related  information throughout  the network.   The  same basic
    handshaking rules apply for logon sessions as with LOGI.  An interface must
    wait for a response to a circuit request from the Supervisor before sending
    further LOGII messages.

         Originating interfaces  use an  ISIS Circuit  Request Message  (ICRM -
    ISIS  message  11 to  the  node code)  to  place a  circuit  request.  This
    replaces  the pseudo-needle  request (message  07 on  RPORT -  0),  and the
    auxiliary circuit request (message 08 on RPORT - 0).  The Node Code assigns
    an RPORT in logon mode to the interface slot and informs the interface slot
    of the new port by sending an Assign Logon Port (ASLP, type 0C5), replacing
    the current pseudo-needle.  If  the port cannot be assigned,  the interface
    is  informed of  the reason  with  an Early  Circuit Reject  -  ISIS (ECRI)
    message (type 12 on RPORT -  0).  This replaces the current type  9 "unable
    to  build pseudo  needle" message  on RPORT  0.  The  ICRM may  or  may not
    contain all the information necessary for the logon request.  The interface
    now has  a port  on which  further logon  session communications  will take
    place,  although  no further  messages  may  be sent  until  a  response is
    received  from  the Supervisor.   The  ASLP alone  does  not  indicate that
    further logon messages can be sent, merely that a port has been assigned.

         Subsequent logon  information is sent  to the Node  Code on  the newly
    assigned  RPORT using  the  ISIS Circuit  Request Supplement  (ICRS  - ISIS
    message  0C4 on  the  newly assigned  RPORT), replacing  the  current logon
    string characters message (message 0B3 on the new RPORT).  If the Node Code
    detects a zapper message on the logon port from the interface, and the port
    has already begun its logon session with the Supervisor, then the Node Code
    sends the Supervisor a LOGON  SESSION ZAPPER MO, which replaces  the zapper
    characters imbedded within the logon string.



    LOGII                       Logon Processing II                          23
    LOGII Logon Session                                         January 6, 1988


         The Node Code  plays no interpretive role  in the LOGII  logon session
    (other than zappers),  and simply recognizes  the new ISIS  Circuit Request
    Messages  and  Supplements  (ICRM/ICRS), and  utilizes  the  new  Node Code
    Circuit Request Message  (NCRM) to communicate  the circuit request  to the
    Supervisor.  The NCRM, message 08 to the Supervisor on the command channel,
    is  recognized  by  the  Supervisor  for  circuit  request  processing, and
    replaces the 0C, 0E, 0F and 10 messages ("new-style" circuit request, logon
    string, TID + logon string, and aux circuit request).

         Since there  is a  possibility of flooding  the Supervisor  with these
    potentially large NCRM messages, the Supervisor should be able  control the
    maximum rate of command channel characters generated by the Node Code.  The
    Node Code may have  Tymfile specification for its command  channel outbound
    traffic rate,  though the  Supervisor should  be able  to override  this by
    setting the  Node Code's rate  with a command  channel message to  the Node
    Code.  This  can prevent pathological  slots from flooding  the Supervisor,
    and also gives the Supervisor some remote control over its rate  of command
    channel  input.   The mechanism  of  command channel  rate  control  is not
    presented in this document;  the need for it is simply stated  here.  There
    are other issues  regarding command channel  protocol, in addition  to rate
    control, that illuminate the need to re-design the Supervisor to  Node Code
    overall communications message structure.   It is hoped that  this document
    will  provide  general  guidelines  for  future  command  channel  protocol
    modifications and enhancements.

         The Supervisor generates a Command Channel Needle (CCN) which  is sent
    on the command channel to  the originating Node Code, utilizing the  0A CCN
    message (replacing the 09  needle message).  If the Supervisor  responds to
    or rejects  the circuit request,  a Respond/Reject Circuit  Request Message
    (type 12, RCRM) is sent to the Node Code on the command  channel, replacing
    the current '0D' or '0E'  Supervisor to node messages (talk to  terminal in
    logon mode, response to  auxiliary circuit).  The Supervisor  also responds
    to a logon port zapper indication by sending a logon zapper acknowledgement
    to the  Node Code in  an RCRM  messages, informing the  Node Code  that the
    logon port is okay for re-use.  This replaces the current '0F8D' Supervisor
    to node general purpose message, indicating a logon zapper acknowledgement.
    The  Supervisor  Base handles  command  channel messages  without  any size
    restrictions.

         The Supervisor does not allow  the mixing of LOGII and current  0F and
    0E logon messages;   any attempt to  do so causes  the logon request  to be
    rejected.   If  the  Supervisor  receives a  LOGII  logon  request  but the
    terminating  ISIS/Node  Code  or  Interface  cannot  interpret  LOGII,  the
    originating Node Code is instructed  to create an old 0310 needle,  and the
    originating interface is informed that this occurred.  Any information that
    cannot be sent in an 0310 needle is discarded.

         The  Node  Code  recognizes   the  RCRM  message  and   transfers  the
    response/reject information to the  originating slot on the  newly assigned
    RPORT, using the Respond/Reject  Circuit Request - ISIS message  (type 0C3,
    RCRI).  This replaces the current B4 and B5 messages (normal  logon status,
    and logon failure) to the originating interface, and the current AF  and B8


    LOGII                       Logon Processing II                          24
    LOGII Logon Session                                         January 6, 1988


    hang  and  super-hang  messages.  The  RCRI  logon  session  responses, and
    message strings  for ports  in logon  mode, are  sent by  TYMNET-II Gateway
    interfaces   to  the   actual  originating   Node  Code   using   IIX,  for
    communications with ports from another network.

         For successful circuit requests, the originating Node  Code recognizes
    the CCN message and constructs  a Node Code Needle (NCN) which  is threaded
    through the  network to  the termination.  The  originating Node  Code also
    informs ISIS and the originating interface of the successful logon  for the
    port, using the  LGSC message (replacing the  current B6 ISIS  message from
    the node code).  The form of the NCN allows for backlevel  passthrough Node
    Code compatibility and eliminates any size constraint on the needle.

         Terminating Node Code recognizes  the NCN inbound to it,  verifies the
    destination host  status and port  availability, and selects  an unassigned
    Dispatcher port to send the ISIS Needle (ISN) to the terminating interface.
    ISIS receives the ISN on an unassigned Dispatcher port and routes it to the
    terminating interface.  The ISN is message 0C2 sent from the Node Code on a
    newly assigned RPORT.

         The LOGII design can be  used for command and rebuild circuits  in the
    future, but for now will not.

         The  LOGII  logon session  is  structured to  provide  a  simple logon
    session message sequence to be used to carry out the logon  session between
    the interface and the Supervisor, with minimal Node Code  involvement.  The
    interface  no  longer  sends  the  logon  request  as  a  series  of single
    characters, but has a  two options for the  form of the request.   The Node
    Code plays  no interpretive  role in logon  string character  handling, but
    simply passes the interfaces request to the Supervisor.  Control characters
    other  than  control-W, have  no  special interpretation  within  the LOGII
    session, and will only have meaning for logon sessions not utilizing LOGII.
    The Escape  character ESC  has no  special meaning  within the  LOGII logon
    session, since the  logon session reset  indication is no  longer contained
    within the logon  string characters.  The  transmission of messages  to the
    Supervisor is  no longer  controlled by  the Node  Code, but  the interface
    slot.  LOGII and non-LOGII protocols cannot be mixed within the  same logon
    session.





                4.1.1  LOGII Parsed and Unparsed Logon

         Two options are provided for the form of the logon request to  be used
    by  the interface,  either Parsed  or Unparsed  LOGII logon.   The unparsed
    option  utilizes  logon  characters to  communicate  a  logon  string (with
    optional password)  to the  Supervisor, and  the Supervisor  interprets the
    logon string syntax and forms  the various logical components of  the logon
    request.  In the parsed option, the logon request is sent to the Supervisor
    in discrete  logical elements,  eliminating the need  for the  interface to


    LOGII                       Logon Processing II                          25
    LOGII Logon Session                                         January 6, 1988


    construct a  syntactic logon  string, and  the need  for the  Supervisor to
    parse it.  The same logical  information is represented whether or  not the
    parsed or unparsed  option is used by  the interface.  Parsed  and unparsed
    information may be included in the same message, provided no information is
    duplicated.

         The  unparsed form  can contain  the Option  List field,  the Username
    field, the Destination  List field, the  Extension field, and  the Password
    field, within a syntactic logon string whose syntax is defined in the ADRII
    GED.   Unparsed  information is  sent  to the  Supervisor  as  logon string
    characters,  in either  one  or two  messages: login  string  with password
    included in a single ICRM, or the login string in an ICRM and  the password
    in a subsequent ICRS message.  The logon character MO implies  a terminator
    by its presence, so  interfaces must construct a terminated  message before
    sending  it  with the  ICRM/ICRS,  since the  Supervisor  will  enforce the
    presence of the terminator.  If the Supervisor detects no terminator at the
    end of the logon  character MO, a CR terminator  is appended to the  end of
    the string.  If a password is present in the logon string character  MO, it
    is  separated from  the login  string  field by  the semi-colon  ";"  or CR
    character,  and is  itself terminated  by a  semi-colon, CR  or  by implied
    terminator  (end  of  MO  implies  a  CR  terminator).   In  this  fashion,
    interfaces are forced to  send only complete logon strings,  complete logon
    strings  with  passwords,  or complete  passwords.   A  control-W character
    imbedded within the unparsed logon string characters causes  the Supervisor
    to ignore  any characters prior  to the control-W  within the  logon string
    field containing the control-W.

         The parsed  form contains  the Option  indications, the  Username, the
    Destination List, the Extension,  and the Password as discrete  MO elements
    within the  ICRM/ICRS messages.   The interface  may use  this form  of the
    session, if  the logon  request elements  are available  to it  as discrete
    pieces,  thus eliminating  the need  for the  interface to  translate these
    pieces into a  syntactic logon string, and  the need for the  Supervisor to
    parse the string.  A control-W character imbedded within the  characters of
    a parsed logon Username, Destination List, Extension or Password MO, causes
    the Supervisor to ignore any  characters prior to the control-W  within the
    MO.

         Because certain interfaces  may receive parts  of the logon  string in
    unparsed form,  and other  parts as  discrete elements,  both forms  may be
    inter-mixed  in  an  ICRM  so  long as  they  do  not  duplicate  any logon
    information.

         The Escape  character no  longer has  special significance  within the
    logon string, and is replaced by a logon session reset indication, which is
    sent by the interface  when it detects that  the user wants to  restart the
    logon session.  The  interface will send the  reset indication in  place of
    any logon characters or  parsed logon elements, and any  message containing
    parsed or unparsed logon information and the reset MO, is considered  to be
    of improper  form and  rejected by  the Supervisor.   Upon reception  of an
    logon session reset MO,  the Supervisor discards all context  regarding the
    logon, except the  OADR and the CCT,  which remain in force  throughout the
    entire logon session.

    LOGII                       Logon Processing II                          26
    LOGII Logon Session                                         January 6, 1988


                4.1.2  Detailed Discussion of LOGII Normal Logon

         The LOGII logon session  is completely carried out by  the originating
    interface, with Node Code intervention  only in the case of  logon zappers.
    The interface  interprets incoming logon  request information  scanning for
    local and Supervisor pertinent  control characters, the ESC  character, and
    semi-colon or CR  terminators.  If a  local control character  is detected,
    the local action is taken and the character is discarded.  If  a Supervisor
    pertinent  control  character  is  present,  it  is  translated   into  the
    appropriate ICRM MO, which is  buffered by the interface until the  ICRM is
    sent.  The Supervisor will echo any half-duplex request to the interface in
    the  first  logon  response  the  Supervisor  sends,  either  RCRM/RCRI  or
    CCN/RCRI.

         If  an ESC  character  is detected  before the  first  terminator, the
    interface  resets the  logon request,  and prompts  the user  to  retry the
    logon,  without informing  the Node  Code or  the Supervisor.   If  the ESC
    character is detected after the first terminator, then an ICRM  should have
    already been sent, and a Dispatcher logon port assigned.  In this  case the
    RESET LOGON SESSION MO is sent  to the Node Code within an  otherwise empty
    ICRS,  which  is  translated  into  a  subsequent  NCRM  and  sent  to  the
    Supervisor, and  the Supervisor  and interface  discard all  previous logon
    session information except  CCT and OADR.   The Supervisor responds  to the
    RESET LOGON SESSION indication by returning an RCRM normal circuit response
    prompt  which the  Node Code  translates  into an  RCRI, and  sends  to the
    interface, requesting the interface  to empty its input and  output buffers
    and turn output on, prompting the user to "please login".





              CONTROL CHARACTERS IN THE LOGON STRING
    USER      ----------------------------------------------------> INTERFACE
                                                                        |
              LOCAL CONTROL CHARACTERS HANDLED AND DISCARDED            |
              -----------------------------------------------------------
                                                                        |
              SUPERVISOR CONTROL CHARACTERS TRANSLATED TO BUFFERED MOs  |
              -----------------------------------------------------------
                                                                        |
              OTHER CONTROL CHARACTERS BUFFERED AS LOGON CHARACTERS     |
              -----------------------------------------------------------











    LOGII                       Logon Processing II                          27
    LOGII Logon Session                                         January 6, 1988





              ESC BEFORE FIRST TERMINATOR
    USER      ----------------------------------------------------> INTERFACE
                                                                        |
              DISCARD SESSION INFORMATION, REQUEST "PLEASE LOGIN"       |
             <-----------------------------------------------------------



              ESC AFTER FIRST TERMINATOR
    USER      ----------------------------------------------------> INTERFACE
                                                                        |
              ICRS WITH RESET LOGON SESSION INDICATION                  |
    NODE CODE <----------------------------------------------------------
        |
        |     NCRM WITH RESET LOGON SESSION INDICATION
        -----------------------------------------------------------> SUPERVISOR
                                                                        |
              RCRM WITH RESET DETECTED INDICATION                       |
    NODE CODE <----------------------------------------------------------
        |
        |     RCRI WITH RESET DETECTED INDICATION, REQUESTING
        -----------------------------------------------------------> INTERFACE
              CLEAR OF INPUT AND OUTPUT BUFFERS, ECHO ON, INDICATING
              "PLEASE LOGIN"



         When the interface detects the CCT,  an ICRM is sent to the  Node Code
    on RPORT 0, along with any interface buffered ICRM MOs, including the logon
    string with imbedded terminator.  The Node Code responds with an ECRI if an
    ASLP cannot be  returned, otherwise the Node  Code returns the ASLP  to the
    interface on a  new Dispatcher port.  In  addition, the Node  Code converts
    the ICRM  into an NCRM  and sends  the message to  the Supervisor  with the
    logon information, including at least  the first part of the  logon string,
    and possibly including the entire parsed logon string with  password.  This
    is  the  start of  the  logon session  at  the Supervisor  and  any further
    information that the Supervisor requests  is sent from the interface  in an
    ICRS which is converted to a subsequent NCRM by the Node Code.

         Alternatively, the interface  may send an  ICRM message with  no X.409
    component at the beginning of  the logon session. This causes Node  Code to
    respond with  an ASLP and  wait for the  required logon  information before
    sending  an NCRM  to the  Supervisor.  If  this method  is used,  the first
    message containing X.409  information is still the  ICRM. The ICRS  is used
    only if subsequent X.409 information is sent.

         If the interface sends a  9F disconnect message on the  newly assigned
    port in logon mode after the  Node Code has sent it's first NCRM,  the Node
    Code detects this condition and sends the Supervisor a LOGON SESSION ZAPPER


    LOGII                       Logon Processing II                          28
    LOGII Logon Session                                         January 6, 1988


    in an otherwise empty NCRM  message.  The Supervisor responds with  a LOGON
    ZAPPER ACKNOWLEDGEMENT in an RCRM message, which informs the Node Code that
    the port is okay for re-use.



















































    LOGII                       Logon Processing II                          29
    LOGII Logon Session                                         January 6, 1988




              CCT
    USER      ----------------------------------------------------> INTERFACE
                                                                        |
              ICRM WITH ANY BUFFERED MOs AND LOGON CHARS W/ TERMINATOR  |
    NODE CODE <----------------------------------------------------------
        |
        |     ECRI FOR PSEUDO-NEEDLE REJECT
        -----------------------------------------------------------> INTERFACE



              FIRST ";" OR CR TERMINATOR
    USER      ----------------------------------------------------> INTERFACE
                                                                        |
              ICRM WITH ALL BUFFERED MOs AND LOGON CHARS W/ TERMINATOR  |
    NODE CODE <----------------------------------------------------------
        |
        |     ASLP INDICATING A LOGON PORT IS ASSIGNED
        -----------------------------------------------------------> INTERFACE
        |
        |     NCRM WITH ALL BUFFERED MOs AND LOGON CHARS W/TERMINATOR
        -----------------------------------------------------------> SUPERVISOR



            START LOGIN
    USER      ----------------------------------------------------> INTERFACE
                                                                        |
              ICRM WITH NO MO'S                                         |
    NODE CODE <----------------------------------------------------------
        |
        |     ASLP INDICATING A LOGON PORT IS ASSIGNED
        -----------------------------------------------------------> INTERFACE
                                                                         | 
              ICRM WITH ALL BUFFERED MOs AND LOGON CHARS W/TERMINATOR    |
    NODE CODE <-----------------------------------------------------------
        |
        |     NCRM WITH ALL BUFFERED MOs AND LOGON CHARS W/TERMINATOR
        -----------------------------------------------------------> SUPERVISOR


              9F DISCONNECT MESSAGE AFTER FIRST TERMINATOR
    INTERFACE -----------------------------------------------------> NODE CODE
                                                                         |
              CLEAR INTERFACE TO NODE CODE LOGON PORT                    |
              ------------------------------------------------------ NODE CODE
                                                                         |
              NCRM WITH LOGON SESSION ZAPPER                             |
    SUPERVISOR<-----------------------------------------------------------
        |
        |     RCRM WITH LOGON ZAPPER ACKNOWLEDGEMENT

    LOGII                       Logon Processing II                          30
    LOGII Logon Session                                         January 6, 1988


        ------------------------------------------------------------> NODE CODE


         Once the first  NCRM message is sent,  the Supervisor is aware  of the
    port in logon mode and the logon session begins.  The interface may include
    the entire logon string  with password in parsed  form in the ICRM,  or may
    send only the logon string without password, and await a response  from the
    Supervisor.  If the Supervisor detects a condition within the logon request
    that requires more data  from the interface (necessary  information missing
    or  invalid),  or  if  the  requested  destination  in   inaccessible,  the
    Supervisor responds with an RCRM  which is translated by the Node  Code and
    sent as an RCRI to the interface, indicating the desired  interface action.
    In  some cases  the desired  action will  be to  hang the  port,  which the
    Supervisor  also  indicates  in  the  RCRM.   The  interface  responds with
    additional logon request  information in an ICRS  message sent to  the Node
    Code on  the newly assigned  Dispatcher port.  The  Node Code  converts the
    ICRS to a subsequent NCRM and sends the data directly to the Supervisor.

         If  the Supervisor  finds all  the necessary  logon information  to be
    present  and  valid,  and  a destination  can  be  reached,  the Supervisor
    responds with a CCN which prompts the originating Node Code to send an LGSC
    indicating successful logon, to the interface.


              ICRM WITHOUT PASSWORD AND PASSWORD REQUIRED,
    INTERFACE -----------------------------------------------------> NODE CODE
              SOME INFORMATION INVALID, OR DESTINATION INACCESSIBLE      |
                                                                         |
              NCRM WITH ICRM INFORMATION                                 |
    SUPERVISOR<-----------------------------------------------------------
        |
        |     RCRM INDICATING ERROR RESPONSE OR PROMPT FOR INFO
        ------------------------------------------------------------> NODE CODE
              AND REQUESTED INTERFACE ACTION, MAYBE HANG THE PORT        |
                                                                         |
              RCRI WITH RCRM INFORMATION                                 |
    INTERFACE <-----------------------------------------------------------
        |
        |     ICRS WITH ADDITIONAL LOGON REQUEST INFORMATION
        ------------------------------------------------------------> NODE CODE
                                                                         |
              SUBSEQUENT NCRM WITH ICRS DATA                             |
    SUPERVISOR<-----------------------------------------------------------




              ICRM WITH PASSWORD, OR NO PASSWORD REQUIRED
    INTERFACE -----------------------------------------------------> NODE CODE
              ALL INFORMATION VALID, DESTINATION ACCESSIBLE              |
                                                                         |
              NCRM WITH ICRM INFORMATION                                 |
    SUPERVISOR<-----------------------------------------------------------

    LOGII                       Logon Processing II                          31
    LOGII Logon Session                                         January 6, 1988


        |
        |     CCN, SUCCESSFUL CIRCUIT REQUEST, NEEDLE
        ------------------------------------------------------------> NODE CODE
                                                                         |
              LGSC INDICATING SUCCESSFUL LOGON TO THE PORT               |
    INTERFACE <-----------------------------------------------------------



         There are many possible responses that the Supervisor may use to reply
    to an  NCRM.  This document  does not attempt  to itemize all  the possible
    Supervisor  actions  in  response  to a  logon  request,  and  the protocol
    examples shown above are  merely intended to illustrate the  mechanism used
    to exchange logon information  and responses between the interface  and the
    Supervisor.  The ADRII GED  contains complete information regarding  all of
    the Supervisor logon states and responses that may occur.

         The above example  is representative of  a terminal interface  type of
    logon session, although other interfaces  may use the only a  simple subset
    of this normal logon session.





                4.1.3  Detailed Discussion of LOGII Auxiliary Logon

         The LOGII Auxiliary  Logon session is  simple in comparison  to normal
    circuit processing, since a LOGII auxiliary logon session utilizes only one
    response  from the  Supervisor, either  rejecting or  completing  the logon
    request.   As  with  non-LOGII  auxiliary  sessions,  the  zapper  and  ESC
    characters have no special significance  in LOGII sessions.  If an  03 data
    character  (zapper)  or  ESC character  is  detected  within  the auxiliary
    request logon string the request is rejected due to bad  format.  Auxiliary
    requests may be in parsed  or unparsed form containing the logon  fields as
    separate ICRM MOs or syntactically represented with a logon characters MO.

         NOTE - LOGII  auxiliary circuit requests  may include a  password, and
    the password requirement is enforced if indicated by the Auxiliary password
    required bit in the MUD entry control bits.

         Essentially, the  LOGII auxiliary session  is identical to  the normal
    logon session, except that any  response from the Supervisor is  final, and
    the method  of logon port  disconnection is different.   If a  normal logon
    port is to be disconnected at the interface's behest, the interface sends a
    9F message on the newly  assigned Dispatcher logon port.  This  is detected
    by the Node Code, which disconnects  the circuit from the Node Code  to the
    interface,  and sends  a  logon zapper  to  the Supervisor,  waiting  for a
    Supervisor logon zapper acknowledgement before re-using the logon port.  If
    a normal logon port is disconnected at the Supervisor's behest,  by sending
    a hang port indication in an RCRM, the indication is sent to  the interface
    in the  corresponding RCRI message,  and the interface  responds with  a 9F
    message, beginning the cycle discussed above.

    LOGII                       Logon Processing II                          32
    LOGII Logon Session                                         January 6, 1988


         Since any  Supervisor response to  a LOGII auxiliary  circuit request,
    other than a successful needle,  results in the disconnection of  the logon
    port, the Node Code interprets any Supervisor auxiliary RCRM to imply logon
    port disconnection.  Upon reception  of an auxiliary circuit RCRM  from the
    Supervisor, the  Node Code  assumes that the  Supervisor has  discarded any
    information associated with this port's logon session, and that the port is
    available  for re-use.   The Node  Code then  sends the  corresponding RCRI
    message to the  interface, followed by a  9F message, which  indicates that
    the  Node  Code  has  disconnected  the  Dispatcher  logon  port.   If  the
    Supervisor responds to  the auxiliary circuit NCRM  with a CCN  needle, the
    Node  Code informs  the  interface of  the  successful logon  with  an RCRI
    message.










































    LOGII                       Logon Processing II                          33
    LOGII Logon Session                                         January 6, 1988





              AUX ICRM WITH LOGON CHARS, OPTIONAL PASSWORD
    INTERFACE -----------------------------------------------------> NODE CODE
              ALL INFORMATION VALID, DESTINATION ACCESSIBLE              |
                                                                         |
              AUX NCRM WITH ICRM INFORMATION                             |
    SUPERVISOR<-----------------------------------------------------------
        |
        |     AUX CCN, SUCCESSFUL CIRCUIT REQUEST, NEEDLE
        ------------------------------------------------------------> NODE CODE
                                                                         |
              AUX RCRI INDICATING SUCCESSFUL LOGON TO THE PORT           |
    INTERFACE <-----------------------------------------------------------




              AUX ICRM WITH LOGON CHARS, OPTIONAL PASSWORD
    INTERFACE -----------------------------------------------------> NODE CODE
              DATA MISSING OR INVALID, OR DESTINATION INACCESSIBLE       |
                                                                         |
              AUX NCRM WITH ICRM INFORMATION                             |
    SUPERVISOR<-----------------------------------------------------------
        |
        |     AUX RCRM WITH ERROR INDICATION
        ------------------------------------------------------------> NODE CODE
                                                                         |
              RCRI INDICATING ERROR, 9F DISCONNECT MESSAGE               |
    INTERFACE <-----------------------------------------------------------























    LOGII                       Logon Processing II                          34
    LOGII Logon Session                                         January 6, 1988


                    4.2  LOGII Message Philosophy - MOs - X.409


         All  of the  new  messages mentioned  above  are designed  to  allow a
    minimum of translation when passing between the interfaces, ISIS, Node Code
    and the Supervisor.  The format allows flexibility for future expandability
    and  provides  a  designed-in compatibility  scheme.   The  ideas  for this
    message format are taken from W. R. Soley's design of a new circuit request
    and  needle format  using variable  length Supplemental  Needle Information
    (SNI) items  appended to  a fixed  length header,  and his  introduction of
    X.409 into the design.  The  LOGII design implements the SNI  concept using
    the CCITT  X.409 standard protocol,  which provides  completely expandable,
    variable  length data  representations.   A thorough  understanding  of the
    basic   concepts   of   the  X.409   standard,   INCLUDING   STANDARD  TYPE
    REPRESENTATION, is  prerequisite to the  discussion that  follows.  Richard
    Rawson has provided an abbreviated X.409 tutorial, which is included  as an
    appendix section to this document.

         Each LOGII message  begins with a  type identifier to  distinguish the
    LOGII message on the particular  data path which the message  is associated
    with.   Each variable  length  message has  a mechanism  included  to allow
    potentially large messages to be split over several data transfers.

         The ISIS messages  (except for the ASLP,  which is fixed  length) each
    have a bit in the message flags field which indicates that a message is not
    complete within the current transfer.   This bit is set for  all incomplete
    message  data  transfers,  and  reset  on  the  final  data  transfer which
    completes the message.  When the  bit is reset in the first  data transfer,
    the entire message is present.  Incomplete messages may not be interspersed
    with other messages on the same logical port, and only remaining  pieces of
    the incomplete message should follow a partial message data  transfer.  The
    byte count for each message  represents the data contained within  the data
    transfer only,  not the  entire message.   Incomplete messages  may contain
    incomplete  X.409 data  constructs, and  messages should  therefore  not be
    analyzed until the entire message is received.

         The  command  channel  messages are  currently  not  limited  in size,
    employing a mechanism which allow  large messages to be split  over several
    data  transfers.   The  Node   Code  Needle  messages  utilize   a  unique,
    terminating sub message to indicate the end of the needle message stream.

         Each LOGII ISIS message obeys the current Dispatcher rules  and starts
    on  a  fullword  boundary.   The  ICRM,  ECRI,  ICRS,  RCRI,  LGSC  and ISN
    Dispatcher messages have  the type encoded within  the first 8 bits  of the
    Dispatcher  message,  following   the  RPORT  number  which   precedes  all
    Dispatcher messages.

         The type is followed by  8 flag bits.  The continuation flag  bit, the
    high order bit of the byte (bit 0), indicates that a message is incomplete,
    and  that  further  portions  of  the  message  will  follow  in subsequent
    transfers.  ISIS LOGII messages that are larger than 0FC bytes must be sent
    in more than one data transfer, due to ring size limitations.   The logical


    LOGII                       Logon Processing II                          35
    LOGII Logon Session                                         January 6, 1988


    message is  not considered  complete until all  partial portions  have been
    received, so no processing of  the message should occur until  the ultimate
    message  portion  (with  the  continuation  bit  reset)  is  received.  All
    portions  of  a  message   except  the  ultimate  portion  will   have  the
    continuation bit set.  Messages less than 80x bytes may not be divided into
    message portions, and messages greater than 0FC bytes must be  divided into
    portions.

         In order to handle some special Dispatcher conditions in the  event of
    an intra-node circuit, an additional bit (bit 1) of the header flag byte is
    used to indicate (if set) that a message is the not the first message  of a
    continuation  sequence.   Single  transfer  messages  will  have  both  the
    continuation and the subsequent message bits reset.

         The following 16 bits contain  the length of the current  message that
    follows including any fixed length header and variable length MOs which the
    message may contain.  Any data that  is not part of the header  follows the
    X.409 standard format.  The ASLP  message is simply comprised of a  fixed 8
    byte  field,  with no  X.409  constructs, and  therefore  needs  no message
    continuation indication.




         LOGII ISIS message general format:

         .--------.--------.--------.--------.
         |      RPORT      |  type  |XS......|
         -------------------------------------
         |   message size  | possible fixed
         -------------------------------------
         |    length header information      |
         -------------------------------------
         |    MOs ....
         -------------------

         Where X = True indicates an incomplete message.
         Where S = True indicates a subsequent message in a partial
                   message sequence.















    LOGII                       Logon Processing II                          36
    LOGII Logon Session                                         January 6, 1988


         The LOGII  NCRM, RCRM, and  CCN messages which  travel on  the command
    channel  have the  type encoded  within  the first  8 bits  of  the command
    channel  message,  following the  16  bit Node  number  which  precedes all
    command channel messages.  The next 8 bits are unused, and included  for 16
    bit alignment.  The high order bit  of this unused field is set.   The next
    16  bits are  used to  indicate the  byte count  size of  the MO  list that
    follows.

         LOGII Command channel message general format:

         .--------.--------.--------.--------.
         |   Node Number   |  type  |   80   |
         -------------------------------------
         |  message count  |  MOs....
         -------------------------------------



         The LOGII  Node Code Needle  messages which travel  on Node  Code link
    channels are preceded by a  16 bit control character pair  which identifies
    the  NCN component,  and consist  of X.409  messages following  the control
    character pair.  The length of the NCN messages is indicated by  the length
    field within the X.409 format.

         All LOGII  message data following  the message type/count  and control
    character pair headers is represented by a single,  Application-Wide class,
    Constructor form, Implicit Sequence X.409 Element.  The Identifier  of this
    overall X.409 Element  indicates the Element's interpretation,  ICRM, ECRI,
    NCRM,  RCRM, RCRI,  CCN, NCN,  LGSC or  ISN.  The  main Element  is usually
    composed  of  two  Elements.   The  first  Element  contains  a  Universal,
    Construction Sequence  of Required Message  Object Elements (RMOs)  for the
    LOGII message,  and the second  Element contains a  Universal, Construction
    Set which, if not empty, contains the optional Supplemental Message Objects
    (SMOs) for the  message.  If a LOGII  message does not contain  a specified
    RMO (and the RMO has no default value), the message is considered to  be of
    invalid format.  If an RMO item is not present in a LOGII message,  and has
    a default value, the  default value for the  RMO is assumed.  All  SMOs are
    optional and if none are present, the SMO set is not present.  The smallest
    data size is 8 bits.

         NCN messages do not have RMOs, which allows a more  relaxed definition
    of  these inter-Node  Code messages.   These messages  are simply  a single
    overall  Implicit  Sequence element,  without  the usual  RMO  and  SMO sub
    elements.

                LOGII X.409 Message Structure
                -----------------------------

                LOGIIMESSAGE ::= [APPLICATION ##] IMPLICIT SEQUENCE {

                            rMOSequence SEQUENCE {   }
                            sMOSet SET {   }                         }


    LOGII                       Logon Processing II                          37
    LOGII Logon Session                                         January 6, 1988




         RMOs  and  SMOs  are  X.409  elements  with  unique  Application  wide
    Identifiers  that  have the  same  interpretation across  the  LOGII design
    application.   Some are  Primitive and  some are  Constructors.   A message
    object can be used as either  an RMO or an SMO depending upon  the message.
    The  sections  that follow  provide  a complete  explanation  of  the LOGII
    messages, each message being presented with its corresponding  RMO sequence
    and SMO set.   The X.409 standard type  representation is used  to describe
    the  message  structures  and  complete  explanations  of  the  elements is
    described in the accompanying text.   Note that SMOs and RMOs each  have an
    X.409 Application Identifier associated with them, although there  are some
    X.409 Application Identifiers that are not directly associated with SMOs or
    RMOs.  X.409 Identifier  codes will be represented  by "ID-xx" where  xx is
    the  Identifier  code,  and  MO  numbers,  which  are  the  same  as  their
    corresponding X.409 Identifier code, are represented by "MO-xx" where xx is
    the MO number.  This notation readily distinguishes X.409 elements that are
    MOs from elements  that are not.   All ID and  MO codes are  represented in
    hexadecimal within this document.

         There are  four MO  codes reserved for  LOGII secondary  logon session
    information (a secondary  logon being generated  by a TYMNET-II  Gateway or
    passthrough interface such  as the MUX or  Menu Server), and these  MOs are
    listed in the MO appendices without any corresponding MO description within
    this document.  They are included within the LOGII X.409  Application since
    they will  be constructed  of LOGII X.409  elements, and  it is  simpler to
    maintain X.409 Application-wide codes for the secondary logon messages that
    are unique within  the LOGII Application.  MOs  44 through 47  are reserved
    for secondary logon related information.

         Appendices  are  included  in  this  document  which  list  the  X.409
    Application-Wide Identifiers which are  used by LOGII, sorted  in numerical
    order by Identifier code, and alphabetically by element  description.  Also
    included is  the full  X.409 standard  type representation  for all  of the
    LOGII messages,  an x.409 tutorial,  and an exemplary  expansion of  a type
    representation to an actual byte stream.

         Since  any future  MOs  must be  able to  transit  backlevel ISIS
    dispatchers and backlevel Node Codes while threading the needle, there
    is no check for valid MO  type in ISIS or Node Code paths.   Since the
    Supervisor  must  be  uplevel  to  any  deployed  network   code,  any
    unexpected MO  encountered by  the Supervisor  will cause  the circuit
    request  to  be  denied, indicating  the  appropriate  reason "Invalid
    ICRM/NCRM  format",  in  the  RCRM/RCRI  circuit  reject  sent  to the
    originating interface.  RMO's, that are required, are only checked for
    by the  entity that  is ultimately interpreting  the message,  so that
    entities that  merely pass a  LOGII message through  do not  check for
    presence of RMOs.

    Here are some general guidelines concering the LOGII implementation of
            X.409:

            - The maximum element size for any X.409 element is 512d bytes.

    LOGII                       Logon Processing II                          38
    LOGII Logon Session                                         January 6, 1988


            - Bit strings contain a maximum of 5 bytes, 1 for unused bit
              indication, and 4 with actual bit data.
            - Octet strings are a maximum of 16d bytes.
            - Integers are a maximum of 16d bytes.
            - IA5 strings are a maximum of 128d bytes.



    NOTE - UNLIKE THE CCITT X.409 DOCUMENTS, THIS DOCUMENT  REPRESENTS ALL
            NUMBERS  IN  HEXADECIMAL   WITHIN  THE  X.409   STANDARD  TYPE
            REPRESENTATIONS.











































    LOGII                       Logon Processing II                          39
    LOGII Logon Session                                         January 6, 1988


                     4.3  ISIS Circuit Request Message - ICRM


         The  new ISIS  Circuit Request  Message (ICRM)  is sent  from the
    originating  interface  to  the  Node Code  on  RPORT  0  and  has the
    following format:

         ICRM - ISIS Circuit Request Message - 11

         Originates in slot, goes to Node Code slot, on RPORT 0.

         .--------.--------.--------.--------.
         |     RPORT 0     |   11   |XS.....A|
         -------------------------------------
         |   message size  | Dispatcher Key  |
         -------------------------------------
         |    Local Key    |   ICRM  MOs ....
         -------------------

         Where X = True indicates an incomplete message.
         Where S = True indicates a subsequent message in a partial
                   message sequence.
         Where A = True indicates the circuit is licenced
                   to be an aux circuit, as indicated by
                   the Dispatcher.


         The Dispatcher will set the  "A" bit of the message  flags field,
    to indicate to  the Node Code  that the request  is licensed to  be an
    Auxiliary circuit.  If the  Node Code detects this circuit  request to
    be for an Auxiliary circuit (from the ICRM flags), then  the Auxiliary
    license bit is checked in  the message header.  If the circuit  is not
    licensed to  be an Auxiliary  circuit the request  is rejected  by the
    Node Code, indicating the appropriate reason.

         The Dispatcher Key  is used between  the dispatcher and  the Node
    Code to keep track of which interface slot is making the  ICRM request
    and contains an index to  the dispatcher port range for  the interface
    slot.  The  interface does not  include this key  in the  ICRM message
    that it sends out on  RPORT 0.  The dispatcher inserts  the Dispatcher
    Key into the ICRM message before delivering it to the Node  Code.  The
    Node Code will  echo this key  with any ECRI  or ASLP message  that it
    sends back to  the interface (on RPORT  0 or the newly  assigned RPORT
    respectively).   The  dispatcher   will  interpret  and   discard  the
    Dispatcher Key from an ECRI, using it to determine which slots RPORT 0
    should receive  the ECRI.  The  dispatcher will interpret  and discard
    the RMO from an ASLP message  and use the key to determine  which slot
    to associate the ASLP with, thus assigning a free dispatcher  port for
    that slot for the new port in logon mode.

         The  Local  Key  is  generated by  the  interface  to  identify a
    response to  a circuit  request.  All  outstanding requests  must have


    LOGII                       Logon Processing II                          40
    LOGII Logon Session                                         January 6, 1988


    unique local keys  since the interface slot  will match this  key with
    the  ASLP  or  ECRI  reject  messages  that  arrive  on  an unassigned
    dispatcher port.



         ICRM ::= [APPLICATION 34] IMPLICIT SEQUENCE {







                4.3.1  ICRM Required Message Objects


            rMOSequence SEQUENCE {


     MO #   INTERPRETATION
    -----   --------------

    MO-37   ICRM Flags

            The ICRM Flags  are used for  any binary indication  that will
            affect  the overall  interpretation  of the  type  11 message.
            Currently only a single bit  is used; if the bit is  reset the
            request is for a normal circuit,  and if the bit is set  it is
            an auxiliary circuit request.

            iCRMFlags [APPLICATION 37] IMPLICIT BIT STRING {
                auxCircuit (0)},  -- Bit set if Auxiliary,
                                     reset if Normal Circuit


    MO-0E   Originating Host Number

            This element  represents the Originating  Host Number  for the
            interface that is requesting the circuit.

            origHostNumber [APPLICATION 0E] IMPLICIT OCTET STRING,


    MO-02   CCT

            The  CCT element  represents the  Circuit  Characteristic Type
            which  is  requested  by the  circuit  originator.   Valid CCT
            values range from  00 to 1F  and no half-duplex  indication is
            contained  within  the CCT.   The  CCT be  zero  for auxiliary
            circuits and non-zero for normal circuit requests.

            cCT [APPLICATION 2] IMPLICIT OCTET STRING      }

    LOGII                       Logon Processing II                          41
    LOGII Logon Session                                         January 6, 1988


                4.3.2  ICRM Supplemental Message Objects


            sMOSet SET {



     MO #   INTERPRETATION
    -----   --------------

    MO-08   Unparsed Logon Characters

            This element represents the IA5 logon string characters for an
            unparsed  logon  request.  This  string  should  contain valid
            logon  string  characters  in  a  proper  ADRII  logon  syntax
            representation.   If  a  semi-colon or  CR  terminator  is not
            present at the end of the string, the Supervisor assumes  a CR
            terminator.   Any  of the  parsed  logon MOs  may  be  used in
            conjunction with  this MO,  providing none  of the  fields are
            duplicated.  If duplicate fields are encountered,  the message
            is rejected with code 0A.

            logonChars [APPLICATION 8] IMPLICIT IA5,
                                       -- CR terminator implied if
                                          no terminator present.





























    LOGII                       Logon Processing II                          42
    LOGII Logon Session                                         January 6, 1988



            ICRM Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-16   Options List

            This  element  contains  a parsed  IA5  string  containing the
            circuit request  Options List field.   The Options  List items
            are contained in this SMO, separated by commas, without the "(
            )" brackets.  The items take either of two forms, a "token" or
            a "token=value" syntax.  Tokens and values may be one to eight
            characters,  and  any legal  options  characters  beyond eight
            characters are  simply ignored, thus  allowing users  to enter
            full  descriptive  tokens,  (of  which  only  the  first eight
            characters are  interpreted).  If any  discrete option  SMO is
            present in addition  to this options  list SMO, this  SMO will
            take precedence over any discrete option SMO indications.  The
            Options List item  interpretation is shown below  with capital
            letters    indicating    characters    required    for   token
            interpretation.

            OPTIONS LIST ITEM SYNTAX        INTERPRETATION
            ------------------------        --------------
                TClass=A                    Throughput class 0, 64 cps
                TClass=B                    Throughput class 1, 160 cps
                TClass=C                    Throughput class 2, 512 cps
                TClass=D                    Throughput class 3, 2048 cps
              Hdx, or Halfduplex            Half-Duplex indication
                Interact                    Request Interactive path routing
              Batch or Volume               Request Batch path routing
                   Rc                       Request Reverse Charge Call
                 Reverse                    Request Reverse Charge Call


            optionsList [APPLICATION 16] IMPLICIT IA5,


    MO-12   Username

            This  element contains  the parsed  IA5 Username  logon string
            field, without terminator.

            userName [APPLICATION 12] IMPLICIT IA5,








    LOGII                       Logon Processing II                          43
    LOGII Logon Session                                         January 6, 1988



            ICRM Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-17   Specified Destination List

            This  SMO  represents  a  sequence  of  parsed  IA5  Specified
            Destination List (SDL) items, the first item  representing the
            primary destination, and the second item representing ultimate
            circuit destination.  Colon ":" separators are not included.

            specDestList [APPLICATION 17] IMPLICIT SEQUENCE OF 
                                          destString IMPLICIT IA5,


    MO-19   Extension

            This SMO contains the parsed IA5 logon request Extension field
            without the terminating square brackets "[   ]".

            extension [APPLICATION 19] IMPLICIT IA5,


    MO-1C   Password

            This SMO contains the parsed IA5 logon request  Password field
            without terminator.  A null password is indicated by sending a
            string containing only a single ASCII NUL (00) character.

            password [APPLICATION 1C] IMPLICIT IA5,


    MO-07   Origination Address

            This element contains  the IA5 Origination Address  string for
            the requesting port.

            origAddress [APPLICATION 7] IMPLICIT IA5,













    LOGII                       Logon Processing II                          44
    LOGII Logon Session                                         January 6, 1988



            ICRM Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-09   Throughput Class

            This  SMO represents  the requested  throughput class  for the
            circuit.  A value of 0 indicates a throughput class of 64 cps,
            value 1 indicates  160 cps, value 2  indicates 512 cps,  and a
            value  of  3  indicates   a  throughput  class  of   2048  cps
            (associated with the ^A, ^B, ^C, and ^D logon  request options
            respectively).  This SMO  may be superceded by  any throughput
            class option specified in  the parsed Options string  SMO, and
            if no  throughput class  indication is  made, in  either form,
            throughput class 0 (64 cps) is assumed default.

            tClass [APPLICATION 9] IMPLICIT INTEGER           {
                cps64(0), cps160(1), cps512(2), cps2048(3)    },


    MO-0F   Half Duplex

            This  element indicates  whether or  not the  originating port
            requested a half-duplex circuit.   This SMO will be  echoed by
            the  Supervisor in  all response  messages if  the half-duplex
            indication of either form,  is sent in the  ICRM/ICRS request.
            This SMO is  echoed in the  response to prevent  the interface
            from having to  locally interpret the  half-duplex indication,
            and  instead leaves  the discovery  of the  indication  to the
            Supervisor, which in turn informs the originating interface of
            the duplex status of the port, in all responses the Supervisor
            sends for this logon  session.  This SMO may be  superceded by
            any duplex indication  option specified in the  parsed Options
            string SMO, and if no indication is made in either form, full-
            duplex is assumed default.

            halfDuplex [APPLICATION 0F] IMPLICIT BOOLEAN DEFAULT FALSE,














    LOGII                       Logon Processing II                          45
    LOGII Logon Session                                         January 6, 1988



            ICRM Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-06   Batch Circuit Request

            This  SMO  indicates whether  the  user requested  a  batch or
            interactive circuit, and affects the Supervisor's path routing
            computations,  and  if  not present  the  Supervisor  uses the
            default indicated by the  CCT.  This SMO may be  superceded by
            any  batch/interactive  indication  option  specified  in  the
            parsed Options  string SMO,  and if no  indication is  made in
            either form, the default setting indicated by the CCT is used.

            requestBatch [APPLICATION 6] IMPLICIT BOOLEAN,


    MO-03   IIX Capable Origination

            This  SMO   indicates  that   the  origination   interface  is
            intelligent interface (IIX)  capable and defaults to  false if
            not present.

            indicateOrigIIX [APPLICATION 3] IMPLICIT BOOLEAN DEFAULT FALSE,


    MO-05   UUN Requested

            This element indicates that the origination interface requests
            the Supervisor return  the UUN for  the logon username  to the
            originating  interface,  when  the  circuit   is  successfully
            completed.

            uUNRequest [APPLICATION 5] IMPLICIT BOOLEAN DEFAULT FALSE,


    MO-10   Reverse Charge Call Requested

            This  SMO indicates  that the  origination  interface requests
            reverse  charging for  the circuit  request.   This indication
            affects the Supervisor's access profile processing to validate
            a reverse charge call circuit.

            rCHGRequest [APPLICATION 10] IMPLICIT BOOLEAN DEFAULT FALSE}}







    LOGII                       Logon Processing II                          46
    LOGII Logon Session                                         January 6, 1988


                      4.4  Early Circuit Reject - ISIS - ECRI


         The new Early Circuit Reject - ISIS (ECRI) is sent from  the Node
    Code to the originating interface  on RPORT 0 to inform  the interface
    that an ASLP could not be provided for the indicated  circuit request.
    The Supervisor is not informed of logon ports that are rejected by the
    Node Code with the ECRI message.  The ECRI has the following format:

         ECRI - Early Circuit Reject - ISIS - 12

         Originates in the Node Code, goes to Slot, on RPORT 0.

         .--------.--------.--------.--------.
         |     RPORT 0     |   12   |XS......|
         -------------------------------------
         |   message size  | Dispatcher Key  |
         -------------------------------------
         |    Local Key    |   ECRI  MOs.....
         -------------------

         Where X = True indicates an incomplete message.
         Where S = True indicates a subsequent message in a partial
                   message sequence.


         The Dispatcher Key  is used between  the dispatcher and  the Node
    Code to keep track of which interface slot is making the  ICRM request
    and contains an index to  the dispatcher port range for  the intarface
    slot.  The interface does not  actually include this data in  the ICRM
    message that  it sends out  on RPORT 0.   The dispatcher fills  in the
    Dispatcher Key in  the ICRM message before  delivering it to  the Node
    Code.  The Node Code will echo this key with any ECRI or  ASLP message
    that it sends back to the interface (on RPORT 0 or the  newly assigned
    RPORT respectively).   The dispatcher will  interpret and  discard the
    Dispatcher Key  RMO from an  ECRI, using it  to determine  which slots
    RPORT 0 should  receive the ECRI.   The dispatcher will  interpret and
    discard the  RMO from  an ASLP message  and use  the key  to determine
    which  slot  to  associate  the  ASLP  with,  thus  assigning  a  free
    dispatcher port for that slot for the new port in logon mode.

         The  Local  Key  is  generated by  the  interface  to  identify a
    response to  a circuit  request.  All  outstanding requests  must have
    unique local keys  since the interface slot  will match this  key with
    the ASLP  or ECRI  reject messages  that arrive  on an  newly assigned
    dispatcher port, or RPORT 0, respectively.

         The ECRI  message contains  no RMO sequence,  since there  are no
    RMOs for this message.



         ECRI ::= [APPLICATION 38] IMPLICIT SEQUENCE {

    LOGII                       Logon Processing II                          47
    LOGII Logon Session                                         January 6, 1988
























































    LOGII                       Logon Processing II                          48
    LOGII Logon Session                                         January 6, 1988


                4.4.1  ECRI Supplemental Message Objects


            sMOSet SET {



     MO #   INTERPRETATION
    -----   --------------

    MO-29   Normal/Auxiliary Early Reject Code

            This element represents  an early reject code  which indicates
            to the interface the reason that the ICRM request could not be
            accepted  by the  Node  Code, the  same  reason interpretation
            being used for both normal and auxiliary circuit requests.

                    The codes have the following interpretation
                    and the default value is zero.

                    Code    Meaning
                    -----   -------
                      0     No command circuit to the Supervisor
                      1     No available Dispatcher port
                      2     Node Code not present
                      3     No Node Code Buffers available
                      4     Circuits/Minute exceeded for the slot
                      5     Circuits/Minute exceeded for the host
                      6     Slot not licensed for Auxiliary circuits
                      7     Interface made LOGII request but Supervisor
                            is not LOGII capable.
                      8     Invalid ICRM format.
                      9     Invalid CCT specified.


            eCRICode [APPLICATION 29] IMPLICIT INTEGER DEFAULT 0 {
                noComCir(0), noDisp(1), noNodeCode(2), noBuffers(3),
                cirMinSlotEx(4), cirMinHostEx(5), licenseProb(6),
                noLOGIISup(7), badICRMForm(8), badCCT(9)          }   } }















    LOGII                       Logon Processing II                          49
    LOGII Logon Session                                         January 6, 1988


                    4.5  ISIS Circuit Request Supplement - ICRS


         The ISIS Circuit Request Supplement (ICRS) is sent by originating
    interfaces to  the Node  Code on the  newly assigned  dispatcher logon
    port.  The message is only used for normal circuit  request subsequent
    responses to Supervisor  prompts, and is  invalid if the  ICRM message
    that began the session indicated an auxiliary circuit  request.  Since
    there is only SMO data for the ICRS, there is no RMO sequence present,
    only  the  SMO set.   An  ICRS message  with  no SMOs  is  useless and
    considered to be invalid form.

         ICRS - ISIS Circuit Request Supplement - 0C4

         Originates in slot, goes to the Node Code, on newly assigned RPORT.
         Valid only for normal circuit request logon ports.

         .--------.--------.--------.--------.
         |      RPORT      |  0C4   |XS......|
         -------------------------------------
         |   message size  |   ICRS MOs.....
         -------------------

         Where X = True indicates an incomplete message.
         Where S = True indicates a subsequent message in a partial
                   message sequence.

         ICRS ::= [APPLICATION 3A] IMPLICIT SEQUENCE {


























    LOGII                       Logon Processing II                          50
    LOGII Logon Session                                         January 6, 1988


                4.5.1  ICRS Supplemental Message Objects


            sMOSet SET {



     MO #   INTERPRETATION
    -----   --------------

    MO-08   Unparsed Logon Characters

            This element represents the IA5 logon string characters for an
            unparsed  logon  request.  This  string  should  contain valid
            logon  string  characters  in  a  proper  ADRII  logon  syntax
            representation.   If  a  semi-colon or  CR  terminator  is not
            present at the end of the string, the Supervisor assumes  a CR
            terminator.   Any  of the  parsed  logon MOs  may  be  used in
            conjunction with  this MO,  providing none  of the  fields are
            duplicated.  If duplicate fields are encountered,  the message
            is rejected with code 0A.

            logonChars [APPLICATION 8] IMPLICIT IA5,
                                       -- CR terminator implied if
                                       no terminator present.





























    LOGII                       Logon Processing II                          51
    LOGII Logon Session                                         January 6, 1988



            ICRS Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-16   Options List

            This  element  contains  a parsed  IA5  string  containing the
            circuit request  Options List field.   The Options  List items
            are contained in this SMO, separated by commas, without the "(
            )" brackets.  The items take either of two forms, a "token" or
            a "token=value" syntax.  Tokens and values may be one to eight
            characters,  and  any legal  options  characters  beyond eight
            characters are  simply ignored, thus  allowing users  to enter
            full  descriptive  tokens,  (of  which  only  the  first eight
            characters are  interpreted).  If any  discrete option  SMO is
            present in addition  to this options  list SMO, this  SMO will
            take precedence over any discrete option SMO indications.  The
            Options List item  interpretation is shown below  with capital
            letters    indicating    characters    required    for   token
            interpretation.

            OPTIONS LIST ITEM SYNTAX        INTERPRETATION
            ------------------------        --------------
                TClass=A                    Throughput class 0, 64 cps
                TClass=B                    Throughput class 1, 160 cps
                TClass=C                    Throughput class 2, 512 cps
                TClass=D                    Throughput class 3, 2048 cps
              Hdx, or Halfduplex            Half-Duplex indication
                Interact                    Request Interactive path routing
              Batch or Volume               Request Batch path routing
                   Rc                       Request Reverse Charge Call
                 Reverse                    Request Reverse Charge Call


            optionsList [APPLICATION 16] IMPLICIT IA5,


    MO-12   Username

            This  element contains  the parsed  IA5 Username  logon string
            field, without terminator.

            userName [APPLICATION 12] IMPLICIT IA5,








    LOGII                       Logon Processing II                          52
    LOGII Logon Session                                         January 6, 1988



            ICRS Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-17   Specified Destination List

            This  SMO  represents  a  sequence  of  parsed  IA5  Specified
            Destination List (SDL) items, the first item  representing the
            primary  destination,  and the  second  item  representing the
            ultimate circuit  destination.  Colon  ":" separators  are not
            included.

            specDestList [APPLICATION 17] IMPLICIT SEQUENCE OF
                                          destString IMPLICIT IA5,


    MO-19   Extension

            This SMO contains the parsed IA5 logon request Extension field
            without the terminating square brackets "[   ]".

            extension [APPLICATION 19] IMPLICIT IA5,


    MO-1C   Password

            This SMO contains the parsed IA5 logon request  Password field
            without terminator.  A null password is indicated by sending a
            string containing only a single ASCII NUL (00) character.

            password [APPLICATION 1C] IMPLICIT IA5,


    MO-07   Origination Address

            This element contains  the IA5 Origination Address  string for
            the  requesting port.   If  an OADR  was  previously specified
            within an ICRM, this element is ignored.

            origAddress [APPLICATION 7] IMPLICIT IA5,











    LOGII                       Logon Processing II                          53
    LOGII Logon Session                                         January 6, 1988



            ICRS Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-09   Throughput Class

            This  SMO represents  the requested  throughput class  for the
            circuit.  A value of 0 indicates a throughput class of 64 cps,
            value 1 indicates  160 cps, value 2  indicates 512 cps,  and a
            value  of  3  indicates   a  throughput  class  of   2048  cps
            (associated with the ^A, ^B, ^C, and ^D logon  request options
            respectively).  This SMO  may be superceded by  any throughput
            class option specified in the parsed Options string SMO or the
            associated ICRM message, and if no throughput class indication
            is  made,  in either  form,  throughput class  0  (64  cps) is
            assumed default.

            tClass [APPLICATION 9] IMPLICIT INTEGER           {
                cps64(0), cps160(1), cps512(2), cps2048(3)    },


    MO-0F   Half Duplex

            This  element indicates  whether or  not the  originating port
            requested a half-duplex circuit.   This SMO will be  echoed by
            the  Supervisor in  all response  messages if  the half-duplex
            indication of either form,  is sent in the  ICRM/ICRS request.
            This SMO is  echoed in the  response to prevent  the interface
            from having to  locally interpret the  half-duplex indication,
            and  instead leaves  the discovery  of the  indication  to the
            Supervisor, which in turn informs the originating interface of
            the duplex status of the port, in all responses the Supervisor
            sends for this logon  session.  This SMO may be  superceded by
            any duplex indication  option specified in the  parsed Options
            string SMO, and if no indication is made in either form, full-
            duplex is assumed default.  If a duplex specification  is made
            within the associated ICRM message, this SMO is ignored.

            halfDuplex [APPLICATION 0F] IMPLICIT BOOLEAN DEFAULT FALSE,












    LOGII                       Logon Processing II                          54
    LOGII Logon Session                                         January 6, 1988



            ICRS Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-06   Batch Circuit Request

            This  SMO  indicates whether  the  user requested  a  batch or
            interactive circuit, and affects the Supervisor's path routing
            computations,  and  if  not present  the  Supervisor  uses the
            default indicated by the  CCT.  This SMO may be  superceded by
            any  batch/interactive  indication  option  specified  in  the
            parsed Options string SMO  or previously specified in  an ICRM
            message,  and if  no indication  is made  in either  form, the
            default setting indicated by the CCT is used.

            requestBatch [APPLICATION 6] IMPLICIT BOOLEAN,


    MO-03   IIX Capable Origination

            This  SMO   indicates  that   the  origination   interface  is
            intelligent interface (IIX) capable and takes  precedence over
            any IIX indication previously specified within  the associated
            ICRM message.  If no IIX indication is present, it  is assumed
            that IIX is not requested.

            indicateOrigIIX [APPLICATION 3] IMPLICIT BOOLEAN DEFAULT FALSE,


    MO-05   UUN Requested

            This element indicates that the origination interface requests
            the Supervisor return  the UUN for  the logon username  to the
            originating  interface,  when  the  circuit   is  successfully
            completed.   This  element  takes  precedence  over   any  UUN
            indication  previously  specified within  the  associated ICRM
            message.

            uUNRequest [APPLICATION 5] IMPLICIT BOOLEAN DEFAULT FALSE,












    LOGII                       Logon Processing II                          55
    LOGII Logon Session                                         January 6, 1988



            ICRS Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-10   Reverse Charge Call Requested

            This  SMO indicates  that the  origination  interface requests
            reverse  charging for  the circuit  request.   This indication
            affects the Supervisor's access profile processing to validate
            a reverse charge call circuit.  This element  takes precedence
            over  any  RCHG  indication  previously  specified  within the
            associated ICRM message.

            rCHGRequest [APPLICATION 10] IMPLICIT BOOLEAN DEFAULT FALSE,


    MO-23   Logon Session Reset

            This SMO indicates that the originating interface  detected an
            ESC character entered by the user after the  first terminator,
            and indicates  to the Supervisor  that all  context associated
            with the logon, is to be discarded, except for the  CCT, OADR,
            IIX, and UUN request status.  Any other SMOs, except  the OADR
            SMO  (if  no previous  OADR  was specified),  are  ignored, if
            present   in  conjunction   with  the   logon   session  reset
            indication.  If this SMO is present with the auxiliary circuit
            indication, the ICRS is invalid form.

            resetLogon [APPLICATION 23] BOOLEAN DEFAULT FALSE          }}






















    LOGII                       Logon Processing II                          56
    LOGII Logon Session                                         January 6, 1988


                   4.6  Node Code Circuit Request Message - NCRM


         The Node  Code Circuit Request  Message (NCRM) is  constructed by
    the  Node  Code  from  an  ICRM  or  ICRS  message  received  from  an
    originating interface.  The NCRM is then sent to the Supervisor on the
    command channel, unless an ICRM could not be accepted, (in  which case
    an  ECRI  is  sent  to  the  interface  and  nothing  is  sent  to the
    Supervisor).

         The  Node  Code  performs  no  interpretation  of   logon  string
    characters since all packetization and terminator/ESC handling is done
    by the LOGII interface.  The Node Code simply maintains whether or not
    an initial  message has  been sent  to the  Supervisor for  this logon
    session, and if a 9F zapper message is received for a logon  port that
    has already  initiated a logon  session, the Node  Code sends  an NCRM
    with  a   single  LOGON  ZAPPER   SMO  indication.   All   logon  port
    disconnection logic between  the interface and  the Node Code  is left
    the same as is currently  being done, and the only  difference between
    the Node  Code and Supervisor  logon zapper logic,  is that  the logon
    zapper acknowledgement is sent to the Node Code in an RCRM rather than
    the old '0F8D'  message.  This message informs  the Node Code  the the
    zapped port is okay for re-use.

         Although the  Node Code  specifically performs  no interpretation
    and analysis of logon data, the integrity of the overall  NCRM message
    structure must be  verified.  The Node  Code guarantees that  the NCRM
    contains at least  an RMO sequence and  insures the message  header MO
    list byte count, NCRM Sequence, RMO Sequence, and SMO Set  lengths are
    consistent.   If  the  Supervisor receives  an  NCRM  with  an invalid
    header, with inconsistent length indications, missing the RMO Sequence
    or  any  specific  RMO,  or containing  an  invalid  RMO,  the message
    construction  is   considered  to  be   invalid.   This   indicates  a
    pathological Node Code  and the originating  node is retaken,  with an
    Error Log message posted to illuminate the problem.

         NCRM - Node Code Circuit Request Message - 08

         Derived from the ICRM/ICRS messages received from the interface
         and sent to the Supervisor on the command channel.

         .--------.--------.--------.--------.
         |   NODE NUMBER   |   08   |   80   |
         -------------------------------------
         |  message size   |   NCRM MOs......
         -------------------------------------



         NCRM ::= [APPLICATION 3C] IMPLICIT SEQUENCE {




    LOGII                       Logon Processing II                          57
    LOGII Logon Session                                         January 6, 1988


                4.6.1  NCRM Required Message Objects


            rMOSequence SEQUENCE {


     MO #   INTERPRETATION
    -----   --------------

    MO-3D   NCRM Flags

            The NCRM Flags  are used for  any binary indication  that will
            affect the overall interpretation of the type 8  message.  Two
            bits  are used;  if bit  zero is  reset the  request is  for a
            normal  circuit, and  if the  bit is  set it  is  an auxiliary
            circuit request.  If bit  1 is reset the NCRM  was constructed
            from the ICRM message initiating the logon, and if the  bit is
            set, the  NCRM was constructed  from an ICRS  subsequent logon
            message for a  normal circuit request.   If both bits  are set
            the NCRM is considered to be invalid form.

            nCRMFlags [APPLICATION 3D] IMPLICIT BIT STRING {
                auxCircuit (0), subsequentNCRM(1) },


    MO-0E   Originating Host Number

            This element  represents the Originating  Host Number  for the
            interface  that is  requesting the  circuit.  This  element is
            ignored by the Supervisor when received in a subsequent NCRM.

            origHostNumber [APPLICATION 0E] IMPLICIT OCTET STRING,


    MO-02   CCT

            The  CCT element  represents the  Circuit  Characteristic Type
            which  is  requested  by the  circuit  originator.   Valid CCT
            values range from  00 to 1F  and no half-duplex  indication is
            contained  within  the CCT.   The  CCT be  zero  for auxiliary
            circuits and non-zero for normal circuit requests.

            cCT [APPLICATION 2] IMPLICIT OCTET STRING,

    MO-1A   Originating Port Number

            This SMO represents the port number for the logon port  and is
            used by the Supervisor,  in conjunction with the  node number,
            to uniquely identify the logon session.

            origPort [APPLICATION 1A] IMPLICIT OCTET STRING   }



    LOGII                       Logon Processing II                          58
    LOGII Logon Session                                         January 6, 1988
























































    LOGII                       Logon Processing II                          59
    LOGII Logon Session                                         January 6, 1988


                4.6.2  NCRM Supplemental Message Objects


            sMOSet SET {



     MO #   INTERPRETATION
    -----   --------------

    MO-08   Unparsed Logon Characters

            This element represents the IA5 logon string characters for an
            unparsed  logon  request.  This  string  should  contain valid
            logon  string  characters  in  a  proper  ADRII  logon  syntax
            representation.   If  a  semi-colon or  CR  terminator  is not
            present at the end of the string, the Supervisor assumes  a CR
            terminator.   Any  of the  parsed  logon MOs  may  be  used in
            conjunction with  this MO,  providing none  of the  fields are
            duplicated.  If duplicate fields are encountered,  the message
            is rejected with code 0A.

            logonChars [APPLICATION 8] IMPLICIT IA5,
                                       -- CR terminator implied if
                                          no terminator present.





























    LOGII                       Logon Processing II                          60
    LOGII Logon Session                                         January 6, 1988



            NCRM Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-16   Options List

            This  element  contains  a parsed  IA5  string  containing the
            circuit request  Options List field.   The Options  List items
            are contained in this SMO, separated by commas, without the "(
            )" brackets.  The items take either of two forms, a "token" or
            a "token=value" syntax.  Tokens and values may be one to eight
            characters,  and  any legal  options  characters  beyond eight
            characters are  simply ignored, thus  allowing users  to enter
            full  descriptive  tokens,  (of  which  only  the  first eight
            characters are  interpreted).  If any  discrete option  SMO is
            present in addition  to this options  list SMO, this  SMO will
            take precedence over any discrete option SMO indications.  The
            Options List item  interpretation is shown below  with capital
            letters    indicating    characters    required    for   token
            interpretation.

            OPTIONS LIST ITEM SYNTAX        INTERPRETATION
            ------------------------        --------------
                TClass=A                    Throughput class 0, 64 cps
                TClass=B                    Throughput class 1, 160 cps
                TClass=C                    Throughput class 2, 512 cps
                TClass=D                    Throughput class 3, 2048 cps
              Hdx, or Halfduplex            Half-Duplex indication
                Interact                    Request Interactive path routing
              Batch or Volume               Request Batch path routing
                   Rc                       Request Reverse Charge Call
                 Reverse                    Request Reverse Charge Call


            optionsList [APPLICATION 16] IMPLICIT IA5,


    MO-12   Username

            This  element contains  the parsed  IA5 Username  logon string
            field, without terminator.

            userName [APPLICATION 12] IMPLICIT IA5,








    LOGII                       Logon Processing II                          61
    LOGII Logon Session                                         January 6, 1988



            NCRM Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-17   Specified Destination List

            This  SMO  represents  a  sequence  of  parsed  IA5  Specified
            Destination List (SDL) items, the first item  representing the
            primary  destination,  and the  second  item  representing the
            ultimate circuit  destination.  Colon  ":" separators  are not
            included.

            specDestList [APPLICATION 17] IMPLICIT SEQUENCE OF
                                          destString IMPLICIT IA5,


    MO-19   Extension

            This SMO contains the parsed IA5 logon request Extension field
            without the terminating square brackets "[   ]".

            extension [APPLICATION 19] IMPLICIT IA5,


    MO-1C   Password

            This SMO contains the parsed IA5 logon request  Password field
            without terminator.  A null password is indicated by sending a
            string containing only a single ASCII NUL (00) character.

            password [APPLICATION 1C] IMPLICIT IA5,


    MO-07   Origination Address

            This element contains  the IA5 Origination Address  string for
            the  requesting  port  and is  ignored  if  any  previous OADR
            specification was made.

            origAddress [APPLICATION 7] IMPLICIT IA5,











    LOGII                       Logon Processing II                          62
    LOGII Logon Session                                         January 6, 1988



            NCRM Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-09   Throughput Class

            This  SMO represents  the requested  throughput class  for the
            circuit.  A value of 0 indicates a throughput class of 64 cps,
            value 1 indicates  160 cps, value 2  indicates 512 cps,  and a
            value  of  3  indicates   a  throughput  class  of   2048  cps
            (associated with the ^A, ^B, ^C, and ^D logon  request options
            respectively).  This SMO  may be superceded by  any throughput
            class option specified in a previous NCRM or within the parsed
            Options string SMO, and  if no throughput class  indication is
            made,  in any  form, throughput  class 0  (64 cps)  is assumed
            default.

            tClass [APPLICATION 9] IMPLICIT INTEGER           {
                cps64(0), cps160(1), cps512(2), cps2048(3)    },


    MO-0F   Half Duplex

            This  element indicates  whether or  not the  originating port
            requested a half-duplex circuit.   This SMO will be  echoed by
            the  Supervisor in  all response  messages if  the half-duplex
            indication of either form,  is sent in the  ICRM/ICRS request.
            This SMO is  echoed in the  response to prevent  the interface
            from having to  locally interpret the  half-duplex indication,
            and  instead leaves  the discovery  of the  indication  to the
            Supervisor, which in turn informs the originating interface of
            the duplex status of the port, in all responses the Supervisor
            sends for this logon  session.  This SMO may be  superceded by
            any duplex indication  option specified in the  parsed Options
            string SMO, and if no indication is made in either form, full-
            duplex is assumed default.  If a duplex specification  is made
            in a previous NCRM, this SMO is ignored.

            halfDuplex [APPLICATION 0F] IMPLICIT BOOLEAN DEFAULT FALSE,












    LOGII                       Logon Processing II                          63
    LOGII Logon Session                                         January 6, 1988



            NCRM Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-06   Batch Circuit Request

            This  SMO  indicates whether  the  user requested  a  batch or
            interactive circuit, and affects the Supervisor's path routing
            computations,  and  if  not present  the  Supervisor  uses the
            default indicated by the  CCT.  This SMO may be  superceded by
            any  batch/interactive   indication  option  specified   in  a
            previous NCRM message or in the parsed Options string SMO, and
            if no indication is  made in either form, the  default setting
            indicated by the CCT is used.

            requestBatch [APPLICATION 6] IMPLICIT BOOLEAN,


    MO-03   IIX Capable Origination

            This  SMO   indicates  that   the  origination   interface  is
            intelligent interface (IIX) capable and takes  precedence over
            any IIX indication  specified within previous  associated NCRM
            message.

            indicateOrigIIX [APPLICATION 3] IMPLICIT BOOLEAN DEFAULT FALSE,


    MO-05   UUN Requested

            This element indicates that the origination interface requests
            the Supervisor return  the UUN for  the logon username  to the
            originating  interface,  when  the  circuit   is  successfully
            completed.   This  element  takes  precedence  over   any  UUN
            indication  previously   specified  within  a   previous  NCRM
            message.

            uUNRequest [APPLICATION 5] IMPLICIT BOOLEAN DEFAULT FALSE,


    MO-10   Reverse Charge Call Requested

            This  SMO indicates  that the  origination  interface requests
            reverse  charging for  the circuit  request.   This indication
            affects the Supervisor's access profile processing to validate
            a reverse charge call circuit.  This element  takes precedence
            over any RCHG  indication previously specified within  a prior
            NCRM message.

            rCHGRequest [APPLICATION 10] IMPLICIT BOOLEAN DEFAULT FALSE,

    LOGII                       Logon Processing II                          64
    LOGII Logon Session                                         January 6, 1988


    MO-23   Logon Session Reset

            This SMO indicates that the originating interface  detected an
            ESC character entered by the user after the  first terminator,
            and indicates  to the Supervisor  that all  context associated
            with  the  logon,  except  for the  CCT  and  OADR,  is  to be
            discarded.   Any  other  SMOs,  except  the  OADR  SMO  (if no
            previous  OADR  was  specified), are  ignored,  if  present in
            conjunction with the logon session reset indication.   If this
            SMO is  present with the  auxiliary circuit indication,  or if
            this is not a subsequent NCRM, the NCRM is invalid form.

            resetLogon [APPLICATION 23] BOOLEAN DEFAULT FALSE,


    MO-0B   Logon Session Zapper

            This SMO,  if present,  indicates to  the Supervisor  that the
            Node Code received a  9F disconnect/zapper message for  a port
            in logon mode  and is only valid  in NCRM messages  flagged as
            subsequent.   The  Node  Code  will  also  generate   an  NCRM
            containing this SMO to if the interface sends an  invalid ICRS
            message form or sends an ICRM on a port already in logon mode.
            This informs the Supervisor that the logon is being zapped and
            the Node Code informs the interface of the error  condition in
            a responding  RCRI and disconnects  the dispatcher  port, then
            awaits  a  logon  zapper  acknowledgment  from  the Supervisor
            before re-using  the port.  Any  other SMOs present  with this
            SMO  are  ignored  by  the  Supervisor,  which   discards  any
            information regarding this logon session, and informs the Node
            Code that the  port is available for  re-use.  If this  SMO is
            present with the  auxiliary circuit indication or  without the
            subsequent NCRM indication, the NCRM is invalid form.

            zapLogon [APPLICATION 0B] IMPLICIT BOOLEAN DEFAULT FALSE }}



















    LOGII                       Logon Processing II                          65
    LOGII Logon Session                                         January 6, 1988


             4.7  Respond/Reject Circuit Request Message - RCRM, RCRI


         There is information that is passed to the  originating interface
    in response to the originating interface logon messages, or indicating
    the  reasons  the Supervisor  has  rejected a  circuit  request.  This
    information is sent to the  Node Code using the type 12  RCRM message,
    and is in  turn sent to the  originating interface using the  type 0C3
    RCRI  message.  The  RCRM  is also  used  to indicate  a  logon zapper
    acknowledgement to the Node Code,  thus freeing up the logon  port for
    re-use.

         The Node Code generates the  RCRI to inform the interface  of any
    Node Code detected error  conditions: ICRM received on a  port already
    in logon mode, logon ports informed of a lost command channel, invalid
    ICRS form received (invalid ICRM form flagged is in the ECRI message),
    or ICRS received for an unassigned port (before an ICRM).

         For normal/auxiliary circuit reject indications, the RCRM message
    indicates  to the  Node  Code that  the Supervisor  has  discarded any
    information  associated  with  the  logon  session  and  the  port  is
    available  for re-use.   The Node  Code sends  the  corresponding RCRI
    message to the interface followed by a 9F disconnect message.

         There is an implied hierarchy in RCRM/RCRI SMO interpretation, in
    the  case  that  a   message  contains  a  confusing   combination  of
    indications.  This discussion is  included in an attempt  to eliminate
    any possible ambiguity  of interpretation that  may occur, and  is not
    intended as a recommendation for messages of this form.   The messages
    should be constructed by the  Supervisor and Node Code such  that such
    dualities of interpretation do not arise.

         In the RCRM message, presence of the logon zapper acknowledgement
    SMO  causes any  other  SMO to  be  ignored.  If  a  normal/aux reject
    message is  present, any  normal response SMO  is ignored,  unless the
    normal/aux reject  code 0C "logon  failure limit exceeded"  is present
    (in which case the accompanying normal response SMO indicates the last
    failure response).  The normal  response SMO is ignored in  RCRMs that
    do not have  the corresponding normal  circuit indication in  the RCRM
    flags.  The  half duplex  indication and logon  port message  SMOs are
    interpreted in all  messages except when logon  zapper acknowledgement
    is present.

         If a Node Code RCRI indication is present in the RCRI message all
    other SMOs are  ignored.  If a  normal/aux reject message  is present,
    any  normal  response SMO  is  ignored.  The  normal  response  SMO is
    ignored in RCRIs that do not have the corresponding normal indication.
    The half duplex indication is interpreted in all messages  except when
    the Node Code RCRI SMO is present.

         These messages replace the  current 0D and 0E Supervisor  to Node
    messages and the current 0B4 and 0B5 ISIS messages to  the originating


    LOGII                       Logon Processing II                          66
    LOGII Logon Session                                         January 6, 1988


    interface, which are currently  used to provide responses  and rejects
    to normal and auxiliary circuits.

         Respond/Reject Circuit Request Message - RCRM - 12

         Sent by the Supervisor to the originating Node Code
         on the command channel, to reject a circuit request,
         or prompt for logon information.

         .--------.--------.--------.--------.
         |   NODE NUMBER   |   12   |   80   |
         -------------------------------------
         |   message size  | RCRM MOs.......
         -------------------------------------




         RCRM ::= [APPLICATION 3B] IMPLICIT SEQUENCE {



































    LOGII                       Logon Processing II                          67
    LOGII Logon Session                                         January 6, 1988


                4.7.1  RCRM Required Message Objects


            rMOSequence SEQUENCE {


     MO #   INTERPRETATION
    -----   --------------

    MO-1A   Originating Port Number

            This SMO represents the port number for the logon port  and is
            used by the Supervisor,  in conjunction with the  node number,
            to uniquely  identify the  logon session, and  is used  by the
            Node Code to identify the dispatcher port on which to send the
            corresponding RCRI message.

            origPort [APPLICATION 1A] IMPLICIT OCTET STRING   }

    MO-33   RCRM Flags

            The RCRM Flags  are used for  any binary indication  that will
            affect the overall interpretation of the message.   Three bits
            are used;  if bit zero  is reset the  request is for  a normal
            circuit, and  if the  bit is  set it  is an  auxiliary circuit
            request.  If bit one is set the RCRM represents a logon zapper
            acknowledgement.  If this is a logon zapper ack, no SMO set is
            present with the RCRM.  If  bit 2 is set, the RCRM  contains a
            reject condition MO-27,  and indicates that the  logon request
            is being rejected.

            rCRMFlags [APPLICATION 33] IMPLICIT BIT STRING {
                auxCircuit(0),logZapAck(1),logReject(2)    }





















    LOGII                       Logon Processing II                          68
    LOGII Logon Session                                         January 6, 1988


                4.7.2  RCRM Supplemental Message Objects


            sMOSet SET {



     MO #   INTERPRETATION
    -----   --------------

    MO-14   Acknowledge Logon Zapper

            This element indicates that the Supervisor received a zapLogon
            in an NCRM  from the Node Code  and has cleared  all resources
            associated with the logon  session, and informs the  Node Code
            that the port is okay for re-use.  Any other SMOs present with
            this SMO  are ignored and  the RCRM is  not converted  into an
            RCRI since the dispatcher port has already been disconnected.

            ackLogonZap [APPLICATION 14] IMPLICIT BOOLEAN DEFAULT FALSE,


    MO-0F   Half Duplex

            This  element indicates  whether or  not the  originating port
            requested a half-duplex circuit.   This SMO will be  echoed by
            the  Supervisor in  all response  messages if  the half-duplex
            indication  is sent  in the  ICRM/ICRS request.   This  SMO is
            echoed in the response  message to prevent the  interface from
            having to  locally interpret  the half-duplex  indication, and
            instead  leaves  the  discovery  of  the  indication   to  the
            Supervisor, which in turn informs the originating interface of
            the duplex status of the port, in all responses the Supervisor
            sends for this logon session.

            halfDuplex [APPLICATION 0F] IMPLICIT BOOLEAN DEFAULT FALSE,


    MO-20   Message String for Port in Logon Mode

            This  element  contains  the  IA5  message  string  which  the
            Supervisor is  sending for  the interface  for display  on the
            originating  logon  port.   The  SMO  is  simply  sent  to the
            interface by the Node  Code in the corresponding  RCRI message
            for handling by the interface.

            logonPortMessage [APPLICATION 20] IMPLICIT IA5,







    LOGII                       Logon Processing II                          69
    LOGII Logon Session                                         January 6, 1988



            RCRM Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-41   PID of Rejecting Host

            This MO is valid only in conjunction with MO-27 and MO-04, the
            Normal  and Auxiliary  Reject Codes,  and the  Normal Response
            Codes, and represents the Product Identification Code (PID) of
            the  terminating  host  that  was  associated  with  a circuit
            reject.  MO-27 codes 16  through 1B and MO-04 codes  8 through
            0D are associated with a terminating host, and this  PID MO-41
            is present  in the  RCRM only  if one  of these  conditions is
            indicated.  The current list of PIDs may be found at  any time
            in the BASELINE file PRODID.DOC.  If the terminating interface
            has not reported a PID to the Supervisor, this SMO will not be
            present.

            rejectTermHostPID [APPLICATION 41] IMPLICIT OCTET STRING,


    MO-27   Normal and Auxiliary Reject Codes

            This integer element, default zero, represents  circuit reject
            codes, some of which  are common to both normal  and auxiliary
            circuit  requests,  and some  which  indicate  conditions that
            cause  a  reject  only when  pertaining  to  auxiliary circuit
            requests.  Codes 16 through 1B represent  discrete conditions,
            one or more of which may be encountered over  several possible
            target hosts.  If several  possible target hosts could  not be
            accessed  for  a  variety  of  reasons,  the  highest numbered
            reason, i.e.  the condition that  came the closest  to circuit
            build success,  is the condition  indicated by the  RCRM MO-27
            code.  This SMO indicates to the Node Code that the logon port
            may be  re-used, and after  sending the corresponding  RCRI to
            the interface, the Node Code disconnects the  dispatcher logon
            port.  Code  0D indicates  that a  normal circuit  request was
            rejected  due  to an  excessive  failure count  for  the logon
            session, and an  accompanying MO-04 indicates the  response to
            the last failure condition.











    LOGII                       Logon Processing II                          70
    LOGII Logon Session                                         January 6, 1988



            The normal/aux reject codes have the
            following interpretation:

                    Code    Meaning
                    -----   -------
                      0     Invalid NCRM format.
                      1     Supervisor in Slow Sleep state.
                      2     Insufficient Supervisor buffer space.
                      3     Logons limited by Probe operator command.
                      4     Invalid CCT in ICRM/NCRM.
                      5     Invalid originating host number.
                      6     Invalid throughput class in ICRM/NCRM.
                      7     Originating host is down.
                      8     Originating host in is not on the base.
                      9     Originating host is terminate only.
                     0A     Duplicate Logon Field.
                     0B     Logon field too long.
                     0C     Bad MUD.
                     0D     Normal request logon failure limit exceeded.
                     0E     Logon session timeout.
                     0F     Unused, invalid.
                     10     Auxiliary circuit queue too long.
                     11     Aux request invalid logon character.
                     12     Aux request invalid destination specified.
                     13     Aux request bad username.
                     14     Aux request bad password.
                     15     Aux request access denied.
                     16     Aux request terminating host is unknown.
                     17     Aux request terminating host is down.
                     18     Aux request terminating host is shut.
                     19     Aux request terminating host is originate only.
                     1A     Aux request terminating host is out of ports.
                     1B     Aux request no network path to destination host.



            normAuxReject [APPLICATION 27] IMPLICIT INTEGER DEFAULT 0 {
                nCRMBad(0), slowSleep(1), noSupBuffers(2),
                logonBarredByOper(3), cCTBad(4),
                origHostBad(5), tclassBad(6), origHostDown(7),
                origHostDifBase(8), origHostTerm(9),
                logFieldDuplicate(0A), logFieldBig(0B), mUDBad(0C),
                logonFailLimit(0D), logTimeOut(0E), unusedInvalid(0F),
                auxQTooLong(10), auxLogCharBad(11), auxDestBad(12),
                auxBadUname(13), auxBadPW(14), auxAccessDenied(15),
                auxTermHostUnk(16), auxTermHostDown(17),
                auxTermHostShut(18), auxTermHostOrig(19),
                auxTermHostNoPorts(1A), auxNoPathToHost(1B)           },





    LOGII                       Logon Processing II                          71
    LOGII Logon Session                                         January 6, 1988



            RCRM Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-04   Normal Circuit Response Codes

            This  integer   element,  default  zero,   represents  circuit
            response  codes  that  are pertinent  only  to  normal circuit
            requests and  are ignored if  the auxiliary indication  is set
            for  the  RCRM.    Codes  8  through  0D   represent  discrete
            conditions,  one  or more  of  which may  be  encountered over
            several  possible target  hosts.  If  several  possible target
            hosts  could not  be accessed  for a  variety of  reasons, the
            highest  numbered reason,  i.e.  the condition  that  came the
            closest to circuit  build success, is the  condition indicated
            by the RCRM MO-04 code.

            The  response  codes  also  imply  certain  actions  that  the
            interface should take for the logon port.  The  interface must
            clear the logon port input or output buffers, turn echo on, or
            some  combination  of  these actions  in  accordance  with the
            specific response code.





























    LOGII                       Logon Processing II                          72
    LOGII Logon Session                                         January 6, 1988






            The normal response codes have the following interpretation:

                    Code    Meaning
                    -----   -------
                      0     Escape indication detected, "please login".
                            Clear input, clear output, turn echo on.

                      1     "username" prompt.
                            Turn echo on.

                      2     "error type username" prompt.
                            Clear input, turn echo on.

                      3     "password" prompt.

                      4     "error type password" prompt.
                            Clear input.

                      5     Invalid logon character, "please login".
                            Clear input, clear output, turn echo on.

                      6     Invalid destination specified, "please login".
                            Clear input, turn echo on.

                      7     Access denied, "please login".
                            Clear input, turn echo on.

                      8     Terminating host is unknown, "please login".
                            Clear input, turn echo on.

                      9     Terminating host is down, "please login".
                            Clear input, turn echo on.

                     0A     Terminating host is shut, "please login".
                            Clear input, turn echo on.

                     0B     Terminating host is originate only,
                            "please login".
                            Clear input, turn echo on.

                     0C     Terminating host is out of ports,
                            "please login".
                            Clear input, turn echo on.

                     0D     No network path to destination host,
                            "please login".
                            Clear input, turn echo on.



    LOGII                       Logon Processing II                          73
    LOGII Logon Session                                         January 6, 1988


            normResponse [APPLICATION 04] IMPLICIT INTEGER DEFAULT 0 {
                EscapePLI(0), username(1), erTypeUname(2), password(3),
                erTypePw(4), logCharBadPLI(5), destBadPLI(6),
                accessDeniedPLI(7), termHostUnk(8),
                termHostDownPLI(9), termHostShutPLI(0A),
                termHostOrigPLI(0B), termHostNoPortsPLI(0C),
                noPathToHostPLI(0D)                                  } }}















































    LOGII                       Logon Processing II                          74
    LOGII Logon Session                                         January 6, 1988



         Respond/Reject Circuit Request ISIS - RCRI - 0C3

         Sent by the Node Code to the originating interface
         on the logon port, to reject a circuit request,
         or prompt for logon information.

         .--------.--------.--------.--------.
         |     RPORT 0     |  0C3   |XS......|
         -------------------------------------
         |   message size  |   RCRI MOs......
         -------------------

         Where X = True indicates an incomplete message
         Where S = True indicates a subsequent message in a partial
                   message sequence.



         RCRI ::= [APPLICATION 32] IMPLICIT SEQUENCE {







                4.7.3  RCRI Required Message Objects


            rMOSequence SEQUENCE {


     MO #   INTERPRETATION
    -----   --------------

    MO-3E   RCRI Flags

            The RCRI Flags  are used for  any binary indication  that will
            affect the overall interpretation of the message.  One  bit is
            used;  if  bit zero  is  reset  the request  is  for  a normal
            circuit, and  if the  bit is  set it  is an  auxiliary circuit
            request.

            rCRIFlags [APPLICATION 3E] IMPLICIT BIT STRING {
                auxCircuit(0)                              }








    LOGII                       Logon Processing II                          75
    LOGII Logon Session                                         January 6, 1988


                4.7.4  RCRI Supplemental Message Objects


            sMOSet SET {



     MO #   INTERPRETATION
    -----   --------------

    MO-24   Node Code Generated RCRI Conditions

            This integer element, default zero, represents  circuit reject
            codes  that are  generated  by the  Node Code  in  response to
            detection   of   a   logon  error   from   the   interface  or
            insurmountable network conditions.

            The Node Code generated codes have the following interpretation:

                    Code    Meaning
                    -----   -------
                      0     ICRM received for port already in logon.
                      1     ICRS received on unassigned port.
                      2     Invalid ICRS form.
                      3     Command channel lost, sent to logon ports.
                      4     ICRS received before RCRI was sent.
                      5     Waited too long for partial message to
                            complete.


            nodeCodeRCRI [APPLICATION 24] IMPLICIT INTEGER DEFAULT 0  {
                iCRMforLogPort(0), iCRSonUnassigned(1), iCRSBad(2),
                comChanLost(3),iCRSbeforeRCRI(4),partialMsgTimeout(5) },


    MO-0F   Half Duplex

            This  element indicates  whether or  not the  originating port
            requested a half-duplex circuit.   This SMO will be  echoed by
            the  Supervisor in  all response  messages if  the half-duplex
            indication  is sent  in the  ICRM/ICRS request.   This  SMO is
            echoed in the response  message to prevent the  interface from
            having to  locally interpret  the half-duplex  indication, and
            instead  leaves  the  discovery  of  the  indication   to  the
            Supervisor, which in turn informs the originating interface of
            the duplex status of the port, in all responses the Supervisor
            sends for this logon session.

            halfDuplex [APPLICATION 0F] IMPLICIT BOOLEAN DEFAULT FALSE,





    LOGII                       Logon Processing II                          76
    LOGII Logon Session                                         January 6, 1988



            RCRI Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-20   Message String for Port in Logon Mode

            This  element  contains  the  IA5  message  string  which  the
            Supervisor is  sending for  the interface  for display  on the
            originating logon port.

            logonPortMessage [APPLICATION 20] IMPLICIT IA5,


    MO-41   PID of Rejecting Host

            This MO is valid only in conjunction with MO-27 and MO-04, the
            Normal  and Auxiliary  Reject Codes,  and the  Normal Response
            Codes, and represents the Product Identification Code (PID) of
            the  terminating  host  that  was  associated  with  a circuit
            reject.  MO-27 codes 16  through 1B and MO-04 codes  8 through
            0D are associated with a terminating host, and this  PID MO-41
            is present  in the  RCRI only  if one  of these  conditions is
            indicated.  The current list of PIDs may be found at  any time
            in the BASELINE file PRODID.DOC.  If the terminating interface
            has not reported a PID to the Supervisor, this SMO will not be
            present.

            rejectTermHostPID [APPLICATION 41] IMPLICIT OCTET STRING,























    LOGII                       Logon Processing II                          77
    LOGII Logon Session                                         January 6, 1988



            RCRI Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-27   Normal and Auxiliary Reject Codes

            This integer element, default zero, represents  circuit reject
            codes, some of which  are common to both normal  and auxiliary
            circuit  requests,  and some  which  indicate  conditions that
            cause  a  reject  only when  pertaining  to  auxiliary circuit
            requests.  Codes 16 through 1B represent  discrete conditions,
            one or more of which may be encountered over  several possible
            target hosts.  If several  possible target hosts could  not be
            accessed  for  a  variety  of  reasons,  the  highest numbered
            reason, i.e.  the condition that  came the closest  to circuit
            build success,  is the condition  indicated by the  RCRI MO-27
            code.  This SMO indicates to the Node Code that the logon port
            may be  re-used, and after  sending the corresponding  RCRI to
            the interface, the Node Code disconnects the  dispatcher logon
            port.  Code  0C indicates  that a  normal circuit  request was
            rejected  due  to an  excessive  failure count  for  the logon
            session, and an  accompanying MO-04 indicates the  response to
            the last failure condition.




























    LOGII                       Logon Processing II                          78
    LOGII Logon Session                                         January 6, 1988



            The normal/aux reject codes have the
            following interpretation:

                    Code    Meaning
                    -----   -------
                      0     Invalid NCRM format.
                      1     Supervisor in Slow Sleep state.
                      2     Insufficient Supervisor buffer space.
                      3     Logons limited by Probe operator command.
                      4     Invalid CCT in ICRM/NCRM.
                      5     Invalid originating host number.
                      6     Invalid throughput class in ICRM/NCRM.
                      7     Originating host is down.
                      8     Originating host in is not on the base.
                      9     Originating host is terminate only.
                     0A     Duplicate Logon fields.
                     0B     Logon field too long.
                     0C     Bad MUD.
                     0D     Normal request logon failure limit exceeded.
                     0E     Logon session timeout.
                     0F     Unused, invalid.
                     10     Auxiliary circuit queue too long.
                     11     Aux request invalid logon character.
                     12     Aux request invalid destination specified.
                     13     Aux request bad username.
                     14     Aux request bad password.
                     15     Aux request access denied.
                     16     Aux request terminating host is unknown.
                     17     Aux request terminating host is down.
                     18     Aux request terminating host is shut.
                     19     Aux request terminating host is originate only.
                     1A     Aux request terminating host is out of ports.
                     1B     Aux request no network path to destination host.



            normAuxReject [APPLICATION 27] IMPLICIT INTEGER DEFAULT 0 {
                nCRMBad(0), slowSleep(1), noSupBuffers(2),
                logonBarredByOper(3), cCTBad(4),
                origHostBad(5), tclassBad(6), origHostDown(7),
                origHostDifBase(8), origHostTerm(9),
                logFieldDuplicate(0A), logFieldBig(0B), mUDBad(0C),
                logonFailLimit(0D), logTimeOut(0E), unusedInvalid(0F),
                auxQTooLong(10), auxLogCharBad(11), auxDestBad(12),
                auxBadUname(13), auxBadPW(14), auxAccessDenied(15),
                auxTermHostUnk(16), auxTermHostDown(17),
                auxTermHostShut(18), auxTermHostOrig(19),
                auxTermHostNoPorts(1A), auxNoPathToHost(1B)           },





    LOGII                       Logon Processing II                          79
    LOGII Logon Session                                         January 6, 1988



            RCRI Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-04   Normal Circuit Response Codes

            This  integer   element,  default  zero,   represents  circuit
            response  codes  that  are pertinent  only  to  normal circuit
            requests and  are ignored if  the auxiliary indication  is set
            for  the  RCRI.    Codes  8  through  0D   represent  discrete
            conditions,  one  or more  of  which may  be  encountered over
            several  possible target  hosts.  If  several  possible target
            hosts  could not  be accessed  for a  variety of  reasons, the
            highest  numbered reason,  i.e.  the condition  that  came the
            closest to circuit  build success, is the  condition indicated
            by the RCRI MO-04 code.

            The  response  codes  also  imply  certain  actions  that  the
            interface should take for the logon port.  The  interface must
            clear the logon port input or output buffers, turn echo on, or
            some  combination  of  these actions  in  accordance  with the
            specific response code.





























    LOGII                       Logon Processing II                          80
    LOGII Logon Session                                         January 6, 1988






            The normal response codes have the following interpretation:

                    Code    Meaning
                    -----   -------
                      0     Escape indication detected, "please login".
                            Clear input, clear output, turn echo on.

                      1     "username" prompt.
                            Turn echo on.

                      2     "error type username" prompt.
                            Clear input, turn echo on.

                      3     "password" prompt.

                      4     "error type password" prompt.
                            Clear input.

                      5     Invalid logon character, "please login".
                            Clear input, clear output, turn echo on.

                      6     Invalid destination specified, "please login".
                            Clear input, turn echo on.

                      7     Access denied, "please login".
                            Clear input, turn echo on.

                      8     Terminating host is unknown, "please login".
                            Clear input, turn echo on.

                      9     Terminating host is down, "please login".
                            Clear input, turn echo on.

                     0A     Terminating host is shut, "please login".
                            Clear input, turn echo on.

                     0B     Terminating host is originate only,
                            "please login".
                            Clear input, turn echo on.

                     0C     Terminating host is out of ports,
                            "please login".
                            Clear input, turn echo on.

                     0D     No network path to destination host,
                            "please login".
                            Clear input, turn echo on.



    LOGII                       Logon Processing II                          81
    LOGII Logon Session                                         January 6, 1988


            normResponse [APPLICATION 04] IMPLICIT INTEGER DEFAULT 0 {
                EscapePLI(0), username(1), erTypeUname(2), password(3),
                erTypePw(4), logCharBadPLI(5), destBadPLI(6),
                accessDeniedPLI(7), termHostUnk(8),
                termHostDownPLI(9), termHostShutPLI(0A),
                termHostOrigPLI(0B), termHostNoPortsPLI(0C),
                noPathToHostPLI(0D)                                  } }}















































    LOGII                       Logon Processing II                          82
    LOGII Logon Session                                         January 6, 1988


                           4.8  Assign Logon Port - ASLP


         The new Assign  Logon Port (ASLP) message  is sent from  the Node
    Code to  the originating  interface on the  newly assigned  RPORT, and
    contains no RMOs or SMOs, simply an ISIS message header.  This message
    is completely analogous to the previous pseudo-needle  message, except
    for the increased field size provided for the Dispatcher Key.

         ASLP - Assign Logon Port - 0C5

         Originates in Node Code slot, goes to interface slot
         on the newly assigned RPORT.  Fixed size = 8 bytes.

         .--------.--------.--------.--------.
         |      RPORT      |  0C5   | unused |
         -------------------------------------
         | Dispatcher Key  |   Local Key     |
         -------------------------------------


         


         The ASLP is created by the Node Code and sent to the interface on
    a new logon port, in response to the Node Code's receiving an ICRM and
    assigning a dispatcher port in logon mode for the logon  session.  The
    dispatcher will interpret and discard the dispatcher key from the ASLP
    message and use the key to determine which slot to associate  the ASLP
    with, thus assigning a free dispatcher port for that slot for  the new
    port in logon  mode (note that the  interface slot does  not interpret
    the Dispatcher Key).  The local  key is used by the interface  slot to
    associate  the new  logon  port with  a particular  user's  ICRM logon
    request,  and  the Node  Code  simply echoes  whatever  local  key was
    received with the original ICRM.



















    LOGII                       Logon Processing II                          83
    LOGII Logon Session                                         January 6, 1988


                         4.9  Command Channel Needle - CCN


         The LOGII Command Channel Needle (CCN) is sent by  the Supervisor
    to the Node Code on  the command channel.  The Supervisor  responds to
    Node Code  Circuit Requests,  and for  successful circuits,  sends the
    needle to the originating Node Code.

         The  CCN  is  only  sent  to  originations   requesting  circuits
    utilizing the new 08  NCRM and if the  terminating interface/ISIS/Node
    Code  is  not  LOGII  capable  a SMO  and  CCN  flag  bit  is included
    indicating  that the  originating Node  Code should  construct  an old
    style  0310 needle.   The originating  Interface is  informed  of this
    event, implying that any LOGII  data that did not have an  0310 needle
    analogue  was  lost.   CCNs  that  are  bound  for  non-LOGII  capable
    destinations  will  not  contain  the  SDL,  RDA,   Extension,  Target
    Selection  and   Qualification  indication,   circuit  cost,   PID  of
    originating host, or OADR  SMOs since this information cannot  be sent
    to a non-LOGII  termination.  The username in  a CCN with  a non-LOGII
    destination will  contain any necessary  shut override  or transparent
    logon prefix, the  carriage return or semi-colon  username terminator,
    and any necessary username suffix,  such as sub host number  or target
    profile.

         The CCN  message contains  no SMO  set, and  the RMO  sequence is
    constructed of three major  elements: logon success MOs bound  for the
    originating interface in a  logon success RCRI, the needle  node list,
    and the needle data.

         CCN - Command Channel Needle - CCN - 0A

         Sent by the Supervisor to the originating Node Code on the
         command channel, in response to a successful circuit request.

         .--------.--------.--------.--------.
         |   NODE NUMBER   |   0A   |   80   |
         -------------------------------------
         |   message size  |  CCN MOs........
         -------------------------------------



         CCN ::= [APPLICATION 2A] IMPLICIT SEQUENCE {











    LOGII                       Logon Processing II                          84
    LOGII Logon Session                                         January 6, 1988


                4.9.1  CCN Required Message Objects


            rMOSequence SEQUENCE {


     MO #   INTERPRETATION
    -----   --------------

    MO-25   CCN Flags

            The CCN  Flags are  used for any  binary indication  that will
            affect  the overall  interpretation  of the  type  0A message.
            There are five bits  used:  If bit 0 is  set the CCN is  for a
            command circuit,  if bit  1 is set  the CCN  is for  a rebuild
            circuit.  If bit 2 is set the CCN is for a circuit between two
            slots  on the  same  node, and  any  needle node  list  SMO is
            ignored.

            Bit 3 of the CCN  flags is set to indicate to  the originating
            Node  Code that  the terminating  ISIS/Node Code  or Interface
            cannot interpret LOGII.  This information is indicated  in the
            CCN flags, as well as in the MO-2C SMO, to allow the Node Code
            to readily determine which kind of a needle to build, LOGII or
            non-LOGII, without scanning the SMO list.  The SMO is included
            in addition to the flags bit, in the CCN set of SMOs  that are
            destined  for   the  originating   interface  with   the  RCRI
            indicating that the logon succeeded.  If this bit is  set, bit
            4 the "passthrough node is not LOGII capable" bit is ignored.

            Bit 4 of the CCN  flags is set to indicate to  the originating
            Node Code that there  is a non-LOGII capable  passthrough node
            in the needle node list.  This indicates to the the  Node Code
            that  a  non-LOGII  needle  head must  be  sent  but  that the
            termination can handle LOGII data.  Therefore  the originating
            Node  Code will  send  the LOGI  needle head  (0310)  but will
            indicate that this is a translated LOGII needle, and  that the
            needle body and tail portions will follow on the newly created
            circuit.  The  NCN Overview  and Compatibility  Issues section
            describes this situation in more detail.  This bit  is ignored
            if bit 3 the "termination is not LOGII" bit is set.

            cCNFlags [APPLICATION 25] IMPLICIT BIT STRING {
                commandCir(0), rebuildCir(1),
                intraNodeCir(2),termNonLOGII(3),
                passThruNonLOGII(4)                       },








    LOGII                       Logon Processing II                          85
    LOGII Logon Session                                         January 6, 1988



            CCN Required Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-01   Logon Success Indication


            This MO is a Sequence  comprised of an an RMO sequence  and an
            SMO set that  are to be sent  to the originating  interface by
            the Node Code in an LGSC.

            The Originating Host Number  is used by the interface  slot to
            identify the originating host of the circuit request.

            The Accounting Invoice Number is established by the Supervisor
            and is used by the originating interface/Node  Code throughout
            the duration of the circuit session when generating accounting
            information relating to the circuit.

            The  PID  of  the  Terminating  Host  indicates   the  Product
            Identification Code of the circuit termination, as reported to
            the Supervisor by the  terminating host.  The current  list of
            PIDs may be found at any time in the BASELINE file PRODID.DOC.

            If  the circuit  terminating interface/ISIS/Node  Code  is not
            LOGII capable, the originating interface is informed  that any
            LOGII data not translatable  to an old style needle format was
            lost, although the 0310 needle was sent to build the circuit.

            The  Shut  Override  Indication  indicates  that  the  user is
            capable of overriding shut terminating host  conditions.  This
            occurs  if  the  terminating  host,  as  determined  by Access
            Profiles  target selection,  is shut,  and the  Access Profile
            Entry for the target indicates that this Access  Profile Entry
            allows shut override.

            If  the  circuit termination  is  intelligent  interface (IIX)
            capable as specified in the Supervisor's host table  entry for
            the terminating host, and the originating  interface indicated
            its  IIX  capability,   the  Supervisor  will   indicate  this
            condition in the CCN, to be sent to the originating interface.

            If  the UUN  was requested  in the  ICRM/ICRS,  the Supervisor
            returns  the UUN  for the  user making  the logon  request (as
            specified  in  the  MUD), which  is  sent  to  the originating
            interface by the Node Code in an RCRI.





    LOGII                       Logon Processing II                          86
    LOGII Logon Session                                         January 6, 1988


            logonSuccess [APPLICATION 1] IMPLICIT SEQUENCE              {


                rMOSequence SEQUENCE                                {
                origHostNumber [APPLICATION 0E] IMPLICIT OCTET STRING,
                invoiceNumber [APPLICATION 26] IMPLICIT OCTET STRING,
                termHostPID [APPLICATION 43] IMPLICIT OCTET STRING  },


                sMOSet SET                                          {
                termNonLOGII [APPLICATION 2C] IMPLICIT BOOLEAN 
                                              DEFAULT FALSE,
                shutOverride [APPLICATION 2F] IMPLICIT BOOLEAN 
                                              DEFAULT FALSE,
                termIIX [APPLICATION 31] IMPLICIT BOOLEAN DEFAULT FALSE,
                uUN [APPLICATION 13] IMPLICIT OCTET STRING          }   },




            CCN Required Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-28   Needle Node List Count

            The Needle Node list MO is made up a sequence of Node Numbers.
            This  MO indicates  how many  node number  entries are  in the
            Needle Node  List MO.  This eliminates the  need for  the Node
            Code to scan the Node List MO to determine the number of nodes
            in the needle list.

            needleNodeCount [APPLICATION 28] IMPLICIT OCTET STRING,


    MO-11   Needle Node List

            The Needle Node list MO is a Constructor made up of a Sequence
            of Implicit  Octet Strings, each  representing a  Node Number,
            and taken as a list defining the circuit path.  The  node list
            is  set  up such  that  the first  entry  in the  list  is the
            neighbor of the origination, and the last node in the  list is
            the  terminating  node number.   The  needle node  list  MO is
            ignored if bit 2 of of the CCN flags is set, indicating a slot
            to slot circuit.

            needleNodeList [APPLICATION 11] IMPLICIT SEQUENCE OF
                                        nodeNumber IMPLICIT OCTET STRING
                           -- each octet string containing a node number,



    LOGII                       Logon Processing II                          87
    LOGII Logon Session                                         January 6, 1988




            CCN Required Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-1D   ISIS Needle

            This MO is  a Sequence, comprised of  an RMO sequence  and SMO
            Set that  form the needle  data. This MO  is extracted  in its
            entirety by  the Node  Code to produce  the ISIS  Needle.  The
            ISIS Needle RMO Sequence contains the ISN  Dispatcher Sequence
            made  up  of  the  intranode  circuit  and  auxiliary circuits
            indications, the invoice number, the terminating  host number,
            the originating  port number, and  possible shut  override and
            IIX indications.  Following the ISN Dispatcher Sequence is the
            throughput  class,  the  CCT,  the  username,  the   SDL,  the
            originating node, host and port numbers, the  originating host
            PID, circuit cost and cost table indications.  The ISIS Needle
            SMO Set may contain: the RDA, the extension,  target selection
            and qualification information, the OADR, the sub  host number,
            the   IRC  number,   access  license   information,   the  HDX
            indication, the reverse charge indication, the origination IIX
            indication, and the transparent logon indication.

            ISN [APPLICATION 1D] IMPLICIT SEQUENCE         {

                rMOSequence SEQUENCE {


    MO-36   ISN Dispatcher Information Sequence

            This  sequence contains  the  data necessary  for  the circuit
            termination   Dispatcher  to   complete  the   logon   to  the
            destination interface.

            The Accounting Invoice Number is established by the Supervisor
            and is used by the terminating interface/Node  Code throughout
            the duration of the circuit session when generating accounting
            information relating to the circuit.

            The Terminating Host Number is the host number of  the circuit
            termination host and is  used by the terminating Node  Code to
            send the ISN to the proper host.

            The ISN  Flags are  used for any  binary indication  that will
            affect  the overall  interpretation of  the type  ISN message.
            There are  two bits used:  If bit 0  is set the  ISN is  for a
            circuit  between two  slots on  the same  node  (an intra-node
            circuit).   If  bit 1  is  set  the ISN  is  for  an auxiliary
            circuit.

    LOGII                       Logon Processing II                          88
    LOGII Logon Session                                         January 6, 1988





            CCN Required Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

            The Originating Port Number is put included in  the iSNDispSeq
            for use by the  Dispatcher to handle intra-node  circuits, and
            is also sent to the terminating interface.

            The  Shut  Override  Indication  indicates  that  the  user is
            capable of overriding shut terminating host  conditions.  This
            occurs  if  the  terminating  host,  as  determined  by Access
            Profiles  target selection,  is shut,  and the  Access Profile
            Entry for the target indicates that this Access  Profile Entry
            allows shut override.

            The  Origination  IIX   MO  indicates  that   the  originating
            interface  is  intelligent  interface  (IIX)  capable  and  is
            present  only  if  the  originating  interface  indicated  IIX
            capability  in its  circuit request  and the  Supervisor found
            that the terminating interface host is also IIX capable.



                iSNDispSeq [APPLICATION 36] IMPLICIT SEQUENCE         {
                    invoiceNumber [APPLICATION 26] IMPLICIT OCTET STRING,
                    termHostNumber [APPLICATION 0D] IMPLICIT OCTET STRING,
                    iSNFlags [APPLICATION 1B] IMPLICIT BIT STRING {
                    intraNodeCir(0),auxCircuit(1)                 },
                    origPort [APPLICATION 1A] IMPLICIT OCTET STRING,
                    shutOverride [APPLICATION 2F] IMPLICIT BOOLEAN 
                                                  DEFAULT FALSE,
                    origIIX [APPLICATION 3] IMPLICIT BOOLEAN 
                                                  DEFAULT FALSE       },
















    LOGII                       Logon Processing II                          89
    LOGII Logon Session                                         January 6, 1988



            CCN Required Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-09   Throughput Class

            This  SMO represents  the requested  throughput class  for the
            circuit.  A value of 0 indicates a throughput class of 64 cps,
            value 1 indicates  160 cps, value 2  indicates 512 cps,  and a
            value  of  3  indicates   a  throughput  class  of   2048  cps
            (associated with the ^A, ^B, ^C, and ^D logon  request options
            respectively).   If no  throughput class  indication  is made,
            throughput class 0 (64 cps) is assumed default.

                tClass [APPLICATION 9] IMPLICIT INTEGER           {
                    cps64(0), cps160(1), cps512(2), cps2048(3)    },


    MO-02   CCT

            The  CCT element  represents the  Circuit  Characteristic Type
            which  is  requested  by the  circuit  originator.   Valid CCT
            values range from  00 to 1F  and no half-duplex  indication is
            contained within the CCT.

                cCT [APPLICATION 2] IMPLICIT OCTET STRING,


    MO-12   Username

            The  username element  contains the  interpreted  IA5 Username
            logon string  field.  The Username  used by the  Supervisor is
            contained in the  SMO and may  be different from  the Username
            that  was  sent  to  the  Supervisor.   Inbound  usernames are
            subject  to  certain  translations,  as  described  in earlier
            portions of this document, and if a null username  was entered
            and the OADR was used  as a username, the OADR will  appear in
            this  MO.   The  username  MO  in  a  CCN  with   a  non-LOGII
            destination  will  contain  any  necessary  shut  override  or
            transparent logon  prefix, the  carriage return  or semi-colon
            username terminator, and  any necessary username  suffix, such
            as sub host number or target profile.

                userName [APPLICATION 12] IMPLICIT IA5,







    LOGII                       Logon Processing II                          90
    LOGII Logon Session                                         January 6, 1988



            CCN Required Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-17   Specified Destination List

            The SDL MO represents  a sequence of translated  IA5 Specified
            Destination List (SDL) items, the first item  representing the
            primary  destination,  and the  second  item  representing the
            ultimate  circuit destination.   Inbound SDLs  are  subject to
            certain translations  before they are  sent back out  with the
            CCN, as described in earlier portions of this document.

                specDestList [APPLICATION 17] IMPLICIT SEQUENCE OF
                                              destString IMPLICIT IA5,


    MO-2B   Originating Node Number

            The originating node  number is put  into the CCN  Needle Body
            set for transmission to the terminating interface.

                origNode [APPLICATION 2B] IMPLICIT OCTET STRING,


    MO-0E   Originating Host Number

            The originating host  number is put  into the CCN  Needle Body
            set for transmission to the terminating interface.

                origHostNumber [APPLICATION 0E] IMPLICIT OCTET STRING,




















    LOGII                       Logon Processing II                          91
    LOGII Logon Session                                         January 6, 1988



            CCN Required Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-42   PID of Originating Host

            This  MO  indicates  the Product  Identification  Code  of the
            circuit  origination, as  reported  to the  Supervisor  by the
            originating host.  The  current list of  PIDs may be  found at
            any time in the BASELINE file PRODID.DOC.

                origHostPID [APPLICATION 42] IMPLICIT OCTET STRING,


    MO-2D   Circuit Cost

            The  circuit cost  for  the circuit  path as  computed  by the
            Supervisor's pathfinding calculations, is included in  the CCN
            Needle Body set.

                circuitCost [APPLICATION 2D] IMPLICIT OCTET STRING,






























    LOGII                       Logon Processing II                          92
    LOGII Logon Session                                         January 6, 1988



            CCN Required Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-0A   Cost Table

            The  Cost  Table   MO  contains  a  code   representing  which
            Supervisor  cost  table  was used  to  compute  the  path, and
            defaults to a Batch throughput class of cps64 if  not present.
            The    code    indicates    which    throughput    class   and
            batch/interactive combination  was used for  cost computations
            during pathfinding.

            A - throughput class ^A (64d cps)    I - Interactive ^I
            B - throughput class ^B (160d cps)   V - Batch ^V
            C - throughput class ^C (512d cps)
            D - throughput class ^D (2048d cps)

            Value   Interpretation
            -----   --------------
              0         IA
              1         IB
              2         IC
              3         ID
              4         VA
              5         VB
              6         VC
              7         VD


                costTable [APPLICATION 0A] IMPLICIT INTEGER DEFAULT 0   {
                  cps64Int(0), cps160Int(1), cps512Int(2), cps2048Int(3),
                  cps64Bat(4), cps160Bat(5), cps512Bat(6), cps2048Bat(7)} }


















    LOGII                       Logon Processing II                          93
    LOGII Logon Session                                         January 6, 1988



            CCN Required Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------


                sMOSet Set {



    MO-18   Resultant Destination Address

            The  RDA element  contains the  Resultant  Destination Address
            that the  Supervisor may  use to lookup  a destination  in the
            MUD.  If the RDA SMO is not present, this indicates that there
            was  no  symbolic  MUD  destination  specification,  and since
            symbolic  addresses  are   not  currently  supported   in  MUD
            destination specifications, no RDA SMOs are sent for now.

                resultDestAdr [APPLICATION 18] IMPLICIT IA5,


    MO-19   Extension

            The  Extension MO  contains the  translated IA5  logon request
            Extension field.   Inbound Extensions  are subject  to certain
            translations,  as  described  in  earlier  portions   of  this
            document.

                extension [APPLICATION 19] IMPLICIT IA5,


    MO-1C   Password

            The password MO contains the parsed IA5 logon request Password
            field  without  terminator.  This  MO  is included  only  if a
            transparent logon  indication is present,  and is sent  to the
            terminating  gateway  (presumably) interface  with  the needle
            body, for use with the other network logon. A null password is
            indicated by a string containing only a single ASCII  NUL (00)
            character.

                password [APPLICATION 1C] IMPLICIT IA5,









    LOGII                       Logon Processing II                          94
    LOGII Logon Session                                         January 6, 1988



            CCN Required Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-15   Target Selection and Qualification

            The  Target Selection  and Qualification  MO is  a  Bit String
            which  utilizes  10  bits  to  indicate  information regarding
            Target Selection and Qualification.  The bits are set  for any
            and all of the  conditions that were encountered over  any and
            all  hosts that  were not  selected, causing  the redirection.
            Set bits are interpreted as follows:
                     Bit    Indication
                    -----   -------------------
                      0     Redirection due to host down.
                      1     Redirection due to host shut.
                      2     Redirection due to no such host.
                      3     Redirection due to no host ports.
                      4     Redirection due to reverse charge barred.
                      5     Redirection due to sent paid barred.
                      6     Redirection due to origination only host.
                      7     Redirection due to no network path to host.
                      8     Redirection due to systematic re-direction.
                            (Primary Username APE produced no
                            intersection with the Destination APEs).
                      9     Multiple target hosts were considered
                            in pathfinding.


                targSelectQual [APPLICATION 15] IMPLICIT BIT STRING  {
                    hostDown(0), hostShut(1), hostUnknown(2),
                    hostNoPorts(3),rCHGBarred(4), nonRCHGBarred(5),
                    hostOrigOnly(6),noPathToHost(7), systematic(8),
                    multiTargets(9)                                  },


    MO-07   Origination Address

            The OADR element  contains the IA5 Origination  Address string
            for the requesting port.

                origAddress [APPLICATION 7] IMPLICIT IA5,









    LOGII                       Logon Processing II                          95
    LOGII Logon Session                                         January 6, 1988



            CCN Required Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-30   Destination Sub-Host Number

            The  destination sub-host  number for  the  actual terminating
            interface host is  included in the CCN  Needle Body if  a sub-
            host number was present in the logon string destination field,
            and the destination is  LOGII capable.  If the  destination is
            not LOGII capable,  the sub-host MO  is not included  since it
            will be  part of the  suffix to the  username for  a non-LOGII
            destined CCN.

                subHost [APPLICATION 30] IMPLICIT OCTET STRING,


    MO-0C   IRC Number for the Username

            The IRC MO contains  the IRC group number associated  with the
            user placing the logon request.  The IRC group number  is part
            of the  user's MUD profile  and is used  by the  Supervisor to
            affect the path selected for the logon request.

                iRCNumber [APPLICATION 0C] IMPLICIT OCTET STRING,


    MO-48   Kernel Debug Access License

            The Kernel  debug access  license MO  indicates what  level of
            access privilege the username has when accessing the Skywalker
            Kernel for debug.  The MUD contains this information  for each
            username.  The  user may  have no  access to  Skywalker Kernel
            debug, no risk access which allows commands that cannot change
            the state of the system nor access network data,  read access,
            and write access.

                kernelAccLic [APPLICATION 48] IMPLICIT INTEGER DEFAULT 0 {
                    noAccess(0),noRiskAccess(1),
                    readAccess(2),writeAccess(3)                         },











    LOGII                       Logon Processing II                          96
    LOGII Logon Session                                         January 6, 1988



            CCN Required Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-49   Dispatcher/Alfred Debug Access License

            The Dispatcher/Alfred debug  access license MO  indicates what
            level of access privilege the username has when  accessing the
            Dispatcher  or  Alfred  for  debug.   The  MUD  contains  this
            information for each username.  The user may have no access to
            Dispatcher/Alfred debug, no risk access which  allows commands
            that cannot change the state of the system nor  access network
            data, read access, and write access.

                dispAlfAccLic [APPLICATION 49] IMPLICIT INTEGER DEFAULT 0 {
                    noAccess(0),noRiskAccess(1),
                    readAccess(2),writeAccess(3)                          },


    MO-4A   Slot Debug Access License

            The  Slot  debug access  license  MO indicates  what  level of
            access privilege  the username has  when accessing a  slot for
            debug.  The MUD  contains this information for  each username.
            The user  may have  no access  to slot  debug, no  risk access
            which  allows commands  that cannot  change the  state  of the
            system nor access network data, read access, and write access.

                slotAccLic [APPLICATION 4A] IMPLICIT INTEGER DEFAULT 0 {
                    noAccess(0),noRiskAccess(1),
                    readAccess(2),writeAccess(3)                       },


    MO-4B   Global Alfred Access License

            The GLobal  Alfred access license  MO indicates what  level of
            access  privilege  the  username  has  when  accessing  global
            Alfred.  The MUD contains this information for  each username.
            The user may have no  access to global Alfred, no  risk access
            which  allows commands  that cannot  change the  state  of the
            system nor access network data, read access, and write access.

                globAlfAccLic [APPLICATION 4B] IMPLICIT INTEGER DEFAULT 0 {
                    noAccess(0),noRiskAccess(1),
                    readAccess(2),writeAccess(3)                          },






    LOGII                       Logon Processing II                          97
    LOGII Logon Session                                         January 6, 1988



            CCN Required Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-0F   Half Duplex

            The  half-duplex   element  indicates   whether  or   not  the
            originating port  requested a  half-duplex circuit.   This SMO
            will be echoed by  the Supervisor in all response  messages if
            the  half-duplex indication  of either  form, is  sent  in the
            ICRM/ICRS request and if the terminating host is  IIX capable.
            This SMO is echoed in the Supervisor's response to prevent the
            interface  from having  to locally  interpret  the half-duplex
            indication, and instead leaves the discovery of the indication
            to  the  Supervisor,  which in  turn  informs  the originating
            interface of the duplex  status of the port, in  all responses
            the Supervisor sends for this logon session.

                halfDuplex [APPLICATION 0F] IMPLICIT BOOLEAN DEFAULT FALSE,


    MO-10   Reverse Charge Call Requested

            The reverse charge MO indicates that the originating interface
            requests  reverse  charging   for  the  logon  and   that  the
            Supervisor has found this request to be acceptable.

                rCHGRequest [APPLICATION 10]
                    IMPLICIT BOOLEAN DEFAULT FALSE,






















    LOGII                       Logon Processing II                          98
    LOGII Logon Session                                         January 6, 1988



            CCN Required Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-2E   Transparent Logon Indication

            The  transparent   logon  MO   indicates  that   the  username
            associated with this logon had a Transparent  Logon indication
            in  the  MUD.   This  indicates  to  T-II  Gateway terminating
            interfaces that  the logon string  is to be  passed on  in the
            same form, to the  next network.  If a password  was presented
            to  the Supervisor  and  the transparent  logon  indication is
            present, the password is sent out in the CCN for  inclusion in
            the  needle  body.   This  will  allow  the  TYMNET-II gateway
            interface to receive a password for its subsequent transparent
            logon in the next network, without prompting the user for one.
            This  MO  is  not  included  for  CCNs  bound   for  non-LOGII
            destinations  since the  information is  included in  the non-
            LOGII destined username prefix.

                transpLogon [APPLICATION 2E] IMPLICIT BOOLEAN 
                                             DEFAULT FALSE         } } } }





























    LOGII                       Logon Processing II                          99
    LOGII Logon Session                                         January 6, 1988


                           4.10  Node Code Needle - NCN






                4.10.1  NCN Overview and Compatibility Issues

         The new Node Code Needle (NCN) is created by the originating Node
    Code from  the Command  Channel Needle  (CCN) and  is threaded  to the
    circuit termination in the  same fashion as the current  needle.  Each
    passthrough Node  Code receives the  needle on an  unassigned channel,
    assigns resources for  the circuit and passes  the needle to  the next
    node indicated in the node list.

         The issue of compatibility with current interface, ISIS  and Node
    Codes is of critical importance  in the design of the LOGII  Node Code
    Needle.  The Supervisor must know the ability of each  interface, ISIS
    kernel and Node Code, to use the LOGII protocol.

         The  interface  slots that  are  LOGII capable  must  report host
    status using the ISIS "Extended report status" message (RPORT  0, type
    10).  The type 10 message has  a byte field for host status,  of which
    the low order 5 bits are currently used.  If bit 0 of the  status byte
    is set, the interface host  is LOGII capable.  The node  code receives
    the extended host status message  from the interface on RPORT  0.  The
    host status is sent to the Supervisor in the new takeover response and
    in the  type 1A host  status report messages  on the  command channel.
    Note that multi-based hosts must have consistent LOGII  capability for
    each host.  The Supervisor  will recognize LOGII capability of  a host
    from the last status update for that host number, regardless of multi-
    base status.

         The type 19 expanded takeover response contains an  extended host
    status halfword prior  to each host  number in the  takeover response.
    If bit three of this halfword is set, the host is LOGII  capable.  The
    type 1A host status message contains a host status byte, and if  bit 1
    of  the  byte is  set,  the  host is  LOGII  capable.   The Supervisor
    maintains the LOGII capability in a bit array, one bit per host in the
    network.  If the bit is reset, the host is LOGII capable.

         The Node  Code and  ISIS code  versions will  be bound  for LOGII
    capability  which  would   prevent  having  to  maintain   a  separate
    capability indication for  the ISIS kernel as  well as the  Node Code.
    Otherwise the Node  Code must be informed  by ISIS of the  ISIS kernel
    LOGII  status,  for  report  in  the  takeover  response.   The  LOGII
    capability  compatibility  between  ISIS and  the  Node  Code  will be
    enforced by MERLIN, or by ISIS/Node Code version number cross check at
    ISIS/Node Code assembly time.

         Any LOGII capable Node  Code reports it's takeover  response with


    LOGII                       Logon Processing II                         100
    LOGII Logon Session                                         January 6, 1988


    the expanded version of the  message (type 19).  The type  19 extended
    takeover response has a HW  field '8080' reserved for future  use.  If
    bit  1 is  set in  this HW  the Node  Code and  ISIS Kernel  are LOGII
    capable, and the Supervisor maintains this information for all network
    nodes.  Any  node reporting  takeover response with  the bit  reset or
    using  the  type  09   takeover  response  is  assumed  to   be  LOGII
    incompatible.

         For compatibility and conversion reasons, the Node Code, ISIS and
    interface slots need to be aware of the Supervisor's LOGII capability.
    During conversion of Bubbnet and TYMNET to LOGII, there will  be cause
    to maintain  a backlevel, non-LOGII  Supervisor in the  network, until
    the LOGII Supervisor is demonstrated to be stable.  If interface slots
    are capable  of using  LOGII protocol,  they must  be informed  of the
    active  Supervisor's LOGII  capability, so  that either  LOGII  or the
    previous logon session protocol  may be used, allowing  the interfaces
    to keep functioning with LOGII and non-LOGII Supervisors.

         The LOGII Supervisor will send a modified Takeover message on the
    command channel, informing the Node Code that the Supervisor  is LOGII
    capable.

         Takeover - 08

         Sent by the Supervisor to the Node Code
         on the command channel, to take control of the node.

         --------.--------
         |  08   | C0 + S|   Where C0 is the escape bit and the LOGII
         --------.--------   indication bit, S is the Supervisor number.


         Previously, this message contained  the Supervisor # + 80  in the
    second byte.  The set of bit  1 in addition to bit 0 indicates  to any
    Node Code at takeover time, that the Supervisor is LOGII  capable, and
    for backlevel  Node Codes, the  reset bit is  ignored.  This  has been
    tested in  the Bubbnet by  patching the Supervisor  to send  the LOGII
    indicative takeover  message (with  the bit  reset), and  observing no
    change  in  the  Supervisor's  ability  to  takeover  and  control the
    Bubbnet.














    LOGII                       Logon Processing II                         101
    LOGII Logon Session                                         January 6, 1988


         When a LOGII capable  Node Code receives a takeover  message from
    the Supervisor, an RPORT 0 message is sent to ISIS, allowing  the ISIS
    Dispatcher  logic to  pass the  takeover information  on  to interface
    slots that have been configured to request takeover information.  This
    message  is  altered  to  indicate  to  LOGII  capable  ISIS  that the
    Supervisor  is  LOGII  capable.   ISIS and  the  Node  Code  are bound
    (MERLIN) to be LOGII compatible as stated above, so there will  not be
    a problem with ISIS/Node Code LOGII mismatches.

         Node has been taken over - 02

         Sent by the Node Code to ISIS on the Dispatcher
         RPORT 0, whereupon it is sent to all interested slots.

         --------.--------
         |  02   |80+Sup#|
         --------.--------


         Previously  the  second  byte  contained  the  Supervisor  number
    without the high order bit set.  If ISIS receives a notice of takeover
    with  the high  order bit  of the  Supervisor number  set,  the active
    Supervisor  is  LOGII  capable.   ISIS  passes  this  message   on  to
    interested slots intact.  This  assumes that a message with  the LOGII
    set  bit  indication  will  not  causes  problems  with  any  existing
    interface code.

         ISIS will also deposit the Supervisor number, with the LOGII/LOGI
    indication bit,  into a  specific area  in Seg  F. This  indicates the
    LOGII/LOGI capability of the Supervisor to any interface.  If there is
    no command circuit, this byte will contain zero.  If an interface on a
    LOGII capable ISIS/Node Code ignores the new SEG F bit and  attempts a
    LOGII  request  to  a  non LOGII  capable  Supervisor,  the  Node Code
    realizes  that the  Supervisor is  not LOGII  capable and  rejects the
    message, indicating the reject reason.

         A race condition could occur that would result in sending a LOGII
    NCRM message to a  LOGI Supervisor.  This could happen  when switching
    from a LOGII Supervisor to a LOGI Supervisor.  The current  version of
    LOGI Supervisor code, version  42.01 must be patched to  recognize the
    type 08 NCRM message on the command channel, and ignore it.  The LOGII
    interface slots must  be able to handle  an ignored message,  and time
    out the circuit request.











    LOGII                       Logon Processing II                         102
    LOGII Logon Session                                         January 6, 1988



         ISIS SEGMENT 15d (SEG F)

    Location        Size    Name
    --------        ----    ----

     0F0439           1     SUP.SP

         .--------.
         |X....SUP|
         ----------

         If there is no command circuit this byte contains zero.

         If there is a LOGI Supervisor in control, this byte contains
         the Supervisor number in the low order 3 bits.

         If there is a LOGII Supervisor in control, this byte contains
         the Supervisor number in the low order 3 bits, and the high order
         bit is set to indicate a LOGII Supervisor.



         In  the  future it  will  be desirable  to  implement  a complete
    mechanism to report and maintain the capability status of  all network
    interfaces,  kernels and  nodes.   Perhaps 8  or 16  bits  which would
    specify  a variety of  capabilities for each entity could  be reported
    and maintained, in host  status changes and takeover  responses.  This
    would  allow  migration  away  from  version  number  as  a  means  of
    capability identification, which has led to some problems in the past.

         The Supervisor knows the  LOGII capability of all of  the network
    entities and uses this information to control to what extent the LOGII
    protocol is used for a  particular logon session.  If an  interface is
    loaded on  a backlevel ISIS/Node  Code and attempts  to use  the LOGII
    messages, the Dispatcher will reject the unknown LOGII  message types.
    If  an interface  places a  circuit request  without using  LOGII, the
    Supervisor  responds  in kind,  and  the entire  logon  session occurs
    without using LOGII.

         LOGII  Originating  interfaces are  only  to be  loaded  on LOGII
    capable ISIS/Node Code configurations, and if an originating interface
    attempts to send  LOGII messages to  a non-LOGII ISIS,  the dispatcher
    will  crash  the  slot,  indicating  a  DISPATCHER  CRASH.  Dispatcher
    crashes occur only if a slot uses an out of range RPORT or TYPE in the
    dispatcher message, or if the slot attempts to send a valid dispatcher
    message that is not allowed by  the slot (such as a message  that only
    Node Code can send).   The offending LOGII interface slot  may analyze
    the Dispatcher  Crash to  determine that the  message that  caused the
    crash was  a LOGII message,  and may then  inform the user  that LOGII
    slots  must be  loaded on  LOGII ISIS/Node  Code  configurations only,
    thereupon halting the slot.


    LOGII                       Logon Processing II                         103
    LOGII Logon Session                                         January 6, 1988


         If the  Supervisor receives a  LOGII circuit request,  it assumes
    that the originating interface,  ISIS and Node Code are  LOGII capable
    (since the LOGII circuit request got to the Supervisor).   Any further
    logon session communications with the origination take place  with the
    LOGII  protocol,  including  responses  and  rejects  (RCRM),   and  a
    resulting LOGII  Command Channel  Needle is produced  and sent  to the
    origination Node Code.

         The Supervisor knows the LOGII capability of all the network node
    codes and  interfaces, and  takes this  information into  account when
    forming the Command Channel  Needle.  If the terminating Node  Code or
    interface is not LOGII capable, the Supervisor sends a reduced  CCN to
    the originating node code, indicating that this needle is bound  for a
    non-LOGII  termination.   The  originating  Node  Code  will  create a
    standard non-LOGII needle to build the circuit to the destination, and
    the originating interface is informed that this occured.   The reduced
    CCN will  not contain  the SDL, RDA,  Extension, Target  Selection and
    Qualification, circuit cost, originating host PID, nor OADR MOs, since
    these elements have no LOGI counterparts.

         If there is a passthrough node in the calculated path that is not
    LOGII capable, the Supervisor sends a full CCN to the originating node
    code, but indicates that this condition exists.  The  originating Node
    Code  will create  a  non-LOGII needle  to  build the  circuit  to the
    destination, but bit  12 of the needle  flags is set to  indicate that
    this  is  a special  LOGI  needle  that will  have  LOGII  needle data
    following it.   When the terminating  Node Code receives  this special
    LOGI needle, it  will realize that the  circuit is complete,  but that
    the needle body and tail will be following on the new channel,  and to
    wait  for these  before  constructing the  LOGII ISIS  needle  for the
    terminating interface.  If any data  other than a needle body  or tail
    follows, the circuit is zapped.   In this fashion, the LOGII  data can
    still be sent to a LOGII termination, even if the needle must traverse
    a LOGI passthrough node.

         Two obscure compatibility issues will cause the Supervisor not to
    send a LOGII  command channel needle  and reject the  circuit request.
    In all cases, the Supervisor checks the LOGII capability of the needle
    passthrough nodes (as reported in the nodes' takeover  responses).  If
    a needle  is constructed  that exceeds  the current  single packetsize
    limitation on a needle, or if the needle contains node numbers greater
    than 16 bits in size, only  a LOGII needle will be capable  of passing
    this data.  If  any passthrough node or  the terminating Node  Code is
    not  LOGII  capable  the   circuit  is  rejected,  since   the  needle
    information cannot be represented within a non-LOGII needle.

         Note that the single packetsize restriction on the current needle
    is an implementation detail within the Node Code, and is not ingrained
    within the TYMNET-II network technology.





    LOGII                       Logon Processing II                         104
    LOGII Logon Session                                         January 6, 1988


                4.10.2  NCN Form and Usage

         The LOGII  Node Code  Needle (NCN) is  comprised of  three parts,
    each preceded with an 03xx control character pair.  The 03xx pairs are
    selected  for  their  transparency  properties,  i.e.   these  control
    character pairs are passed through just like user data in current Node
    Code.

         The Needle Head is preceded by an 0329 control character pair and
    contains only information needed to create the circuit: the  node list
    routing information and destination host, the invoice number,  and the
    circuit throughput class.   The Needle Head is  sent to the  Node Code
    neighbors  on  unassigned  channels,  and  each  passthrough allocates
    resources for the circuit and  sends the Needle Head to the  next node
    as soon  the present node  has received the  complete Needle  Head (as
    indicated by reception of a Needle Body or Tail).  The  current node's
    number  is eliminated  from the  Needle Node  List SMO  (MO-11) before
    forwarding the needle to the next node, so the list reduces in size as
    the needle traverses to the termination.

         The Needle Body is preceded by an 032A control character pair and
    a  halfword  physical  length  byte count  for  the  needle  body, and
    contains  all non-routing  circuit request  information bound  for the
    terminating  interface.  This  includes IIX,  OADR, IRC,  Username and
    other  information bound  for the  terminating interface.   The needle
    tail  is  simply  an  032B  control  character  pair,  with  no  other
    associated data, and indicates  that no further needle  information is
    following.

         Zappers   and   black   balls   have   some    special   handling
    characteristics  regarding  the  LOGII  needle  pieces.   In  order to
    attempt to complete  the circuit to  the termination before  zapping a
    circuit, zappers  do not  gobble needle  head data.   Each passthrough
    node code is aware whether it  has received a needle head and  has not
    yet received  a body or  tail, and  if a zapper  is received  with the
    needle head in the buffer,  the zapper simply follows the  needle head
    data without  gobbling it.   A zapper is  considered to  terminate the
    needle head, and  indicates that no needle  body or head  will follow.
    If a black ball is received while accumulating the needle head,  it is
    allowed to pass and  a zapper is inserted  behind it to tear  down the
    circuit.

         For now the LOGII protocol is implemented for user circuits only,
    but in the future will be used for command and rebuild circuits.










    LOGII                       Logon Processing II                         105
    LOGII Logon Session                                         January 6, 1988



         Node Code Needle - NCN
         Needle Head - Needle Node List and accompanying
         data preceded by 0329 control character pair.
         Contains no RMO Sequence or SMO set, constructed of
         a single Implicit Sequence.

         Created by the originating Node Code from the Command Channel
         Needle (CCN) and threaded through the network to the termination.

         --------
         | 0329 |               NEEDLE HEAD CONTROL CHARACTER PAIR
         --------

         NCNHead ::= [APPLICATION 22] IMPLICIT SEQUENCE {






                4.10.3  NCN Head Message Objects


     MO #   INTERPRETATION
    -----   --------------

    MO-21   NCN Flags

            The NCN  Flags are  used for any  binary indication  that will
            affect the overall interpretation of the NCN  messages.  There
            are two bits used:  If bit  0 is set the NCN is for  a command
            circuit, if bit 2 is set the CCN is for a rebuild circuit.

            nCNFlags [APPLICATION 21] IMPLICIT BIT STRING {
                commandCir(0), rebuildCir(1)              },


    MO-09   Throughput Class

            This  MO represents  the  requested throughput  class  for the
            circuit.  A value of 0 indicates a throughput class of 64 cps,
            value 1 indicates  160 cps, value 2  indicates 512 cps,  and a
            value  of  3  indicates   a  throughput  class  of   2048  cps
            (associated with the ^A, ^B, ^C, and ^D logon  request options
            respectively).   If no  throughput class  indication  is made,
            throughput class 0 (64 cps) is assumed default.

            tClass [APPLICATION 9] IMPLICIT INTEGER           {
                cps64(0), cps160(1), cps512(2), cps2048(3)    },




    LOGII                       Logon Processing II                         106
    LOGII Logon Session                                         January 6, 1988



            NCN Head Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-26   Accounting Invoice Number

            The Accounting Invoice Number is established by the Supervisor
            and is used by the terminating interface/Node  Code throughout
            the duration of the circuit session when generating accounting
            information relating to the circuit.

            invoiceNumber [APPLICATION 26] IMPLICIT OCTET STRING,


    MO-0D   Terminating Host Number

            This MO  contains the host  number of the  circuit termination
            host and is used by the terminating Node Code to send  the ISN
            to the proper host.

            termHostNumber [APPLICATION 0D] IMPLICIT OCTET STRING,


    MO-28   Needle Node List Count

            The Needle Node list MO is made up a sequence of Node Numbers.
            This  MO indicates  how many  node number  entries are  in the
            Needle Node  List MO.  This eliminates the  need for  the Node
            Code to scan the Node List MO to determine the number of nodes
            in the needle list.

            needleNodeCount [APPLICATION 28] IMPLICIT OCTET STRING,


    MO-11   Needle Node List

            This SMO is  a Constructor made up  of a Sequence  of Implicit
            Octet Strings, each representing a Node Number, and taken as a
            list defining the circuit path.  The node list is set  up such
            that  the first  entry  in the  list  is the  neighbor  of the
            origination, and the last node in the list is  the terminating
            node number.

            needleNodeList [APPLICATION 11] IMPLICIT SEQUENCE OF
                                        nodeNumber IMPLICIT OCTET STRING
                           -- each octet string containing a node number
                                                                         }




    LOGII                       Logon Processing II                         107
    LOGII Logon Session                                         January 6, 1988



         Node Code Needle - NCN
         Needle Body - Needle data not used for circuit allocation
         preceded by an 032A control character pair and
         a halfword physical length byte count for the needle body.
         Contains no RMO Sequence or SMO set, constructed of
         a single Implicit Sequence.

         Created by the originating Node Code from the Command Channel
         Needle (CCN) sent as user data on the newly built circuit
         following the needle head to the termination.

         --------
         | 032A |                NEEDLE BODY CONTROL CHARACTER PAIR
         --------.--------
         | physical count|       PHYSICAL RECORD LENGTH OF NEEDLE BODY
         -----------------

         NCNBody ::= [APPLICATION 1F] IMPLICIT SEQUENCE {



































    LOGII                       Logon Processing II                         108
    LOGII Logon Session                                         January 6, 1988


                4.10.4  NCN Body Message Objects


     MO #   INTERPRETATION
    -----   --------------

    MO-1D   ISIS Needle

            This MO is  a Sequence, comprised of  an RMO sequence  and SMO
            Set that form the needle data and is extracted in its entirety
            by the Node Code to form the ISIS Needle.  The ISIS Needle RMO
            Sequence contains the ISN  Dispatcher Sequence made up  of the
            intranode  circuit  and  auxiliary  circuits  indications, the
            invoice number, the  terminating host number,  the originating
            port number, and  possible shut override and  IIX indications.
            Following the ISN Dispatcher Sequence is the throughput class,
            the CCT, the username, the SDL, the originating node, host and
            port numbers, the originating host PID, circuit cost  and cost
            table indications.  The ISIS  Needle SMO Set may  contain: the
            RDA,  the   extension,  target  selection   and  qualification
            information, the  OADR, the sub  host number, the  IRC number,
            the  HDX  indication,  the  reverse  charge   indication,  the
            origination   IIX  indication,   and  the   transparent  logon
            indication.

            ISN [APPLICATION 1D] IMPLICIT SEQUENCE         {

                rMOSequence SEQUENCE {


























    LOGII                       Logon Processing II                         109
    LOGII Logon Session                                         January 6, 1988



            NCN Body Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-36   ISN Dispatcher Information Sequence

            This  sequence contains  the  data necessary  for  the circuit
            termination   Dispatcher  to   complete  the   logon   to  the
            destination interface.

            The Accounting Invoice Number is established by the Supervisor
            and is used by the terminating interface/Node  Code throughout
            the duration of the circuit session when generating accounting
            information relating to the circuit.

            The Terminating Host Number is the host number of  the circuit
            termination host and is  used by the terminating Node  Code to
            send the ISN to the proper host.

            The ISN  Flags are  used for any  binary indication  that will
            affect  the overall  interpretation of  the type  ISN message.
            There are  two bits used:  If bit 0  is set the  ISN is  for a
            circuit  between two  slots on  the same  node  (an intra-node
            circuit).   If  bit 1  is  set  the ISN  is  for  an auxiliary
            circuit.

            The Originating Port Number is put included in  the iSNDispSeq
            for use by the  Dispatcher to handle intra-node  circuits, and
            is also sent to the terminating interface.

            The  Shut  Override  Indication  indicates  that  the  user is
            capable of overriding shut terminating host  conditions.  This
            occurs  if  the  terminating  host,  as  determined  by Access
            Profiles  target selection,  is shut,  and the  Access Profile
            Entry for the target indicates that this Access  Profile Entry
            allows shut override.

            The  Origination  IIX   MO  indicates  that   the  originating
            interface  is  intelligent  interface  (IIX)  capable  and  is
            present  only  if  the  originating  interface  indicated  IIX
            capability  in its  circuit request  and the  Supervisor found
            that the terminating interface host is also IIX capable.









    LOGII                       Logon Processing II                         110
    LOGII Logon Session                                         January 6, 1988


                iSNDispSeq [APPLICATION 36] IMPLICIT SEQUENCE         {
                    invoiceNumber [APPLICATION 26] IMPLICIT OCTET STRING,
                    termHostNumber [APPLICATION 0D] IMPLICIT OCTET STRING,
                    iSNFlags [APPLICATION 1B] IMPLICIT BIT STRING {
                    intraNodeCir(0),auxCircuit(1)                 },
                    origPort [APPLICATION 1A] IMPLICIT OCTET STRING,
                    shutOverride [APPLICATION 2F] IMPLICIT BOOLEAN 
                                                  DEFAULT FALSE,
                    origIIX [APPLICATION 3] IMPLICIT BOOLEAN 
                                                  DEFAULT FALSE       },












































    LOGII                       Logon Processing II                         111
    LOGII Logon Session                                         January 6, 1988



            NCN Body Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-09   Throughput Class

            This  MO represents  the  requested throughput  class  for the
            circuit.  A value of 0 indicates a throughput class of 64 cps,
            value 1 indicates  160 cps, value 2  indicates 512 cps,  and a
            value  of  3  indicates   a  throughput  class  of   2048  cps
            (associated with the ^A, ^B, ^C, and ^D logon  request options
            respectively).   If no  throughput class  indication  is made,
            throughput class 0 (64 cps) is assumed default.

                tClass [APPLICATION 9] IMPLICIT INTEGER           {
                    cps64(0), cps160(1), cps512(2), cps2048(3)    },


    MO-02   CCT

            The  CCT element  represents the  Circuit  Characteristic Type
            which  is  requested  by the  circuit  originator.   Valid CCT
            values range from  00 to 1F  and no half-duplex  indication is
            contained within the CCT.

                cCT [APPLICATION 2] IMPLICIT OCTET STRING,


    MO-12   Username

            The  username element  contains the  interpreted  IA5 Username
            logon string  field.  The Username  used by the  Supervisor is
            contained in this  MO and may  be different from  the Username
            that  was  sent  to  the  Supervisor.   Inbound  usernames are
            subject  to  certain  translations,  as  described  in earlier
            portions of this document, and if a null username  was entered
            and the OADR was used  as a username, the OADR will  appear in
            this  MO.   The  username  MO  in  an  NCN  with  a  non-LOGII
            destination  will  contain  any  necessary  shut  override  or
            transparent logon  prefix, the  carriage return  or semi-colon
            username terminator, and  any necessary username  suffix, such
            as sub host number or target profile.

                userName [APPLICATION 12] IMPLICIT IA5,







    LOGII                       Logon Processing II                         112
    LOGII Logon Session                                         January 6, 1988



            NCN Body Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-17   Specified Destination List

            The SDL MO represents  a sequence of translated  IA5 Specified
            Destination List (SDL) items, the first item  representing the
            primary  destination,  and the  second  item  representing the
            ultimate  circuit destination.   Inbound SDLs  are  subject to
            certain translations  before they are  sent back out  with the
            CCN, as described in earlier portions of this document.

                specDestList [APPLICATION 17] IMPLICIT SEQUENCE OF
                                              destString IMPLICIT IA5,


    MO-2B   Originating Node Number

            The originating node  number is put  into the CCN  Needle Body
            set for transmission to the terminating interface.

                origNode [APPLICATION 2B] IMPLICIT OCTET STRING,


    MO-0E   Originating Host Number

            The originating host  number is put  into the CCN  Needle Body
            set for transmission to the terminating interface.

                origHostNumber [APPLICATION 0E] IMPLICIT OCTET STRING,




















    LOGII                       Logon Processing II                         113
    LOGII Logon Session                                         January 6, 1988



            NCN Body Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-42   PID of Originating Host

            This  MO  indicates  the Product  Identification  Code  of the
            circuit  origination, as  reported  to the  Supervisor  by the
            originating host.  The  current list of  PIDs may be  found at
            any time in the BASELINE file PRODID.DOC.

                origHostPID [APPLICATION 42] IMPLICIT OCTET STRING,


    MO-2D   Circuit Cost

            The  circuit cost  for  the circuit  path as  computed  by the
            Supervisor's pathfinding calculations, is included in  the CCN
            Needle Body set.

                circuitCost [APPLICATION 2D] IMPLICIT OCTET STRING,






























    LOGII                       Logon Processing II                         114
    LOGII Logon Session                                         January 6, 1988



            NCN Body Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-0A   Cost Table

            The  Cost  Table   MO  contains  a  code   representing  which
            Supervisor  cost  table  was used  to  compute  the  path, and
            defaults to a Batch throughput class of cps64 if  not present.
            The    code    indicates    which    throughput    class   and
            batch/interactive combination  was used for  cost computations
            during pathfinding.

            A - throughput class ^A (64d cps)    I - Interactive ^I
            B - throughput class ^B (160d cps)   V - Batch ^V
            C - throughput class ^C (512d cps)
            D - throughput class ^D (2048d cps)

            Value   Interpretation
            -----   --------------
              0         IA
              1         IB
              2         IC
              3         ID
              4         VA
              5         VB
              6         VC
              7         VD


                costTable [APPLICATION 0A] IMPLICIT INTEGER DEFAULT 0   {
                  cps64Int(0), cps160Int(1), cps512Int(2), cps2048Int(3),
                  cps64Bat(4), cps160Bat(5), cps512Bat(6), cps2048Bat(7)} }


















    LOGII                       Logon Processing II                         115
    LOGII Logon Session                                         January 6, 1988



            NCN Body Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------


                sMOSet Set {



    MO-18   Resultant Destination Address

            The  RDA element  contains the  Resultant  Destination Address
            that the  Supervisor may  use to lookup  a destination  in the
            MUD.  If the RDA MO is not present, this indicates  that there
            was  no  symbolic  MUD  destination  specification,  and since
            symbolic  addresses  are   not  currently  supported   in  MUD
            destination specifications, no RDA MOs are sent for now.

                resultDestAdr [APPLICATION 18] IMPLICIT IA5,


    MO-19   Extension

            The  Extension MO  contains the  translated IA5  logon request
            Extension field.   Inbound Extensions  are subject  to certain
            translations,  as  described  in  earlier  portions   of  this
            document.

                extension [APPLICATION 19] IMPLICIT IA5,


    MO-1C   Password

            The password MO contains the parsed IA5 logon request Password
            field  without  terminator.  This  MO  is included  only  if a
            transparent logon  indication is present,  and is sent  to the
            terminating  gateway  (presumably) interface  with  the needle
            body, for use with the other network logon. A null password is
            indicated by sending a  string containing only a  single ASCII
            NUL (00) character.

                password [APPLICATION 1C] IMPLICIT IA5,









    LOGII                       Logon Processing II                         116
    LOGII Logon Session                                         January 6, 1988



            NCN Body Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-15   Target Selection and Qualification

            The  Target Selection  and Qualification  MO is  a  Bit String
            which  utilizes  10  bits  to  indicate  information regarding
            Target Selection and Qualification.  The bits are set  for any
            and all of the  conditions that were encountered over  any and
            all  hosts that  were not  selected, causing  the redirection.
            Set bits are interpreted as follows:
                     Bit    Indication
                    -----   -------------------
                      0     Redirection due to host down.
                      1     Redirection due to host shut.
                      2     Redirection due to no such host.
                      3     Redirection due to no host ports.
                      4     Redirection due to reverse charge barred.
                      5     Redirection due to sent paid barred.
                      6     Redirection due to origination only host.
                      7     Redirection due to no network path to host.
                      8     Redirection due to systematic re-direction.
                            (Primary Username APE produced no
                            intersection with the Destination APEs).
                      9     Multiple target hosts were considered
                            in pathfinding.


                targSelectQual [APPLICATION 15] IMPLICIT BIT STRING  {
                    hostDown(0), hostShut(1), hostUnknown(2),
                    hostNoPorts(3),rCHGBarred(4), nonRCHGBarred(5),
                    hostOrigOnly(6),noPathToHost(7), systematic(8),
                    multiTargets(9)                                  },


    MO-07   Origination Address

            The OADR element  contains the IA5 Origination  Address string
            for the requesting port.

                origAddress [APPLICATION 7] IMPLICIT IA5,









    LOGII                       Logon Processing II                         117
    LOGII Logon Session                                         January 6, 1988



            NCN Body Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-30   Destination Sub-Host Number

            The  destination sub-host  number for  the  actual terminating
            interface host is  included in the CCN  Needle Body if  a sub-
            host number was present in the logon string destination field.

                subHost [APPLICATION 30] IMPLICIT OCTET STRING,


    MO-0C   IRC Number for the Username

            The IRC MO contains  the IRC group number associated  with the
            user placing the logon request.  The IRC group number  is part
            of the  user's MUD profile  and is used  by the  Supervisor to
            affect the path selected for the logon request.

                iRCNumber [APPLICATION 0C] IMPLICIT OCTET STRING,


    MO-48   Kernel Debug Access License

            The Kernel  debug access  license MO  indicates what  level of
            access privilege the username has when accessing the Skywalker
            Kernel for debug.  The MUD contains this information  for each
            username.  The  user may  have no  access to  Skywalker Kernel
            debug, no risk access which allows commands that cannot change
            the state of the system nor access network data,  read access,
            and write access.

                kernelAccLic [APPLICATION 48] IMPLICIT INTEGER DEFAULT 0 {
                    noAccess(0),noRiskAccess(1),
                    readAccess(2),writeAccess(3)                         },















    LOGII                       Logon Processing II                         118
    LOGII Logon Session                                         January 6, 1988



            NCN Body Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-49   Dispatcher/Alfred Debug Access License

            The Dispatcher/Alfred debug  access license MO  indicates what
            level of access privilege the username has when  accessing the
            Dispatcher  or  Alfred  for  debug.   The  MUD  contains  this
            information for each username.  The user may have no access to
            Dispatcher/Alfred debug, no risk access which  allows commands
            that cannot change the state of the system nor  access network
            data, read access, and write access.

                dispAlfAccLic [APPLICATION 49] IMPLICIT INTEGER DEFAULT 0 {
                    noAccess(0),noRiskAccess(1),
                    readAccess(2),writeAccess(3)                          },


    MO-4A   Slot Debug Access License

            The  Slot  debug access  license  MO indicates  what  level of
            access privilege  the username has  when accessing a  slot for
            debug.  The MUD  contains this information for  each username.
            The user  may have  no access  to slot  debug, no  risk access
            which  allows commands  that cannot  change the  state  of the
            system nor access network data, read access, and write access.

                slotAccLic [APPLICATION 4A] IMPLICIT INTEGER DEFAULT 0 {
                    noAccess(0),noRiskAccess(1),
                    readAccess(2),writeAccess(3)                       },


    MO-4B   Global Alfred Access License

            The GLobal  Alfred access license  MO indicates what  level of
            access  privilege  the  username  has  when  accessing  global
            Alfred.  The MUD contains this information for  each username.
            The user may have no  access to global Alfred, no  risk access
            which  allows commands  that cannot  change the  state  of the
            system nor access network data, read access, and write access.

                globAlfAccLic [APPLICATION 4B] IMPLICIT INTEGER DEFAULT 0 {
                    noAccess(0),noRiskAccess(1),
                    readAccess(2),writeAccess(3)                          },






    LOGII                       Logon Processing II                         119
    LOGII Logon Session                                         January 6, 1988



            NCN Body Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-0F   Half Duplex

            The  half-duplex   element  indicates   whether  or   not  the
            originating  port requested  a half-duplex  circuit.   This MO
            will be echoed by  the Supervisor in all response  messages if
            the  half-duplex indication  of either  form, is  sent  in the
            ICRM/ICRS request and if the terminating host is  IIX capable.
            This MO is echoed in the Supervisor's response to  prevent the
            interface  from having  to locally  interpret  the half-duplex
            indication, and instead leaves the discovery of the indication
            to  the  Supervisor,  which in  turn  informs  the originating
            interface of the duplex  status of the port, in  all responses
            the Supervisor sends for this logon session.

                halfDuplex [APPLICATION 0F] IMPLICIT BOOLEAN DEFAULT FALSE,


    MO-10   Reverse Charge Call Requested

            The reverse charge MO indicates that the originating interface
            requests  reverse  charging   for  the  logon  and   that  the
            Supervisor has found this request to be acceptable.

                rCHGRequest [APPLICATION 10]
                    IMPLICIT BOOLEAN DEFAULT FALSE,






















    LOGII                       Logon Processing II                         120
    LOGII Logon Session                                         January 6, 1988



            NCN Body Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-2E   Transparent Logon Indication

            The  transparent   logon  MO   indicates  that   the  username
            associated with this logon had a Transparent  Logon indication
            in  the  MUD.   This  indicates  to  T-II  Gateway terminating
            interfaces that  the logon string  is to be  passed on  in the
            same form, to the  next network.  If a password  was presented
            to  the Supervisor  and  the transparent  logon  indication is
            present, the password is sent out in the CCN for  inclusion in
            the  needle  body.   This  will  allow  the  TYMNET-II gateway
            interface to receive a password for its subsequent transparent
            logon in the next network, without prompting the user for one.

                transpLogon [APPLICATION 2E] IMPLICIT BOOLEAN 
                                             DEFAULT FALSE         } } }
































    LOGII                       Logon Processing II                         121
    LOGII Logon Session                                         January 6, 1988



         Node Code Needle - NCN
         Needle Tail - Indicates the end of the entire NCN, i.e the
         data that follows is circuit user data.

         Created by the originating Node Code and sent
         as user data on the newly built circuit
         following the needle body to the termination.

         The NCN tail is simply a control character pair with no
         other data.

         --------
         | 032B |  CONTROL CHARACTER PAIR
         --------







































    LOGII                       Logon Processing II                         122
    LOGII Logon Session                                         January 6, 1988


                       4.11  Logon Success Indication - LGSC


         The  Logon  Success   Indication  (LGSC)  is  generated   by  the
    originating  Node Code  in  response to  a Command  Channel  Needle to
    inform the originating ISIS and  interface of a successful logon  to a
    port.

         LGSC - Logon Success Indication, Rport Type 0C6

         Created by the originating Node Code from the CCN
         and sent to ISIS on the appropriate dispatcher port to
         inform the originating interface of a successful logon.

         .--------.--------.--------.--------.
         |      RPORT      |  0C6   |XS.....I|
         -------------------------------------
         |   message size  |   LGSC MOs.......
         -------------------------------------

         Where X = True indicates an incomplete message.
         Where S = True indicates a subsequent message in a partial
                   message sequence.
         Where I = True indicates an intra-node circuit.



         LGSC ::= [APPLICATION 01] IMPLICIT SEQUENCE {


























    LOGII                       Logon Processing II                         123
    LOGII Logon Session                                         January 6, 1988


                4.11.1  LGSC Required Message Objects


            rMOSequence SEQUENCE {


     MO #   INTERPRETATION
    -----   --------------

    MO-0E   Originating Host Number

            The Originating Host Number  is used by the interface  slot to
            identify the originating host of the circuit request.

            origHostNumber [APPLICATION 0E] IMPLICIT OCTET STRING,


    MO-26   Accounting Invoice Number

            The Accounting Invoice Number is established by the Supervisor
            and is used by the origination interface/Node  Code throughout
            the duration of the circuit session when generating accounting
            information relating to the circuit.

            invoiceNumber [APPLICATION 26] IMPLICIT OCTET STRING,


    MO-43   PID of the Terminating Host

            The  PID  of  the  Terminating  Host  indicates   the  Product
            Identification Code of the circuit termination, as reported to
            the Supervisor by the  terminating host.  The current  list of
            PIDs may be found at any time in the BASELINE file PRODID.DOC.

            termHostPID [APPLICATION 43] IMPLICIT OCTET STRING    }



















    LOGII                       Logon Processing II                         124
    LOGII Logon Session                                         January 6, 1988


                4.11.2  LGSC Supplemental Message Objects


            sMOSet SET {



     MO #   INTERPRETATION
    -----   --------------

    MO-2C   Non-LOGII Termination

            If  the circuit  terminating interface/ISIS/Node  Code  is not
            LOGII capable, the originating interface is informed  that any
            LOGII data not translatable  to an old style needle format was
            lost, although the 0310 needle was sent to build the circuit.

            termNonLOGII [APPLICATION 2C] IMPLICIT BOOLEAN 
                                          DEFAULT FALSE,


    MO-2F   Shut Override Indication

            The  Shut  Override  Indication  indicates  that  the  user is
            capable of overriding shut terminating host  conditions.  This
            occurs  if  the  terminating  host,  as  determined  by Access
            Profiles  target selection,  is shut,  and the  Access Profile
            Entry for the target indicates that this Access  Profile Entry
            allows shut override.

            shutOverride [APPLICATION 2F] IMPLICIT BOOLEAN 
                                          DEFAULT FALSE,


    MO-31   IIX Capable Termination

            If  the  circuit termination  is  intelligent  interface (IIX)
            capable as specified in the Supervisor's host table  entry for
            the terminating host, and the originating  interface indicated
            its  IIX  capability,   the  Supervisor  will   indicate  this
            condition in the CCN, to be sent to the originating interface.

            termIIX [APPLICATION 31] IMPLICIT BOOLEAN DEFAULT FALSE,











    LOGII                       Logon Processing II                         125
    LOGII Logon Session                                         January 6, 1988



            LGSC Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-13   UUN

            If  the UUN  was requested  in the  ICRM/ICRS,  the Supervisor
            returns  the UUN  for the  user making  the logon  request (as
            specified in  the MUD), to  the originating  interface  in the
            CCN, which is  sent to the  originating interface by  the Node
            Code in a LGSC.

            uUN [APPLICATION 13] IMPLICIT OCTET STRING    }    }






































    LOGII                       Logon Processing II                         126
    LOGII Logon Session                                         January 6, 1988


                              4.12  ISIS Needle - ISN


         The ISIS Needle is constructed by the terminating Node Code based
    upon  the  received  network  needle  (old  style  0310  prefixed with
    translation bit set,  or new three  portion 0329, 032A,  032B prefixed
    NCN).  The ISN is sent  on an unassigned Node Code dispatcher  port to
    ISIS for circuit completion to the desired interface slot, and  may be
    sent as more than one message to avoid any limitations on  the overall
    message  size.   The  first  RMO present  contains  the  data  that is
    pertinent to the Dispatcher.

         If this ISN is for an intra-node circuit, the Node Code  must not
    split the ISN message into multiple data transfer pieces.  Instead the
    ISN is sent  in a single transfer,  regardless of the size  of message
    and the continuation message rules.  If the Dispatcher  cannot deliver
    the ISN to the  slot due to the actual  size of the slot's  ring being
    too small, then the circuit will be zapped.  If the  Dispatcher cannot
    deliver the  message to  the slot due  to a  currently busy  ring, the
    Dispatcher will buffer the message until ring space is made available.

         ISIS Needle - ISN - 0C2

         Created by the terminating Node Code from the Node Code
         Needle (NCN or old style 0310 needle) and sent to ISIS on
         an available dispatcher port to complete the circuit to the
         terminating interface.

         .--------.--------.--------.--------.
         |      RPORT      |  0C2   |XS.....I|
         -------------------------------------
         |   message size  |ISIS internal use|
         -------------------------------------
         |   ISN MOs.......
         ------------------

         The 16 bit field following the message size is
         reserved for ISIS internal use in handling intra-node circuits.

         Where X = True indicates an incomplete message.
         Where S = True indicates a subsequent message in a partial
                   message sequence.
         Where I = True indicates an intra-node circuit.



         ISN ::= [APPLICATION 1D] IMPLICIT SEQUENCE {







    LOGII                       Logon Processing II                         127
    LOGII Logon Session                                         January 6, 1988


                4.12.1  ISN Required Message Objects


            rMOSequence SEQUENCE {


     MO #   INTERPRETATION
    -----   --------------

    MO-36   ISN Dispatcher Information Sequence

            This  sequence contains  the  data necessary  for  the circuit
            termination   Dispatcher  to   complete  the   logon   to  the
            destination interface.

            The Accounting Invoice Number is established by the Supervisor
            and is used by the terminating interface/Node  Code throughout
            the duration of the circuit session when generating accounting
            information relating to the circuit.

            The Terminating Host Number is the host number of  the circuit
            termination host and is  used by the terminating Node  Code to
            send the ISN to the proper host.

            The ISN  Flags are  used for any  binary indication  that will
            affect  the overall  interpretation of  the type  ISN message.
            There are  two bits used:  If bit 0  is set the  ISN is  for a
            circuit  between two  slots on  the same  node  (an intra-node
            circuit).   If  bit 1  is  set  the ISN  is  for  an auxiliary
            circuit.

            The Originating Port Number is put included in  the iSNDispSeq
            for use by the  Dispatcher to handle intra-node  circuits, and
            is also sent to the terminating interface.

            The  Shut  Override  Indication  indicates  that  the  user is
            capable of overriding shut terminating host  conditions.  This
            occurs  if  the  terminating  host,  as  determined  by Access
            Profiles  target selection,  is shut,  and the  Access Profile
            Entry for the target indicates that this Access  Profile Entry
            allows shut override.

            The  Origination  IIX   MO  indicates  that   the  originating
            interface  is  intelligent  interface  (IIX)  capable  and  is
            present  only  if  the  originating  interface  indicated  IIX
            capability  in its  circuit request  and the  Supervisor found
            that the terminating interface host is also IIX capable.







    LOGII                       Logon Processing II                         128
    LOGII Logon Session                                         January 6, 1988


            iSNDispSeq [APPLICATION 36] IMPLICIT SEQUENCE         {
                invoiceNumber [APPLICATION 26] IMPLICIT OCTET STRING,
                termHostNumber [APPLICATION 0D] IMPLICIT OCTET STRING,
                iSNFlags [APPLICATION 1B] IMPLICIT BIT STRING {
                intraNodeCir(0),auxCircuit(1)                 },
                origPort [APPLICATION 1A] IMPLICIT OCTET STRING,
                shutOverride [APPLICATION 2F] IMPLICIT BOOLEAN 
                                              DEFAULT FALSE,
                origIIX [APPLICATION 3] IMPLICIT BOOLEAN 
                                              DEFAULT FALSE       },












































    LOGII                       Logon Processing II                         129
    LOGII Logon Session                                         January 6, 1988



            ISN Required Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-09   Throughput Class

            This  SMO represents  the requested  throughput class  for the
            circuit.  A value of 0 indicates a throughput class of 64 cps,
            value 1 indicates  160 cps, value 2  indicates 512 cps,  and a
            value  of  3  indicates   a  throughput  class  of   2048  cps
            (associated with the ^A, ^B, ^C, and ^D logon  request options
            respectively).   If no  throughput class  indication  is made,
            throughput class 0 (64 cps) is assumed default.

            tClass [APPLICATION 9] IMPLICIT INTEGER           {
                cps64(0), cps160(1), cps512(2), cps2048(3)    },


    MO-02   CCT

            The  CCT element  represents the  Circuit  Characteristic Type
            which  is  requested  by the  circuit  originator.   Valid CCT
            values range from  00 to 1F  and no half-duplex  indication is
            contained within the CCT.

            cCT [APPLICATION 2] IMPLICIT OCTET STRING,


    MO-12   Username

            This  element  contains  the  interpreted  IA5  Username logon
            string  field.   The  Username  used  by  the   Supervisor  is
            contained in the  SMO and may  be different from  the Username
            that  was  sent  to  the  Supervisor.   Inbound  usernames are
            subject  to  certain  translations,  as  described  in earlier
            portions of this document, and if a null username  was entered
            and the OADR was used  as a username, the OADR will  appear in
            this  SMO.   The  username  MO  in  an  ISN  with  a non-LOGII
            destination  will  contain  any  necessary  shut  override  or
            transparent logon  prefix, the  carriage return  or semi-colon
            username terminator, and  any necessary username  suffix, such
            as sub host number or target profile.

            userName [APPLICATION 12] IMPLICIT IA5,







    LOGII                       Logon Processing II                         130
    LOGII Logon Session                                         January 6, 1988



            ISN Required Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-17   Specified Destination List

            This  SMO represents  a sequence  of translated  IA5 Specified
            Destination List (SDL) items, the first item  representing the
            primary  destination,  and the  second  item  representing the
            ultimate  circuit destination.   Inbound SDLs  are  subject to
            certain translations, as described in earlier portions of this
            document.

            specDestList [APPLICATION 17] IMPLICIT SEQUENCE OF
                                          destString IMPLICIT IA5,


    MO-2B   Originating Node Number

            This SMO represents the requesting node number.

            origNode [APPLICATION 2B] IMPLICIT OCTET STRING,


    MO-0E   Originating Host Number

            This element  represents the Originating  Host Number  for the
            interface that is requesting the circuit.

            origHostNumber [APPLICATION 0E] IMPLICIT OCTET STRING,


    MO-42   PID of Originating Host

            This  MO  indicates  the Product  Identification  Code  of the
            circuit  origination, as  reported  to the  Supervisor  by the
            originating host.  The  current list of  PIDs may be  found at
            any time in the BASELINE file PRODID.DOC.

            origHostPID [APPLICATION 42] IMPLICIT OCTET STRING,











    LOGII                       Logon Processing II                         131
    LOGII Logon Session                                         January 6, 1988



            ISN Required Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-2D   Circuit Cost

            This RMO contains the circuit cost for the circuit as computed
            by the Supervisor's pathfinding calculations.

            circuitCost [APPLICATION 2D] IMPLICIT OCTET STRING,


    MO-0A   Cost Table

            This integer SMO contains a code representing which Supervisor
            cost table  was used to  compute the path,  and defaults  to a
            Batch  throughput class  of cps64  if not  present.   The code
            indicates   which  throughput   class   and  batch/interactive
            combination was used for cost computations during pathfinding.

            A - throughput class ^A (64d cps)    I - Interactive ^I
            B - throughput class ^B (160d cps)   V - Batch ^V
            C - throughput class ^C (512d cps)
            D - throughput class ^D (2048d cps)

            Value   Interpretation
            -----   --------------
              0         IA
              1         IB
              2         IC
              3         ID
              4         VA
              5         VB
              6         VC
              7         VD


            costTable [APPLICATION 0A] IMPLICIT INTEGER DEFAULT 0   {
                cps64Int(0), cps160Int(1), cps512Int(2), cps2048Int(3),
                cps64Bat(4), cps160Bat(5), cps512Bat(6), cps2048Bat(7)} }











    LOGII                       Logon Processing II                         132
    LOGII Logon Session                                         January 6, 1988


                4.12.2  ISN Supplemental Message Objects


            sMOSet SET {



     MO #   INTERPRETATION
    -----   --------------

    MO-18   Resultant Destination Address

            This element contains  the Resultant Destination  Address that
            the Supervisor may use to lookup a destination in the MUD.  If
            the RDA SMO is not  present, this indicates that there  was no
            symbolic  MUD  destination specification,  and  since symbolic
            addresses  are  not  currently  supported  in  MUD destination
            specifications, no RDA SMOs are sent for now.

            resultDestAdr [APPLICATION 18] IMPLICIT IA5,


    MO-19   Extension

            This SMO contains  the translated IA5 logon  request Extension
            field.    Inbound   Extensions   are   subject    to   certain
            translations,  as  described  in  earlier  portions   of  this
            document.

            extension [APPLICATION 19] IMPLICIT IA5,


    MO-1C   Password

            The  password  RMO  contains  the  parsed  IA5  logon  request
            Password field without  terminator.  This MO is  included only
            if a transparent logon  indication is present, and is  sent to
            the terminating gateway (presumably) interface with the needle
            body, for use with the other network logon. A null password is
            indicated by sending a  string containing only a  single ASCII
            NUL (00) character.

            password [APPLICATION 1C] IMPLICIT IA5,











    LOGII                       Logon Processing II                         133
    LOGII Logon Session                                         January 6, 1988



            ISN Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-15   Target Selection and Qualification

            This SMO is  a Bit String which  utilizes 10 bits  to indicate
            information regarding Target Selection and Qualification.  The
            bits  are set  for any  and all  of the  conditions  that were
            encountered over  any and  all hosts  that were  not selected,
            causing the redirection.  Set bits are interpreted as follows:
                     Bit    Indication
                    -----   -------------------
                      0     Redirection due to host down.
                      1     Redirection due to host shut.
                      2     Redirection due to no such host.
                      3     Redirection due to no host ports.
                      4     Redirection due to reverse charge barred.
                      5     Redirection due to sent paid barred.
                      6     Redirection due to origination only host.
                      7     Redirection due to no network path to host.
                      8     Redirection due to systematic re-direction.
                            (Primary Username APE produced no
                            intersection with the Destination APEs).
                      9     Multiple target hosts were considered
                            in pathfinding.


            targSelectQual [APPLICATION 15] IMPLICIT BIT STRING {
                hostDown(0), hostShut(1), hostUnknown(2), hostNoPorts(3),
                rCHGBarred(4), nonRCHGBarred(5), hostOrigOnly(6),
                noPathToHost(7), systematic(8), multiTargets(9) },



















    LOGII                       Logon Processing II                         134
    LOGII Logon Session                                         January 6, 1988



            ISN Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-07   Origination Address

            This element contains  the IA5 Origination Address  string for
            the requesting port.

            origAddress [APPLICATION 7] IMPLICIT IA5,


    MO-30   Destination Sub-Host Number

            This  element  contains the  Destination  Sub-Host  Number, if
            present in the logon string destination field.

            subHost [APPLICATION 30] IMPLICIT OCTET STRING,


    MO-0C   IRC Number for the Username

            This SMO  contains the  IRC group  number associated  with the
            user placing the logon request.  The IRC group number  is part
            of the  user's MUD profile  and is used  by the  Supervisor to
            affect the path selected for the logon request.

            iRCNumber [APPLICATION 0C] IMPLICIT OCTET STRING,


    MO-0F   Half Duplex

            This  element indicates  whether or  not the  originating port
            requested a half-duplex circuit.   This SMO will be  echoed by
            the  Supervisor in  all response  messages if  the half-duplex
            indication of either form,  is sent in the  ICRM/ICRS request.
            This SMO is  echoed in the  response to prevent  the interface
            from having to  locally interpret the  half-duplex indication,
            and  instead leaves  the discovery  of the  indication  to the
            Supervisor, which in turn informs the originating interface of
            the duplex status of the port, in all responses the Supervisor
            sends for this logon session.

            halfDuplex [APPLICATION 0F] IMPLICIT BOOLEAN DEFAULT FALSE,







    LOGII                       Logon Processing II                         135
    LOGII Logon Session                                         January 6, 1988



            ISN Supplemental Message Objects (continued)


     MO #   INTERPRETATION
    -----   --------------

    MO-10   Reverse Charge Call Requested

            This  SMO indicates  that the  originating  interface requests
            reverse  charging  for  the  circuit  request  and   that  the
            Supervisor has found this request to be acceptable.

            rCHGRequest [APPLICATION 10] IMPLICIT BOOLEAN DEFAULT FALSE,


    MO-2E   Transparent Logon Indication

            This  SMO indicates  that  the username  associated  with this
            logon had  a Transparent  Logon indication  in the  MUD.  This
            indicates  to  T-II Gateway  terminating  interfaces  that the
            logon string is to be passed on in the same form, to  the next
            network.

            transpLogon [APPLICATION 2E] IMPLICIT BOOLEAN
                                         DEFAULT FALSE       } }




























    LOGII                       Logon Processing II                         136
    LOGII Error Log Messages                                    January 6, 1988






                           5 -  LOGII Error Log Messages


         Error  Log  message  450  is  reserved  for  any   LOGII  related
    Supervisor log error indications, such as required MOs not present, or
    X.409 format errors.  Although the final form and variety of errors is
    not yet finalized,  it is anticipated that  the message will  take the
    following form:


    ERROR LOG MESSAGE 450, TMCS EVENT CODE 138

    +----------------+----------------+
    |   NODE NUMBER  |  PORT NUMBER   |
    +----------------+----------------+
    |OFFSET TO ERROR |ERROR INDICATION|
    +----------------+----------------+


         NODE NUMBER - is the node number of the node sending  the problem
    LOGII message.

         PORT NUMBER - is the port number of the port sending  the problem
    LOGII message.

         OFFSET  TO ERROR  - is  the byte  offset of  the  error condition
    within the LOGII message.

         ERROR INDICATION  - is a  code representing the  particular LOGII
    message error.  Error indication interpretation is as follows:

                    CODE    INTERPRETATION
                    ----    --------------

















    LOGII                       Logon Processing II                         137
    LOGII related Accounting Data                               January 6, 1988






                        6 -  LOGII related Accounting Data


         There is new logon related data provided by the LOGII design that
    is pertinent to  Accounting, such as  the Origination Address  and the
    Reverse Charge  indication.  Essentially, any  MO that is  appended to
    the  Command  Channel  Needle  could  potentially  be  of  interest to
    Accounting.  Such items include CCT, IIX, Cost Table and  Circuit Cost
    information, Circuit path node list, and others.  most of  these items
    are already  present in the  current Accounting messages,  though some
    are not.

         The Supervisor  adds the  LOGII CCN  MO data  of interest  to the
    Accounting Preamble  in a  new Accounting message,  Type 4,  Subtype 7
    (LOGII needle MO data).  For Accounting file storage reasons, the only
    MOs the Supervisor will send with  the Type 4.7 will be the  OADR (MO-
    07),  the  Reverse  Charge  indication  (MO-10),  and   the  Specified
    Destination List  (MO-17).  The  Accounting processing  programs (RAM)
    will recognize these, but allow other MOs of proper form to  be simply
    ignored,  perhaps with  some informative  operator  indications.  This
    will allow other MOs  to be included with  the Type 4.7 in  the future
    for permanent use or temporary testing, without impacting  any current
    Accounting file processing programs.

         It  would  also  be  possible,  in  the  future,  to  migrate the
    Accounting protocol to utilize more CCN MOs to form some or all of the
    remaining Type 4.x subtype's current information, and even the  Type 1
    IRC information, and the Types  2, 3 and 5 preamble data.   This would
    take advantage of the efficient, flexible and expandable nature of the
    MO  message  structure,  and  would  relieve  the  Supervisor  of  any
    translation and interpretation of this data that is necessary only for
    Accounting.

         Type 4.7 messages are  deposited in the Accounting stream  by the
    Supervisor  in a  contiguous  series, each  message  simply containing
    three octets from  the X.409 MO list  being entered to  the accounting
    4.7 records.  The X.409 standard MO data elements define the length of
    each entry, so  no byte count  or end marker  is used to  indicate how
    many type 4.7 Accounting messages comprise the series.  When there are
    no more type 4.7 messages  left, the X.409/MO messages should  also be
    complete, otherwise an  invalid Accounting message format  is present,
    and should  be reported by  the Accounting processing  programs (RAM).
    If the X.409  message stream does not  fill an integral number  of 4.7
    messages, any remaining message 4.7 fields are padded zeroes.






    LOGII                       Logon Processing II                         138
    LOGII related Accounting Data                               January 6, 1988



         Type 4.7 -- LOGII Needle MO Data

    --.-.-.-.-.-.-.-:-.-.-.-.-.-.-.-:-.-.-.-.-.-.-.-:-.-.-.-.-.-.-.--
    |   4   |   7   |        3 octets of Accounting MO data         |
    --.-.-.-.-.-.-.-:-.-.-.-.-.-.-.-:-.-.-.-.-.-.-.-:-.-.-.-.-.-.-.--


         Currently, the only  MOs that will be  present with the  Type 4.7
    will be the OADR  (MO-07), the Reverse Charge indication  (MO-10), and
    the Specified Destination List (MO-17).  The CCN MO item list entries,
    their structure and interpretation,  are documented in this GED,  in a
    previous  section.   The  Accounting  processing  programs  (RAM) will
    recognize  these, but  simply  ignore other  MOs of  proper  form.  An
    example is shown for a 4.7 message construction for a  circuit request
    indicating an  OADR of "31064084467667",  requesting a  reverse charge
    call,  and  specifying an  SDL  of two  destination  items  "4242" and
    "HOST33".

    Breakdown of the MO into octet strings:

    OADR "31064084467667"  origAddress [APPLICATION 7] IMPLICIT IA5

          47               0E             3331303634303834343637363637
    APPLICATION WIDE,    LENGTH                       DATA
    PRIMITIVE ID 7

    RCHG REQUESTED
    rCHGRequest [APPLICATION 10] IMPLICIT BOOLEAN DEFAULT FALSE

          50               01                     FF
    APPLICATION WIDE,    LENGTH                  DATA
    PRIMITIVE ID 10


    SDL "4242", "HOST33"
    specDestList [APPLICATION 17] IMPLICIT SEQUENCE OF
                                  destString IMPLICIT IA5

          77               0C
    APPLICATION WIDE,    LENGTH
    CONSTRUCTOR ID 17

                           04                  34323432
                         LENGTH                  DATA

                           06                484F53543333
                         LENGTH                  DATA






    LOGII                       Logon Processing II                         139
    LOGII related Accounting Data                               January 6, 1988



    Converting the X.409 octet stream into a
    series of type 4.7 Accounting Messages:
    21x octets requires 0B 4.7 messages in the series.

         Type 4.7 -- LOGII Needle MO Data

    --.-.-.-.-.-.-.-:-.-.-.-.-.-.-.-:-.-.-.-.-.-.-.-:-.-.-.-.-.-.-.--
    |   4   |   7   |                  470E33                       |
    |   4   |   7   |                  313036                       |
    |   4   |   7   |                  343038                       |
    |   4   |   7   |                  343436                       |
    |   4   |   7   |                  373636                       |
    |   4   |   7   |                  375001                       |
    |   4   |   7   |                  FF770C                       |
    |   4   |   7   |                  043432                       |
    |   4   |   7   |                  343206                       |
    |   4   |   7   |                  484F53                       |
    |   4   |   7   |                  543333                       |
    --.-.-.-.-.-.-.-:-.-.-.-.-.-.-.-:-.-.-.-.-.-.-.-:-.-.-.-.-.-.-.--


































    LOGII                       Logon Processing II                         140
    X.409 Tutorial                                              January 6, 1988






                                7 -  X.409 Tutorial


         This  draft  has  been  provided  by  Richard  Rawson,  and  this
    disclaimer is included upon his request.  This appendix section is not
    complete may require revisions and corrections.

         CCITT Recommendation  X.409 defines a  set of rules  for encoding
    digital messages  as a  sequence of bytes.   (The CCITT  documents use
    'octet' rather  than 'byte';  bytes will  be used  in this  section as
    throughout  this  document).   This is  in  contrast  to  the familiar
    alternative method of encoding messages as bits and bit  fields within
    a more-or-less  fixed length  block of bytes  or words.   The official
    documentation, Recommendation X.409, is very difficult reading and the
    following  article  is  an  introduction,  to  help  get  you  started
    understanding X.409.   It is not  complete; you will  need to  use the
    X.409 document to  learn all the details  when you implement  an X.409
    protocol.

         X.409  brings  some  important benefits  to  Tymnet,  in  that it
    addresses  several  technical  issues  that  we  now  recognize  to be
    important.   Most of  all,  it becomes  easier to  develop  and deploy
    network changes.  However, there are some drawbacks: X.409 is  new and
    strange, and messages usually are larger than they might have been.

         The major parts of X.409 are:

            - the Standard Representation which is the binary
              information that is sent between two parties
              that are using an X.409 protocol.  It comprises:

              o The rules for constructing messages as strings of bytes
              o The specific type and value codes placed in messages

            - Standard Notation for describing X.409 protocols.
              The Standard Notation is used in documentation to provide
              a human-readable specification, in place of the (binary)
              Standard Representation.  This Standard Notation looks
              rather like type or variable declarations in some strange
              higher-level programming language.  Indeed, X.409 is like
              a highly typed programming language.









    LOGII                       Logon Processing II                         141
    X.409 Tutorial                                              January 6, 1988


         Here are  examples to show  the distinction between  the Standard
    Representation and the Standard Notation.

         An example of  the Standard Representation is  "0x 16 02  48 69".
    It represents  the two  IA5 (i.e., Ascii)  characters "Hi".   They are
    preceeded by 16,  which says that this  is a character string,  and by
    02, its length in bytes.



         An example of the Standard Notation is:

      userName [APPLICATION 12] IMPLICIT IA5.



         It declares that an element of type 'userName' will be identified
    by the application-specific type code 12, and that the contents of the
    element is implicitly an IA5 string.  (That is, IMPLICIT says that the
    contents will be in the format of an IA5 string, but there won't be an
    additional descriptor of type IA5.)






                         7.1  The Standard Representation


         The Standard  Representation means the  bytes that are  sent from
    one place to another.  It may be helpful to remember it  "the (binary)
    Standard   Representation."  That's   not  to   suggest   there's  any
    alternative to "binary."

         The X.409 recommendation  actually discusses "data  elements" not
    messages (or just "element" for short).  That is, X.409 really doesn't
    talk about what the data elements are being used for.  For the rest of
    this explanation, assume that a LOG II message has a single X.409 data
    element.

         However, data elements can  be nested within data  elements: this
    is a crucial part of X.409.  A "primitive" element is an atomic value,
    such as a  number or a string  of characters, with no  elements nested
    inside.  A  "constructor" element, in  contrast, contains one  or more
    elements  within  it.  Each  of  these inner  elements  can  be either
    primitive or constructor, and so on.







    LOGII                       Logon Processing II                         142
    X.409 Tutorial                                              January 6, 1988


         So  while a  LOG II  message has  a single  data  element, that's
    usually a constructor element, and there are often many other elements
    contained inside the message.

         An element has three parts:

            - identifier (one or more bytes)
            - length (one or more bytes)
            - contents (zero or more bytes)

    ________________________________________________________________
    |              |          |                                    |
    |  identifier  |  length  |  contents                          |
    |______________|__________|____________________________________|






                7.1.1  Identifier

         The identifier specifies three attributes of the element:

            - form (primitive, constructor)
            - class (universal, application-wide,
                     context-specific, private-use)
            - ID code (numeric)


         The  "form" indicates  whether the  contents is  structured.  The
    distinction  between primitive  and constructor  is the  one described
    earlier.

         The "class" selects  one of four ways  to interpret the  ID code.
    In  LOG II,  we will  use  only two  of these  classes:  universal and
    application-wide.

         ID Codes for the universal class are defined in sections 5  and 6
    of  the  X.409  recommendation  itself;  these  are  generally useful,
    application-independent   data   types.   Examples   are   boolean  (a
    primitive), and sequence (a constructor).  "Application-wide" ID codes
    are peculiar to  a particular application.  Context-specific  ID codes
    are peculiar  to a  certain context  within a  particular application.
    Identifiers are assigned so as to be distinct only within that limited
    context.  Private-use types "are reserved for private use";  the CCITT
    says nothing about the assignment of private-use ID codes.

         The ID Code is simply a number that distinguishes  one identifier
    from another of the same class.  The ID Code can be  arbitrarly large,
    but if the value is 30 or less, then the entire identifer fits  in one
    byte.  Otherwise, the field spills into one or more  additional bytes.
    See X.409 Section 3.1 for exactly how this works.

    LOGII                       Logon Processing II                         143
    X.409 Tutorial                                              January 6, 1988


                7.1.2  Length

         The "length" specifies the length in bytes of the  contents.  The
    length itself  occupies a  variable number  of bytes.   It has  one of
    three forms: short, long, or indefinite.

         The short form encodes  lengths from zero through 127,  using one
    byte.  These are easy for us to read:  09 really does mean a length of
    9.

         The long  form encodes  lengths from 128  through (2**1008  - 1),
    using a  variable number (2  to 127) of  bytes to contain  the length.
    The first byte indicates  the number of following bytes  which contain
    the actual length value.  The first byte is in essence the  "length of
    the length".   The remaining  bytes of  length represent  the absolute
    value (no sign bit) length of the X.409 element.

         The indefinite form  can be used only  if the element is  of form
    constructor.  It has the value 0x80.  When it is used, a  special end-
    of-contents element terminates the contents.  LOGII uses no indefinite
    forms of length.





                7.1.3  Contents

         The  contents contains  the  primary information  the  element is
    intended to convey.  Remember that the element has two possible forms:
    primitive and constructor.

         In a constructor element, the contents are zero or more elements,
    with each element having its own identifier, length, and contents.  In
    a  primitive  element,  the  contents  are  anything   except  further
    elements.


















    LOGII                       Logon Processing II                         144
    X.409 Tutorial                                              January 6, 1988


         The so-called primitive elements can have very elaborate contents
    if you like.  The only  thing primitive about them is that  they don't
    contain nested  elements.  Some of  the primitive elements  that X.409
    defines are:

        null
        boolean
        videotex string
        utc time
        printable string






                7.1.4  Example Elements

         Here are some simple examples of elements.

            The string "Hi":  0x 16 02 48 69

        where:  16    is the identifier for IA5 string (ascii)
                02    is the length, 2 bytes
                4869  are the character codes themselves

            LOGII Originating Node Number of 0x7777;
        X.409 representation:  5F 2B 02 77 77

        Where:  5F2B  is the identifier.  Note:   5F = 01 0 11111
                5F
                    01    means application-wide
                    0     means primitive
                    11111 means that the ID code is in the following byte
                2B  means Orig. Node Number (in the LOGII application)
                02  is the length, 2 bytes
                7777 is the actual Originating Node Number.


         Note that this type, 2B, is an Implicit Octet String, but only by
    convention  within  the  LOGII  application.   The  element  does  not
    explicitly say that the content is an octet string.












    LOGII                       Logon Processing II                         145
    X.409 Tutorial                                              January 6, 1988


                            7.2  The Standard Notation


         The Standard Notation is intended for describing X.409 protocols.
    It is used in documentation to provide a human-readable specification,
    in place of the (binary) Standard Representation.

         This  Standard  Notation  looks  rather  like  type  or  variable
    declarations in some  strange higher-level programming  language.  The
    Standard Notation  is defined using  BNF:  Backus-Naur Form.   (BNF is
    widely used for defining programming language syntax.)

         Standard Notation is used for the following purposes:

            Type definition:
            specifying a name for a type,
            and describing how values of that type will be coded in binary
            (in the type's Standard Representation).

            Value definition:
            specifying a nickname for a value that is already defined.

            Macro definition:
            defining types or values in a non-standard way.

            Module definition:
            grouping type, value, and macro definitions together,
            and giving them a name.


























    LOGII                       Logon Processing II                         146
    X.409 Tutorial                                              January 6, 1988


                7.2.1  Type Definition

         Out  of the  above list,  the LOGII  documentation uses  only the
    first kind  of definition:   type definition.  Let's  look at  it more
    closely.

         A new  type can  be defined in  terms of  an existing  type.  The
    result is a Defined Type.  This process starts with a set  of Built-in
    Types, described in words in X.409,  Chapter 5.  So a new type  can be
    defined in terms of a Built-in Type, or in terms of some other Defined
    Type.

         The example in X.409, section 4.2, is:

            PrimaryColor ::=  INTEGER { red(0), yellow(1), blue(2) }

            This tells you all of the following:

            An element of type PrimaryColor encodes a choice only three
            values.  For example, there is no way to express orange
            (No, you cannot use 0.5).

            The value 0 encodes red, the value 1 encodes yellow,
            and 2 encodes blue.

            The value (0, 1, or 2) is an INTEGER, whatever that is.


         In fact, the example does not tell you what an INTEGER  is.  That
    happens  to  be  a  forward reference.   In  chapter  5  of  the X.409
    recommendation, we find the "Built-in Types" one of which  is INTEGER.
    We need this  information to finish  understanding how the  element in
    our example would be expressed as a byte stream:

            Its Identifier has:

            - a class of universal (it is defined right here in X.409)
            - a form of primitive (there are no nested elements)
            - an ID Code of 2















    LOGII                       Logon Processing II                         147
    X.409 Tutorial                                              January 6, 1988


         Its  Contents are  encoded as  a twos  complement  binary number,
    using the fewest  possible bytes.  (Leading  zero bytes of  a positive
    number must be omitted; leading FF bytes of a negative number likewise
    must be omitted.) Now we can express blue as an X.409 element  of type
    PrimaryColor:

            02 01 02, where:

            02 is the Identifier.  Note that 02 (hex) = 00 0 00010 (binary).
            The class Universal is encoded as 00.
            The form Primitive is encoded as 0.
            The ID Code is 00010, or 2:  an INTEGER.
            01 is the Length of the contents, one byte.
            02 is the value defined as encoding the PrimaryColor, Blue.






                7.2.2  Built-in Types

         The Recommendation defines ten Built-In types, out of which other
    types can be defined.  It is useful to separate these into groups:

           Primitive elements:  Boolean, Integer, BitString, OctetString,
           Null.
           Constructor elements:  Sequence, Set.
           Notation for creating new types:  Tagged.
           Miscellaneous:  Choice, Any


         For  each  of  these types,  the  Recommendation  gives  both the
    Standard Notation and the Standard Representation.  Here, we will just
    introduce  the  various  Primitive  and  Constructor  element Built-in
    Types.



    7.2.2.1  Primitive Elements Built-in Types

         These  are  the  Built-in  Types  that  name  primitive elements.
    Eventually,  almost everything  gets  expressed in  these  terms.  For
    example, an IA5String is defined (in Chapter 6) to be  an OctetString,
    with the restriction that each  byte (octet) is a code defined  in IA5
    (International Alphabet 5).  Another method is to use  the constructor
    types we discuss later to make sequences or sets of other types.

         Boolean:  This element means either TRUE or FALSE, as you expect.

         Integer:   An   Integer  element  represents   arbitrarily  large
    positive or negative integers.  (While  there is a limit, it is  of no


    LOGII                       Logon Processing II                         148
    X.409 Tutorial                                              January 6, 1988


    practical  consequence.)  The  Integer element  utilizes  a  "sign bit
    extension" philosophy.  Therefore any number that contains a True most
    significant bit  is considered  negative.  A high  order zero  byte is
    included to  indicate positive numbers  when representing  values from
    128-255, 32768-65535 and so on.

         BitString: A BitString element represents an ordered set  of zero
    or  more bits.   Note that  you  can tell  exactly how  many  bits are
    represented, and  the number need  not be a  multiple of 8.   There is
    also  provision for  creating a  single BitString  gradually;  you can
    start sending segments of the string before you know how long  it will
    be in total.

         OctetString: This is like the BitString, except that  it contains
    some  multiple  of  8  bits.   An  OctetString  can  also  be  created
    gradually, as mentioned above.

         Null: This represents a  valueless placeholder.  We can  use Null
    instead of reserving an unlikely value for representing "undefined" or
    "missing" (a person's age, a pointer, etc.)



    7.2.2.2  Constructor Elements Built-in Types

         These elements contain combinations (possibly empty) of elements.
    Ordering is considered significant for a Sequence, but not for a Set.

         Sequence: A Sequence  represents an ordered  set of zero  or more
    values.   For  example,  the LOGII  Early  Circuit  Reject  Message is
    defined as (simplified!):

           ... SEQUENCE { RMOSEQUENCE, SMOSET }


         Set: A Set  represents an unordered set  of zero or  more values.
    For example, in the  definition just above, RMOSEQUENCE is  defined as
    (still simplified):

       ... SEQUENCE { ECRIFLAGS, DISPATCHERKEY, LOCALKEY }














    LOGII                       Logon Processing II                         149
    Example of X.409 Type Representation Interpretation         January 6, 1988






             8 -  Example of X.409 Type Representation Interpretation


         This  appendix illustrates  the octet  expansion of  an exemplary
    ICRM message.  All numbers are specified in hexadecimal.  This  is not
    meant to be an X.409  tutorial, simply an illustration of some  of the
    X.409 usages defined  in this document.  The  exemplary ICRM is  for a
    normal circuit, with  a dispatcher key of  7777, a local key  of 9999,
    origination host 22,  CCT of 4, username  of "OSERANG", two  SDL items
    "4242"  and "HOST33",  an origination  address of  "31064084467667", a
    requested throughput of 128cps, and requesting reverse call charging.

    X.409 TYPE REPRESENTATION FOR THE EXEMPLARY ICRM

    ICRM ::= [APPLICATION 34] IMPLICIT SEQUENCE                           {
        rMOSequence SEQUENCE                                            {
            iCRMFlags [APPLICATION 37] IMPLICIT BIT STRING {
                                       auxCircuit(0)       },
            origHostNumber [APPLICATION 0E] IMPLICIT OCTET STRING,
            cCT [APPLICATION 2] IMPLICIT OCTET STRING                   }
        sMOSet SET                                                      {
            userName [APPLICATION 12] IMPLICIT IA5,
            specDestList [APPLICATION 17] IMPLICIT SEQUENCE OF
                                          destString IMPLICIT IA5,
            origAddress [APPLICATION 7] IMPLICIT IA5,
            tClass [APPLICATION 9] IMPLICIT INTEGER DEFAULT 0 {
                64cps(0), 128cps(1), 512cps(2), 2048cps(3)    },
            rCHGRequest [APPLICATION 10] IMPLICIT BOOLEAN DEFAULT FALSE } }

                                                  Rport 0, Type 11
                                                  Message is complete.
         .--------.--------.--------.--------.    Not a subsequent partial.
         |     RPORT 0     |   11   |00000001|  - User has Aux license.
         -------------------------------------
         |      0043       |       7777      |  - Message size   =   43
         -------------------------------------    Dispatcher Key = 7777
         |      9999       |    ICRM MOs....      Local Key      = 9999
         -------------------------------------












    LOGII                       Logon Processing II                         150
    Example of X.409 Type Representation Interpretation         January 6, 1988



    Byte representation of the ICRM MOs:

    7F34                                        3C
    ICRM - APPLICATION WIDE, CONSTRUCTOR ID 34, LENGTH


    30                                             0B
    RMOSEQUENCE - UNIVERSAL, CONSTRUCTOR SEQUENCE, LENGTH

    5F37
    ICRM FLAGS - APPLICATION WIDE, PRIMITIVE ID 37,

        IMPLICIT BIT STRING
        02      07             00
        LENGTH, 7 BITS UNUSED, BIT 0 RESET


    4E                                                    01      22
    ORIGINATION HOST - APPLICATION WIDE, PRIMITIVE ID 0E, LENGTH, DATA 22

    42                                      01      04
    CCT - APPLICATION WIDE, PRIMITIVE ID 2, LENGTH, DATA 4































    LOGII                       Logon Processing II                         151
    Example of X.409 Type Representation Interpretation         January 6, 1988






    31                                   2D
    SMOSET - UNIVERSAL, CONSTRUCTOR SET, LENGTH

    52
    USERNAME - APPLICATION WIDE, PRIMITIVE ID 12,

                      07      4F534552414E47
        IMPLICIT IA5, LENGTH, DATA "OSERANG"


    77                                         0C
    SDL - APPLICATION WIDE, CONSTRUCTOR ID 17, LENGTH

                      04      34323432
        IMPLICIT IA5, LENGTH, DATA "4242"

                      06      484F53543333
        IMPLICIT IA5, LENGTH, DATA "HOST33"


    47
    OADR - APPLICATION WIDE, PRIMITIVE ID 7,

                      0E      3331303634303834343637363637
        IMPLICIT IA5, LENGTH, DATA "31064084467667"


    49                                         01      01
    TCLASS - APPLICATION WIDE, PRIMITIVE ID 9, LENGTH, DATA "CPS128"

    50                                                  01      FF
    RCHG REQUESTED - APPLICATION WIDE, PRIMITIVE ID 10, LENGTH, DATA "TRUE"


















    LOGII                       Logon Processing II                         152
    LOGII X.409 MESSAGE TYPE REPRESENTATION                     January 6, 1988






                   9 -  LOGII X.409 MESSAGE TYPE REPRESENTATION





    ICRM ISIS Circuit Request Message, Rport 0, Type 11

    ICRM ::= [APPLICATION 34] IMPLICIT SEQUENCE {


        rMOSequence SEQUENCE {

            iCRMFlags [APPLICATION 37] IMPLICIT BIT STRING {
                auxCircuit (0)},  -- Bit set if Auxiliary,
                                     reset if Normal Circuit

            origHostNumber [APPLICATION 0E] IMPLICIT OCTET STRING,

            cCT [APPLICATION 2] IMPLICIT OCTET STRING      }


        sMOSet SET {

            logonChars [APPLICATION 8] IMPLICIT IA5,
                                       -- CR terminator implied if
                                          no terminator present.

            optionsList [APPLICATION 16] IMPLICIT IA5,

            userName [APPLICATION 12] IMPLICIT IA5,

            specDestList [APPLICATION 17] IMPLICIT SEQUENCE OF 
                                          destString IMPLICIT IA5,

            extension [APPLICATION 19] IMPLICIT IA5,

            password [APPLICATION 1C] IMPLICIT IA5,

            origAddress [APPLICATION 7] IMPLICIT IA5,

            tClass [APPLICATION 9] IMPLICIT INTEGER           {
                cps64(0), cps160(1), cps512(2), cps2048(3)    },

            halfDuplex [APPLICATION 0F] IMPLICIT BOOLEAN DEFAULT FALSE,

            requestBatch [APPLICATION 6] IMPLICIT BOOLEAN,

            indicateOrigIIX [APPLICATION 3] IMPLICIT BOOLEAN DEFAULT FALSE,

    LOGII                       Logon Processing II                         153
    LOGII X.409 MESSAGE TYPE REPRESENTATION                     January 6, 1988


            uUNRequest [APPLICATION 5] IMPLICIT BOOLEAN DEFAULT FALSE,

            rCHGRequest [APPLICATION 10] IMPLICIT BOOLEAN DEFAULT FALSE}}



















































    LOGII                       Logon Processing II                         154
    LOGII X.409 MESSAGE TYPE REPRESENTATION                     January 6, 1988


    ECRI Early Circuit Reject Message, Rport 0, Type 12

    ECRI ::= [APPLICATION 38] IMPLICIT SEQUENCE {




        sMOSet SET {

            eCRICode [APPLICATION 29] IMPLICIT INTEGER DEFAULT 0 {
                noComCir(0), noDisp(1), noNodeCode(2), noBuffers(3),
                cirMinSlotEx(4), cirMinHostEx(5), licenseProb(6),
                noLOGIISup(7), badICRMForm(8), badCCT(9)          }   } }









































    LOGII                       Logon Processing II                         155
    LOGII X.409 MESSAGE TYPE REPRESENTATION                     January 6, 1988


    ICRS ISIS Circuit Request Supplement, Rport Type 0C4

    ICRS ::= [APPLICATION 3A] IMPLICIT SEQUENCE {




        sMOSet SET {

            logonChars [APPLICATION 8] IMPLICIT IA5,
                                       -- CR terminator implied if
                                       no terminator present.

            optionsList [APPLICATION 16] IMPLICIT IA5,

            userName [APPLICATION 12] IMPLICIT IA5,

            specDestList [APPLICATION 17] IMPLICIT SEQUENCE OF
                                          destString IMPLICIT IA5,

            extension [APPLICATION 19] IMPLICIT IA5,

            password [APPLICATION 1C] IMPLICIT IA5,

            origAddress [APPLICATION 7] IMPLICIT IA5,

            tClass [APPLICATION 9] IMPLICIT INTEGER           {
                cps64(0), cps160(1), cps512(2), cps2048(3)    },

            halfDuplex [APPLICATION 0F] IMPLICIT BOOLEAN DEFAULT FALSE,

            requestBatch [APPLICATION 6] IMPLICIT BOOLEAN,

            indicateOrigIIX [APPLICATION 3] IMPLICIT BOOLEAN DEFAULT FALSE,

            uUNRequest [APPLICATION 5] IMPLICIT BOOLEAN DEFAULT FALSE,

            rCHGRequest [APPLICATION 10] IMPLICIT BOOLEAN DEFAULT FALSE,

            resetLogon [APPLICATION 23] BOOLEAN DEFAULT FALSE          }}














    LOGII                       Logon Processing II                         156
    LOGII X.409 MESSAGE TYPE REPRESENTATION                     January 6, 1988


    NCRM Node Code Circuit Request Message, Node-Sup 08

    NCRM ::= [APPLICATION 3C] IMPLICIT SEQUENCE {


        rMOSequence SEQUENCE {

            nCRMFlags [APPLICATION 3D] IMPLICIT BIT STRING {
                auxCircuit (0), subsequentNCRM(1) },

            origHostNumber [APPLICATION 0E] IMPLICIT OCTET STRING,

            cCT [APPLICATION 2] IMPLICIT OCTET STRING,
            origPort [APPLICATION 1A] IMPLICIT OCTET STRING   }


        sMOSet SET {

            logonChars [APPLICATION 8] IMPLICIT IA5,
                                       -- CR terminator implied if
                                          no terminator present.

            optionsList [APPLICATION 16] IMPLICIT IA5,

            userName [APPLICATION 12] IMPLICIT IA5,

            specDestList [APPLICATION 17] IMPLICIT SEQUENCE OF
                                          destString IMPLICIT IA5,

            extension [APPLICATION 19] IMPLICIT IA5,

            password [APPLICATION 1C] IMPLICIT IA5,

            origAddress [APPLICATION 7] IMPLICIT IA5,

            tClass [APPLICATION 9] IMPLICIT INTEGER           {
                cps64(0), cps160(1), cps512(2), cps2048(3)    },

            halfDuplex [APPLICATION 0F] IMPLICIT BOOLEAN DEFAULT FALSE,

            requestBatch [APPLICATION 6] IMPLICIT BOOLEAN,

            indicateOrigIIX [APPLICATION 3] IMPLICIT BOOLEAN DEFAULT FALSE,

            uUNRequest [APPLICATION 5] IMPLICIT BOOLEAN DEFAULT FALSE,

            rCHGRequest [APPLICATION 10] IMPLICIT BOOLEAN DEFAULT FALSE,

            resetLogon [APPLICATION 23] BOOLEAN DEFAULT FALSE,

            zapLogon [APPLICATION 0B] IMPLICIT BOOLEAN DEFAULT FALSE }}



    LOGII                       Logon Processing II                         157
    LOGII X.409 MESSAGE TYPE REPRESENTATION                     January 6, 1988


    RCRM Respond-Reject Crq. Req. Message, Sup-Node 12

    RCRM ::= [APPLICATION 3B] IMPLICIT SEQUENCE {


        rMOSequence SEQUENCE {

            origPort [APPLICATION 1A] IMPLICIT OCTET STRING   }
            rCRMFlags [APPLICATION 33] IMPLICIT BIT STRING {
                auxCircuit(0),logZapAck(1),logReject(2)    }



        sMOSet SET {

            ackLogonZap [APPLICATION 14] IMPLICIT BOOLEAN DEFAULT FALSE,

            halfDuplex [APPLICATION 0F] IMPLICIT BOOLEAN DEFAULT FALSE,

            logonPortMessage [APPLICATION 20] IMPLICIT IA5,

            rejectTermHostPID [APPLICATION 41] IMPLICIT OCTET STRING,

            normAuxReject [APPLICATION 27] IMPLICIT INTEGER DEFAULT 0 {
                nCRMBad(0), slowSleep(1), noSupBuffers(2),
                logonBarredByOper(3), cCTBad(4),
                origHostBad(5), tclassBad(6), origHostDown(7),
                origHostDifBase(8), origHostTerm(9),
                logFieldDuplicate(0A), logFieldBig(0B), mUDBad(0C),
                logonFailLimit(0D), logTimeOut(0E), unusedInvalid(0F),
                auxQTooLong(10), auxLogCharBad(11), auxDestBad(12),
                auxBadUname(13), auxBadPW(14), auxAccessDenied(15),
                auxTermHostUnk(16), auxTermHostDown(17),
                auxTermHostShut(18), auxTermHostOrig(19),
                auxTermHostNoPorts(1A), auxNoPathToHost(1B)           },

            normResponse [APPLICATION 04] IMPLICIT INTEGER DEFAULT 0 {
                EscapePLI(0), username(1), erTypeUname(2), password(3),
                erTypePw(4), logCharBadPLI(5), destBadPLI(6),
                accessDeniedPLI(7), termHostUnk(8),
                termHostDownPLI(9), termHostShutPLI(0A),
                termHostOrigPLI(0B), termHostNoPortsPLI(0C),
                noPathToHostPLI(0D)                                  } }}











    LOGII                       Logon Processing II                         158
    LOGII X.409 MESSAGE TYPE REPRESENTATION                     January 6, 1988


    RCRI Respond-Reject Crq. Req. ISIS, Rport Type 0C3

    RCRI ::= [APPLICATION 32] IMPLICIT SEQUENCE {


        rMOSequence SEQUENCE {

            rCRIFlags [APPLICATION 3E] IMPLICIT BIT STRING {
                auxCircuit(0)                              }



        sMOSet SET {

            nodeCodeRCRI [APPLICATION 24] IMPLICIT INTEGER DEFAULT 0  {
                iCRMforLogPort(0), iCRSonUnassigned(1), iCRSBad(2),
                comChanLost(3),iCRSbeforeRCRI(4),partialMsgTimeout(5) },

            halfDuplex [APPLICATION 0F] IMPLICIT BOOLEAN DEFAULT FALSE,

            logonPortMessage [APPLICATION 20] IMPLICIT IA5,

            rejectTermHostPID [APPLICATION 41] IMPLICIT OCTET STRING,

            normAuxReject [APPLICATION 27] IMPLICIT INTEGER DEFAULT 0 {
                nCRMBad(0), slowSleep(1), noSupBuffers(2),
                logonBarredByOper(3), cCTBad(4),
                origHostBad(5), tclassBad(6), origHostDown(7),
                origHostDifBase(8), origHostTerm(9),
                logFieldDuplicate(0A), logFieldBig(0B), mUDBad(0C),
                logonFailLimit(0D), logTimeOut(0E), unusedInvalid(0F),
                auxQTooLong(10), auxLogCharBad(11), auxDestBad(12),
                auxBadUname(13), auxBadPW(14), auxAccessDenied(15),
                auxTermHostUnk(16), auxTermHostDown(17),
                auxTermHostShut(18), auxTermHostOrig(19),
                auxTermHostNoPorts(1A), auxNoPathToHost(1B)           },

            normResponse [APPLICATION 04] IMPLICIT INTEGER DEFAULT 0 {
                EscapePLI(0), username(1), erTypeUname(2), password(3),
                erTypePw(4), logCharBadPLI(5), destBadPLI(6),
                accessDeniedPLI(7), termHostUnk(8),
                termHostDownPLI(9), termHostShutPLI(0A),
                termHostOrigPLI(0B), termHostNoPortsPLI(0C),
                noPathToHostPLI(0D)                                  } }}










    LOGII                       Logon Processing II                         159
    LOGII X.409 MESSAGE TYPE REPRESENTATION                     January 6, 1988


    ASLP Assign Logon Port, Rport Type 0C5

    



















































    LOGII                       Logon Processing II                         160
    LOGII X.409 MESSAGE TYPE REPRESENTATION                     January 6, 1988


    CCN Command Channel Needle, Sup to Node 0A

    CCN ::= [APPLICATION 2A] IMPLICIT SEQUENCE {


        rMOSequence SEQUENCE {

            cCNFlags [APPLICATION 25] IMPLICIT BIT STRING {
                commandCir(0), rebuildCir(1),
                intraNodeCir(2),termNonLOGII(3),
                passThruNonLOGII(4)                       },

            logonSuccess [APPLICATION 1] IMPLICIT SEQUENCE              {

                rMOSequence SEQUENCE                                {
                origHostNumber [APPLICATION 0E] IMPLICIT OCTET STRING,
                invoiceNumber [APPLICATION 26] IMPLICIT OCTET STRING,
                termHostPID [APPLICATION 43] IMPLICIT OCTET STRING  },

                sMOSet SET                                          {
                termNonLOGII [APPLICATION 2C] IMPLICIT BOOLEAN 
                                              DEFAULT FALSE,
                shutOverride [APPLICATION 2F] IMPLICIT BOOLEAN 
                                              DEFAULT FALSE,
                termIIX [APPLICATION 31] IMPLICIT BOOLEAN DEFAULT FALSE,
                uUN [APPLICATION 13] IMPLICIT OCTET STRING          }   },

            needleNodeCount [APPLICATION 28] IMPLICIT OCTET STRING,

            needleNodeList [APPLICATION 11] IMPLICIT SEQUENCE OF
                                        nodeNumber IMPLICIT OCTET STRING
                           -- each octet string containing a node number,

            ISN [APPLICATION 1D] IMPLICIT SEQUENCE         {

                rMOSequence SEQUENCE {

                iSNDispSeq [APPLICATION 36] IMPLICIT SEQUENCE         {
                    invoiceNumber [APPLICATION 26] IMPLICIT OCTET STRING,
                    termHostNumber [APPLICATION 0D] IMPLICIT OCTET STRING,
                    iSNFlags [APPLICATION 1B] IMPLICIT BIT STRING {
                    intraNodeCir(0),auxCircuit(1)                 },
                    origPort [APPLICATION 1A] IMPLICIT OCTET STRING,
                    shutOverride [APPLICATION 2F] IMPLICIT BOOLEAN 
                                                  DEFAULT FALSE,
                    origIIX [APPLICATION 3] IMPLICIT BOOLEAN 
                                                  DEFAULT FALSE       },

                tClass [APPLICATION 9] IMPLICIT INTEGER           {
                    cps64(0), cps160(1), cps512(2), cps2048(3)    },

                cCT [APPLICATION 2] IMPLICIT OCTET STRING,


    LOGII                       Logon Processing II                         161
    LOGII X.409 MESSAGE TYPE REPRESENTATION                     January 6, 1988


                userName [APPLICATION 12] IMPLICIT IA5,

                specDestList [APPLICATION 17] IMPLICIT SEQUENCE OF
                                              destString IMPLICIT IA5,

                origNode [APPLICATION 2B] IMPLICIT OCTET STRING,

                origHostNumber [APPLICATION 0E] IMPLICIT OCTET STRING,

                origHostPID [APPLICATION 42] IMPLICIT OCTET STRING,

                circuitCost [APPLICATION 2D] IMPLICIT OCTET STRING,

                costTable [APPLICATION 0A] IMPLICIT INTEGER DEFAULT 0   {
                  cps64Int(0), cps160Int(1), cps512Int(2), cps2048Int(3),
                  cps64Bat(4), cps160Bat(5), cps512Bat(6), cps2048Bat(7)} }

                sMOSet Set {

                resultDestAdr [APPLICATION 18] IMPLICIT IA5,

                extension [APPLICATION 19] IMPLICIT IA5,

                password [APPLICATION 1C] IMPLICIT IA5,

                targSelectQual [APPLICATION 15] IMPLICIT BIT STRING  {
                    hostDown(0), hostShut(1), hostUnknown(2),
                    hostNoPorts(3),rCHGBarred(4), nonRCHGBarred(5),
                    hostOrigOnly(6),noPathToHost(7), systematic(8),
                    multiTargets(9)                                  },

                origAddress [APPLICATION 7] IMPLICIT IA5,

                subHost [APPLICATION 30] IMPLICIT OCTET STRING,

                iRCNumber [APPLICATION 0C] IMPLICIT OCTET STRING,

                kernelAccLic [APPLICATION 48] IMPLICIT INTEGER DEFAULT 0 {
                    noAccess(0),noRiskAccess(1),
                    readAccess(2),writeAccess(3)                         },

                dispAlfAccLic [APPLICATION 49] IMPLICIT INTEGER DEFAULT 0 {
                    noAccess(0),noRiskAccess(1),
                    readAccess(2),writeAccess(3)                          },

                slotAccLic [APPLICATION 4A] IMPLICIT INTEGER DEFAULT 0 {
                    noAccess(0),noRiskAccess(1),
                    readAccess(2),writeAccess(3)                       },

                globAlfAccLic [APPLICATION 4B] IMPLICIT INTEGER DEFAULT 0 {
                    noAccess(0),noRiskAccess(1),
                    readAccess(2),writeAccess(3)                          },


    LOGII                       Logon Processing II                         162
    LOGII X.409 MESSAGE TYPE REPRESENTATION                     January 6, 1988


                halfDuplex [APPLICATION 0F] IMPLICIT BOOLEAN DEFAULT FALSE,

                rCHGRequest [APPLICATION 10]
                    IMPLICIT BOOLEAN DEFAULT FALSE,

                transpLogon [APPLICATION 2E] IMPLICIT BOOLEAN 
                                             DEFAULT FALSE         } } } }















































    LOGII                       Logon Processing II                         163
    LOGII X.409 MESSAGE TYPE REPRESENTATION                     January 6, 1988


    NCN Node Code Needle Head, Control Char 0329

    NCNHead ::= [APPLICATION 22] IMPLICIT SEQUENCE {


            nCNFlags [APPLICATION 21] IMPLICIT BIT STRING {
                commandCir(0), rebuildCir(1)              },

            tClass [APPLICATION 9] IMPLICIT INTEGER           {
                cps64(0), cps160(1), cps512(2), cps2048(3)    },

            invoiceNumber [APPLICATION 26] IMPLICIT OCTET STRING,

            termHostNumber [APPLICATION 0D] IMPLICIT OCTET STRING,

            needleNodeCount [APPLICATION 28] IMPLICIT OCTET STRING,

            needleNodeList [APPLICATION 11] IMPLICIT SEQUENCE OF
                                        nodeNumber IMPLICIT OCTET STRING
                           -- each octet string containing a node number
                                                                         }

































    LOGII                       Logon Processing II                         164
    LOGII X.409 MESSAGE TYPE REPRESENTATION                     January 6, 1988


    NCN Node Code Needle Body, Control Char 032A

    NCNBody ::= [APPLICATION 1F] IMPLICIT SEQUENCE {


            ISN [APPLICATION 1D] IMPLICIT SEQUENCE         {

                rMOSequence SEQUENCE {

                iSNDispSeq [APPLICATION 36] IMPLICIT SEQUENCE         {
                    invoiceNumber [APPLICATION 26] IMPLICIT OCTET STRING,
                    termHostNumber [APPLICATION 0D] IMPLICIT OCTET STRING,
                    iSNFlags [APPLICATION 1B] IMPLICIT BIT STRING {
                    intraNodeCir(0),auxCircuit(1)                 },
                    origPort [APPLICATION 1A] IMPLICIT OCTET STRING,
                    shutOverride [APPLICATION 2F] IMPLICIT BOOLEAN 
                                                  DEFAULT FALSE,
                    origIIX [APPLICATION 3] IMPLICIT BOOLEAN 
                                                  DEFAULT FALSE       },

                tClass [APPLICATION 9] IMPLICIT INTEGER           {
                    cps64(0), cps160(1), cps512(2), cps2048(3)    },

                cCT [APPLICATION 2] IMPLICIT OCTET STRING,

                userName [APPLICATION 12] IMPLICIT IA5,

                specDestList [APPLICATION 17] IMPLICIT SEQUENCE OF
                                              destString IMPLICIT IA5,

                origNode [APPLICATION 2B] IMPLICIT OCTET STRING,

                origHostNumber [APPLICATION 0E] IMPLICIT OCTET STRING,

                origHostPID [APPLICATION 42] IMPLICIT OCTET STRING,

                circuitCost [APPLICATION 2D] IMPLICIT OCTET STRING,

                costTable [APPLICATION 0A] IMPLICIT INTEGER DEFAULT 0   {
                  cps64Int(0), cps160Int(1), cps512Int(2), cps2048Int(3),
                  cps64Bat(4), cps160Bat(5), cps512Bat(6), cps2048Bat(7)} }

                sMOSet Set {

                resultDestAdr [APPLICATION 18] IMPLICIT IA5,

                extension [APPLICATION 19] IMPLICIT IA5,

                password [APPLICATION 1C] IMPLICIT IA5,

                targSelectQual [APPLICATION 15] IMPLICIT BIT STRING  {
                    hostDown(0), hostShut(1), hostUnknown(2),
                    hostNoPorts(3),rCHGBarred(4), nonRCHGBarred(5),

    LOGII                       Logon Processing II                         165
    LOGII X.409 MESSAGE TYPE REPRESENTATION                     January 6, 1988


                    hostOrigOnly(6),noPathToHost(7), systematic(8),
                    multiTargets(9)                                  },

                origAddress [APPLICATION 7] IMPLICIT IA5,

                subHost [APPLICATION 30] IMPLICIT OCTET STRING,

                iRCNumber [APPLICATION 0C] IMPLICIT OCTET STRING,

                kernelAccLic [APPLICATION 48] IMPLICIT INTEGER DEFAULT 0 {
                    noAccess(0),noRiskAccess(1),
                    readAccess(2),writeAccess(3)                         },

                dispAlfAccLic [APPLICATION 49] IMPLICIT INTEGER DEFAULT 0 {
                    noAccess(0),noRiskAccess(1),
                    readAccess(2),writeAccess(3)                          },

                slotAccLic [APPLICATION 4A] IMPLICIT INTEGER DEFAULT 0 {
                    noAccess(0),noRiskAccess(1),
                    readAccess(2),writeAccess(3)                       },

                globAlfAccLic [APPLICATION 4B] IMPLICIT INTEGER DEFAULT 0 {
                    noAccess(0),noRiskAccess(1),
                    readAccess(2),writeAccess(3)                          },

                halfDuplex [APPLICATION 0F] IMPLICIT BOOLEAN DEFAULT FALSE,

                rCHGRequest [APPLICATION 10]
                    IMPLICIT BOOLEAN DEFAULT FALSE,

                transpLogon [APPLICATION 2E] IMPLICIT BOOLEAN 
                                             DEFAULT FALSE         } } }






















    LOGII                       Logon Processing II                         166
    LOGII X.409 MESSAGE TYPE REPRESENTATION                     January 6, 1988


    LGSC Logon Success Indication, Rport Type 0C6

    LGSC ::= [APPLICATION 01] IMPLICIT SEQUENCE {


        rMOSequence SEQUENCE {

            origHostNumber [APPLICATION 0E] IMPLICIT OCTET STRING,

            invoiceNumber [APPLICATION 26] IMPLICIT OCTET STRING,

            termHostPID [APPLICATION 43] IMPLICIT OCTET STRING    }



        sMOSet SET {

            termNonLOGII [APPLICATION 2C] IMPLICIT BOOLEAN 
                                          DEFAULT FALSE,

            shutOverride [APPLICATION 2F] IMPLICIT BOOLEAN 
                                          DEFAULT FALSE,

            termIIX [APPLICATION 31] IMPLICIT BOOLEAN DEFAULT FALSE,

            uUN [APPLICATION 13] IMPLICIT OCTET STRING    }    }




























    LOGII                       Logon Processing II                         167
    LOGII X.409 MESSAGE TYPE REPRESENTATION                     January 6, 1988


    ISN ISIS Needle, Rport Type 0C2

    ISN ::= [APPLICATION 1D] IMPLICIT SEQUENCE {


        rMOSequence SEQUENCE {

            iSNDispSeq [APPLICATION 36] IMPLICIT SEQUENCE         {
                invoiceNumber [APPLICATION 26] IMPLICIT OCTET STRING,
                termHostNumber [APPLICATION 0D] IMPLICIT OCTET STRING,
                iSNFlags [APPLICATION 1B] IMPLICIT BIT STRING {
                intraNodeCir(0),auxCircuit(1)                 },
                origPort [APPLICATION 1A] IMPLICIT OCTET STRING,
                shutOverride [APPLICATION 2F] IMPLICIT BOOLEAN 
                                              DEFAULT FALSE,
                origIIX [APPLICATION 3] IMPLICIT BOOLEAN 
                                              DEFAULT FALSE       },

            tClass [APPLICATION 9] IMPLICIT INTEGER           {
                cps64(0), cps160(1), cps512(2), cps2048(3)    },

            cCT [APPLICATION 2] IMPLICIT OCTET STRING,

            userName [APPLICATION 12] IMPLICIT IA5,

            specDestList [APPLICATION 17] IMPLICIT SEQUENCE OF
                                          destString IMPLICIT IA5,

            origNode [APPLICATION 2B] IMPLICIT OCTET STRING,

            origHostNumber [APPLICATION 0E] IMPLICIT OCTET STRING,

            origHostPID [APPLICATION 42] IMPLICIT OCTET STRING,

            circuitCost [APPLICATION 2D] IMPLICIT OCTET STRING,

            costTable [APPLICATION 0A] IMPLICIT INTEGER DEFAULT 0   {
                cps64Int(0), cps160Int(1), cps512Int(2), cps2048Int(3),
                cps64Bat(4), cps160Bat(5), cps512Bat(6), cps2048Bat(7)} }


        sMOSet SET {

            resultDestAdr [APPLICATION 18] IMPLICIT IA5,

            extension [APPLICATION 19] IMPLICIT IA5,

            password [APPLICATION 1C] IMPLICIT IA5,

            targSelectQual [APPLICATION 15] IMPLICIT BIT STRING {
                hostDown(0), hostShut(1), hostUnknown(2), hostNoPorts(3),
                rCHGBarred(4), nonRCHGBarred(5), hostOrigOnly(6),
                noPathToHost(7), systematic(8), multiTargets(9) },

    LOGII                       Logon Processing II                         168
    LOGII X.409 MESSAGE TYPE REPRESENTATION                     January 6, 1988


            origAddress [APPLICATION 7] IMPLICIT IA5,

            subHost [APPLICATION 30] IMPLICIT OCTET STRING,

            iRCNumber [APPLICATION 0C] IMPLICIT OCTET STRING,

            halfDuplex [APPLICATION 0F] IMPLICIT BOOLEAN DEFAULT FALSE,

            rCHGRequest [APPLICATION 10] IMPLICIT BOOLEAN DEFAULT FALSE,

            transpLogon [APPLICATION 2E] IMPLICIT BOOLEAN
                                         DEFAULT FALSE       } }










































    LOGII                       Logon Processing II                         169
    LOGII X.409 IDENTIFIER SUMMARY...ALPHABETICAL               January 6, 1988






                10 -  LOGII X.409 IDENTIFIER SUMMARY...ALPHABETICAL

    ID Description                                      ID Code            PAGE

    Accounting Invoice Number                             MO-26              88
    Acknowledge Logon Zapper                              MO-14              69
    ASLP Assign Logon Port, Rport Type 0C5                ID-xx              83

    Batch Circuit Request                                 MO-06              46

    CCN Command Channel Needle, Sup to Node 0A            ID-2A              85
    CCN Flags                                             MO-25              85
    CCT                                                   MO-02              41
    Circuit Cost                                          MO-2D              92
    Cost Table                                            MO-0A              93

    Destination Sub-Host Number                           MO-30              96
    Dispatcher/Alfred Debug Access License                MO-49              97

    ECRI Early Circuit Reject Message, Rport 0, Type 12   ID-38              49
    Extension                                             MO-19              44

    Gateway Generated Text Message                        MO-47              38
    Gateway Secondary Circuit Request Message             MO-45              38
    Gateway Secondary Logon Response/Reject Message       MO-44              38
    Global Alfred Access License                          MO-4B              97

    Half Duplex                                           MO-0F              45

    ICRM Flags                                            MO-37              41
    ICRM ISIS Circuit Request Message, Rport 0, Type 11   ID-34              41
    ICRS ISIS Circuit Request Supplement, Rport Type 0C4  ID-3A              51
    IIX Capable Origination                               MO-03              46
    IIX Capable Termination                               MO-31              86
    IRC Number for the Username                           MO-0C              96
    ISIS Needle                                           MO-1D              88
    ISN Dispatcher Information Sequence                   MO-36              88
    ISN Flags                                             MO-1B              88
    ISN ISIS Needle, Rport Type 0C2                       ID-1D             128

    Kernel Debug Access License                           MO-48              96

    LGSC Logon Success Indication, Rport Type 0C6         ID-01             124
    Logon Session Reset                                   MO-23              56
    Logon Session Zapper                                  MO-0B              65

    Message String for Port in Logon Mode                 MO-20              69

    NCN Flags                                             MO-21             106

    LOGII                       Logon Processing II                         170
    LOGII X.409 IDENTIFIER SUMMARY...ALPHABETICAL               January 6, 1988


    NCN Node Code Needle Body, Control Char 032A          ID-1F             109
    NCN Node Code Needle Head, Control Char 0329          ID-22             106
    NCRM Flags                                            MO-3D              58
    NCRM Node Code Circuit Request Message, Node-Sup 08   ID-3C              58
    Needle Node List                                      MO-11              87
    Needle Node List Count                                MO-28              87
    Node Code Generated RCRI Conditions                   MO-24              76
    Non-LOGII Termination                                 MO-2C              86
    Normal and Auxiliary Reject Codes                     MO-27              70
    Normal Circuit Response Codes                         MO-04              72
    Normal/Auxiliary Early Reject Code                    MO-29              49

    Options List                                          MO-16              43
    Originating Host Number                               MO-0E              41
    Originating Node Number                               MO-2B              91
    Originating Port Number                               MO-1A              58
    Origination Address                                   MO-07              44

    Passthrough Generated Text Message                    MO-46              38
    Password                                              MO-1C              44
    PID of Originating Host                               MO-42              92
    PID of Rejecting Host                                 MO-41              70
    PID of the Terminating Host                           MO-43              86

    RCRI Flags                                            MO-3E              75
    RCRI Respond-Reject Crq. Req. ISIS, Rport Type 0C3    ID-32              75
    RCRM Flags                                            MO-33              68
    RCRM Respond-Reject Crq. Req. Message, Sup-Node 12    ID-3B              68
    Resultant Destination Address                         MO-18              94
    Reverse Charge Call Requested                         MO-10              46

    Shut Override Indication                              MO-2F              86
    Slot Debug Access License                             MO-4A              97
    Specified Destination List                            MO-17              44

    Target Selection and Qualification                    MO-15              95
    Terminating Host Number                               MO-0D              88
    Throughput Class                                      MO-09              45
    Transparent Logon Indication                          MO-2E              99

    Unparsed Logon Characters                             MO-08              42
    Username                                              MO-12              43
    UUN                                                   MO-13              86
    UUN Requested                                         MO-05              46










    LOGII                       Logon Processing II                         171
    LOGII X.409 IDENTIFIER SUMMARY...NUMERICAL                  January 6, 1988






                 11 -  LOGII X.409 IDENTIFIER SUMMARY...NUMERICAL

    ID Code   ID Description                                               PAGE

    ID-01     LGSC Logon Success Indication, Rport Type 0C6                 124
    ID-1D     ISN ISIS Needle, Rport Type 0C2                               128
    ID-1F     NCN Node Code Needle Body, Control Char 032A                  109
    ID-22     NCN Node Code Needle Head, Control Char 0329                  106
    ID-2A     CCN Command Channel Needle, Sup to Node 0A                     85
    ID-32     RCRI Respond-Reject Crq. Req. ISIS, Rport Type 0C3             75
    ID-34     ICRM ISIS Circuit Request Message, Rport 0, Type 11            41
    ID-38     ECRI Early Circuit Reject Message, Rport 0, Type 12            49
    ID-3A     ICRS ISIS Circuit Request Supplement, Rport Type 0C4           51
    ID-3B     RCRM Respond-Reject Crq. Req. Message, Sup-Node 12             68
    ID-3C     NCRM Node Code Circuit Request Message, Node-Sup 08            58
    ID-xx     ASLP Assign Logon Port, Rport Type 0C5                         83

    MO-02     CCT                                                            41
    MO-03     IIX Capable Origination                                        46
    MO-04     Normal Circuit Response Codes                                  72
    MO-05     UUN Requested                                                  46
    MO-06     Batch Circuit Request                                          46
    MO-07     Origination Address                                            44
    MO-08     Unparsed Logon Characters                                      42
    MO-09     Throughput Class                                               45
    MO-0A     Cost Table                                                     93
    MO-0B     Logon Session Zapper                                           65
    MO-0C     IRC Number for the Username                                    96
    MO-0D     Terminating Host Number                                        88
    MO-0E     Originating Host Number                                        41
    MO-0F     Half Duplex                                                    45
    MO-10     Reverse Charge Call Requested                                  46
    MO-11     Needle Node List                                               87
    MO-12     Username                                                       43
    MO-13     UUN                                                            86
    MO-14     Acknowledge Logon Zapper                                       69
    MO-15     Target Selection and Qualification                             95
    MO-16     Options List                                                   43
    MO-17     Specified Destination List                                     44
    MO-18     Resultant Destination Address                                  94
    MO-19     Extension                                                      44
    MO-1A     Originating Port Number                                        58
    MO-1B     ISN Flags                                                      88
    MO-1C     Password                                                       44
    MO-1D     ISIS Needle                                                    88
    MO-20     Message String for Port in Logon Mode                          69
    MO-21     NCN Flags                                                     106
    MO-23     Logon Session Reset                                            56
    MO-24     Node Code Generated RCRI Conditions                            76

    LOGII                       Logon Processing II                         172
    LOGII X.409 IDENTIFIER SUMMARY...NUMERICAL                  January 6, 1988


    MO-25     CCN Flags                                                      85
    MO-26     Accounting Invoice Number                                      88
    MO-27     Normal and Auxiliary Reject Codes                              70
    MO-28     Needle Node List Count                                         87
    MO-29     Normal/Auxiliary Early Reject Code                             49
    MO-2B     Originating Node Number                                        91
    MO-2C     Non-LOGII Termination                                          86
    MO-2D     Circuit Cost                                                   92
    MO-2E     Transparent Logon Indication                                   99
    MO-2F     Shut Override Indication                                       86
    MO-30     Destination Sub-Host Number                                    96
    MO-31     IIX Capable Termination                                        86
    MO-33     RCRM Flags                                                     68
    MO-36     ISN Dispatcher Information Sequence                            88
    MO-37     ICRM Flags                                                     41
    MO-3D     NCRM Flags                                                     58
    MO-3E     RCRI Flags                                                     75
    MO-41     PID of Rejecting Host                                          70
    MO-42     PID of Originating Host                                        92
    MO-43     PID of the Terminating Host                                    86
    MO-44     Gateway Secondary Logon Response/Reject Message                38
    MO-45     Gateway Secondary Circuit Request Message                      38
    MO-46     Passthrough Generated Text Message                             38
    MO-47     Gateway Generated Text Message                                 38
    MO-48     Kernel Debug Access License                                    96
    MO-49     Dispatcher/Alfred Debug Access License                         97
    MO-4A     Slot Debug Access License                                      97
    MO-4B     Global Alfred Access License                                   97


























    LOGII                       Logon Processing II                         173
    ACRONYM DEFINITIONS                                         January 6, 1988






                             12 -  ACRONYM DEFINITIONS

    Acronym   Definition                                                   PAGE

    ADRII     TYMNET Addressing II                                            1
    APE       Access Profile Entry                                           15
    APX       Access Profile Intersection                                    12
    ASLP      ASsign Logon Port                                              21

    CCN       Command Channel Needle                                         21
    CCT       Circuit Characteristic Type                                    41
    CONSAT    Consolidated Tymsat async terminal interface                   13
    CR        Carriage Return                                                 6

    DNIC      Data Network Identification Code                               11
    DTE       Data Terminal Equipment                                        13

    ECRI      Early Circuit Reject - ISIS                                    21
    ESC       Escape character                                               25

    ICRM      ISIS Circuit Request Message                                   21
    ICRS      ISIS Circuit Request Supplement                                21
    IDN       International Data Number                                      18
    IIX       Intelligent Interface protocol                                  3
    ISIS      Internally Switched Interface System                            2
    ISN       ISIS Needle                                                    21

    LGSC      LoGon SuCcess Indication                                       21
    LOGII     Logon Session II, the design this document describes            1

    MERLIN    "Merge and Link" Program                                      100
    MO        Message Object                                                 13
    MUD       Master User Directory, Supervisor username disk file            1
    MUDII     Master User Directory Format II                                 1
    MUX       Multiplexor interface                                          14

    NAD       Native Assembler-Debugger                                       2
    NCN       Node Code Needle                                               21
    NCRM      Node Code Circuit Request                                      21
    NIB       NAD Image Binary                                                2
    NTN       Network Terminal Number                                        11

    OADR      Origination Address, TYMNET definition                         12

    PID       Product IDentification code                                    70
    PVC       Permanent Virtual Circuit                                      12

    RAM       Raw Accounting Merger                                         138
    RCHG      Reverse Charge                                                 12

    LOGII                       Logon Processing II                         174
    ACRONYM DEFINITIONS                                         January 6, 1988


    RCRI      Respond/Reject Circuit Request - ISIS                          21
    RCRM      Respond/Reject Circuit Request Message                         21
    RDA       Resultant Destination Address                                  12
    RMO       Required Message Object                                        37
    RPOA      Recognized Private Operating Agency                            11
    RPORT     Dispatcher port                                                 3

    SDL       Specified Destination List                                     12
    SMO       Supplemental Message Object                                    37
    SWBT      SouthWestern Bell Telephone                                     1

    TMCS      TYMNET Monitoring and Control System                            2

    UUN       Universal User Number, TYMNET                                  46








































    LOGII                       Logon Processing II                         175
    ,@y