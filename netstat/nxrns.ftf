CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C                                                                       C
C       SUBROUTINE: XRNS                                                C
C                                                                       C
C       THIS SUBROUTINE GETS NODE STATISTICS INFORMATION FROM OUTPUT    C
C       FROM THE XRAY NS COMMAND.  THE OUPUT MUST BE IN THE FORMAT OF   C
C       AN ARRAY AS RETURNED FROM THE AXMOUT SUBROUTINE.                C
C                                                                       C
C       FORMAT: CALL XRNS(OUTDEV,NODE,KERNEL,XRHOLD,XRHSIZ,LLINE)       C
C       ARGUMENTS:                                                      C
C           OUTDEV - DEVICE NUMBER TO WRITE DATA TO DISK                C
C           NODE   - NODE DATA WAS COLLECTED FROM                       C
C           KERNEL - KERNEL HOST NUMBER OF NODE                         C
C           XRHOLD: INPUT - ARRAY CONTAINING THE OUTPUT FROM AXMOUT.    C
C           XRHSIZ - MAX NUMBER OF LINES IN XRHOLD.  XRHOLD WILL BE      C
C                    DIMENSIONED TO XRHSIZ * 80.                         C
C           LLINE:  INPUT - LAST LINE OF INFORMATION IN XRHOLD.         C
C                                                                       C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC

        SUBROUTINE NXRNS(OUTDV1,OUTDV2,OUTTYP,NODE,KERNEL,XRHOLD,
     +  XRHSIZ,LLINE,ECOUNT,ENDFLG,EARRAY,PAGE,IDATE,ITIME)

        INTEGER XRHSIZ,XRHOLD(XRHSIZ,80),LLINE,OUTDV1,NODE,KERNEL,CDATE,
     1          SDATE(2),STIME,EXCT,EXLW,EXHW,EDHW,EEHW,SYHW,NEHW,NECT,
     2          MPRT,MPAS,MLNK,XCT,NMK,PACK,LCO,LCI,LHO,LHI,ACO,ACI,AHO,
     3          AHI,PCO,PCI,PHO,PHI,CD,HWD,TD,EFF,AP,SYP,QP,HP,SPP,SWP,
     4          LP,DP,SOP,XP,SEP,AM,SYM,QM,HM,SPM,SWM,LM,DM,SOM,XM,SEM,
     5          AA,MA,WA,CLINE,ONELIN(80),OUTDV2,OUTTYP,NAMES(63,3),
     6          EARRAY(63,8),ECOUNT,PAGE,ENDFLG,CTIME,PLCO,PLCI,PLHO,
     7          PLHI,IDATE,ITIME


        DATA ((NAMES(I,J),J=1,3),I=1,34)/'NODE',' ',' ','KERNE','L',' ',
     +  'CDATE',' ',' ','CTIME',' ',' ','EXCT',' ',' ','EXLW',' ',' ',
     +  'EXHW',' ',' ','EDHW',' ',' ','EEHW',' ',' ','SYHW',' ',' ',
     +  'NEHW',' ',' ','NECT',' ',' ','MPRT',' ',' ','MPAS',' ',' ',
     +  'MLNK',' ',' ','RMK X','CT',' ','RMK N','MK',' ','PACKE','TS',
     +  ' ','LOG L','INK C','PSO','LOG L','INK C','PSI','LOG L','INK H',
     +  'WMO','LOG L','INK H','WMI','PHY L','INK C','PSO','PHY L',
     +  'INK C','PSI','PHY L','INK H','WMO','PHY L','INK H','WMI',
     +  'ASYNC',' CPSO',' ','ASYNC',' CPSI',' ',
     +  'ASYNC',' HWMO',' ','ASYNC',' HWMI',' ','PRINT',' CPSO',' ',
     +  'PRINT',' CPSI',' ','PRINT',' HWMO',' ','PRINT',' HWMI',' '/
        DATA ((NAMES(I,J),J=1,3),I=35,63)/'CODE',
     +  'DELAY',' ','HWARE',' DELA','Y','TOTAL',' DELA','Y',
     +  'EFFIC','IENCY',' ','ASYNC',' %',' ','SYLVR',' %',' ',
     +  'Q-SEC',' %',' ','H-SEC',' %',' ','SPIDR',' %',' ',
     +  'SWICH',' %',' ','LINKR',' %',' ','DWLIN',' %',' ',
     +  'SOURC',' %',' ','X-RAY',' %',' ','1SEC ',' %',' ','ASYNC',
     +  ' MAX',' ','SYLVR',' MAX',' ','Q-SEC',' MAX',' ','H-SEC',' MAX',
     +  ' ','SPIDR',' MAX',' ','SWICH',' MAX',' ','LINKR',' MAX',' ',
     +  'DWLIN',' MAX',' ','SOURC',' MAX',' ','X-RAY',' MAX',' ',
     +  '1SEC ','MAX',' ','AVG A','SY TI','ME','MAX A','SY TI','ME',
     +  'WRAP',' ',' '/

        EXCT=0
        EXLW=0
        EXHW=0
        EDHW=0
        EEHW=0
        SYHW=0
        NEHW=0
        NECT=0
        MPRT=0
        MPAS=0
        MLNK=0
        XCT=0
        NMK=0
        PACK=0
        LCO=0
        LCI=0
        LHO=0
        LHI=0
        PLCO=0
        PLCI=0
        PLHO=0
        PLHI=0
        ACO=0
        ACI=0
        AHO=0
        AHI=0
        PCO=0
        PCI=0
        PHO=0
        PHI=0
        CD=0
        HWD=0
        TD=0
        EFF=0
        AP=0
        SYP=0
        QP=0
        HP=0
        SPP=0
        SWP=0
        LP=0
        DP=0
        SOP=0
        XP=0
        SEP=0
        AM=0
        SYM=0
        QM=0
        HM=0
        SPM=0
        SWM=0
        LM=0
        DM=0
        SOM=0
        SOM=0
        SEM=0
        AA=0
        MA=0
        WA=0

        CLINE=1

CCCCC
C IF ENDFLG = 1, THEN FINISHED WITH DATA COLLECTTION. GO WRITE
C LAST PAGE OF FORMATTED OUTPUT.
CCCCC
        IF (ENDFLG.EQ.1.AND.(OUTTYP.EQ.1.OR.OUTTYP.EQ.3)) GOTO 970

CCCCC
C GET DATE AND TIME AND CONVERT THEM
CCCCC
C90      CALL DATE(SDATE)
C        CALL TIME(STIME)
C        CALL DATCON(SDATE,CDATE,IERR)
C        CALL TIMCON(STIME,CTIME,IERR)

CCCCC
C IF THIS LINE BEGINS WITH A BLANK THEN IGNORE IT, UNLESS 2ND CHAR
C IS AN R.
CCCCC
100     IF (XRHOLD(CLINE,1).NE.' '.OR.XRHOLD(CLINE,2).EQ.'R') GOTO 150
        CLINE=CLINE+1
        IF (CLINE.EQ.LLINE)GOTO 900
        GOTO 100

CCCCC
C THIS LINE CONTAINS SOMETHING BESIDES BLANKS. BRANCH ON VALUE OF
C FIRST WORD OF LINE.
CCCCC
150     CONTINUE
        IF (XRHOLD(CLINE,1).EQ.'E' .AND. XRHOLD(CLINE,2).EQ.'X' .AND.
     1      XRHOLD(CLINE,3).EQ.'C' .AND. XRHOLD(CLINE,4).EQ.'T')
     2     GOTO 200
        IF (XRHOLD(CLINE,1).EQ.' ' .AND. XRHOLD(CLINE,2).EQ.'R' .AND.
     1      XRHOLD(CLINE,3).EQ.'M' .AND. XRHOLD(CLINE,4).EQ.'K')
     2     GOTO 250
        IF (XRHOLD(CLINE,1).EQ.'N' .AND. XRHOLD(CLINE,2).EQ.'O' .AND.
     1      XRHOLD(CLINE,3).EQ.'D' .AND. XRHOLD(CLINE,4).EQ.'E')
     2     GOTO 300
        IF (XRHOLD(CLINE,1).EQ.'A' .AND. XRHOLD(CLINE,2).EQ.'S' .AND.
     1      XRHOLD(CLINE,3).EQ.'Y' .AND. XRHOLD(CLINE,4).EQ.'N')
     2     GOTO 350
        IF (XRHOLD(CLINE,1).EQ.'C' .AND. XRHOLD(CLINE,2).EQ.'O' .AND.
     1      XRHOLD(CLINE,3).EQ.'D' .AND. XRHOLD(CLINE,4).EQ.'E')
     2     GOTO 400
        IF (XRHOLD(CLINE,1).EQ.'P' .AND. XRHOLD(CLINE,2).EQ.'E' .AND.
     1      XRHOLD(CLINE,3).EQ.'R' .AND. XRHOLD(CLINE,4).EQ.'C')
     2     GOTO 450
        IF (XRHOLD(CLINE,1).EQ.'M' .AND. XRHOLD(CLINE,2).EQ.'A' .AND.
     1      XRHOLD(CLINE,3).EQ.'X' .AND. XRHOLD(CLINE,4).EQ.'(')
     2     GOTO 500
        IF (XRHOLD(CLINE,1).EQ.'A' .AND. XRHOLD(CLINE,2).EQ.'V' .AND.
     1      XRHOLD(CLINE,3).EQ.'E' .AND. XRHOLD(CLINE,4).EQ.'R')
     2     GOTO 550
        IF (XRHOLD(CLINE,1).EQ.'P' .AND. XRHOLD(CLINE,2).EQ.'R' .AND.
     1      XRHOLD(CLINE,3).EQ.'I' .AND. XRHOLD(CLINE,4).EQ.'N')
     2     GOTO 600

C       CCCCC
C       C THIS LINE DOESN'T CONTAIN SOMETHING THAT WE ARE LOOKING
C       C FOR, SO CONTINUE
C       CCCCC
        CLINE=CLINE+1
        IF (CLINE.EQ.LLINE) GOTO 900
        GO TO 100

CCCCC
C THE NEXT LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC

200     CLINE=CLINE+1
        DO 210 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
210     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THE LINE
C       CCCCC
220     CALL AXISCA(ONELIN,1,EXCT,IERR)
        CALL AXISCA(ONELIN,7,EXLW,IERR)
        CALL AXISCA(ONELIN,13,EXHW,IERR)
        CALL AXISCA(ONELIN,19,EDHW,IERR)
        CALL AXISCA(ONELIN,25,EEHW,IERR)
        CALL AXISCA(ONELIN,31,SYHW,IERR)
        CALL AXISCA(ONELIN,37,NEHW,IERR)
        CALL AXISCA(ONELIN,43,NECT,IERR)
        CALL AXISCA(ONELIN,49,MPRT,IERR)
        CALL AXISCA(ONELIN,55,MPAS,IERR)
        CALL AXISCA(ONELIN,61,MLNK,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
225     CLINE=CLINE+1
        GOTO 100


CCCCC
C THE NEXT LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
250     CLINE=CLINE+1
        DO 255 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
255     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
260     CALL AXISCA(ONELIN,1,XCT,IERR)
        CALL AXISCA(ONELIN,10,NMK,IERR)
        CALL AXISCA(ONELIN,19,PACK,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
270     CLINE=CLINE+1
        GOTO 100

CCCCC
C THE LINE AFTER NEXT CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
300     continue
        CPSTYP= 'T'
        IF (XRHOLD(CLINE,19).EQ.'L') CPSTYP='L'
        CLINE=CLINE+2
        DO 310 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
310     CONTINUE
        IF (CPSTYP.NE.'L') GO TO 325

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
320     CALL AXISCA(ONELIN,1,LCO,IERR)
        CALL AXISCA(ONELIN,10,LCI,IERR)
        CALL AXISCA(ONELIN,19,LHO,IERR)
        CALL AXISCA(ONELIN,28,LHI,IERR)
        cline = cline + 4
        do 322 i = 1, 80
        onelin(i) = xrhold(cline,i)
322     continue
C        GOTO 330

C       CCCCC
C       C GET ALL PHYSICAL LINK STATISTICS ON THIS LINE
C       CCCCC
325     CALL AXISCA(ONELIN,1,PLCO,IERR)
        CALL AXISCA(ONELIN,10,PLCI,IERR)
        CALL AXISCA(ONELIN,19,PLHO,IERR)
        CALL AXISCA(ONELIN,28,PLHI,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
330     CLINE=CLINE+1
        GOTO 100

CCCCC
C THE NEXT LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
350     continue
        CLINE=CLINE+2
        DO 355 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
355     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
360     CALL AXISCA(ONELIN,1,ACO,IERR)
        CALL AXISCA(ONELIN,10,ACI,IERR)
        CALL AXISCA(ONELIN,19,AHO,IERR)
        CALL AXISCA(ONELIN,28,AHI,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
370     CLINE=CLINE+1
        GOTO 100

CCCCC
C THE NEXT LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
400     CLINE=CLINE+1
        DO 410 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
410     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
420     CALL AXISCA(ONELIN,5,CD,IERR)
        CALL AXISCA(ONELIN,19,HWD,IERR)
        CALL AXISCA(ONELIN,33,TD,IERR)
        CALL AXISCA(ONELIN,47,EFF,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
430     CLINE=CLINE+1
        GOTO 100

CCCCC
C THIS LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
450     CONTINUE
        DO 455 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
455     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
460     CALL AXISCA(ONELIN,12,AP,IERR)
        CALL AXISCA(ONELIN,18,SYP,IERR)
        CALL AXISCA(ONELIN,24,QP,IERR)
        CALL AXISCA(ONELIN,30,HP,IERR)
        CALL AXISCA(ONELIN,36,SPP,IERR)
        CALL AXISCA(ONELIN,42,SWP,IERR)
        CALL AXISCA(ONELIN,48,LP,IERR)
        CALL AXISCA(ONELIN,54,DP,IERR)
        CALL AXISCA(ONELIN,60,SOP,IERR)
        CALL AXISCA(ONELIN,66,XP,IERR)
        CALL AXISCA(ONELIN,72,SEP,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
470     CLINE=CLINE+1
        GOTO 100

CCCCC
C THIS LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
500     CONTINUE
        DO 510 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
510     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
520     CALL AXISCA(ONELIN,10,AM,IERR)
        CALL AXISCA(ONELIN,16,SYM,IERR)
        CALL AXISCA(ONELIN,22,QM,IERR)
        CALL AXISCA(ONELIN,28,HM,IERR)
        CALL AXISCA(ONELIN,34,SPM,IERR)
        CALL AXISCA(ONELIN,40,SWM,IERR)
        CALL AXISCA(ONELIN,46,LM,IERR)
        CALL AXISCA(ONELIN,52,DM,IERR)
        CALL AXISCA(ONELIN,58,SOM,IERR)
        CALL AXISCA(ONELIN,64,XM,IERR)
        CALL AXISCA(ONELIN,70,SEM,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
530     CLINE=CLINE+1
        GOTO 100

CCCCC
C THIS LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
550     CONTINUE
        DO 555 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
555     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
560     CALL AXISCA(ONELIN,27,AA,IERR)
        CALL AXISCA(ONELIN,43,MA,IERR)
        CALL AXISCA(ONELIN,60,WA,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
570     CLINE=CLINE+1
        GOTO 100

CCCCC
C THE LINE AFTER NEXT  CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
600     CLINE=CLINE+2
        DO 610 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
610     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
620     CALL AXISCA(ONELIN,1,PCO,IERR)
        CALL AXISCA(ONELIN,10,PCI,IERR)
        CALL AXISCA(ONELIN,19,PHO,IERR)
        CALL AXISCA(ONELIN,28,PHI,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
630     CLINE=CLINE+1
        GOTO 100


CCCCC
C WRITE UNFORMATTED INFORMATION TO OUTPUT FILE.
CCCCC
900     IF (OUTTYP.EQ.1) GOTO 950
        IPOS=SIZE(OUTDV1)+1
        WRITE(OUTDV1#IPOS,910)NODE,KERNEL,IDATE,ITIME,
     1          EXCT,EXLW,EXHW,EDHW,EEHW,SYHW,NEHW,NECT,
     2          MPRT,MPAS,MLNK,XCT,NMK,PACK,LCO,LCI,LHO,LHI,
     +          PLCO,PLCI,PLHO,PLHI,ACO,ACI,AHO,
     4          AHI,PCO,PCI,PHO,PHI,CD,HWD,TD,EFF,AP,SYP,QP,HP,SPP,SWP,
     5          LP,DP,SOP,XP,SEP,AM,SYM,QM,HM,SPM,SWM,LM,DM,SOM,XM,SEM,
     6          AA,MA,WA

910     FORMAT (I5,I5,I6,I4,11(I4),19(I8),4(I4),11(I2),14(I4))
        IF (OUTTYP.EQ.2) GOTO 999

CCCCC
C USER WANTS FORMATTED OUTPUT
CCCCC
950     ECOUNT=ECOUNT+1
        IF (ECOUNT.GT.8)GOTO 970

        EARRAY(1,ECOUNT)=NODE
        EARRAY(2,ECOUNT)=KERNEL
        EARRAY(3,ECOUNT)=CDATE
        EARRAY(4,ECOUNT)=CTIME
        EARRAY(5,ECOUNT)=EXCT
        EARRAY(6,ECOUNT)=EXLW
        EARRAY(7,ECOUNT)=EXHW
        EARRAY(8,ECOUNT)=EDHW
        EARRAY(9,ECOUNT)=EEHW
        EARRAY(10,ECOUNT)=SYHW
        EARRAY(11,ECOUNT)=NEHW
        EARRAY(12,ECOUNT)=NECT
        EARRAY(13,ECOUNT)=MPRT
        EARRAY(14,ECOUNT)=MPAS
        EARRAY(15,ECOUNT)=MLNK
        EARRAY(16,ECOUNT)=XCT
        EARRAY(17,ECOUNT)=NMK
        EARRAY(18,ECOUNT)=PACK
        EARRAY(19,ECOUNT)=LCO
        EARRAY(20,ECOUNT)=LCI
        EARRAY(21,ECOUNT)=LHO
        EARRAY(22,ECOUNT)=LHI
        EARRAY(23,ECOUNT)=PLCO
        EARRAY(24,ECOUNT)=PLCI
        EARRAY(25,ECOUNT)=PLHO
        EARRAY(26,ECOUNT)=PLHI
        EARRAY(27,ECOUNT)=ACO
        EARRAY(28,ECOUNT)=ACI
        EARRAY(29,ECOUNT)=AHO
        EARRAY(30,ECOUNT)=AHI
        EARRAY(31,ECOUNT)=PCO
        EARRAY(32,ECOUNT)=PCI
        EARRAY(33,ECOUNT)=PHO
        EARRAY(34,ECOUNT)=PHI
        EARRAY(35,ECOUNT)=CD
        EARRAY(36,ECOUNT)=HWD
        EARRAY(37,ECOUNT)=TD
        EARRAY(38,ECOUNT)=EFF
        EARRAY(39,ECOUNT)=AP
        EARRAY(40,ECOUNT)=SYP
        EARRAY(41,ECOUNT)=QP
        EARRAY(42,ECOUNT)=HP
        EARRAY(43,ECOUNT)=SPP
        EARRAY(44,ECOUNT)=SWP
        EARRAY(45,ECOUNT)=LP
        EARRAY(46,ECOUNT)=DP
        EARRAY(47,ECOUNT)=SOP
        EARRAY(48,ECOUNT)=XP
        EARRAY(49,ECOUNT)=SEP
        EARRAY(50,ECOUNT)=AM
        EARRAY(51,ECOUNT)=SYM
        EARRAY(52,ECOUNT)=QM
        EARRAY(53,ECOUNT)=HM
        EARRAY(54,ECOUNT)=SPM
        EARRAY(55,ECOUNT)=SWM
        EARRAY(56,ECOUNT)=LM
        EARRAY(57,ECOUNT)=DM
        EARRAY(58,ECOUNT)=SOM
        EARRAY(59,ECOUNT)=XM
        EARRAY(60,ECOUNT)=SEM
        EARRAY(61,ECOUNT)=AA
        EARRAY(62,ECOUNT)=MA
        EARRAY(63,ECOUNT)=WA

        GOTO 999

970     PAGE=PAGE+1
        IPOS=SIZE(OUTDV2)+1
        WRITE (OUTDV2#IPOS,972)PAGE
972     FORMAT(/,20X,'XRAY NODE STATISTICS REPORT',10X,'PAGE ',I5,/,
     +  /,20X,7('NODE',3X),'NODE')
        IPOS=SIZE(OUTDV2)+1
        WRITE(OUTDV2#IPOS,973)(EARRAY(1,I),I=1,8)
973     FORMAT(18X,7(I6,1X),I6,/)

974     DO 980 I=2,63
        IPOS=SIZE(OUTDV2)+1
        WRITE(OUTDV2#IPOS,975)(NAMES(I,J),J=1,3),(EARRAY(I,J),J=1,8)
975     FORMAT (5X,2A5,A2,1X,7(I6,1X),I6)
980     CONTINUE

        IPOS=SIZE(OUTDV2)+1
        WRITE (OUTDV2#IPOS,982)
982     FORMAT (//)
        IF (ENDFLG.EQ.1) GOTO 999
        ECOUNT=1
        DO 985 I=1,63
        DO 985 J=1,8
        EARRAY(I,J)=0
985     CONTINUE

CCCCC
C RETURN
CCCCC
999     RETURN
        END
