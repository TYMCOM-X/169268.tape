












                                 TYMNET ENGINE TRAINING MANUAL                                 TYMNET ENGINE TRAINING MANUAL                                 TYMNET ENGINE TRAINING MANUAL                                 TYMNET ENGINE TRAINING MANUAL


                                         BY ED MOORING















                                   FOR TRAINING PURPOSES ONLY                                   FOR TRAINING PURPOSES ONLY                                   FOR TRAINING PURPOSES ONLY                                   FOR TRAINING PURPOSES ONLY
            













            ====================================================================
            |       THIS DOCUMENT IS THE SOLE PROPERTY AND CONFIDENTIAL        |
            |       INFORMATION  OF  TYMSHARE,  INC.,  AND  MAY  NOT BE        |
            |       COPIED  IN  WHOLE OR IN PART  OR  DISCLOSED  TO ANY        |
            |       THIRD PARTY  WITHOUT THE PRIOR  WRITTEN  CONSENT OF        |
            |       TYMSHARE.                                                  |
            ====================================================================


                              Parts of this document are based on ENGINE.DOC.
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                       Table of Contents                                       Table of Contents                                       Table of Contents                                       Table of Contents





      Chapter                                                                         Page



          List of Figures           .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . viii

          List of Tables            .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . x


      1.    ENGINE BLOCK DIAGRAM EXPLANATION .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  


      2.    THE PROGRAM STATUS WORD .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 3


      3.    FRONT CONSOLE OPERATION .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 7

          3-1    UTILITY OPERATIONS .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 7

               3-1.1   STOPPING THE COMPUTER .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 7

               3-1.2   CLEARING THE SWITCH REGISTER   .  .  .  .  .  .  .  .  .  .  .  . 7

               3-1.3   ENTERING DIGITS INTO THE SWITCH REGISTER   .  .  .  .  .  .  .  . 7

               3-1.4   REPEATING AN OPERATION   .  .  .  .  .  .  .  .  .  .  .  .  .  . 7

          3-2    MEMORY OPERATIONS  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 8

               3-2.1   SELECTING AN ADDRESS  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 8

               3-2.2   READING FROM MEMORY   .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 8

               3-2.3   WRITING INTO MEMORY   .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 8

               3-2.4   INCREMENTING OR DECREMENTING THROUGH MEMORY   .  .  .  .  .  .  . 8

          3-3    THE PSW            .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 9

               3-3.1   READING THE PSW .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 9

               3-3.2   SETTING A NEW PSW  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 9

          3-4    REGISTER OPERATIONS   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   10

               3-4.1   SELECTING A REGISTER SET .  .  .  .  .  .  .  .  .  .  .  .  .   10

               3-4.2   SELECTING A GENERAL REGISTER   .  .  .  .  .  .  .  .  .  .  .   10


      Table of Contents                                                                  i
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                     3-4.3   WRITING INTO A GENERAL REGISTER   .  .  .  .  .  .  .  .  .  .   10

                3-5    RUNNING THE COMPUTER  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   11

                     3-5.1   STARTING THE COMPUTER .  .  .  .  .  .  .  .  .  .  .  .  .  .   11

                     3-5.2   SINGLE STEPPING THE COMPUTER   .  .  .  .  .  .  .  .  .  .  .   11

                     3-5.3   INITIALIZING THE COMPUTER   .  .  .  .  .  .  .  .  .  .  .  .   11

                     3-5.4   STARTING THE BOOTSTRAP   .  .  .  .  .  .  .  .  .  .  .  .  .   11

                3-6    ADDITIONAL CONSOLE OPERATING PROCEDURES .  .  .  .  .  .  .  .  .  .   12

                     3-6.1   STOPPING THE COMPUTER .  .  .  .  .  .  .  .  .  .  .  .  .  .   12

                     3-6.2   MAKING THE COMPUTER PAUSE   .  .  .  .  .  .  .  .  .  .  .  .   12

                     3-6.3   TAKING A SAMPLE (SNAP) OF A RUNNING MACHINE'S LOCATION
                                      AND STATUS   .  .  .  .  .  .  .  .  .  .  .  .  .  .   12

                3-7    CONSOLE DIAGNOSTICS   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   13


            4.    INSTRUCTION FORMATS     .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   15

                4-1    REGISTER TO REGISTER FORMAT (RR)  .  .  .  .  .  .  .  .  .  .  .  .   15

                4-2    SHORT FORMAT (SF)  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   15

                4-3    REGISTER AND IMMEDIATE STORAGE (RI1, RI2)  .  .  .  .  .  .  .  .  .   16

                4-4    REGISTER AND INDEXED STORAGE (RX1,RX2,RX3) .  .  .  .  .  .  .  .  .   17


            5.    INSTRUCTION SET         .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   21

                5-1    LOGICAL INSTRUCTIONS  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   23

                     5-1.1   LOAD Instructions  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   23

                     5-1.2   LOAD Address Instructions   .  .  .  .  .  .  .  .  .  .  .  .   24

                     5-1.3   LOAD Halfword Logical Instructions   .  .  .  .  .  .  .  .  .   24

                     5-1.4   LOAD Multiple Instructions  .  .  .  .  .  .  .  .  .  .  .  .   25

                     5-1.5   LOAD Byte Instructions   .  .  .  .  .  .  .  .  .  .  .  .  .   25

                     5-1.6   EXCHANGE Halfword Instructions .  .  .  .  .  .  .  .  .  .  .   26

                     5-1.7   EXCHANGE Byte Instructions  .  .  .  .  .  .  .  .  .  .  .  .   26

                     5-1.8   STORE Instructions .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   27


            ii                                         
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


               5-1.9   STORE Multiple Instructions .  .  .  .  .  .  .  .  .  .  .  .   27

               5-1.10  STORE Byte Instructions  .  .  .  .  .  .  .  .  .  .  .  .  .   28

               5-1.11  COPY Instructions  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   28

               5-1.12  COMPARE Logical Instructions   .  .  .  .  .  .  .  .  .  .  .   29

               5-1.13  COMPARE Logical Byte Instructions .  .  .  .  .  .  .  .  .  .   29

               5-1.14  AND Instructions   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   30

               5-1.15  OR Instructions .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   31

               5-1.16  EXCLUSIVE OR Instructions   .  .  .  .  .  .  .  .  .  .  .  .   31

               5-1.17  ARRAY-AND Instructions   .  .  .  .  .  .  .  .  .  .  .  .  .   32

               5-1.18  TEST IMMEDIATE Instructions .  .  .  .  .  .  .  .  .  .  .  .   32

               5-1.19  SHIFT Left Logical Instructions   .  .  .  .  .  .  .  .  .  .   33

               5-1.20  SHIFT Right Logical Instructions  .  .  .  .  .  .  .  .  .  .   33

               5-1.21  SHIFT Left Halfword Logical Instructions   .  .  .  .  .  .  .   33

               5-1.22  SHIFT Right Halfword Logical Instructions  .  .  .  .  .  .  .   34

               5-1.23  ROTATE Left Logical Instructions  .  .  .  .  .  .  .  .  .  .   34

               5-1.24  ROTATE Right Logical Instructions .  .  .  .  .  .  .  .  .  .   35

               5-1.25  TEST and Set Instructions   .  .  .  .  .  .  .  .  .  .  .  .   35

               5-1.26  TEST Bit Instructions .  .  .  .  .  .  .  .  .  .  .  .  .  .   36

               5-1.27  SET Bit Instructions  .  .  .  .  .  .  .  .  .  .  .  .  .  .   36

               5-1.28  RESET Bit Instructions   .  .  .  .  .  .  .  .  .  .  .  .  .   37

               5-1.29  COMPLEMENT Bit Instructions .  .  .  .  .  .  .  .  .  .  .  .   37

          5-2    JUMP INSTRUCTIONS  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   39

               5-2.1   JUMP on CONDITION Instructions .  .  .  .  .  .  .  .  .  .  .   39

               5-2.2   JUMP and LINK Instructions  .  .  .  .  .  .  .  .  .  .  .  .   41

               5-2.3   JUMP on Find First One Instructions  .  .  .  .  .  .  .  .  .   41

          5-3    ARITHMETIC INSTRUCTIONS  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   43

               5-3.1   ADD Instructions   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   43



      Table of Contents                                                                iii
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                     5-3.2   ADD to Memory Instructions  .  .  .  .  .  .  .  .  .  .  .  .   44

                     5-3.3   SUBTRACT Instructions .  .  .  .  .  .  .  .  .  .  .  .  .  .   44

                     5-3.4   COMPARE Algebraic Instructions .  .  .  .  .  .  .  .  .  .  .   45

                     5-3.5   MULTIPLY Instructions .  .  .  .  .  .  .  .  .  .  .  .  .  .   46

                     5-3.6   MULTIPLY Halfword Instructions .  .  .  .  .  .  .  .  .  .  .   46

                     5-3.7   DIVIDE Instructions   .  .  .  .  .  .  .  .  .  .  .  .  .  .   47

                     5-3.8   DIVIDE Halfword Instructions   .  .  .  .  .  .  .  .  .  .  .   47

                     5-3.9   SHIFT Right Arithmetic Instructions  .  .  .  .  .  .  .  .  .   48

                     5-3.10  LOAD Halfword Register Instructions  .  .  .  .  .  .  .  .  .   48

                5-4    STATUS SWITCHING INSTRUCTIONS  .  .  .  .  .  .  .  .  .  .  .  .  .   51

                     5-4.1   LOAD Program Status Word Instructions   .  .  .  .  .  .  .  .   51

                     5-4.2   EXCHANGE Program Status Register Instructions .  .  .  .  .  .   51

                     5-4.3   SUPERVISOR Call Instructions   .  .  .  .  .  .  .  .  .  .  .   52

                5-5    I/O INSTRUCTIONS   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   53

                     5-5.1   Console IO Instructions  .  .  .  .  .  .  .  .  .  .  .  .  .   53

                     5-5.2   Sense Status Instructions   .  .  .  .  .  .  .  .  .  .  .  .   54

                     5-5.3   Output Command Instructions .  .  .  .  .  .  .  .  .  .  .  .   54

                     5-5.4   Read Data Instructions   .  .  .  .  .  .  .  .  .  .  .  .  .   55

                     5-5.5   Write Data Instructions  .  .  .  .  .  .  .  .  .  .  .  .  .   55

                5-6    SPECIAL INSTRUCTIONS  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   57

                     5-6.1   Async Microcode Instructions   .  .  .  .  .  .  .  .  .  .  .   57

                          A.        SBOD  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   57

                          B.        XMIT  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   57

                          C.        SPM   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   57

                          D.        GCHAR .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   58

                     5-6.2   SYNC Microcode Instructions .  .  .  .  .  .  .  .  .  .  .  .   61

                          A.        SCAN  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   61



            iv                                         
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                    B.        ALIGN .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   61

                    C.        CKSUM .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   62

               5-6.3   Bufferlet Microcode Instructions  .  .  .  .  .  .  .  .  .  .   62

                    A.        GCI   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   62

                    B.        WCI   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   63

                    C.        CBCT  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   63

                    D.        RTD1 and RTD2  .  .  .  .  .  .  .  .  .  .  .  .  .  .   64

                    E.        RMA1 and RMA2  .  .  .  .  .  .  .  .  .  .  .  .  .  .   64

                    F.        Buffer and Bufferlet Structure   .  .  .  .  .  .  .  .   65


      6.    BOARD BLOCK DIAGRAMS    .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   67

          6-1    CPU BLOCK DIAGRAM EXPLANATION  .  .  .  .  .  .  .  .  .  .  .  .  .   69

          6-2    ROM & I/O CARD BLOCK DIAGRAM   .  .  .  .  .  .  .  .  .  .  .  .  .   75

          6-3    MAC BLOCK DIAGRAM EXPLANATION  .  .  .  .  .  .  .  .  .  .  .  .  .   79

          6-4    MULTI-FUNCTION CARD BLOCK DIAGRAM EXPLANATION .  .  .  .  .  .  .  .   83

          6-5    SYNC CARD BLOCK DIAGRAM EXPLANATION  .  .  .  .  .  .  .  .  .  .  .   85

          6-6    ASYNC CARD BLOCK DIAGRAM EXPLANATION .  .  .  .  .  .  .  .  .  .  .   89

          6-7    QUAD PRINTER INTERFACE CARD BLOCK DIAGRAM EXPLANATION  .  .  .  .  .   93

               6-7.1   DAUGHTER BOARD BLOCK DIAGRAM EXPLANATION:  .  .  .  .  .  .  .   94


      7.    THE SIO SYSTEM          .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   95

          7-1    HARDWARE           .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   95

               7-1.1   THE PCSIO    .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   95

                    A.        SIO BLOCK DIAGRAM EXPLANATION .  .  .  .  .  .  .  .  .   96

                    B.        The PCSIO Microcode  .  .  .  .  .  .  .  .  .  .  .  .  102

               7-1.2   INTERFACE BOARDS   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  111

                    A.        The Z-80 SIO Chip .  .  .  .  .  .  .  .  .  .  .  .  .  112

                    B.        T609 CMOS Support Chip  .  .  .  .  .  .  .  .  .  .  .  121



      Table of Contents                                                                  v
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                          C.        Synchronous RS232/V.24 and V.35 Interface Boards  .  .   121

                          D.        Asynchronous RS232/V.24 Interface Board  .  .  .  .  .   121

                          E.        Optically Coupled Serial I/O (OCSIO) Interface
                                      Board  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  121

                7-2    SOFTWARE INTERFACE .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  122

                     7-2.1   CPU COMMANDS TO THE SIO CARD   .  .  .  .  .  .  .  .  .  .  .  122

                          A.        Sense Status Instructions  .  .  .  .  .  .  .  .  .  .  122

                          B.        Start Input Command  .  .  .  .  .  .  .  .  .  .  .  .  124

                          C.        Start Output Command .  .  .  .  .  .  .  .  .  .  .  .  124

                          D.        Relocation Command   .  .  .  .  .  .  .  .  .  .  .  .  124

                          E.        Lower Limit Command  .  .  .  .  .  .  .  .  .  .  .  .  124

                          F.        Window Size Command  .  .  .  .  .  .  .  .  .  .  .  .  124

                          G.        Read Status Command  .  .  .  .  .  .  .  .  .  .  .  .  125

                          H.        Reset Command  .  .  .  .  .  .  .  .  .  .  .  .  .  .  125

                          I.        Channel Reset Command   .  .  .  .  .  .  .  .  .  .  .  126

                     7-2.2   CHANNEL COMMANDS   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  126

                          A.        Input Channel Commands  .  .  .  .  .  .  .  .  .  .  .  128

                          B.        Output Channel Commands .  .  .  .  .  .  .  .  .  .  .  129

                     7-2.3   SIO INTERRUPTS  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  129


            8.    INTERRUPTS AND INTERRUPT HANDLING   .  .  .  .  .  .  .  .  .  .  .  .  .  131

                8-1    GENERAL SEQUENCE   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  131

                8-2    INTERRUPT PRIORITIES  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  132

                8-3    ILLEGAL INSTRUCTION INTERRUPT  .  .  .  .  .  .  .  .  .  .  .  .  .  133

                8-4    MACHINE MALFUNCTION INTERRUPTS .  .  .  .  .  .  .  .  .  .  .  .  .  133

                8-5    CONSOLE ATTENTION  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  133

                8-6    RELOCATION/PROTECTION (MAC) .  .  .  .  .  .  .  .  .  .  .  .  .  .  133

                8-7    SUPERVISORY CALL (SVC)   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  134



            vi                                         
      ED MOORING                 TYMNET ENGINE TRAINING MANUA           June 29, 1983


          8-8    I/O INTERRUPTS     .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  134

               8-8.1   ATN0 INTERRUPTS .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  134

               8-8.2   ATN1 INTERRUPTS .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  135

               8-8.3   ATN2 INTERRUPTS .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  135

               8-8.4   THE RACKX/TACKX CHAIN .  .  .  .  .  .  .  .  .  .  .  .  .  .  136


      9.    MEMORY MANAGEMENT       .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  137

          9-1    RELOCATION         .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  137

          9-2    PROTECTION         .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  138

          9-3    THE SEGMENTATION REGISTERS  .  .  .  .  .  .  .  .  .  .  .  .  .  .  139

          9-4    INTERRUPT STATUS REGISTER   .  .  .  .  .  .  .  .  .  .  .  .  .  .  141


      10.   MICROCODE MAP EXPLANATION  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  145


      11.   THE MAPPING PROM AND OPCODE DECODING   .  .  .  .  .  .  .  .  .  .  .  .  151


      12.   System Illustrations    .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  153


          Appendix A

             ALPHABETICAL SUMMARY OF THE ENGINE INSTRUCTION SET   .  .  .  .  .  .  .  161


          Appendix B

             NUMERIC SUMMARY OF THE ENGINE INSTRUCTION SET  .  .  .  .  .  .  .  .  .  167


          Index                     .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  175














      Table of Contents                                                                vii
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                              List of Figures                                              List of Figures                                              List of Figures                                              List of Figures



            Figure                                                                          Page


             1-1.  System Block Diagram   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .    1

             3-1.  Instruction Formats .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   14

             4-1.  Register to Register Format  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   15

             4-2.  Short Format  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   16

             4-3.  Register and Indexed Storage Immediate   .  .  .  .  .  .  .  .  .  .  .   16

             4-4.  RX1 Format .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   17

             4-5.  RX2 Format .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   19

             4-6.  RX3 format .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   20

             6-1.  CPU Block Diagram   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   68

             6-2.  ROM & I/O Block Diagram   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   74

             6-3.  MAC Block Diagram   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   78

             6-4.  Multifunction Card Block Diagram   .  .  .  .  .  .  .  .  .  .  .  .  .   82

             6-5.  Sync Card Block Diagram   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   84

             6-6.  Async Card Block Diagram  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   88

             6-7.  Quad Printer Interface Block Diagram  .  .  .  .  .  .  .  .  .  .  .  .   92

             7-1.  PCSIO Block Diagram .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   97

             7-2.  PCSIO Microcode Map .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  103

             7-3.  Z-80 SIO Chip Write Registers.  .  .  .  .  .  .  .  .  .  .  .  .  .  .  113

             7-4.  Z-80 SIO Read Registers.  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  120

             7-5.  Pictorial Summary of the SIO/MUX Bus Interface.   .  .  .  .  .  .  .  .  123

             7-6.  SIO DMA Interface Channel Commands.   .  .  .  .  .  .  .  .  .  .  .  .  127

             9-1.  Example of Relocation by MAC .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  138

             9-2.  Segmentation Register Fields.   .  .  .  .  .  .  .  .  .  .  .  .  .  .  141

             9-3.  Interrupt Status Register Bits and Meanings .  .  .  .  .  .  .  .  .  .  142


            viii                                       
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


       9-4.  Microcode Map .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  144

      10-1.  Op-code Decoding .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  150

      12-1.  Tymnet Engine .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  154

      12-2.  Basic Engine (Front View) .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  155

      12-3.  Basic Engine (Rear View)  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  156

      12-4.  Basic Engine (with options)  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  157

      12-5.  Basic Engine (with options)  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  158

      12-6.  Tymnet Engine (Two Chassis)  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  159

      12-7.  Tymnet Engine (Two Chassis Back View, Showing Terminators)  .  .  .  .    160







































      List of Figures                                                                   ix
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                               List of Tables                                               List of Tables                                               List of Tables                                               List of Tables



            Table                                                                           Page


            2-1.  Meaning of PSW Bits  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .    3

            2-2.  I/O Interrupt Enable .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .    4

            2-3.  Privileged Instructions .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .    5

            3-1.  Console Error Messages  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   13

            6-1.  Async Board Addresses and Signals   .  .  .  .  .  .  .  .  .  .  .  .  .   89

            6-2.  Async Board Addresses   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .   89

            7-1.  B Bus Destinations and Special Functions  .  .  .  .  .  .  .  .  .  .  .  105

            7-2.  B Bus Sources  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  106

            7-3.  Operand Sources for the 2901 ALU.   .  .  .  .  .  .  .  .  .  .  .  .  .  106

            7-4.  2901 ALU Operation Control .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  108

            7-5.  2901 ALU Result Destinations. .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  108

            7-6.  Test Condition Selection.  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  110

            7-7.  SIO Status Halfwords.   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  125

            8-1.  Dedicated Memory Addresses .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  132

            8-2.  Interrupt Priorities .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  132

            9-1.  Dedicated Addreses for Segmentation Registers.  .  .  .  .  .  .  .  .  .  139


















            x                                          
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                           Chapter 1                                           Chapter 1                                           Chapter 1                                           Chapter 1

                                ENGINE BLOCK DIAGRAM EXPLANATION                                ENGINE BLOCK DIAGRAM EXPLANATION                                ENGINE BLOCK DIAGRAM EXPLANATION                                ENGINE BLOCK DIAGRAM EXPLANATION




      The block diagram shows a "full-blown" Engine with all of the possible  options.  In
      most machines, these will  not all be used.  The  basic Engine consists of  the CPU,
      ROM & I/O, MAC, Multi-Function, Sync and Async cards, together with the  core memory
      and  the console  blocks.  The  other cards  and features  are added  as  needed for
      special applications.

      BLOCKS:

      CPU      CPU      CPU      CPU--This is where the actual  processing occurs.  It contains the ALU,  the working
      registers, the system clock, and a  stack of 256 general registers, divided  into 16
      sets of 16 registers each.

      ROM  & I/O      ROM  & I/O      ROM  & I/O      ROM  & I/O--This  board  contains the  microcode  and its  controlling  and decoding
      circuitry.  It also contains interfaces with the Memory Access Controller  (MAC) and
      the system console, and generates the I/O Bus.

      MAC      MAC      MAC      MAC--This is the memory access controller.   It is the only path through  which data
      flows to and from the memory, and it also handles the restoring of the core after it
      is read, creates the DMA bus, handles the DMA and standard memory access priorities,
      and the software-controlled relocation and protection circuitry.

      Core Memory      Core Memory      Core Memory      Core Memory--The  memory for the  Engine consists  of up to  16 64  kilobyte Dataram
      magnetic core memory boards.  This allows  up to a megabyte of memory.   The address
      bus for the Engine is only 19 bits effectively, though, since it accesses the memory
      along half-word (16 bit) boundaries.   The 20th bit of addressing, needed  to access
      the full megabyte, is forced to zero,  and the addressed byte and the next  byte are
      put onto the Memory Sense Bus as a single 17-bit word consisting of a parity bit and
      the 16 bits of data.

      Multi-Function Card      Multi-Function Card      Multi-Function Card      Multi-Function Card--The Multi-Function Card resides on the I/O Bus, and as its name
      implies, performs a number of  necessary housekeeping functions for the  Engine.  It
      contains a  local TTY  interface, the external  PROM Loader,  the watchdog  timer, a
      temperature sensor, the 3600 Baud interrupt generator, and the interface to  WWV for
      network supervisor timing.

      Console      Console      Console      Console--The operator console  is connected to  the ROM &  I/O board by  the Console
      Bus.  It contains the hex displays to show memory addresses or data, the contents of
      the  general  registers,  and  the  PSW;  and  the  keyboard  for  machine  language
      programming.










                                           Chapter 1 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983























































                                     Figure 1-1                                     Figure 1-1                                     Figure 1-1                                     Figure 1-1.  System Block Diagram


            ENGINE BLOCK DIAGRAM EXPLANATION                                                   1
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      Async Card      Async Card      Async Card      Async Card--Each Async Card contains 32 low-speed asynchronous ports which  are used
      to interface to terminals or  other peripherals directly or through the  phone lines
      using modems.  The Engine can contain up to 8 of these boards if it is  enhanced and
      four if it is not.

      Sync Card      Sync Card      Sync Card      Sync Card--The Sync Card provides 16 high-speed synchronous ports used  to interface
      the Engine with certain  IBM terminals, and to connect  it to the network  via high-
      speed  synchronous  modems.   The  Engine can  contain  two  of  these  boards, thus
      providing 32 synchronous lines.

      ESELCH (Extended  SELector CHannel)      ESELCH (Extended  SELector CHannel)      ESELCH (Extended  SELector CHannel)      ESELCH (Extended  SELector CHannel)--This board  is the only  means of talking  to a
      disk or mag tape unit.  It is  connected to the standard I/O and DMA buses,  as well
      as to  a private  I/O bus  used only  by the  disk and/or  tape controllers  and the
      ESELCH.  The disk and tape drives get data to and from the Engine via DMA.  Whenever
      such an operation is to be performed, the CPU needs to communicate with the disk and
      tape controllers.  The ESELCH connects the I/O bus to the disk and tape controllers'
      private I/O bus so that the CPU  can communicate with them.  Then the CPU  sends the
      ESELCH  the starting  and  stopping addresses  for  the DMA  operation.   The ESELCH
      connects the  disk and tape  I/O bus  to the DMA  bus and handles  the DMA  by cycle
      stealing, that is, taking every other available memory cycle to do the DMA.  When it
      is finished, it generates an interrupt.

      PCSIO (Printed Circuit Serial  I/O)      PCSIO (Printed Circuit Serial  I/O)      PCSIO (Printed Circuit Serial  I/O)      PCSIO (Printed Circuit Serial  I/O)--This card is used  to interface up to  16 high-
      speed serial I/O lines to the Engine via DMA.  It will support standard synchronous,
      asynchronous,  HDLC, and  very  high-speed optically  coupled  serial communications
      modes.  It is controlled by a microprogrammed microprocessor on the board.   The CPU
      sends the card  an address for  the memory location  where the instructions  for the
      card begin.  The PCSIO then accesses that memory location for the first  command and
      continues accessing memory via DMA until it reaches an instruction that tells  it to
      stop.  In other words, the program for the microprocessor on the board  is contained
      in the main memory and may be altered by the CPU or other DMA.  The microprogramming
      on the card then handles the addressing and control of the various I/O lines.

      SIO interface cards      SIO interface cards      SIO interface cards      SIO interface cards--These cards are used only with the PCSIO and reside in  a small
      auxiliary card  cage connected to  the SIO  card with ribbon  cables.  Each  card is
      designed to  handle a particular  communications mode or  protocol and  contains two
      ports of that type.  The protocols or modes available are  asynchronous, synchronous
      or HDLC, and very high speed optically coupled serial communication.

      Quad Printer Interface      Quad Printer Interface      Quad Printer Interface      Quad Printer Interface--This card is used  to interface up to four line  printers to
      the Engine.















      2                                    Chapter 1 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                                 Chapter 2                                                 Chapter 2                                                 Chapter 2                                                 Chapter 2

                                          THE PROGRAM STATUS WORD                                          THE PROGRAM STATUS WORD                                          THE PROGRAM STATUS WORD                                          THE PROGRAM STATUS WORD




            The Program Status Word (PSW) is a  16-bit register on the ROM & I/O Card,  which is
            used  to  control and/or  describe  the state  of  the machine.   The  functions and
            meanings of the various bits are shown in Table 2-1:


                                                 Table 2-1                                                 Table 2-1                                                 Table 2-1                                                 Table 2-1

                                            Meaning of PSW Bits

                 PSW BIT         FUNCTION
                 0               Wait Bit.
                 1               I/O Interrupt Enable.
                 2               Machine Malfunction Enable.
                 3               Trace Bit.
                 4               Async-enhanced microcode enable.
                 5               Enables relocation/protection interrupts.
                 6               Enables sync-enhanced microcode interrupt
                                 (ATN1) servicing.
                 7               Declares execution of privileged mode
                                 instructions illegal.
                 8               Bit 0 of Register Set Select.  Also used
                                 to enable I/O interrupts.
                 9               Bit 1 of Register Set Select.  Also used to
                                 enable I/O interrupts.
                 10              Bit 2 of Register Set Select.
                 11              Bit 3 of Register Set Select.
                 12              Result of operation is longer than 32 bits.
                 13              False SYNC time-out on I/O Bus.
                 14              Result of operation is greater than 0.
                 15              Result of operation is less than 0.

            BIT 0
            WAIT BIT

            When  set,  this  bit will  cause  the  processor to  wait,  halting  normal program
            execution until a  new PSW is  loaded, with bit 0  reset, allowing the  processor to
            execute instructions.

            BIT 1
            I/O INTERRUPT ENABLE

            When set,  this bit allows  the CPU  to acknowledge and  service I/O  interrupts, in
            conjunction with bits 8 and 9, which determine the levels of I/O interrupts enabled.
            The selection is shown below in Table 2-2.

            If bit 1 is reset, all I/O interrupts are disabled.



            THE PROGRAM STATUS WORD                                                            3
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                           Table 2-2                                           Table 2-2                                           Table 2-2                                           Table 2-2

                                      I/O Interrupt Enable

           BIT 1   BIT 8   BIT 9           INTERRUPTS ENABLED
           SET     RESET   DON'T CARE      ATN0
           SET     SET     RESET           ATN0 & ATN1
           SET     SET     SET             ATN0,ATN1, & ATN2

      BIT 2
      MACHINE MALFUNCTION INTERRUPT ENABLE

      This  bit,  when  set,  allows the  machine  to  recognize  and  acknowledge machine
      malfunction interrupts.  When such an  interrupt occurs with bit 2 set,  the machine
      enters  the  appropriate  interrupt  service routine.   If  the  bit  is  reset, the
      interrupt is ignored.

      BIT 3
      TRACE BIT

      The  Trace Bit  is a  debugging tool  for software.   It can  be enabled  by  a UPSW
      instruction (opcode D5), which is not a privileged instruction.  When it is enabled,
      it  causes the  program to  enter a  special subroutine,  analogous to  an interrupt
      service routine, before each jump instruction is executed.

      When a jump  instruction is read  in and the  Trace Bit is  on, the Jump  address is
      stored in memory address 14, subject to relocation by the MAC.  The PSW in effect at
      the time is stored in memory address 10, also subject to relocation.  The  Trace Bit
      is turned off, and a fullword pointer from user memory address 18 is loaded into the
      Program Counter.   This address is  the beginning of  the special  subroutine, whose
      function is  completely up to  the programmer.  It  might check  program conditions,
      store program addresses, or simply display something on the console.  At the  end of
      the routine,  the programmer should  put in  a UPSW instruction  from address  10 to
      restore the  old PSW and  jump address, reset  the Trace Bit  and continue  with the
      original program.  Each time a jump  instruction is executed with the Trace  Bit on,
      the above sequence will occur.

      BIT 4
      ASYNC-ENHANCED MICROCODE ENABLE

      When Bit 4 is  set, it allows the  use of the async-enhanced  microcode instructions
      **SBOD,  **XMIT, **SPM,  and **GCHAR.   If bit  4 is  reset, these  instructions are
      treated as illegal instructions.

      BIT 5
      MEMORY RELOCATION/PROTECTION ENABLE

      When set, this bit turns on the relocation and protection circuitry in the MAC.  All
      memory  accesses  are  then  subject  to  relocation,  and  validity  checks  by the
      protection  circuitry.   It  also  allows the  processor  to  recognize  and service
      interrupts from the MAC.   When the bit is  reset, all relocation and  protection is
      turned off, and no MAC interrupts are recognized.




      4                                    Chapter 2 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            BIT 6
            SYNC-ENHANCED MICROCODE INTERRUPT SERVICE ENABLE

            When this bit is  set, it allows the processor  to service ATN1 interrupts  with the
            routine in the sync-enhanced  microcode, if the machine has  it.  If the bit  is not
            set, a machine with sync-enhanced microcode receiving an ATN1 interrupt treats it as
            an ATN2 interrupt.  If a  machine doesn't have sync-enhanced microcode,  the setting
            of bit 6 is immaterial.  If ATN1 is received the machine will die.

            BIT 7
            PRIVILEGED INSTRUCTION DISABLE

            When  this bit  is set,  no privileged  instructions will  be executed.   If  one is
            encountered,  it  is  treated  as an  illegal  instruction  and  creates  an Illegal
            Instruction interrupt.  When  the bit is reset,  all privileged instructions  can be
            executed.  The privileged instructions are listed below in Table 2-3:


                                                 Table 2-3                                                 Table 2-3                                                 Table 2-3                                                 Table 2-3

                                          Privileged Instructions

                 INSTRUCTION                             MNEMONIC        OPCODE
                 Exchange Program Status Register        EPSR            95
                 Load Program Status Word                LPSW            C2
                 Load Program Status Word Register       LPSWR           18
                 Write Data Register                     WDR             9A
                 Write Data                              WD              DA
                 Read Data                               RDR             9B
                 Sense Status                            SSR             9D
                 Output Command                          OC              DE
                 Output Command Register                 OCR             9E


            BITS 8-11
            REGISTER SET SELECT

            Bits 8-11 of the PSW are used to select which of the 16 sets of 16 general registers
            is to  be used  in that  portion of  the program.   Bits 8  and 9  are also  used in
            conjunction with bit 1 of the PSW to enable the various levels of I/O interrupts, as
            described in the section on bit 1.

            BITS 12-15
            CONDITION CODE

            The Condition Code is used to give the programmer some information about the results
            of instructions and to determine whether jumps are executed.  Most user instructions
            change the Condition Code  in some way.  See  the description of the  instruction in
            Chapter 5 for details on  how it is changed.  The  usual meaning of each bit  in the
            Condition Code is explained below:






            THE PROGRAM STATUS WORD                                                            5
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


              BIT 12
              CARRY FLAG

              This bit is set whenever the result of an operation is longer than 32 bits.

              BIT 13
              OVERFLOW FLAG

              This flag corresponds to the Overflow Flag on the Interdata 7/32, so  it has
              the same name in the  write-ups.  However, its function is different  in the
              Engine.  Following any arithmetic instruction, the flag is set to zero.  The
              flag is set when  a false sync timeout  occurs after an I/O  instruction.  A
              false  sync timeout  occurs  when an  I/O  device is  addressed  and doesn't
              respond with SYN0.

              BIT 14
              GREATER THAN ZERO FLAG

              This flag is set whenever the sign bit (most significant bit) of  the result
              is zero and there is at least one bit set in the result, indicating a result
              greater than  zero.  It  is also set  when a  memory parity  error interrupt
              occurs.

              BIT 15
              LESS THAN ZERO FLAG

              This flag is set when the sign  bit of the result is one.  If neither  the G
              flag nor the L flag is set, the result was zero.




























      6                                    Chapter 2 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                                 Chapter 3                                                 Chapter 3                                                 Chapter 3                                                 Chapter 3

                                          FRONT CONSOLE OPERATION                                          FRONT CONSOLE OPERATION                                          FRONT CONSOLE OPERATION                                          FRONT CONSOLE OPERATION




            This section  describes the  operation of the  front console.   It assumes  that the
            Engine is stopped, that is, the WAIT bit in the PSW is set.



            3-1    UTILITY OPERATIONS            3-1    UTILITY OPERATIONS            3-1    UTILITY OPERATIONS            3-1    UTILITY OPERATIONS


            3-1.1    STOPPING THE COMPUTER            3-1.1    STOPPING THE COMPUTER            3-1.1    STOPPING THE COMPUTER            3-1.1    STOPPING THE COMPUTER

            There are a number of keys which will stop the processor.  The easiest is  the [PSW]
            key.   Pressing the  [PSW] key  will stop  the computer,  and cause  the  console to
            display the current PSW, with the WAIT bit set, and the current memory address, that
            of the instruction about to be  executed.  Note that the Engine can only  be stopped
            if the Keyswitch is set to RUN mode.   If it is in the Lock position, the  keys have
            no effect.  See "Additional Console Operating Procedures" for more information.


            3-1.2    CLEARING THE SWITCH REGISTER            3-1.2    CLEARING THE SWITCH REGISTER            3-1.2    CLEARING THE SWITCH REGISTER            3-1.2    CLEARING THE SWITCH REGISTER

            The Switch Register may  be cleared by pressing the  [DTA] key.  It is  also cleared
            when the first  digit of a new  number is entered after  a function key  is pressed.
            For example, if [ADR] was pressed to select an address, entering the first  digit of
            the data for that address will clear the register.


            3-1.3    ENTERING DIGITS INTO THE SWITCH REGISTER            3-1.3    ENTERING DIGITS INTO THE SWITCH REGISTER            3-1.3    ENTERING DIGITS INTO THE SWITCH REGISTER            3-1.3    ENTERING DIGITS INTO THE SWITCH REGISTER

            Simply key the  numbers in.  If the  console was in some  other mode when  the first
            digit is entered, it  will clear, and display  the contents of the  Switch Register.
            The  right half  of the  display, along  with its  label, will  flash,  indicating a
            pending operation.


            3-1.4    REPEATING AN OPERATION            3-1.4    REPEATING AN OPERATION            3-1.4    REPEATING AN OPERATION            3-1.4    REPEATING AN OPERATION

            Pressing [RPT] will repeat the previous operation for as long as the key is pressed.

            Example:  [RD] and [RPT]  will repeat the read  data operation from the  same memory
                      address.   [RD],[INC]  and [RPT]  will  read data  from  successive memory
                      locations.








            FRONT CONSOLE OPERATION                                                            7
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      3-2    MEMORY OPERATIONS      3-2    MEMORY OPERATIONS      3-2    MEMORY OPERATIONS      3-2    MEMORY OPERATIONS


      3-2.1    SELECTING AN ADDRESS      3-2.1    SELECTING AN ADDRESS      3-2.1    SELECTING AN ADDRESS      3-2.1    SELECTING AN ADDRESS

      1.  Enter the digits of the address into the Switch Register.

      2.  Press [ADR].  The console will display the address and the PSW.


      3-2.2    READING FROM MEMORY      3-2.2    READING FROM MEMORY      3-2.2    READING FROM MEMORY      3-2.2    READING FROM MEMORY

      1.  Select the address as described above (Section 3-2.1).

      2.  Press [RD].  This will cause the current memory address and the data in it to be
          displayed.


      3-2.3    WRITING INTO MEMORY      3-2.3    WRITING INTO MEMORY      3-2.3    WRITING INTO MEMORY      3-2.3    WRITING INTO MEMORY

      1.  Select the address as described above (Section 3-2.1).

      2.  Enter the data into the Switch Register.

      3.  Press [WRT].  The console will display the selected address and the data written
          in.  To check on the correctness of the data, press [RD].


      3-2.4    INCREMENTING OR DECREMENTING THROUGH MEMORY      3-2.4    INCREMENTING OR DECREMENTING THROUGH MEMORY      3-2.4    INCREMENTING OR DECREMENTING THROUGH MEMORY      3-2.4    INCREMENTING OR DECREMENTING THROUGH MEMORY

      It is possible to read or  write to successive memory locations in  either ascending
      or descending  order using the  [INC] and  [DEC] keys by  simply pressing  [INC] for
      incrementing or [DEC] for decrementing  the current address after performing  a Read
      or Write operation.   Each time the  key is depressed,  the current address  will be
      decremented by two to  the next half-word, and the  Read or Write operation  will be
      performed again.  If either key is pressed after any operation other than a  Read or
      Write, the console  will display a DEAD  0BAD message, indicating that  a disallowed
      sequence has occurred.

      NOTE:   Remember that  while performing  an increment  or decrement  during  a Write
      operation, you are writing the contents of the Switch Register into  each successive
      memory location, filling the memory with the same number.














      8                                    Chapter 3 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            3-3    THE PSW            3-3    THE PSW            3-3    THE PSW            3-3    THE PSW


            3-3.1    READING THE PSW            3-3.1    READING THE PSW            3-3.1    READING THE PSW            3-3.1    READING THE PSW

            To read the PSW, press the [PSW] key.  The console will display the  current address
            and PSW.


            3-3.2    SETTING A NEW PSW            3-3.2    SETTING A NEW PSW            3-3.2    SETTING A NEW PSW            3-3.2    SETTING A NEW PSW

            1.  Enter the new PSW into the Switch Register.

            2.  Press [SET].  The console will display  the new PSW.  Note that the  third digit
                in the PSW is the current Register Set.









































            THE PSW                                                                            9
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      3-4    REGISTER OPERATIONS      3-4    REGISTER OPERATIONS      3-4    REGISTER OPERATIONS      3-4    REGISTER OPERATIONS


      3-4.1    SELECTING A REGISTER SET      3-4.1    SELECTING A REGISTER SET      3-4.1    SELECTING A REGISTER SET      3-4.1    SELECTING A REGISTER SET

      1.  Enter the number of the register set you wish to select into the third  digit of
          the Switch Register.

      2.  Press [SET].

      NOTE:  This procedure changes the PSW.


      3-4.2    SELECTING A GENERAL REGISTER      3-4.2    SELECTING A GENERAL REGISTER      3-4.2    SELECTING A GENERAL REGISTER      3-4.2    SELECTING A GENERAL REGISTER

      1.  Press [REG].

      2.  Press the number of the register you wish to read from or write to.  The console
          will display the register number and the contents of the register.  If  [PSW] or
          [SET] is pushed first, the number  of the register set will be displayed  on the
          extreme left of the console.


      3-4.3    WRITING INTO A GENERAL REGISTER      3-4.3    WRITING INTO A GENERAL REGISTER      3-4.3    WRITING INTO A GENERAL REGISTER      3-4.3    WRITING INTO A GENERAL REGISTER

      1.  Select the desired register set and general register within the set.

      2.  Enter the first  four (left-most) digits of  the desired number into  the Switch
          Register.

      3.  Press [WRG].  The right-most four digits of the general register will shift left
          four places, and the Switch Register  contents will copy into the right  half of
          the general register.

      4.  Enter the second four digits of the number into the Switch Register.

      5.  Press [WRG] again.   The complete new 32-bit  general register contents  will be
          displayed at the console.


















      10                                   Chapter 3 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            3-5    RUNNING THE COMPUTER            3-5    RUNNING THE COMPUTER            3-5    RUNNING THE COMPUTER            3-5    RUNNING THE COMPUTER


            3-5.1    STARTING THE COMPUTER            3-5.1    STARTING THE COMPUTER            3-5.1    STARTING THE COMPUTER            3-5.1    STARTING THE COMPUTER

            1.  Select the desired starting memory address.

            2.  Press [RUN].   The light bar  on the  console will go  off, indicating  that the
                computer is running.


            3-5.2    SINGLE STEPPING THE COMPUTER            3-5.2    SINGLE STEPPING THE COMPUTER            3-5.2    SINGLE STEPPING THE COMPUTER            3-5.2    SINGLE STEPPING THE COMPUTER

            Press [SGL].  The computer will  execute one machine instruction, halt,  and display
            the current memory address and the PSW.


            3-5.3    INITIALIZING THE COMPUTER            3-5.3    INITIALIZING THE COMPUTER            3-5.3    INITIALIZING THE COMPUTER            3-5.3    INITIALIZING THE COMPUTER

            Press [INI].   Pressing this  simulates a power  failure and  causes a  restart from
            microcode address zero, creating a power-up interrupt.


            3-5.4    STARTING THE BOOTSTRAP            3-5.4    STARTING THE BOOTSTRAP            3-5.4    STARTING THE BOOTSTRAP            3-5.4    STARTING THE BOOTSTRAP

            The Boot will load from a byte-oriented device, starting at address 00080 and ending
            at the current  address, which must  be less than 00300.   The device address  and a
            command code (94) must be entered into the Switch Register first.




























            RUNNING THE COMPUTER                                                              11
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      3-6    ADDITIONAL CONSOLE OPERATING PROCEDURES      3-6    ADDITIONAL CONSOLE OPERATING PROCEDURES      3-6    ADDITIONAL CONSOLE OPERATING PROCEDURES      3-6    ADDITIONAL CONSOLE OPERATING PROCEDURES

              The procedures above are for  normal console operation, are obvious  and can
      be quickly  learned.  There  are additional  procedures which  are more  subtle, but
      which can  be of immense  help in hardware  trouble-shooting or  software debugging.
      These procedures are described below.


      3-6.1    STOPPING THE COMPUTER      3-6.1    STOPPING THE COMPUTER      3-6.1    STOPPING THE COMPUTER      3-6.1    STOPPING THE COMPUTER

              As previously mentioned, the computer may be stopped in several  ways.  Each
      method stops the CPU in a slightly different way.

      1.  Press [PSW].  The computer will stop IMMEDIATELY, displaying the  current memory
          address and the PSW.

      2.  Press [SGL].  The computer will execute the next machine instruction,  then stop
          and display the current memory address and data.

      3.  Press [REG][N].   Select a  Register.  The computer  will immediately  stop, and
          display the contents of the selected register and its number.

      4.  Press [RD].  The console will display the current memory address and  data.  The
          address will not be off by two.


      3-6.2    MAKING THE COMPUTER PAUSE      3-6.2    MAKING THE COMPUTER PAUSE      3-6.2    MAKING THE COMPUTER PAUSE      3-6.2    MAKING THE COMPUTER PAUSE

              Press [RPT] while the computer  is running.  The computer will  stop (pause)
      and the  light bar  will light.  As  long as  [RPT] is held  down, the  console will
      indicate the current PSW and memory address at the instant [RPT] was pressed.


      3-6.3    TAKING A SAMPLE (SNAP) OF A RUNNING MACHINE'S LOCATION AND STATUS      3-6.3    TAKING A SAMPLE (SNAP) OF A RUNNING MACHINE'S LOCATION AND STATUS      3-6.3    TAKING A SAMPLE (SNAP) OF A RUNNING MACHINE'S LOCATION AND STATUS      3-6.3    TAKING A SAMPLE (SNAP) OF A RUNNING MACHINE'S LOCATION AND STATUS

              Press  [RUN] while  the  computer is  running.   The console  will  show the
      current memory address and PSW at the instant [RUN] was pressed.  The processor will
      continue to  run and  the console  display will  change on  the next  console output
      instruction.

















      12                                   Chapter 3 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            3-7    CONSOLE DIAGNOSTICS            3-7    CONSOLE DIAGNOSTICS            3-7    CONSOLE DIAGNOSTICS            3-7    CONSOLE DIAGNOSTICS

                    Certain console error diagnostics have been incorporated into  the microcode
            in order  to assist  in determining  the more  common types  of machine  or operator
            errors.  These codes and their meanings  are shown in Table 3-1.  Note  that, except
            in the case of the Sync up when it should be down and operator error  messages, that
            the first four digits are the microcode addresses of the error routines.


                                                 Table 3-1                                                 Table 3-1                                                 Table 3-1                                                 Table 3-1

                                           Console Error Messages


                 CONSOLE CODE MEANING

                 001A DEAD       Illegal second  decode.  Possibly caused  by MAPSEL, bit  44 of
                                 the microcode, not being reset.

                 0160 DEAD       Illegal ATN0 interrupt.   Usually caused by having  an enhanced
                                 Multi-Function  Card in  a machine  that does  not  have async-
                                 enhanced microcode.

                 01A0 DEAD       Illegal ATN  1 interrupt.   Caused by  having an  enhanced sync
                                 card in a machine that does not have sync-enhanced microcode.

                 01E9 DEAD       No SYNC response to ATN2 interrupt.  Usually caused by a broken
                                 RACK0/TACK0 chain, or some device holding ATN2 active.   In the
                                 first case, check the  RACK0/TACK0 lines.  In the  second case,
                                 remove the I/O  boards from the machine,  one at a  time, until
                                 the problem goes away, thus locating the offending board.

                 0100 DEAD       No response to address on boot function.

                 02XX DEAD       Bad status (boot function), XX= status.

                 0060 DEAD       Early power down.

                 01A8 DEAD       SYNC up when it should be down.

                 DEAD 0BAD       Console operator error.

                 0020 DEAD       Caused by a bad interrupt decoder on the ROM & I/O Board.

                 0201 DEAD       Device unavailable.











            CONSOLE DIAGNOSTICS                                                               13
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983














































                                Figure 3-1                                Figure 3-1                                Figure 3-1                                Figure 3-1.  Instruction Formats











      14                                   Chapter 3 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                                 Chapter 4                                                 Chapter 4                                                 Chapter 4                                                 Chapter 4

                                            INSTRUCTION FORMATS                                            INSTRUCTION FORMATS                                            INSTRUCTION FORMATS                                            INSTRUCTION FORMATS




            The TYMNET  ENGINE uses  seven basic  types of  instruction formats.   The different
            formats provide various methods by which the processor may access data to be used in
            an instruction. Figure 3-1 illustrates the different formats and should  be referred
            to during the following discussion.




            4-1    REGISTER TO REGISTER FORMAT (RR)            4-1    REGISTER TO REGISTER FORMAT (RR)            4-1    REGISTER TO REGISTER FORMAT (RR)            4-1    REGISTER TO REGISTER FORMAT (RR)

            In the register to register format,  bits 0:7 specify the op code, or  the operation
            to be  performed.  Bits  8:11 contain  the R1 field  and bits  12:15 contain  the R2
            field.  In most cases, an RR instruction performs the operation specified by  the op
            code with the contents (32 bits) of the general registers specified in the R1 and R2
            fields.  The result  is placed in  the general register  specified in the  R1 field.
            Figure  4-1  illustrates a  "load"  instruction  in the  RR  format.   The assembler
            notation appears on the  right side and the machine  code appears on the  left.  For
            the machine code '0865', the '08' is the op code for a load instruction,  RR format.
            General register 6  is in the R1  field and general register  5 is in the  R2 field.
            This instruction  will take  the contents  of general  register 5  and load  it into
            general register 6, without altering the contents of register 5.


                         example:

                         0865            LR      R6,R5

                                 -----------------               -----------------
                            R6   |   XXXX YYYY   |   <-----   R5 |   XXXX YYYY   |
                                 -----------------               -----------------


                                  Figure 4-1                                  Figure 4-1                                  Figure 4-1                                  Figure 4-1.  Register to Register Format




            4-2    SHORT FORMAT (SF)            4-2    SHORT FORMAT (SF)            4-2    SHORT FORMAT (SF)            4-2    SHORT FORMAT (SF)

            In short format instructions, bits 0:7 specify the op code and bits 8:11 contain the
            R1 field.  Bits 12:15 contain a four bit quantity to be used as the  second operand.
            Figure 4-2  illustrates a short  format instruction.  In  this example, the  op code
            '24' specifies a load instruction in the SF format.  '245E' directs the processor to
            load general register 5 with a  hexadecimal quantity 'E'.  At the completion  of the
            instruction, register 5 will contain a 32 bit value '0000 000E'.




            INSTRUCTION FORMATS                                                               15
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



           example:

           245E            LIS     R5,14

                   -----------------               -----------------
              R5   |   0000 000E   |   <--         | 2 | 4 | 5 | E |
                   -----------------      \        -----------------
                                           \                     |
                                            ---------------------

                                   Figure 4-2                                   Figure 4-2                                   Figure 4-2                                   Figure 4-2.  Short Format


      Both the RR and  SF format instructions are 16  bits long and therefore  require two
      memory byte locations (one halfword).



      4-3    REGISTER AND IMMEDIATE STORAGE (RI1, RI2)      4-3    REGISTER AND IMMEDIATE STORAGE (RI1, RI2)      4-3    REGISTER AND IMMEDIATE STORAGE (RI1, RI2)      4-3    REGISTER AND IMMEDIATE STORAGE (RI1, RI2)

      Register and immediate storage  (RI) type instructions perform operations  between a
      general register,  an index register,  and either  a 16 or  32 bit  immediate value.
      Bits 0:7 specify  the op code  and bits 8:11 specify  a general register,  R1.  Bits
      12:15  specify an  index register  (X2), which  can be  any general  register except
      register 0.  Bits 16:31 in RI1 format  or bits 16:47 in RI2 format contain  either a
      16  or 32  bit immediate  value  (I2).  RI  instructions will  perform  an operation
      between the  contents of a  general register  specified in the  R1 field  (the first
      operand) and the immediate value contained in the I2 field plus the contents  of the
      general  register specified  in the  X2 field.   Figure 4-3  illustrates an  RI type
      instruction.  The register  specified in the  X2 field is added  to the I2  field to
      obtain the effective second operand.  For example, the instruction 'C841  1234' will
      load register 4 with the value obtained by adding the hex quantities '0000 1234' and
      the contents of  general register 1.  If  a '0' is specified  in the X2  field, this
      indicates that no indexing will take place.

           example:

           C841 1234       LHI     R4,X'1234',R1

                   ---------------------------------
                   |  C8  | 4 | 1 |         1234   |
                   ---------------------------------
                                           +
                                   -----------------
                             R1    |   0000 EDCC   |
                                   -----------------
                                           |
                                           V
                                   -----------------
                             R4    |   0001 0000   |
                                   -----------------

                      Figure 4-3                      Figure 4-3                      Figure 4-3                      Figure 4-3.  Register and Indexed Storage Immediate


      16                                   Chapter 4 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            4-4    REGISTER AND INDEXED STORAGE (RX1,RX2,RX3)            4-4    REGISTER AND INDEXED STORAGE (RX1,RX2,RX3)            4-4    REGISTER AND INDEXED STORAGE (RX1,RX2,RX3)            4-4    REGISTER AND INDEXED STORAGE (RX1,RX2,RX3)

            RX type instructions are used to operate on data contained in a general register and
            data located at a specific memory  address.  Bits 0:7 specify the opcode,  bits 8:11
            specify a  general register,  and bits  12:15 specify  an index  register, as  in RI
            format.   The  difference is  that,  instead of  adding  the contents  of  the index
            register to the next half-  word or full word of  data, and using that as  a result;
            the RX format instructions add the  contents of the index register to  the following
                                                  location                                                  location                                                  location            bits of the instruction to obtain the location of the data to be operated on.

            In an RX1 format instruction, bits 16 and 17 must be zero.  Bits 18:31 specify a 14-
            bit  memory address  (A2).  The  A2  field is  added to  the contents  of  the index
            register to obtain the effective address of the second operand.  From  this address,
            a byte,  halfword, or  full word,  depending upon  the type  of the  instruction, is
            obtained for  use as the  second operand.   In most cases,  the result  replaces the
            contents of the register specified by R1.  An illustration of RX1 format is given in
            Figure 4-4.


                 example:

                 5A41 1234         A        R4,X'1234',R1

                         +--------+----+----+----------------+
                         |   5A   | 4  | 1  |      1234      |
                         +--------+----+----+----------------+
                                                     +

                                            +----------------+
                                     R1     |   0000  3210   |
                                            +----------------+
                                                     |
                                                     V
                                            +----------------+
                     (effective address)    |   0000  4444   |
                                            +----------------+



                                            +----------------+
                                     R4     |   1234  5678   |
                                            +----------------+

                                                     +
                                            +----------------+
                 (memory location X'4444')  |   7654  3210   |
                                            +----------------+
                                                     |
                                                     V
                                            +----------------+
                  (result placed in R4)     |   8888  8888   |
                                            +----------------+

                                          Figure 4-4                                          Figure 4-4                                          Figure 4-4                                          Figure 4-4.  RX1 Format


            REGISTER AND INDEXED STORAGE (RX1,RX2,RX3)                                        17
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      The  example given  above is  a  full-word Add  instruction.  First,  the  A2 field,
      X'1234' is  added to  the contents  of R1,  X'3210', to  obtain the  memory location
      containing  the  second  operand,  location X'4444'.   Then,  the  contents  of this
      location, X'7654  3210', are  added to  the contents  of R4,  X'1234 5678',  and the
      result, X'8888 8888' is placed in R4.

      RX2 format instructions are similar to RX1 format instructions, except that A2 field
      is replaced by a D2 field, which is a displacement from the current location, rather
      than  an  absolute  number  (relative  addressing).   Bits  0:15  of  an  RX2 format
      instruction  are identical  to those  bits  in an  RX1 instruction.   RX2  format is
      signified by setting bit 16 of the instruction to 1.  Bits 17:32 make up  the 15-bit
      displacement field (D2).  The most significant bit of the D2 field (bit 17)  is used
      as the sign bit so that both positive and negative displacements are  possible.  The
      effective address  of the second  operand is  obtained by adding  the D2  field, the
      contents of  the register  specified by  X2, if any,  and the  current value  of the
      Program Counter  plus 4.  Figure  4-5 shows  the same instruction  in RX2  format as
      Figure 4-4 shows in RX1.

      Again, the example is a full word Add instruction.  First,the D2 field,  X'1234', is
      added to the contents  of R1, X'3210', then the  Program Counter plus 4 is  added to
      the result.  In the example, the Program Counter is at X'1000', so the  final result
      is X'5448', the effective address of  the second operand.  Then, the contents  of R4
      and location X'5448' are added, and the result X'1234 5678' is placed in R4.

      RX3 format instructions are  similar to RX1, except  that they allow a  second index
      register.  Bits 0:11 are the same as for for an RX1 format instruction.   Bits 12:15
      specify the first index register FX2.   Bits 16:19 determine the format and  must be
      '0100' or a hex '4'.  Bits 20:23 specify the second index register SX2.   Bits 24:47
      contain the  24 bit address  (A2) field.   Since the maximum  memory address  on the
      Engine is only 20 bits, the first digit of the A2 field must be 0.

      Although RX3  instructions allow for  double indexing, they  are also useful  when a
      single-indexed  jump  with a  displacement  greater than  X'3FFF'  from  the current
      address  is needed,  since the  A2 field  of RX1  instructions allows  a  maximum of
      X'3FFF' and the D2 field of RX2 instructions allows a maximum displacement of + or -
      X'3FFF', while the  A2 field of  RX3 instructions allows a  jump to anywhere  in the
      available memory.

      An example of an RX3 instruction is shown in Figure 4-6.

















      18                                   Chapter 4 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



                 Example:

                 5A41 9234        A        R4,+X'1234',R1

                         +--------+----+----+-+---------------+
                         |   5A   | 4  | 1  |1|        1234   |
                         +--------+----+----+-+---------------+
                                                      +
                                              +---------------+
                                         R1   |   0000 3210   |
                                              +---------------+
                                                      +
                                              +---------------+
                         (Program Counter)    |   0000 1000   |
                                              +---------------+
                                                      +
                                              +---------------+
                                         4    |   0000 0004   |
                                              +---------------+
                                                      |
                                                      V
                                              +---------------+
                         (Effective Address)  |   0000 5448   |
                                              +---------------+

                                              +---------------+
                                         R4   |   1234 0000   |
                                              +---------------+
                                                      +
                                              +---------------+
                         (location X'5448)    |   0000 5678   |
                                              +---------------+
                                                      |
                                                      V
                                              +---------------+
                 (result placed in R4)        |   1234 5678   |
                                              +---------------+

                                          Figure 4-5                                          Figure 4-5                                          Figure 4-5                                          Figure 4-5.  RX2 Format
















            REGISTER AND INDEXED STORAGE (RX1,RX2,RX3)                                        19
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



           Example:


           5A41 4600 1234        A         R4,X'1234',R1,R6

                   +--------+----+----+----+----+-------------------------+
                   |   5A   | 4  | 1  | 4  | 6  |       00  1234          |
                   +--------+----+----+----+----+-------------------------+
                                                           +
                                                        +-----------------+
                                                   R1   |   0000 3210     |
                                                        +-----------------+
                                                           +
                                                        +-----------------+
                                                   R6   |   0000 0F0F     |
                                                        +-----------------+
                                                           |
                                                           V
                                                        +-----------------+
                           (effective address)          |   0000 5353     |
                                                        +-----------------+



                                                        +-----------------+
                           (contents of R4)             |   0000 5678     |
                                                        +-----------------+
                                                           +
                                                        +-----------------+
                           (contents of location 5353)  |   1234 0000     |
                                                        +-----------------+
                                                           |
                                                           V
                                                        +-----------------+
                   (result placed in R4)                |   1234 5678    |
                                                        +-----------------+

                                    Figure 4-6                                    Figure 4-6                                    Figure 4-6                                    Figure 4-6.  RX3 format


      The example above is, yet again,  a full-word Add instruction.  The contents  of the
      two index registers, R1 and  R6 are added to the  A2 field to obtain the  address of
      the second operand, in this case, X'5353'.  The contents of this location  are added
      to the contents of R4 and the result is placed in R4.











      20                                   Chapter 4 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                                 Chapter 5                                                 Chapter 5                                                 Chapter 5                                                 Chapter 5

                                              INSTRUCTION SET                                              INSTRUCTION SET                                              INSTRUCTION SET                                              INSTRUCTION SET




            This chapter covers the  instruction set of the  Tymnet Engine.  It is  divided into
            sections,  each  covering  a  particular  type  of  instruction;  such  as  logical,
            arithmetic, I/O or special-purpose instructions.  These sections are further divided
            into sub-sections, each of which  discusses a particular instruction, in all  of the
            various  formats  and  operands  it  can  have,  so  that  all  the  compare logical
            instructions are  grouped together,  whether they  compare full  or half  words, the
            contents of registers, or a register and an immediate operand or memory location.










































            INSTRUCTION SET                                                                   21
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



























                                               *
                                              * *
                                               *




























      22                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            5-1    LOGICAL INSTRUCTIONS            5-1    LOGICAL INSTRUCTIONS            5-1    LOGICAL INSTRUCTIONS            5-1    LOGICAL INSTRUCTIONS

            The set of logical instructions provide a means for the manipulation of binary data.
            Many of  the instructions  grouped with  the logical set  may also  be used  with in
            arithmetic  and  other  operations.   These  instructions  include   loads,  stores,
            compares, and shifts.

            Halfword operands:

            Unless otherwise specified, the halfword  second argument is expanded to  a fullword
            by propagating the  most significant bit through  bits 0:15.  This fullword  is then
            used as the operand.

            SF operands:

            The SF format instructions  take the four bit argument  and extend it to 32  bits by
            filling bits 0:27 with 0.




                                         5-1.1    LOAD Instructions                                         5-1.1    LOAD Instructions                                         5-1.1    LOAD Instructions                                         5-1.1    LOAD Instructions


                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                L                                           58                   L                                           58                   L                                           58                   L       Load                                58         RX1
                L                                           58                   L                                           58                   L                                           58                   L       Load                                58         RX2
                L                                           58                   L                                           58                   L                                           58                   L       Load                                58         RX3
                LH                                          48                   LH                                          48                   LH                                          48                   LH      Load Halfword                       48         RX1
                LH                                          48                   LH                                          48                   LH                                          48                   LH      Load Halfword                       48         RX2
                LH                                          48                   LH                                          48                   LH                                          48                   LH      Load Halfword                       48         RX3
                LI                                          F8                   LI                                          F8                   LI                                          F8                   LI      Load Immediate                      F8         RI2
                LHI                                         C8                   LHI                                         C8                   LHI                                         C8                   LHI     Load Halfword Immediate             C8         RI1
                LR                                          08                   LR                                          08                   LR                                          08                   LR      Load Register                       08         RR
                LIS                                         24                   LIS                                         24                   LIS                                         24                   LIS     Load Immediate Short                24         SF
                LCS                                         25                   LCS                                         25                   LCS                                         25                   LCS     Load Complement Short               25         SF

            The second operand replaces the contents of the register specified by R1.  LCS takes
            the two's complement and loads it into the register specified by R1.



                                              Condition Codes                                              Condition Codes                                              Condition Codes                                              Condition Codes
                    X000     operand is zero
                    X001     operand is less than zero
                    X010     operand is greater than zero









            LOGICAL INSTRUCTIONS                                                              23
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



                               5-1.2    LOAD Address Instructions                               5-1.2    LOAD Address Instructions                               5-1.2    LOAD Address Instructions                               5-1.2    LOAD Address Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          LA                                          E6             LA                                          E6             LA                                          E6             LA      Load Address                        E6         RX1
          LA                                          E6             LA                                          E6             LA                                          E6             LA      Load Address                        E6         RX2
          LA                                          E6             LA                                          E6             LA                                          E6             LA      Load Address                        E6         RX3

      The effective address (a full 32 bit value) is loaded into the register specified by
      R1.



                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes
              X000     operand is zero
              X001     operand is less than zero
              X010     operand is greater than zero




                          5-1.3    LOAD Halfword Logical Instructions                          5-1.3    LOAD Halfword Logical Instructions                          5-1.3    LOAD Halfword Logical Instructions                          5-1.3    LOAD Halfword Logical Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          LHL                                         73             LHL                                         73             LHL                                         73             LHL     Load Halfword Logical               73         RX1
          LHL                                         73             LHL                                         73             LHL                                         73             LHL     Load Halfword Logical               73         RX2
          LHL                                         73             LHL                                         73             LHL                                         73             LHL     Load Halfword Logical               73         RX3

      The halfword  second operand replaces  bits 16:31 of  the register specified  by R1.
      Bits 0:15 of the register specified by R1 are forced to zero.



                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes
              X000     operand is zero
              X010     operand is greater than zero














      24                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



                                    5-1.4    LOAD Multiple Instructions                                    5-1.4    LOAD Multiple Instructions                                    5-1.4    LOAD Multiple Instructions                                    5-1.4    LOAD Multiple Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                LM                                          D1                   LM                                          D1                   LM                                          D1                   LM      Load Multiple                       D1         RX1
                LM                                          D1                   LM                                          D1                   LM                                          D1                   LM      Load Multiple                       D1         RX2
                LM                                          D1                   LM                                          D1                   LM                                          D1                   LM      Load Multiple                       D1         RX3

            n successive registers, starting with the register specified by R1, are  loaded from
            successive memory locations, starting  with the location specified by  the effective
            address of the second operand.  Each register is loaded with a fullword from memory.
            The process stops when register 15 has been loaded.

            The instructions are not interruptable.



                                              Condition Codes                                              Condition Codes                                              Condition Codes                                              Condition Codes
                          Condition codes are not affected.




                                      5-1.5    LOAD Byte Instructions                                      5-1.5    LOAD Byte Instructions                                      5-1.5    LOAD Byte Instructions                                      5-1.5    LOAD Byte Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                LB                                          D3                   LB                                          D3                   LB                                          D3                   LB      Load Byte                           D3         RX1
                LB                                          D3                   LB                                          D3                   LB                                          D3                   LB      Load Byte                           D3         RX2
                LB                                          D3                   LB                                          D3                   LB                                          D3                   LB      Load Byte                           D3         RX3
                LBR                                         93                   LBR                                         93                   LBR                                         93                   LBR     Load Byte Register                  93         RR

            The eight bit second operand replaces the least significant bits (bits 24:31) of the
            register specified by R1.  Bits 0:23 of the register are forced to zero.



                                              Condition Codes                                              Condition Codes                                              Condition Codes                                              Condition Codes
                    X000     operand is zero
                    X010     operand is greater than zero











            LOAD Multiple Instructions                                                        25
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                            5-1.6    EXCHANGE Halfword Instructions                            5-1.6    EXCHANGE Halfword Instructions                            5-1.6    EXCHANGE Halfword Instructions                            5-1.6    EXCHANGE Halfword Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          EXHR                                        34             EXHR                                        34             EXHR                                        34             EXHR    EXchange Halfword Register          34         RR

      Bits  0:15 of  the  register specified  by R2  replace  bits 16:31  of  the register
      specified by R1.  Bits  16:31 of the register specified  by R2 replace bits  0:15 of
      the register specified by R1.  If  R1 equals R2, the two halfwords  contained within
      the register are exchanged.



                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes
                       (32 bit operand):
              X000     operand is zero
              X001     operand is less than zero
              X010     operand is greater than zero




                              5-1.7    EXCHANGE Byte Instructions                              5-1.7    EXCHANGE Byte Instructions                              5-1.7    EXCHANGE Byte Instructions                              5-1.7    EXCHANGE Byte Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          EXBR                                        94             EXBR                                        94             EXBR                                        94             EXBR    EXchange Byte Register              94         RR

      The two eight bit bytes contained in bits 16:31 of the register specified by  R2 are
      exchanged and loaded into bits 16:31 of the register specified by R1.  Bits  0:15 of
      the  register  specified by  R1  are unchanged.   The  register specified  by  R2 is
      unchanged (unless equal to R1).  R1 and R2 may specify the same register.



                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes
                       (32 bit operand):
              X000     operand is zero
              X001     operand is less than zero
              X010     operand is greater than zero












      26                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



                                        5-1.8    STORE Instructions                                        5-1.8    STORE Instructions                                        5-1.8    STORE Instructions                                        5-1.8    STORE Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                ST                                          50                   ST                                          50                   ST                                          50                   ST      STore                               50         RX1
                ST                                          50                   ST                                          50                   ST                                          50                   ST      STore                               50         RX2
                ST                                          50                   ST                                          50                   ST                                          50                   ST      STore                               50         RX3
                STH                                         40                   STH                                         40                   STH                                         40                   STH     STore Halfword                      40         RX1
                STH                                         40                   STH                                         40                   STH                                         40                   STH     STore Halfword                      40         RX2
                STH                                         40                   STH                                         40                   STH                                         40                   STH     STore Halfword                      40         RX3

            The 32  bit contents of  the register specified  by R1 replace  the contents  of the
            location specified  by the effective  address.  Halfword store:   Bits 16:31  of the
            register specified by  R1 replace the contents  of the memory location  specified by
            the effective address of the second operand.



                                              Condition Codes                                              Condition Codes                                              Condition Codes                                              Condition Codes
                          Condition codes are not affected.




                                    5-1.9    STORE Multiple Instructions                                    5-1.9    STORE Multiple Instructions                                    5-1.9    STORE Multiple Instructions                                    5-1.9    STORE Multiple Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                STM                                         D0                   STM                                         D0                   STM                                         D0                   STM     STore Multiple                      D0         RX1
                STM                                         D0                   STM                                         D0                   STM                                         D0                   STM     STore Multiple                      D0         RX2
                STM                                         D0                   STM                                         D0                   STM                                         D0                   STM     STore Multiple                      D0         RX3

            THe fullword  contents of  registers, starting  with the  register specified  by R1,
            replace  the contents  of successive  memory locations,  starting with  the location
            specified by the  effective address of the  second operand.  The process  stops when
            register 15 has been stored.



                                              Condition Codes                                              Condition Codes                                              Condition Codes                                              Condition Codes
                          Condition codes are not affected.










            STORE Instructions                                                                27
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                               5-1.10    STORE Byte Instructions                               5-1.10    STORE Byte Instructions                               5-1.10    STORE Byte Instructions                               5-1.10    STORE Byte Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          STB                                         D2             STB                                         D2             STB                                         D2             STB     STore Byte                          D2         RX1
          STB                                         D2             STB                                         D2             STB                                         D2             STB     STore Byte                          D2         RX2
          STB                                         D2             STB                                         D2             STB                                         D2             STB     STore Byte                          D2         RX3
          STBR                                        92             STBR                                        92             STBR                                        92             STBR    STore Byte Register                 92         RR

      The least significant eight  bits (bits 24:31) of  the register specified by  R1 are
      stored in the second operand location.  In the Store Byte Register  instruction, the
      eight bit quantity is  stored in bits 24:31 of  the register specified by  R2.  Bits
      0:23 of that register are unchanged.  STBR (only) sets the condition codes:
              X000     operand is equal to zero
              X010     operand is greater than zero




                                  5-1.11    COPY Instructions                                  5-1.11    COPY Instructions                                  5-1.11    COPY Instructions                                  5-1.11    COPY Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          **COPY                                      3F          **COPY                                      3F          **COPY                                      3F          **COPY  COPY memory                         3F         R?

      The instruction copies a  block of memory from  one place to another.   R1 specifies
      the address  of the last  source halfword;  R1+1 specifies the  address of  the last
      destination halfword.   R2 specifies the  number of half-words  (minus 1!)  to move,
      times 10x!  The instruction is interruptable, and will continue from the interrupted
      point upon return  from interrupt--this is possible  because (R2) is used  to record
      how much of the copy has been performed.
              Example:
              LA      R3,SOURCE+0E    :address of source end to R1
              LA      R4,DESTIN+0E    :address of destination end to R1+1
              LHI     R1,70           :10*(number of HW's -1)
              HC      3F31            :: COPY R3,R1 ::


                               THIS INSTRUCTION IS IMPLEMENTED IN                               THIS INSTRUCTION IS IMPLEMENTED IN                               THIS INSTRUCTION IS IMPLEMENTED IN                               THIS INSTRUCTION IS IMPLEMENTED IN
                          MICRO-CODE VERSION S-15 AND IT'S SUCCESSORS!                          MICRO-CODE VERSION S-15 AND IT'S SUCCESSORS!                          MICRO-CODE VERSION S-15 AND IT'S SUCCESSORS!                          MICRO-CODE VERSION S-15 AND IT'S SUCCESSORS!












      28                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



                                   5-1.12    COMPARE Logical Instructions                                   5-1.12    COMPARE Logical Instructions                                   5-1.12    COMPARE Logical Instructions                                   5-1.12    COMPARE Logical Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                CL                                          55                   CL                                          55                   CL                                          55                   CL      Compare Logical                     55         RX1
                CL                                          55                   CL                                          55                   CL                                          55                   CL      Compare Logical                     55         RX2
                CL                                          55                   CL                                          55                   CL                                          55                   CL      Compare Logical                     55         RX3
                CLH                                         45                   CLH                                         45                   CLH                                         45                   CLH     Compare Logical Halfword            45         RX1
                CLH                                         45                   CLH                                         45                   CLH                                         45                   CLH     Compare Logical Halfword            45         RX2
                CLH                                         45                   CLH                                         45                   CLH                                         45                   CLH     Compare Logical Halfword            45         RX3
                CLI                                         F5                   CLI                                         F5                   CLI                                         F5                   CLI     Compare Logical Immediate           F5         RI2
                CLHI                                        C5                   CLHI                                        C5                   CLHI                                        C5                   CLHI    Compare Logical Halfword Immediate  C5         RI1
                CLR                                         05                   CLR                                         05                   CLR                                         05                   CLR     Compare Logical Register            05         RR

            The  first  operand, the  contents  of the  register  specified by  R1,  is compared
            logically to  the second  operand.  The result  is indicated  by the  Condition Code
            setting.  Neither operand is changed.

            The Compare  Logical operation  is performed by  adding the  twos complement  of the
            first operand to the  second operand.  The state of  the Carry Bit in  the Condition
            Code then shows whether the first  or second operand was greater.  If the  Carry Bit
            is set, the  first operand is greater  than the second.  If  it is reset,  the first
            operand is less than the second.



                                              Condition Codes                                              Condition Codes                                              Condition Codes                                              Condition Codes
                    X000     operands are the same
                    1001     first operand is greater than second
                    1010     first operand is greater than second
                    0001     first operand is less than second
                    0010     first operand is less than second




                                5-1.13    COMPARE Logical Byte Instructions                                5-1.13    COMPARE Logical Byte Instructions                                5-1.13    COMPARE Logical Byte Instructions                                5-1.13    COMPARE Logical Byte Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                CLB                                         D4                   CLB                                         D4                   CLB                                         D4                   CLB     Compare Logical Byte                D4         RX1
                CLB                                         D4                   CLB                                         D4                   CLB                                         D4                   CLB     Compare Logical Byte                D4         RX2
                CLB                                         D4                   CLB                                         D4                   CLB                                         D4                   CLB     Compare Logical Byte                D4         RX3

            The byte  quantity, contained  in bits  24:31 if  the register  specified by  R1, is
            compared with  the second operand.   The result is  indicated by the  Condition Code
            setting.  Neither operand is changed.




            COMPARE Logical Instructions                                                      29
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes
              X000     operands are the same
              1001     first operand is greater than second
              1010     first operand is greater than second
              0001     first operand is less than second
              0010     first operand is less than second




                                   5-1.14    AND Instructions                                   5-1.14    AND Instructions                                   5-1.14    AND Instructions                                   5-1.14    AND Instructions


          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format


          N                                           54             N                                           54             N                                           54             N       aNd                                 54         RX1
          N                                           54             N                                           54             N                                           54             N       aNd                                 54         RX2
          N                                           54             N                                           54             N                                           54             N       aNd                                 54         RX3
          NH                                          44             NH                                          44             NH                                          44             NH      aNd Halfword                        44         RX1
          NH                                          44             NH                                          44             NH                                          44             NH      aNd Halfword                        44         RX2
          NH                                          44             NH                                          44             NH                                          44             NH      aNd Halfword                        44         RX3
          NI                                          F4             NI                                          F4             NI                                          F4             NI      aNd Immediate                       F4         RI2
          NHI                                         C4             NHI                                         C4             NHI                                         C4             NHI     aNd Halfword Immediate              C4         RI1
          NR                                          04             NR                                          04             NR                                          04             NR      aNd Register                        04         RR

      The logical product of  the 32 bit second operand  and the contents of  the register
      specified by R1 replace  the contents of the register  specified by R1.  The  32 bit
      product is formed on a bit-by-bit basis.



                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes

              X000     result is zero
              X001     less than zero (bit 0 is 1)
              X010     greater than zero



















      30                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983






                                         5-1.15    OR Instructions                                         5-1.15    OR Instructions                                         5-1.15    OR Instructions                                         5-1.15    OR Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                O                                           56                   O                                           56                   O                                           56                   O       Or word                             56         RX1
                O                                           56                   O                                           56                   O                                           56                   O       Or word                             56         RX2
                O                                           56                   O                                           56                   O                                           56                   O       Or word                             56         RX3
                OH                                          46                   OH                                          46                   OH                                          46                   OH      Or Halfword                         46         RX1
                OH                                          46                   OH                                          46                   OH                                          46                   OH      Or Halfword                         46         RX2
                OH                                          46                   OH                                          46                   OH                                          46                   OH      Or Halfword                         46         RX3
                OI                                          F6                   OI                                          F6                   OI                                          F6                   OI      Or Immediate                        F6         RI2
                OHI                                         C6                   OHI                                         C6                   OHI                                         C6                   OHI     Or Halfword Immediate               C6         RI1
                OR                                          06                   OR                                          06                   OR                                          06                   OR      Or Register                         06         RR

            The  logical sum  of the  32 bit  second operand  and the  contents of  the register
            specified by R1 replaces the contents  of the register specified by R1.  The  sum is
            formed on a bit-by-bit basis.




                                    5-1.16    EXCLUSIVE OR Instructions                                    5-1.16    EXCLUSIVE OR Instructions                                    5-1.16    EXCLUSIVE OR Instructions                                    5-1.16    EXCLUSIVE OR Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                X                                           57                   X                                           57                   X                                           57                   X       eXclusive or                        57         RX1
                X                                           57                   X                                           57                   X                                           57                   X       eXclusive or                        57         RX2
                X                                           57                   X                                           57                   X                                           57                   X       eXclusive or                        57         RX3
                XH                                          47                   XH                                          47                   XH                                          47                   XH      eXclusive or Halfword               47         RX1
                XH                                          47                   XH                                          47                   XH                                          47                   XH      eXclusive or Halfword               47         RX2
                XH                                          47                   XH                                          47                   XH                                          47                   XH      eXclusive or Halfword               47         RX3
                XI                                          F7                   XI                                          F7                   XI                                          F7                   XI      eXclusive or Immediate              F7         RI2
                XHI                                         C7                   XHI                                         C7                   XHI                                         C7                   XHI     eXclusive or Halfword Immediate     C7         RI1
                XR                                          07                   XR                                          07                   XR                                          07                   XR      eXclusive or Register               07         RR

            The logical difference of the 32 bit second operand and the contents of the register
            specified by R1 replaces the contents  of the register specified by R1.  The  32 bit
            difference is formed on a bit-by-bit basis.










            OR Instructions                                                                   31
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                5-1.17    ARRAY-AND Instructions                                5-1.17    ARRAY-AND Instructions                                5-1.17    ARRAY-AND Instructions                                5-1.17    ARRAY-AND Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          *ARAND                                      3E          *ARAND                                      3E          *ARAND                                      3E          *ARAND  ARray AND                           3E          R??

      The logical "AND" of  two bit arrays is  performed, and the instruction  returns the
      highest bit number which is set in the result.

      If no bits fall through the sieve, the instruction performs a skip (+2) return; else
      a normal return is performed.

      R1 is to  contain the address of  the last halfword in  the first array; R1+1  is to
      contain the address of the last halfword in the second array.  R2 is to  contain the
      number of bits to scan.

      On success  (skip return)  in finding  the bit set,  R2 contains  the number  of the
      highest bit set in both arrays.


              Example:

              LA      R7,A1+4         :end of array 1 into (R1)
              LA      R8,A2+4         :end of array 2 into (R1+1)
              LHI     R3,30           :number of bits to test
              HC      3E73            :: ARAND R7,R3 ::
              JFS     HIT             Jump to process if bits matched
              NOP                     :skip return to here if no bits 
                                       matched

              . . . .

      HIT     NOP                     :target of above jump


                               THIS INSTRUCTION IS IMPLEMENTED IN                               THIS INSTRUCTION IS IMPLEMENTED IN                               THIS INSTRUCTION IS IMPLEMENTED IN                               THIS INSTRUCTION IS IMPLEMENTED IN
                          MICRO-CODE VERSION S-15 AND IT'S SUCCESSORS!                          MICRO-CODE VERSION S-15 AND IT'S SUCCESSORS!                          MICRO-CODE VERSION S-15 AND IT'S SUCCESSORS!                          MICRO-CODE VERSION S-15 AND IT'S SUCCESSORS!




                             5-1.18    TEST IMMEDIATE Instructions                             5-1.18    TEST IMMEDIATE Instructions                             5-1.18    TEST IMMEDIATE Instructions                             5-1.18    TEST IMMEDIATE Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          TI                                          F3             TI                                          F3             TI                                          F3             TI      Test Immediate                      F3         RI2
          THI                                         C3             THI                                         C3             THI                                         C3             THI     Test Halfword Immediate             C3         RI1

      Each bit  of the second  operand is  logically ANDed with  the corresponding  bit of
      register specified by R1.  Neither operand is changed


      32                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983






                                 5-1.19    SHIFT Left Logical Instructions                                 5-1.19    SHIFT Left Logical Instructions                                 5-1.19    SHIFT Left Logical Instructions                                 5-1.19    SHIFT Left Logical Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                SLL                                         ED                   SLL                                         ED                   SLL                                         ED                   SLL     Shift Left Logical                  ED         RI1
                SLLS                                        11                   SLLS                                        11                   SLLS                                        11                   SLLS    Shift Left Logical Short            11         SF

            The first operand, the contents of the register specified by R1, is shifted left the
            number of places specified  by the second operand.   Bits shifted out of  position 0
            are shifted through the carry flag  of the condition codes and then lost.   The last
            bit shifted remains in the carry flag.  Zeros are shifted into position 31.




                                 5-1.20    SHIFT Right Logical Instructions                                 5-1.20    SHIFT Right Logical Instructions                                 5-1.20    SHIFT Right Logical Instructions                                 5-1.20    SHIFT Right Logical Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                SRL                                         EC                   SRL                                         EC                   SRL                                         EC                   SRL     Shift Right Logical                 EC         RI1
                SRLS                                        10                   SRLS                                        10                   SRLS                                        10                   SRLS    Shift Right Logical Short           10         SF

            The first operand, the  contents of the register  specified by R1, is  shifted right
            the number of places specified by the second operand.  Bits shifted out  of position
            31 are shifted through the carry  flag and then lost.  The last bit  shifted remains
            in the carry flag.  Zeros are shifted into position 0.




                             5-1.21    SHIFT Left Halfword Logical Instructions                             5-1.21    SHIFT Left Halfword Logical Instructions                             5-1.21    SHIFT Left Halfword Logical Instructions                             5-1.21    SHIFT Left Halfword Logical Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                SLHL                                        CD                   SLHL                                        CD                   SLHL                                        CD                   SLHL    Shift Left Halfword Logical         CD         RI1
                SLHLS                                       91                   SLHLS                                       91                   SLHLS                                       91                   SLHLS   Shift Left Halfword Logical Short   91         SF

            Bits 16:31 of  the register specified  by R1 are shifted  left the number  of places
            specified  by the  second operand.   Bits  shifted out  of position  16  are shifted
            through the carry flag  and lost.  The last bit  shifted remains in the  carry flag.
            Zeros  are  shifted  into positions  31.   Bits  0:15 of  the  first  operand remain
            unchanged.




            TEST IMMEDIATE Instructions                                                       33
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983





                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes

              X000     result is zero
              X001     result is less than zero
              X010     result is greater than zero




                      5-1.22    SHIFT Right Halfword Logical Instructions                      5-1.22    SHIFT Right Halfword Logical Instructions                      5-1.22    SHIFT Right Halfword Logical Instructions                      5-1.22    SHIFT Right Halfword Logical Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          SRHL                                        CC             SRHL                                        CC             SRHL                                        CC             SRHL    Shift Right Halfword Logical        CC         RI1
          SRHLS                                       90             SRHLS                                       90             SRHLS                                       90             SRHLS   Shift Right Halfword Logical Short  90         SF

      Bits 16:31 of the  register specified by R1 are  shifted right the number  of places
      specified  by the  second operand.   Bits  shifted out  of position  31  are shifted
      through the carry flag  and lost.  The last bit  shifted remains in the  carry flag.
      Zeros  are  shifted  into  position  16.  Bits  0:15  of  the  first  operand remain
      unchanged.



                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes

              X000     result is zero
              X001     result is less than zero
              X010     result is greater than zero




                           5-1.23    ROTATE Left Logical Instructions                           5-1.23    ROTATE Left Logical Instructions                           5-1.23    ROTATE Left Logical Instructions                           5-1.23    ROTATE Left Logical Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          RLL                                         EB             RLL                                         EB             RLL                                         EB             RLL     Rotate Left Logical                 EB         RI1

      The 32  bit first operand,  contained in  the register specified  by R1,  is shifted
      left, end  around, the number  of positions specified  by the second  operand.  Bits
      shifted out of position 0 are shifted into position 31.







      34                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983





                                              Condition Codes                                              Condition Codes                                              Condition Codes                                              Condition Codes

                    X000     result is zero
                    X001     result is less than zero
                    X010     result is greater than zero




                                5-1.24    ROTATE Right Logical Instructions                                5-1.24    ROTATE Right Logical Instructions                                5-1.24    ROTATE Right Logical Instructions                                5-1.24    ROTATE Right Logical Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                RRL                                         EA                   RRL                                         EA                   RRL                                         EA                   RRL     Rotate Right Logical                EA         RI1

            The 32  bit first operand,  contained in  the register specified  by R1,  is shifted
            right, end around,  the number of positions  specified by the second  operand.  Bits
            shifted out of position 31 are shifted into position 0.



                                              Condition Codes                                              Condition Codes                                              Condition Codes                                              Condition Codes

                    X000     result is zero
                    X001     result is less than zero
                    X010     result is greater than zero




                                    5-1.25    TEST and Set Instructions                                    5-1.25    TEST and Set Instructions                                    5-1.25    TEST and Set Instructions                                    5-1.25    TEST and Set Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                TS                                          E0                   TS                                          E0                   TS                                          E0                   TS      Test and Set                        E0         RX1
                TS                                          E0                   TS                                          E0                   TS                                          E0                   TS      Test and Set                        E0         RX2
                TS                                          E0                   TS                                          E0                   TS                                          E0                   TS      Test and Set                        E0         RX3

            The halfword second operand  is read from memory, and,  on the same cycle,  0FFFF is
            written back.  The condition code reflects the original value of the memory cell (at
            the time of the memory read).








            ROTATE Left Logical Instructions                                                  35
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983





                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes

              X000     cell contained zero
              X001     cell was negative
              X010     cell was greater than zero




                                5-1.26    TEST Bit Instructions                                5-1.26    TEST Bit Instructions                                5-1.26    TEST Bit Instructions                                5-1.26    TEST Bit Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          TBT                                         74             TBT                                         74             TBT                                         74             TBT     Test BiT                            74         RX1
          TBT                                         74             TBT                                         74             TBT                                         74             TBT     Test BiT                            74         RX2
          TBT                                         74             TBT                                         74             TBT                                         74             TBT     Test BiT                            74         RX3

      The second operand address  points to a bit  array starting on a  halfword boundary.
      The value contained in the register specified by R1 is the bit displacement into the
      array.  The bit is located and tested.  The test does not change the bit.



                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes

              X000     tested bit is zero
              X010     tested bit is one




                                 5-1.27    SET Bit Instructions                                 5-1.27    SET Bit Instructions                                 5-1.27    SET Bit Instructions                                 5-1.27    SET Bit Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          SBT                                         75             SBT                                         75             SBT                                         75             SBT     Set BiT                             75         RX1
          SBT                                         75             SBT                                         75             SBT                                         75             SBT     Set BiT                             75         RX2
          SBT                                         75             SBT                                         75             SBT                                         75             SBT     Set BiT                             75         RX3

      The second operand address  points to a bit  array starting on a  halfword boundary.
      The value contained in the register specified by R1 is the bit displacement into the
      array.  The bit is located and forced to one.







      36                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983





                                              Condition Codes                                              Condition Codes                                              Condition Codes                                              Condition Codes

                    X000     previous state of bit was zero
                    X010     previous state of bit was one




                                      5-1.28    RESET Bit Instructions                                      5-1.28    RESET Bit Instructions                                      5-1.28    RESET Bit Instructions                                      5-1.28    RESET Bit Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                RBT                                         76                   RBT                                         76                   RBT                                         76                   RBT     Reset BiT                           76         RX1
                RBT                                         76                   RBT                                         76                   RBT                                         76                   RBT     Reset BiT                           76         RX2
                RBT                                         76                   RBT                                         76                   RBT                                         76                   RBT     Reset BiT                           76         RX3

            The second operand address  points to a bit  array starting on a  halfword boundary.
            The value contained in the register specified by R1 is the bit displacement into the
            array.  The bit is located and forced to zero.



                                              Condition Codes                                              Condition Codes                                              Condition Codes                                              Condition Codes

                    X000     previous state of bit was zero
                    X010     previous state of bit was one




                                   5-1.29    COMPLEMENT Bit Instructions                                   5-1.29    COMPLEMENT Bit Instructions                                   5-1.29    COMPLEMENT Bit Instructions                                   5-1.29    COMPLEMENT Bit Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                CBT                                         77                   CBT                                         77                   CBT                                         77                   CBT     Complement BiT                      77         RX1
                CBT                                         77                   CBT                                         77                   CBT                                         77                   CBT     Complement BiT                      77         RX2
                CBT                                         77                   CBT                                         77                   CBT                                         77                   CBT     Complement BiT                      77         RX3

            The second operand address  points to a bit  array starting on a  halfword boundary.
            The value contained in the register specified by R1 is the bit displacement into the
            array.  The bit is located and complemented.








            SET Bit Instructions                                                              37
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983





                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes

              X000     previous state of bit was zero
              X010     previous state of bit was one

















































      38                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            5-2    JUMP INSTRUCTIONS            5-2    JUMP INSTRUCTIONS            5-2    JUMP INSTRUCTIONS            5-2    JUMP INSTRUCTIONS




            In normal operation,  the CPU executes instructions  in sequential order.   The Jump
            instructions allow this sequential mode of operation to be varied, so  that programs
            can loop, transfer control to subroutines, or make decisions based on the results of
            previous operations.




                                  5-2.1    JUMP on CONDITION Instructions                                  5-2.1    JUMP on CONDITION Instructions                                  5-2.1    JUMP on CONDITION Instructions                                  5-2.1    JUMP on CONDITION Instructions


                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                JF                                          43M                  JF                                          43M                  JF                                          43M                  JF      Jump on False condition             43M        RX1
                JF                                          43M                  JF                                          43M                  JF                                          43M                  JF      Jump on False condition             43M        RX2
                JF                                          43M                  JF                                          43M                  JF                                          43M                  JF      Jump on False condition             43M        RX3
                JFR                                         03M                  JFR                                         03M                  JFR                                         03M                  JFR     Jump on False condition Register    03M        RR
                JFBS                                        22M                  JFBS                                        22M                  JFBS                                        22M                  JFBS    Jump False Backward Short           22M        SF
                JFFS                                        23M                  JFFS                                        23M                  JFFS                                        23M                  JFFS    Jump False Forward Short            23M        SF
                JT                                          42M                  JT                                          42M                  JT                                          42M                  JT      Jump on True condition              42M        RX1
                JT                                          42M                  JT                                          42M                  JT                                          42M                  JT      Jump on True condition              42M        RX2
                JT                                          42M                  JT                                          42M                  JT                                          42M                  JT      Jump on True condition              42M        RX3
                JTR                                         02M                  JTR                                         02M                  JTR                                         02M                  JTR     Jump on True condition Register     02M        RR
                JTBS                                        20M                  JTBS                                        20M                  JTBS                                        20M                  JTBS    Jump True Backward Short            20M        SF
                JTFS                                        21M                  JTFS                                        21M                  JTFS                                        21M                  JTFS    Jump True Forward Short             21M        SF

            Jump on FALSE condition:

            The condition code of the Program Status Word is tested for the conditions specified
            in the mask  field, M.  If ALL  conditions tested are found  to be false, a  jump is
            executed to the second operation location.  If any of the conditions tested is found
            to be true, the next sequential instruction is executed.

            Jump on TRUE condition:

            The condition code of the Program Status Word is tested for the conditions specified
            in the mask  field, M.  If  ANY conditions tested  are found to  be true, a  jump is
            executed to  the second  operation location.  If  all of  the conditions  tested are
            found to be false, the next sequential instruction is executed.

            In the RR format, the jump address is contained in the register specified by R2.

            In the  SF format,  the N  field contains  the number  of HALFWORDS  to be  added or
            subtracted from the current Location Counter to obtain the jump address.







            JUMP INSTRUCTIONS                                                                 39
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes

              Condition codes are not affected.

              Several NAD mnemonics have been defined for convenience:
          NAD     Instruction                       Op-code      Format

          NOP     No OPeration                        420        RX1
          NOP     No OPeration                        420        RX2
          NOP     No OPeration                        420        RX3
          NOPR    No OPeration Register               020        RR

          J       Jump                                430        RX1
          J       Jump                                430        RX2
          J       Jump                                430        RX3
          JR      Jump Register                       030        RR
          JBS     Jump Backward Short                 220        SF
          JFS     Jump Forward Short                  230        SF

          JE      Jump Equal                          433        RX1
          JE      Jump Equal                          433        RX2
          JE      Jump Equal                          433        RX3
          JER     Jump Equal Register                 033        RR
          JEBS    Jump Equal Backward Short           223        SF
          JEFS    Jump Equal Forward Short            233        SF

          JN      Jump Not equal                      423        RX1
          JN      Jump Not equal                      423        RX2
          JN      Jump Not equal                      423        RX3
          JNR     Jump Not equal Register             023        RR
          JNBS    Jump Not equal Backward Short       203        SF
          JNFS    Jump Not equal Forward Short        213        SF

          JG      Jump Greater                        422        RX1
          JG      Jump Greater                        422        RX2
          JG      Jump Greater                        422        RX3
          JGR     Jump Greater Register               022        RR
          JGBS    Jump Greater Backward Short         202        SF
          JGFS    Jump Greater Forward Short          212        SF

          JGE     Jump Greater Equal                  431        RX1
          JGE     Jump Greater Equal                  431        RX2
          JGE     Jump Greater Equal                  431        RX3
          JGER    Jump Greater Equal Register         031        RR
          JGEBS   Jump Greater Equal Backward Short   221        SF
          JGEFS   Jump Greater Equal Forward Short    231        SF

          JLE     Jump Less Equal                     432        RX1
          JLE     Jump Less Equal                     432        RX2
          JLE     Jump Less Equal                     432        RX3
          JLER    Jump Less Equal Register            032        RR
          JLEBS   Jump Less Equal Backward Short      222        SF
          JLEFS   Jump Less Equal Forward Short       232        SF



      40                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                JL      Jump Less                           421        RX1
                JL      Jump Less                           421        RX2
                JL      Jump Less                           421        RX3
                JLR     Jump Less Register                  021        RR
                JLBS    Jump Less Backward Short            201        SF
                JLFS    Jump Less Forward Short             211        SF

                JC      Jump Carry                          428        RX1
                JC      Jump Carry                          428        RX2
                JC      Jump Carry                          428        RX3
                JCR     Jump Carry Register                 028        RR
                JCBS    Jump Carry Backward Short           208        SF
                JCFS    Jump Carry Forward Short            218        SF

                JNC     Jump No Carry                       438        RX1
                JNC     Jump No Carry                       438        RX2
                JNC     Jump No Carry                       438        RX3
                JNCR    Jump No Carry Register              038        RR
                JNCBS   Jump No Carry Backward Short        228        SF
                JNCFS   Jump No Carry Forward Short         238        SF




                                    5-2.2    JUMP and LINK Instructions                                    5-2.2    JUMP and LINK Instructions                                    5-2.2    JUMP and LINK Instructions                                    5-2.2    JUMP and LINK Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                JAL                                         41                   JAL                                         41                   JAL                                         41                   JAL     Jump And Link                       41         RX1
                JAL                                         41                   JAL                                         41                   JAL                                         41                   JAL     Jump And Link                       41         RX2
                JAL                                         41                   JAL                                         41                   JAL                                         41                   JAL     Jump And Link                       41         RX3
                JALR                                        01                   JALR                                        01                   JALR                                        01                   JALR    Jump And Link Register              01         RR

            The address of the next sequential instruction is saved in the register specified by
            R1, and a branch is taken to the second operand address.

            The branch address is obtained before the register specified by R1 is changed.




                                5-2.3    JUMP on Find First One Instructions                                5-2.3    JUMP on Find First One Instructions                                5-2.3    JUMP on Find First One Instructions                                5-2.3    JUMP on Find First One Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                JFFO                                        31                   JFFO                                        31                   JFFO                                        31                   JFFO    Jump Find First One                 31         SF
                JFFOH                                       33                   JFFOH                                       33                   JFFOH                                       33                   JFFOH   Jump Find First One Halfword        33         SF

            The register  specified is examined  to determine if  it is zero.   If so,  the next



            JUMP on CONDITION Instructions                                                    41
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      sequential instruction is executed.  If not, these instructions are equivalent  to a
      JFS, and the NUMBER of the left-most ONE is placed into register R+1.  The left-most
      bit is numbered zero, the next is numbered 1, etc.

      JFFO operates on the full, 32-bit register specified.

      JFFOH operates  on the  right-most 16 bits  of the  register specified.   It numbers
      register bit 16d as number 0, etc.
















































      42                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            5-3    ARITHMETIC INSTRUCTIONS            5-3    ARITHMETIC INSTRUCTIONS            5-3    ARITHMETIC INSTRUCTIONS            5-3    ARITHMETIC INSTRUCTIONS




            The fixed  point arithmetic instructions  provide a complete  set of  operations for
            calculating addresses and indexes, for counting, and for general purpose fixed point
            arithmetic.

            The fixed point instructions  include both full- and halfword  operations.  Fullword
            operations take place between the contents of two general registers, or  between the
            contents of  a general  register and  a fullword  stored in  memory, or  between the
            contents of a general register and a fullword obtained from the instruction stream.

            Halfword operations are  like fullword, except that  before the halfword  operand is
            used, it is  expanded to a  fullword by propagating  the most significant  bit (sign
            bit) into the high order bits of the fullword.




                                         5-3.1    ADD Instructions                                         5-3.1    ADD Instructions                                         5-3.1    ADD Instructions                                         5-3.1    ADD Instructions


                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                A                                           5A                   A                                           5A                   A                                           5A                   A       Add                                 5A         RX1
                A                                           5A                   A                                           5A                   A                                           5A                   A       Add                                 5A         RX2
                A                                           5A                   A                                           5A                   A                                           5A                   A       Add                                 5A         RX3
                AH                                          4A                   AH                                          4A                   AH                                          4A                   AH      Add Halfword                        4A         RX1
                AH                                          4A                   AH                                          4A                   AH                                          4A                   AH      Add Halfword                        4A         RX2
                AH                                          4A                   AH                                          4A                   AH                                          4A                   AH      Add Halfword                        4A         RX3
                AI                                          FA                   AI                                          FA                   AI                                          FA                   AI      Add Immediate                       FA         RI2
                AHI                                         CA                   AHI                                         CA                   AHI                                         CA                   AHI     Add Halfword Immediate              CA         RI1
                AR                                          0A                   AR                                          0A                   AR                                          0A                   AR      Add Register                        0A         RR
                AIS                                         26                   AIS                                         26                   AIS                                         26                   AIS     Add Immediate Short                 26         SF

            The second operand is added algebraically to the contents of the  register specified
            by R1.  The results  of this 32 bit addition  replaces the contents of  the register
            specified by R1.

            The second operand for the add immediate short instruction is obtained  by expanding
            the four bit data field, N, to a  32 bit fullword by forcing the high order  bits to
            zero.



                                              Condition Codes                                              Condition Codes                                              Condition Codes                                              Condition Codes

                    0000     equal to zero
                    0001     less than zero
                    0010     greater than zero




            ARITHMETIC INSTRUCTIONS                                                           43
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983




                              5-3.2    ADD to Memory Instructions                              5-3.2    ADD to Memory Instructions                              5-3.2    ADD to Memory Instructions                              5-3.2    ADD to Memory Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          AM                                          51             AM                                          51             AM                                          51             AM      Add to Memory                       51         RX1
          AM                                          51             AM                                          51             AM                                          51             AM      Add to Memory                       51         RX2
          AM                                          51             AM                                          51             AM                                          51             AM      Add to Memory                       51         RX3
          AHM                                         61             AHM                                         61             AHM                                         61             AHM     Add Halfword to Memory              61         RX1
          AHM                                         61             AHM                                         61             AHM                                         61             AHM     Add Halfword to Memory              61         RX2
          AHM                                         61             AHM                                         61             AHM                                         61             AHM     Add Halfword to Memory              61         RX3

      The second operand is added algebraically to the contents of the  register specified
      by R1.  The result replaces the second operand in memory.




                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes

              X000     equal to zero
              X001     less than to zero
              X010     greater than to zero





                                 5-3.3    SUBTRACT Instructions                                 5-3.3    SUBTRACT Instructions                                 5-3.3    SUBTRACT Instructions                                 5-3.3    SUBTRACT Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          S                                           5B             S                                           5B             S                                           5B             S       Subtract                            5B         RX1
          S                                           5B             S                                           5B             S                                           5B             S       Subtract                            5B         RX2
          S                                           5B             S                                           5B             S                                           5B             S       Subtract                            5B         RX3
          SH                                          4B             SH                                          4B             SH                                          4B             SH      Subtract Halfword                   4B         RX1
          SH                                          4B             SH                                          4B             SH                                          4B             SH      Subtract Halfword                   4B         RX2
          SH                                          4B             SH                                          4B             SH                                          4B             SH      Subtract Halfword                   4B         RX3
          SI                                          FB             SI                                          FB             SI                                          FB             SI      Subtract Immediate                  FB         RI2
          SHI                                         CB             SHI                                         CB             SHI                                         CB             SHI     Subtract Halfword Immediate         CB         RI1
          SR                                          0B             SR                                          0B             SR                                          0B             SR      Subtract Register                   0B         RR
          SIS                                         27             SIS                                         27             SIS                                         27             SIS     Subtract Immediate Short            27         SF

      The second  operand is subtracted  algebraically from the  contents of  the register
      specified by R1.  The result replaces the contents of the register specified by R1.






      44                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



                                              Condition Codes                                              Condition Codes                                              Condition Codes                                              Condition Codes

                    X000     equal to zero
                    X001     less than to zero
                    X010     greater than to zero





                                  5-3.4    COMPARE Algebraic Instructions                                  5-3.4    COMPARE Algebraic Instructions                                  5-3.4    COMPARE Algebraic Instructions                                  5-3.4    COMPARE Algebraic Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                C                                           59                   C                                           59                   C                                           59                   C       Compare                             59         RX1
                C                                           59                   C                                           59                   C                                           59                   C       Compare                             59         RX2
                C                                           59                   C                                           59                   C                                           59                   C       Compare                             59         RX3
                CH                                          49                   CH                                          49                   CH                                          49                   CH      Compare Halfword                    49         RX1
                CH                                          49                   CH                                          49                   CH                                          49                   CH      Compare Halfword                    49         RX2
                CH                                          49                   CH                                          49                   CH                                          49                   CH      Compare Halfword                    49         RX3
                CI                                          F9                   CI                                          F9                   CI                                          F9                   CI      Compare Immediate                   F9         RI2
                CHI                                         C9                   CHI                                         C9                   CHI                                         C9                   CHI     Compare Halfword Immediate          C9         RI1
                CR                                          09                   CR                                          09                   CR                                          09                   CR      Compare Register                    09         RR

            The  first  operand,  contained  in  the  register  specified  by  R1,  is  compared
            algebraically to the second operand.  The result is indicated by the  Condition Code
            setting.  Neither operand is changed.




                                              Condition Codes                                              Condition Codes                                              Condition Codes                                              Condition Codes

                    X000     operands are equal
                    X001     first operand less than second
                    X010     first operand greater than second

                      NOTE                      NOTE                      NOTE                      NOTE...These instructions are like compare logical,  except that
                      positive  numbers  are  always  greater  than  negative numbers.
                      Compare logical is faster, and produces the same condition codes
                      as subtract.












            SUBTRACT Instructions                                                             45
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                 5-3.5    MULTIPLY Instructions                                 5-3.5    MULTIPLY Instructions                                 5-3.5    MULTIPLY Instructions                                 5-3.5    MULTIPLY Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          M                                           5C             M                                           5C             M                                           5C             M       Multiply                            5C         RX1
          M                                           5C             M                                           5C             M                                           5C             M       Multiply                            5C         RX2
          M                                           5C             M                                           5C             M                                           5C             M       Multiply                            5C         RX3
          MR                                          1C             MR                                          1C             MR                                          1C             MR      Multiply Register                   1C         RR

      The  fullword  first  operand,  contained in  the  register  specified  by  R1+1, is
      multiplied by  the fullword  second operand.   the 64  bit result  is stored  in the
      registers specified by R1 and R1+1.




                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes


                    Condition codes are not affected.

                NOTE                NOTE                NOTE                NOTE...Multiply and divide use unsigned absolute arithmetic.

                R1+1 is  computed from R1  modulo 16d.  Thus  if R1  is register
                15d, then R1+1 is register 0.





                            5-3.6    MULTIPLY Halfword Instructions                            5-3.6    MULTIPLY Halfword Instructions                            5-3.6    MULTIPLY Halfword Instructions                            5-3.6    MULTIPLY Halfword Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          MH                                          4C             MH                                          4C             MH                                          4C             MH      Multiply Halfword                   4C         RX1
          MH                                          4C             MH                                          4C             MH                                          4C             MH      Multiply Halfword                   4C         RX2
          MH                                          4C             MH                                          4C             MH                                          4C             MH      Multiply Halfword                   4C         RX3
          MHR                                         0C             MHR                                         0C             MHR                                         0C             MHR     Multiply Halfword Register          0C         RR

      The  first operand,  contained in  bits 16:31  of the  register specified  by  R1 is
      multiplied by the 16 bit second operand.  The 32 bit result replaces the contents of
      the register specified by R1.




                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes


                    Condition codes are not affected.


      46                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983




                                        5-3.7    DIVIDE Instructions                                        5-3.7    DIVIDE Instructions                                        5-3.7    DIVIDE Instructions                                        5-3.7    DIVIDE Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                D                                           5D                   D                                           5D                   D                                           5D                   D       Divide                              5D         RX1
                D                                           5D                   D                                           5D                   D                                           5D                   D       Divide                              5D         RX2
                D                                           5D                   D                                           5D                   D                                           5D                   D       Divide                              5D         RX3
                DR                                          1D                   DR                                          1D                   DR                                          1D                   DR      Divide Register                     1D         RR

            The 64 bit operand contained in  the registers specified by R1 and R1+1  are divided
            by the fullword divisor.  The 32  bit signed remainder replaces the contents  of the
            register specified  by R1.  The  32 bit quotient  replaces the contents  of register
            R1+1.




                                              Condition Codes                                              Condition Codes                                              Condition Codes                                              Condition Codes


                          Condition codes are not affected.





                                   5-3.8    DIVIDE Halfword Instructions                                   5-3.8    DIVIDE Halfword Instructions                                   5-3.8    DIVIDE Halfword Instructions                                   5-3.8    DIVIDE Halfword Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                DH                                          4D                   DH                                          4D                   DH                                          4D                   DH      Divide Halfword                     4D         RX1
                DH                                          4D                   DH                                          4D                   DH                                          4D                   DH      Divide Halfword                     4D         RX2
                DH                                          4D                   DH                                          4D                   DH                                          4D                   DH      Divide Halfword                     4D         RX3
                DHR                                         0D                   DHR                                         0D                   DHR                                         0D                   DHR     Divide Halfword Register            0D         RR

            The 32 bit dividend contained in the register specified by R1 is divided by a 16 bit
            divisor taken from memory or from  bits 16:31 of the register specified by  R2.  The
            16 bit remainder is expanded to a fullword by propagating the sign bit  through bits
            0:15 and is stored in the register specified by R1.  The 16 bit quotient is expanded
            to a fullword  by propagating the sign  bit through bits 0:15  and is stored  in the
            register specified by R1+1.

            R1+1 is  computed from  R1 modulo 16d.   Thus if  R1 is register  15d, then  R1+1 is
            register 0.






            MULTIPLY Halfword Instructions                                                    47
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes


                    Condition codes are not affected.





                          5-3.9    SHIFT Right Arithmetic Instructions                          5-3.9    SHIFT Right Arithmetic Instructions                          5-3.9    SHIFT Right Arithmetic Instructions                          5-3.9    SHIFT Right Arithmetic Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          SRA                                         EE             SRA                                         EE             SRA                                         EE             SRA     Shift Right Arithmetic              EE         RX1
          SRA                                         EE             SRA                                         EE             SRA                                         EE             SRA     Shift Right Arithmetic              EE         RX2
          SRA                                         EE             SRA                                         EE             SRA                                         EE             SRA     Shift Right Arithmetic              EE         RX3

      The contents  of the  register specified  by R1 is  shifted right  by the  number of
      places specified by the second operand.  The sign bit (bit 0) remains unchanged, and
      is propagated right  as many places  as are specified  by the second  operand.  Bits
      shifted out of position  31 are shifted through the  carry flag and lost.   The last
      bit shifted remains in the carry flag.




                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes

              X000     equal to zero
              X001     less than zero
              X010     greater than zero





                         5-3.10    LOAD Halfword Register Instructions                         5-3.10    LOAD Halfword Register Instructions                         5-3.10    LOAD Halfword Register Instructions                         5-3.10    LOAD Halfword Register Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          LHR                                         12             LHR                                         12             LHR                                         12             LHR     Load Halfword Register              12         RR
          CHVR                                        12             CHVR                                        12             CHVR                                        12             CHVR    Convert Halfword Value Register     12         RR

      The  halfword second  operand, (bits  16:31)  of the  register specified  by  R2, is
      expanded to a fullword by sign-extending bit 16 through bits 0:15, and then replaces
      the contents of the register specified by R1.

      CHVR is an obsolete mnemonic for the LHR instruction.



      48                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



                                              Condition Codes                                              Condition Codes                                              Condition Codes                                              Condition Codes

                    X000     equal to zero
                    X001     less than zero
                    X010     greater than zero


















































            LOAD Halfword Register Instructions                                               49
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



























                                               *
                                              * *
                                               *




























      50                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            5-4    STATUS SWITCHING INSTRUCTIONS            5-4    STATUS SWITCHING INSTRUCTIONS            5-4    STATUS SWITCHING INSTRUCTIONS            5-4    STATUS SWITCHING INSTRUCTIONS



            The  Status-Switching instructions  provide for  software control  of  the interrupt
            structure of the  system.  They also allow  user level programs to  communicate with
            control software.  All status switching instructions, with the exception of  the SVC
            and UPSW instructions, are privileged instructions.  Because of this,  all interrupt
            handling routines must run in the supervisor mode.




                               5-4.1    LOAD Program Status Word Instructions                               5-4.1    LOAD Program Status Word Instructions                               5-4.1    LOAD Program Status Word Instructions                               5-4.1    LOAD Program Status Word Instructions


                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                LPSW                                        C2                   LPSW                                        C2                   LPSW                                        C2                   LPSW    Load Program Status Word            C2         RX1
                LPSW                                        C2                   LPSW                                        C2                   LPSW                                        C2                   LPSW    Load Program Status Word            C2         RX2
                LPSW                                        C2                   LPSW                                        C2                   LPSW                                        C2                   LPSW    Load Program Status Word            C2         RX3
                UPSW                                        D5                   UPSW                                        D5                   UPSW                                        D5                   UPSW    User Program Status Word            D5         RX1
                UPSW                                        D5                   UPSW                                        D5                   UPSW                                        D5                   UPSW    User Program Status Word            D5         RX2
                UPSW                                        D5                   UPSW                                        D5                   UPSW                                        D5                   UPSW    User Program Status Word            D5         RX3
                LPSWR                                       18                   LPSWR                                       18                   LPSWR                                       18                   LPSWR   Load Program Status Word Register   18         RR

            The low-order 16 bits of the first 32-bit word of the second operand become  the new
            PSW, and  the low-order 20  bits of the  second 32-bit word  become the  new Program
            Counter.

            UPSW works  like LPSW,  except that  not all  of the  fields of  the target  PSW are
            loaded.  In particular,  only those bits masked  by x'100F' ("trace"  bit, condition
            codes) in the PSW may be changed.  Other bits will remain unchanged.

            For the  LPSWR instruction, it  should be noted  that the 64  bit second  operand is
            obtained from the registers specified by R1 and R2, where the address  portion comes
            from (R1), and the PSW portion comes from (R2).



                                              Condition Codes                                              Condition Codes                                              Condition Codes                                              Condition Codes

                          determined by the new PSW.




                           5-4.2    EXCHANGE Program Status Register Instructions                           5-4.2    EXCHANGE Program Status Register Instructions                           5-4.2    EXCHANGE Program Status Register Instructions                           5-4.2    EXCHANGE Program Status Register Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                EPSR                                        95                   EPSR                                        95                   EPSR                                        95                   EPSR    Exchange Program Status Register    95         RR


            STATUS SWITCHING INSTRUCTIONS                                                     51
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      Bits 0:31 of the  current program status word  replace the contents of  the register
      specified by R1.  The contents of the register specified by R2 replace bits  0:31 of
      the current  program status  word.  If R1  = R2,  bits 0:31 of  the current  PSW are
      copied into the register specified by R1, but otherwise remain unchanged.



                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes

                    Determined by the new status.




                             5-4.3    SUPERVISOR Call Instructions                             5-4.3    SUPERVISOR Call Instructions                             5-4.3    SUPERVISOR Call Instructions                             5-4.3    SUPERVISOR Call Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          SVC                                         E1             SVC                                         E1             SVC                                         E1             SVC     SuperVisor Call                     E1         RX1
          SVC                                         E1             SVC                                         E1             SVC                                         E1             SVC     SuperVisor Call                     E1         RX2
          SVC                                         E1             SVC                                         E1             SVC                                         E1             SVC     SuperVisor Call                     E1         RX3

      The address of the second operand replaces bits 8:31 of register 13 of  register set
      0.  Bits 0:7 of this register  are forced to zero.  The current program  status word
      replaces  the contents  of registers  14 and  15 of  register set  0.   The fullword
      quantity located at X'00098 in memory replaces bits 0:31 of the current PSW.  The R1
      field  is doubled  and added  to  X'0009C.  The  halfword quantity  located  at this
      address is  expanded to 32  bits by filling  bits 0:15 with  zeros, and  becomes the
      current location counter.



                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes

                    Determined by the new PSW.



















      52                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            5-5    I/O INSTRUCTIONS            5-5    I/O INSTRUCTIONS            5-5    I/O INSTRUCTIONS            5-5    I/O INSTRUCTIONS



            The I/O instructions use the Register to Register (RR) and the Register  and Indexed
            Storage (RX) instruction formats.

            ALL  CPU operands  are 16-bit  quantities, even  if certain  devices only  use 8-bit
            quantities.  Thus, status and commands are both 16-bit quantities.

            In particular, device address is a 16-bit quantity, even though, by convention, only
            the low-order (rightmost)  8-bits are used to  address the specific  device (certain
            devices may address subdevices via the high- order bits).

            For the  RX instructions,  The half-word operand  is fetched  from the  half-word of
            memory specified (the low-order bit of address is ignored).  Then, if  the low-order
            bit of memory  is off (even byte  address), the half-word of  data has the  left and
            right  bytes  swapped,  and  the resulting  operand  is  output.   This  permits the
            addressing of  bytes in memory  for the  use of byte-oriented  devices.  The  way to
            remember this rule is that the byte addressed is transmitted as the  right-most byte
            of the  16-bit operand.   (If one  wishes to  transmit a  half-word from  a halfword
            boundary, with  the same left-right  relationship as appears  in memory,  one should
            address the right-most byte:  i. e., the half-word address + 1!)

             NOTE                                             NOT             NOTE                                             NOT             NOTE                                             NOT             NOTE...Unlike  the  Interdata,  register  3  is  NOT  set  up  with  status  on I/O
                                                        MUST                                                        MUST                                                        MUST            interrupts.  If status is desired, the user MUST issue a SSR instruction!

            Following  most I/O  instructions, the  V flag  in the  Condition Code  indicates an
            instruction  timeout.  This  means that  the instruction  was not  completed, either
            because the device did not respond at all, or because it responded incorrectly.

            In  the Sense  Status instruction,  the V  flag can  also mean  examine  status.  To
            distinguish between these  two conditions, the program  should test Bits 0:3  of the
            device status.  If all of these bits are zero, device timeout has occurred.



                                              Condition Codes                                              Condition Codes                                              Condition Codes                                              Condition Codes
            0100     timeout has occurred
            XXXX     normal response




                                      5-5.1    Console IO Instructions                                      5-5.1    Console IO Instructions                                      5-5.1    Console IO Instructions                                      5-5.1    Console IO Instructions


                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                CIO                                         99                   CIO                                         99                   CIO                                         99                   CIO     Console IO                          99         RR

            The low-order 16 bits of the register specified by R1 are placed into  the low-order
            (right) 16 bits of the display.   The low-order 20 bits of the next  register (R1+1)



            SUPERVISOR Call Instructions                                                      53
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      are placed into  the high-order (left)  20 bits of the  display.  The 16  bit switch
      register is then input, and placed into the register specified by R2.



                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes


            The condition codes are not affected by this instruction.




                               5-5.2    Sense Status Instructions                               5-5.2    Sense Status Instructions                               5-5.2    Sense Status Instructions                               5-5.2    Sense Status Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          SSR                                         9D             SSR                                         9D             SSR                                         9D             SSR     Sense Status Register               9D         RR

      Bits 16:31 of the register specified  by R1 contain the device address.   The device
      is addressed and the device status is placed in R2.  The Condition Code is set equal
      to the rightmost four bits of the device status.  The first operand is unchanged.

      This is a privileged instruction.



                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes

      Bits  4:7  of  the device  status  are  copied into  the  Condition  Code.   See the
      appropriate device manual for a description of this status.




                              5-5.3    Output Command Instructions                              5-5.3    Output Command Instructions                              5-5.3    Output Command Instructions                              5-5.3    Output Command Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          OC                                          DE             OC                                          DE             OC                                          DE             OC      Output Command                      DE         RX1
          OC                                          DE             OC                                          DE             OC                                          DE             OC      Output Command                      DE         RX2
          OC                                          DE             OC                                          DE             OC                                          DE             OC      Output Command                      DE         RX3
          OCR                                         9E             OCR                                         9E             OCR                                         9E             OCR     Output Command Register             9E         RR

      Bits 16:31 of the register specified  by R1 contain the device address.   The device
      is  addressed and  the command  half-word from  the second  operand location  to the
      device.  Neither operand is changed.

      These are privileged instructions.



      54                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                              Condition Codes                                              Condition Codes                                              Condition Codes                                              Condition Codes

            0100     Instruction timeout
            0000     Operation successful




                                      5-5.4    Read Data Instructions                                      5-5.4    Read Data Instructions                                      5-5.4    Read Data Instructions                                      5-5.4    Read Data Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                RDR                                         9B                   RDR                                         9B                   RDR                                         9B                   RDR     Read Data                           9B         RR

            Bits 16:31 of the register specified  by R1 contain the device address.   The device
            is  addressed  and  responds  by transmitting  a  sixteen-bit  data  quantity.  This
            quantity is placed in the register specified  by R2.  Bits 0:15 of R2 are  forced to
            zero.

            This is a privileged instruction.



                                              Condition Codes                                              Condition Codes                                              Condition Codes                                              Condition Codes

            0000     Operation Successful
            0100     Instruction timeout




                                      5-5.5    Write Data Instructions                                      5-5.5    Write Data Instructions                                      5-5.5    Write Data Instructions                                      5-5.5    Write Data Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                WD                                          DA                   WD                                          DA                   WD                                          DA                   WD      Write Data                          DA         RX1
                WD                                          DA                   WD                                          DA                   WD                                          DA                   WD      Write Data                          DA         RX2
                WD                                          DA                   WD                                          DA                   WD                                          DA                   WD      Write Data                          DA         RX3
                WDR                                         9A                   WDR                                         9A                   WDR                                         9A                   WDR     Write Data Register                 9A         RR

            Bits 16:31 of the register specified  by R1 contain the device address.   The device
            is addressed the  processor transmits a sixteen-bit  data quantity, from  the second
            operand location, to the device.  Neither operand is changed.

            For the  RX format  instructions, the 16-bit  halfword at  the effective  address is
            output.  If the effective address is EVEN, THE LEFT AND RIGHT BYTE OF  THAT HALFWORD
            ARE SWAPPED BEFORE  OUTPUT!  This insures that  the specific byte addressed  will be
            output in the correct format for  byte (8-bit data) devices.  It also  requires that
            the programmer transferring  a 16-bit quantity from  memory to a device  address the
            ODD (right-most) byte of that half-word!


            Output Command Instructions                                                       55
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      For the RR format instruction, the low-order 16 bits of the register specified by R2
      are output.

      This is a privileged instruction.



                                        Condition Codes                                        Condition Codes                                        Condition Codes                                        Condition Codes

      0000     Operation Successful
      0100     Instruction timeout













































      56                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            5-6    SPECIAL INSTRUCTIONS            5-6    SPECIAL INSTRUCTIONS            5-6    SPECIAL INSTRUCTIONS            5-6    SPECIAL INSTRUCTIONS



            This chapter describes the special, TYMNET-oriented instructions implemented  in the
            ENGINE microcode.




                                   5-6.1    Async Microcode Instructions                                   5-6.1    Async Microcode Instructions                                   5-6.1    Async Microcode Instructions                                   5-6.1    Async Microcode Instructions


                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                **SBOD                                      13                   **SBOD                                      13                   **SBOD                                      13                   **SBOD  Start Baud                          13         RR
                **XMIT                                      14                   **XMIT                                      14                   **XMIT                                      14                   **XMIT  Start Baud Output                   14         RR
                **SPM                                       15                   **SPM                                       15                   **SPM                                       15                   **SPM   Start Baud TID                      15         RR
                **GCHAR                                     16                   **GCHAR                                     16                   **GCHAR                                     16                   **GCHAR Start Baud Input                    16         RR

                                                 A.    SBOD                                                 A.    SBOD                                                 A.    SBOD                                                 A.    SBOD

            SBOD performs  the start-baud scanner  function.  Expects R2  to contain  the MAC'ed
            address of a  bit array with  bits set corresponding  to ports with  output pending.
            This instruction does a normal return if no input or output pending; a skip  (^4) if
            a start-baud has been detected; skip-2 (^8) if an output port requires  service.  In
            the latter two cases, registers RP and RP2 (0E and 0D) will be set up to reflect the
            port discovered.




                                                 B.    XMIT                                                 B.    XMIT                                                 B.    XMIT                                                 B.    XMIT

            XMIT places output character into the ring.  Expects registers RP and RP2 to  be set
            up.  The  character is  output from  register 0,  and the  register specified  by R2
            contains the output baud rate index for this port.




                                                 C.    SPM                                                 C.    SPM                                                 C.    SPM                                                 C.    SPM

            SPM Performs the Terminal Identification function.  SPM will perform a normal return
            if more than 36 samples of spacing  state are detected: else it will perform  a skip
            (^2)  return; then  the  number of  samples of  spacing  state is  contained  in the
            register specified by R1.









            SPECIAL INSTRUCTIONS                                                              57
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                          D.    GCHAR                                          D.    GCHAR                                          D.    GCHAR                                          D.    GCHAR

      GCHAR gets input character.  Expects registers RP and RP2 to be set up.   It expects
      the character to be output to be  in register 0, and also expects that  the register
      specified by R2 contain the input baud rate index.  This instruction will  perform a
      normal return for normal characters; it performs a skip (^4) return if it  detects a
      break character (no stop baud) on input.

      The  async microcode  performs a  number of  specialized operations  associated with
      async input and  output.  It also causes  the "70"-series interrupts to  be serviced
      automatically, without any memory references, EVEN IF NO ASYNC IS IMPLEMENTED!  As a
      result, it is  critical that the initialization  be performed correctly,  to prevent
      run-away.

      The microcode assumes the use of register sets 1, 2, 3, 4, and 0D.   These registers
      should be initialized to the following usage:

      :       Initialization for register set 1
                                      :R0     PSW SAVE
                                      :R1     WORKING
                                      :R2     PORT NUMBER
                                      :R3     OFFSET
      IREG1   WC      0               :R4     CONTROL INDEX
              WC      AS.CTL          :R5     CONTROL ADDRESS
              WC      4               :R6     5COUNT
              WC      -AS.SIZ+F/6     :R7     SBX
              WC      -AS.SIZ+F/6     :R8     RGX1
              WC      OFFSET          :R9     RGX
              HC      F/6,2*F/6       :R10    1/6|2/6 FRAME
              HC      3*F/6,4*F/6     :R11    3/6|4/6 FRAME
              HC      5*F/6,F         :R12    5/6|6/6 FRAME
              WC      AS.SIZ          :R13    SIZE OF RING
              WC      AS.ERN          :R14    BASE ADDRESS
              IF      NASYNG                                          <a>
              HC      LAREG,ADA       :R15    YD INIT|ADDRESS INIT
              ELSE
              HC      8010,ADA        :R15    SIGN BIT SET IF NO ASYNC
              EI


















      58                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



            :       Initialization for register set 2
                                            :R0     PSW SAVE
                                            :R1     WORKING
                                            :R2     PORT NUMBER
                                            :R3     WORKING
                                            :R4     WORKING
            IREG2   WC      -F              :R5     RGX
                    WC      -F              :R6     RGI
                    WC      AS.ERN          :R7     RING END
                    WC      0               :R8     TIME5 COUNT
                    WC      OFFSET+TIK5-F/6 :R9     RGX5
                    WC      LAREG           :R10    YDINIT
                    WC      RCHAR           :R11    RECEIVE CHAR WIDTH      <b>
                    WC      XLNGTH          :R12    TRANSMIT CHAR WIDTH     <b>
                    WC      AS.SIZ          :R13    RSIZE
                    HC      4*TIK5,TIK5     :R14    4*TIKM5|TIKM5
                    WC      AS.LCT          :R15    AS.LCT

            :       Initialization for register set 3
            :       Each register corresponds to one group:  SBA|TAM
            :       Each register in register set 3 holds the SBA|TAM data for
            :       16 ports in the format SSSSTTTT, where SSSS is the SBA
            :       data, and TTTT is the corresponding TAM information.

            :       Initialization for register set 4
            :       Each register corresponds to one group:  OUT DATA
            IREG34  RE      10;     WC      0000FFFF;       ER

            :       Initialization for register set 0D
                                            :R0
                                            :R1
                                            :R2
                                            :R3
                                            :R4
                                            :R5
                                            :R6
                                            :R7
                                            :R8
                                            :R9
                                            :R10
                                            :R11
                                            :R12
                                            :R13
                    WC      WAIT            :R14    HOW LONG 'TIL INTERRUPT
                    WC      TIME            :R15    INTERRUPT ROUTINE ADDRESS










            GCHAR                                                                             59
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


              Where:

      RP      EQ      $A 14           :CURRENT PORT INDEX
      RP2     EQ      $A 13           :TWICE CURRENT PORT INDEX
              IF      NASYNG-8                                        <c>
      ADA     EQ      0C1             :ASYNC DEVICE ADDRESS
              ELSE
      ADA     EQ      91              :ASYNC DEVICE ADDRESS
              EI
      LAREG   EQ      10-NASYNG       :LOWEST ASYNC REGISTER USED
      F       EQ      $A 12*NASYNG    :FRAME SIZE (BYTES)             <d>
      OFFSET  EQ      -AS.SIZ+$A53*F  :DISPLACEMENT BETWEEN SBX AND RGX
      TIK5    EQ      5*F
      AS.CTL  WS      100             :CONTROL STORAGE                <e>
      AS.LCT  HS      100             :TIMEOUT STORAGE
      AS.SIZ  EQ      $A(53+60)*F+30*TIK5 :THE SIZE OF THE RING (BYTES)
      AS.RNG  BS      AS.SIZ          :RING STORAGE
      AS.ERN  WS      0               :END OF RING

      Furthermore, the following tables need be provided if async is active:

      :    PARAMETERS (all numbers are decimal)
      Q    EQ      F/2             :Q IS 1/1200TH OF A SECOND
      :    CPS:    10     15    30    40    60    120   30    14.7  30/10
      :    TRANSMIT WIDTH
      XLNGTH  HC   120*Q, 80*Q, 40*Q, 30*Q, 20*Q, 10*Q, 40*Q, 90*Q, 120*Q
      :  RECEIVE CHARACTER LENGTH IN 2*1800 UNITS
      RCHAR   HC      312,   228,  114,  86,   56,   28,   114,  230,  0

                                             NOTES                                             NOTES                                             NOTES                                             NOTES

           a.   The  left-half  of  this register  specifies  the  first  register of
                register set 3 (or 4) which  is to be used, for the number  of groups
                active.  It should  be set to register  16d, and have  the high-order
                bit on, if the machine contains microcode, but no async is in use.

           b.   These parameters  are not  referenced (and  may thus  be left  to any
                arbitrary value) if async is not in use.

           c.   If there are  4 (or less) async  cards, the cards are  addressed with
                the first  card having device  address 91; if  there are more  than 4
                cards, it becomes  necessary to address  the first card  with address
                0C1.

           d.   For each  frame of async  data, it is  necessary to allocate  6 half-
                words of space for each group of 16 async ports.

           e.   This storage must be allocated (with these sizes, and in  this order)
                for the microcode to access.  It should be initialized as follows:


      AS.CTL  to  AS.RNG+$A53*F-1             all bits on;
      AS.RNG+$A53*F  to AS.ERN-1              all bits off.



      60                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



                                    5-6.2    SYNC Microcode Instructions                                    5-6.2    SYNC Microcode Instructions                                    5-6.2    SYNC Microcode Instructions                                    5-6.2    SYNC Microcode Instructions



                NAD                                       Op-code                NAD                                       Op-code                NAD                                       Op-code                NAD     Instruction                       Op-code      Format

                **SCAN                                      35                   **SCAN                                      35                   **SCAN                                      35                   **SCAN  Scan Sync input                     35         RR
                **ALIGN                                     36                   **ALIGN                                     36                   **ALIGN                                     36                   **ALIGN Align Sync input                    36         RR
                **CKSUM                                     37                   **CKSUM                                     37                   **CKSUM                                     37                   **CKSUM Checksum Sync input                 37         RR

                                                 A.    SCAN                                                 A.    SCAN                                                 A.    SCAN                                                 A.    SCAN

            SCAN scans through  the SYNC input  data looking for  data other than  marking state
            (all ones).   Expects the register  specified by  R2 to contain  the address  of the
            input ring  to scan  (100x bytes  long).  Expects  the register  specified by  R1 to
            contain the  lead pointer  (RLP, index), and  R1+1 to  contain the  trailing pointer
            (RTP, index).  A  normal return is  made if non-marking  data is encountered  in the
            input ring, and a skip return (+2) if not.  The instruction stops scanning  when the
            trailing pointer is less than 10x bytes behind the lead pointer.
            EXAMPLE:

                    LA      9,BUFFER                :address of input ring
                    LHL     7,RLP                   :lead pointer
                    LHL     8,RTP                   :trailing pointer
                    HC      3579                    :**SCAN
                    JFS     HIT                     :non-skip return for hit
            NOHIT   EQ      .                       :no-hit return
                    ...
            HIT     EQ      .                       :success routine




                                                B.    ALIGN                                                B.    ALIGN                                                B.    ALIGN                                                B.    ALIGN

            ALIGN gets  data from  the SYNC  input ring,  shifts it  for correct  alignment, and
            stores  it in  the designated  buffer  (input sector)  for RTD.   Both  vertical and
            diagonal  checksums are  computed  in the  process.   The register  specified  by R1
            contains the start address of the input ring.  R2 is to contain the trailing pointer
            (RTP, index) BEYOND the first word of the input packet.

            ALIGN also requires the following specific registers to be set up:

              1       no. of halfwords to move
              3       first halfword of input data
              5       vertical checksum (initialize to 0)
              7       diagonal checksum (initialize to 0)
              8       Address of input sector where aligned data is to be stored.
                 (If negative, no store takes place).
              10d      alignment shift factor (complement:  no. bits-1  to shift
                 right)




            GCHAR                                                                             61
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                          C.    CKSUM                                          C.    CKSUM                                          C.    CKSUM                                          C.    CKSUM

      CKSUM computes the  vertical and diagonal checksums  for the designated area  (up to
      80x bytes long).  Expects the register specified by R2 to contain the  start address
      of  the data,  and Register  0 to  contain the  negative byte  count.   The vertical
      checksum is returned in the register  specified by R1, and the diagonal  checksum in
      R1+1.

      If the byte  count specifies more than  80x bytes, an illegal  instruction interrupt
      occurs.

      Both  checksums  MUST be  initialized  by  the software  BEFORE  executing  the CKSM
      instruction.




                           5-6.3    Bufferlet Microcode Instructions                           5-6.3    Bufferlet Microcode Instructions                           5-6.3    Bufferlet Microcode Instructions                           5-6.3    Bufferlet Microcode Instructions



          NAD                                       Op-code          NAD                                       Op-code          NAD                                       Op-code          NAD     Instruction                       Op-code      Format

          **GCI                                       38             **GCI                                       38             **GCI                                       38             **GCI   Get Character Input                 38         ???
          **WCI                                       39             **WCI                                       39             **WCI                                       39             **WCI   Write Character Input               39         ???
          **CBCT                                      3A             **CBCT                                      3A             **CBCT                                      3A             **CBCT  Compute BCT                         3A         ???
          **RTD1                                      3B             **RTD1                                      3B             **RTD1                                      3B             **RTD1  RTD Copy 1                          3B         ???
          **RTD2                                      3C             **RTD2                                      3C             **RTD2                                      3C             **RTD2  RTD Copy 2                          3C         ???
          **RMA1                                      0E             **RMA1                                      0E             **RMA1                                      0E             **RMA1  RMAKE Copy 1                        0E         ???
          **RMA2                                      0F             **RMA2                                      0F             **RMA2                                      0F             **RMA2  RMAKE Copy 2                        0F         ???

                                           A.    GCI                                           A.    GCI                                           A.    GCI                                           A.    GCI

      GCI  Gets a  character from  the specified  buffer and  returns it  in  the register
      specified by R1.  Register 3  will then contain BB.  Expects the  register specified
      by R2 to contain the buffer no. times 4.  The instruction is followed by 5 halfwords
      of data, containing the information:

      GCIINS  HC      3801                    :**GCI instruction
              HC      4*NBUF                  :size of BB storage (BE-BB)
              HC      ERROR-GCIINS            :error address (on empty
                                              : buffer, bad buffer index)
              HC      BB/4                    :address of BB storage/4
              HC      NEXT-GCIINS             :Empty Bufferlet Address
              HC      LAST-GCIINS             :Empty Buffer Address

            where:

      ERROR,  NEXT,  and LAST  are  addresses of  routines  to handle  errors,  freeing of
      bufferlets,  and  emptying  of  buffers,  respectively.   These  addresses  are  all
      specified as RELATIVE to the GCI instruction!

      The  word array  BE (length  = NBUF  words) FOLLOWS  IMMEDIATELY the  word  array BB
      (length = NBUF words).


      62                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            The address of BB is absolute, but divided by 4, to allow references to  any address
            within the first 256K of Address Space.




                                                 B.    WCI                                                 B.    WCI                                                 B.    WCI                                                 B.    WCI

            WCI Writes a character to the specified buffer from the register specified by R1.

            Expects  the register  specified by  R2 to  contain the  buffer no.   times  4.  The
            instruction is followed by 5 halfwords of data, containing the information:

            WCIINS  HC      3901                    :**WCI instruction
                    HC      4*NBUF                  :size of BB storage (BE-BB)
                    HC      ERROR-WCIINS            :error addr. (bad buf. index)
                    HC      BE/4                    :address of BE storage/4
                    HC      NEXT-WCIINS             :Full Bufferlet Address
                    HC      FIRST-WCIINS            :Empty Buffer Addr. (1st time)

                  where:

            ERROR,  NEXT, and  FIRST are  addresses  of routines  to handle  errors,  filling of
            bufferlets, and using of  buffers, respectively.  These addresses are  all specified
            as RELATIVE to the WCI instruction!

            The word array BE has length = NBUF words.

            The address of BE is absolute, but divided by 4, to allow references to  any address
            within the first 256K of Address Space.




                                                 C.    CBCT                                                 C.    CBCT                                                 C.    CBCT                                                 C.    CBCT

            CBCT  Computes the  exact size  (BCT) of  a buffer  and returns  it in  the register
            specified by R1.   Expects the register  specified by R2  to contain the  buffer no.
            times  4.   The instruction  is  followed by  2  halfwords of  data,  containing the
            information:

                    HC      3A04                    :**CBCT instruction (r4
                                                    :       has buffer no.)
                    HC      BB/4                    :address of BB storage/4
                    HC      4*NBUF                  :size of BB











            GCI                                                                               63
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                      D.    RTD1 and RTD2                                      D.    RTD1 and RTD2                                      D.    RTD1 and RTD2                                      D.    RTD1 and RTD2

      These perform the RTD function of  copying data from an input logical record  to the
      appropriate buffer.  R1 is used as a scratch register by the microcode, and  may, on
      occasion, contain the last character.  R2  is expected to contain the byte  count of
      characters to move.  In addition, register  12 is assumed to contain the  address of
      the logical record, and register 3 is BE (address of the last character input).

      The  3B opcode  (RTD1) is  used for  the initial  entry into  the microcode,  and is
      followed immediately  by the the  3C opcode (RTD2)  which is used  to return  to the
      microcode.

      The RTD2 instruction is followed by 5 halfwords:

      RTD     HC      3B02                    :**RTD1
      RTDRTN  HC      3C02                    :**RTD2
              HC      NEXT-RTDRTN             :to get next bufferlet
                                              :  (continue at RTDRTN)
              HC      CHAR0-RTDRTN            :to handle char 0
              HC      CHAR1-RTDRTN            :to handle char 1
              HC      CHAR2-RTDRTN            :to handle char 2
              HC      CHAR3-RTDRTN            :to handle char 3

      Each of these character handlers  should return to RTD to continue  execution.  Each
      address is a displacement from the RTD2 instruction itself.  When any of the special
      character handlers (CHAR0-CHAR3)  is called, the  character has already  been stored
      but the byte count has not  been decremented or tested.  These operations  should be
      done PRIOR to resuming control at RTD.  (Also, store last character if count = 0.)

      It is up to the software to handle character pairs.




                                      E.    RMA1 and RMA2                                      E.    RMA1 and RMA2                                      E.    RMA1 and RMA2                                      E.    RMA1 and RMA2

      These perform the RMAKE function of copying data from an output buffer to  a logical
      record.  R1  is used  as a  scratch register by  the microcode.   R2 is  expected to
      contain the byte count of characters  to move.  In addition, register 12  is assumed
      to contain the  address of the  logical record-1, and register  3 is BB  (address of
      next character to be output).

      The  0E opcode  (RMA1) is  used for  the initial  entry into  the microcode,  and is
      followed immediately  by the the  0F opcode (RMA2)  which is used  to return  to the
      microcode.

      The RMA2 instruction is followed by 5 halfwords:









      64                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            RMAKE   HC      0E02                    :**RMA1
            RMRTN   HC      0F02                    :**RMA2
                    HC      NEXT-RMRTN              :to return a bufferlet,
                                                    :  get next one.
                                                    :  (continue at RMRTN)
                    HC      CHAR0-RMRTN             :to handle char 0
                    HC      CHAR1-RMRTN             :to handle char 1
                    HC      CHAR2-RMRTN             :to handle char 2
                    HC      CHAR3-RMRTN             :to handle char 3

            Each of these character handlers should return to RMAKE to continue execution.  Each
            address is a displacement from the RMA2 instruction itself.




                                    F.    Buffer and Bufferlet Structure                                    F.    Buffer and Bufferlet Structure                                    F.    Buffer and Bufferlet Structure                                    F.    Buffer and Bufferlet Structure

            It is assumed that the following data structures have been set up:

            BB      WS      NBUF                    :pointers to "Buffer Begin"
            BE      WS      NBUF                    :pointers to "Buffer End"

                  Each bufferlet has the form:


                    --------.-------.-------.--------
                    |       | char storage  |       |
                    |-------.-------.-------.-------|
                    |       |       |       |       |
                    |-------.-------.-------.-------|
                    |       |       |       |       |
                    |-------.-------.-------.-------|
                    |       |       | next buflet # |
                    ---------------------------------



            The bufferlet  storage is required  to begin at  a multiple of  16 bytes;  The first
            halfword in this space is then (normally) the free list (list of  unused bufferlets)
            header.  Thus the first bufferlet is numbered "1", starts at FREE+2, and its pointer
            is at  FREE+10.  The  next bufferlet  is numbered  "2", starts  at FREE+12,  and its
            pointer is at FREE+20...etc.

            In use, BB (and BE) are indexed via the buffer index (4*buffer number),  and contain
            a pointer to the next byte to be emptied (or filled).  If that buffer is  empty, the
            pointers are also zeroed  out.  The exhaustion of  a bufferlet is recognized  by the
            low-order  4  bits  of  the character  address  going  to  zero,  causing full/empty
            bufferlet traps.  In all  cases, the "next buflet  no" field contains the  NUMBER of
            the next bufferlet associated with this character stream.






            RMA1 and RMA2                                                                     65
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



























                                               *
                                              * *
                                               *




























      66                                   Chapter 5 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                                 Chapter 6                                                 Chapter 6                                                 Chapter 6                                                 Chapter 6

                                            BOARD BLOCK DIAGRAMS                                            BOARD BLOCK DIAGRAMS                                            BOARD BLOCK DIAGRAMS                                            BOARD BLOCK DIAGRAMS




            This section  contains the  block diagrams  for each  of the  circuit boards  in the
            Engine, together with a brief description of the block diagram.















































            BOARD BLOCK DIAGRAMS                                                              67
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983























































                                 Figure 6-1                                 Figure 6-1                                 Figure 6-1                                 Figure 6-1.  CPU Block Diagram


      68                                   Chapter 6 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            6-1    CPU BLOCK DIAGRAM EXPLANATION            6-1    CPU BLOCK DIAGRAM EXPLANATION            6-1    CPU BLOCK DIAGRAM EXPLANATION            6-1    CPU BLOCK DIAGRAM EXPLANATION

            ALU  (Arithmetic and  Logic Unit)            ALU  (Arithmetic and  Logic Unit)            ALU  (Arithmetic and  Logic Unit)            ALU  (Arithmetic and  Logic Unit)--This  is the  number-crunching heart  of  the CPU
            board.  It is a full 32-bit device,  using 8 74S181 chips, so that it is  capable of
            anything up to a 32-bit multiply.  It also has look-ahead carry (CIN) from the ROM &
            I/O microcode.  The ALU functions are determined by the microcode via the ALU Select
            MUX.

            The output  of the  ALU is the  Sigma or  Sum Bus, a  32-bit bus  which goes  to the
            Working Register  and the  Extended Working  Register, the  Program Counter  and the
            Memory Counter.

            Some of the more frequently used ALU functions are listed below:
                            F=A PLUS 1
                            F=B
                            F=A
                            F=A AND B
                            F=A OR B
                            F=A PLUS B
                            F=A MINUS B
                            F=A EXOR B
                            F=A MINUS 1

            Working Register and Extended  Working Register            Working Register and Extended  Working Register            Working Register and Extended  Working Register            Working Register and Extended  Working Register--These are 32-bit registers  used to
            hold the output of the ALU.  The Extended Register is used for results  of full-word
            multiplications and other 64-bit results.  Three sets of signals are used to control
            these registers:   XWRS0 and  XWRS1 for  the Extended  Working Register,  WRRTS0 and
            WRRTS1 for the  right half of  the Working Register, and  WRLTS0 and WRLTS1  for the
            left half of  the Working Register.   Each set of signals  can specify one  of three
            functions:

                      xxxxS0  xxxxS1    Function
                           1       1    Parallel Load from Sum Bus.
                           1       0    Shift Right.
                           0       1    Shift Left.
                           0       0    No Function.

            The SR and  SL inputs are  serial inputs for use  on operations that  require serial
            inputs of bits, such as a rotate.

            Shift Register Control Store            Shift Register Control Store            Shift Register Control Store            Shift Register Control Store-- Translates the microcode from the ROM & I/O Card into
            control signals for the Working  Register and Extended Working Register.   These can
            be made to shift, rotate, or arithmetic shift their contents, either all at  once or
            one half at a time.  They can also be loaded individually, together, or one  part at
            a time.  The Control Store also  provides control signals for the Carry  Bit Control
            MUX and the Overflow Bit and Control MUX.  WRCTL bits 0:3 of the microcode  select a
            location  in the  Shift Register  Control  Store PROM.   The data  in  that location
            determines the state of the control signals to the Working Register and the Extended
            Working register.  Also,  MUXS0 and MUXS1 are  generated to handle shift  and rotate
            operations:
                 MUXS0  MUXS1    Function

                     0      0    WR0 is available at WR31 for left rotate operations, XWR31



            CPU BLOCK DIAGRAM EXPLANATION                                                     69
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                           for multiplication,  and WR0 to  maintain the sign  bit on
                           shift right operations.

               0      1    XWR31 is available at WR0 for divide operations and a zero
                           is available at WR31 for shift left operations.

               1      0    XWR0 is available at  WR31 for the microcoded  left rotate
                           of the Extended Working Register and the Working Register,
                           and a zero is available and WR0 for right  shifts, without
                           maintaining the sign.

               1      1    WR31 is available at WR0 for rotate right  operations, and
                           WR16 is  available at  WR31 for  the halfword  left rotate
                           used by the microcode.

      Carry Bit Control  MUX      Carry Bit Control  MUX      Carry Bit Control  MUX      Carry Bit Control  MUX-- This determines where  the carry bit comes  from, depending
      upon the type of operation.  For arithmetic operations, the carry bit comes from the
      ALU, while  for shift operations,  the carry bit  may come from  either the  most or
      least significant bit of the Working Register.

      Overflow Bit and Control MUX      Overflow Bit and Control MUX      Overflow Bit and Control MUX      Overflow Bit and Control MUX--This  determines what happens to the Overflow  Bit and
      where  it comes  from  , similarly  to  the Carry  Bit  Control MUX.   It  must also
      determine where the overflow bit goes.  For shift operations, it may wrap  around to
      the other end of the shift  register, while, for other operations, it may  just fall
      in the bit bucket.

      The Control MUX  uses the MUXS0  and MUXS1 signals  from the Shift  Register Control
      Store to generate the Shift Left and Shift Right signals for the Working Register.

      Sum Bus to B Bus Fast Driver Buffer      Sum Bus to B Bus Fast Driver Buffer      Sum Bus to B Bus Fast Driver Buffer      Sum Bus to B Bus Fast Driver Buffer--This device takes the lower 16 bits of  the Sum
      Bus  and puts  it onto  the B  Bus between  the CPU  and the  ROM &  I/O  card, when
      commanded by the microcode.  During  multiply or divide operations, it puts  the ALU
      output back into the B input of the ALU through the 8:1 MUX.

      Program Counter      Program Counter      Program Counter      Program Counter--This is  a 19-bit register  which may be loaded  by the Sum  Bus or
      incremented  by  the  microcode.   It  contains  the  memory  address  of  the  next
      instruction to be fetched.

      Memory Counter      Memory Counter      Memory Counter      Memory Counter--Similar  to the Program  Counter, except that  it contains  the next
      memory location to  be accessed.  This  may be the same  as the Program  Counter for
      immediate operations, but could  be quite different with indexed  instructions.  Its
      output goes to the MAC as the PMA (Processor Memory Address) Bus.

      4:1  MUX      4:1  MUX      4:1  MUX      4:1  MUX--This provides  the A  input to  the ALU.   It allows  the contents  of the
      Register Stack Latch, the Working  Register, the Program Counter, or the  Mask Field
      Decode to go to the A input of the ALU.

      8:1 MUX      8:1 MUX      8:1 MUX      8:1 MUX--This is the B input to  the ALU.  It is actually three separate  8:1 MUX's,
      one 16 bits  wide, the other two  8 bits wide, forming  a 32-bit wide input  for the
      ALU.

      The highest-order 16 bits of the input  to the ALU are provided by the left  half of
      the 8:1 MUX.  Its inputs are:



      70                                   Chapter 6 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                    Zero--This sets  all 16 bits  of the input  to zero.  It  is used as  a null
                    setting.

                    Bits 0-15  of Latch--This puts  bits 0-15 of  the Register stack  Latch onto
                    bits 0-15 of the B input to the ALU.

                    Extended Working Register--Puts bits  0-15 of the Extended  Working Register
                    onto bits 0-15 of the B input to the ALU.

                    Working Register--Puts bits 0-15 of  the Working Register onto bits  0-15 of
                    the B input to the ALU.

                    Right Half of  Latch--This puts the right  half of the Register  Stack Latch
                    onto the left half of the B input to the ALU.  It is used in  EXHR (Exchange
                    Halfword Register) instructions.

                    B-Bus--this puts the 16-bit B Bus from the ROM & I/O Card onto the left half
                    of the B input to the ALU.

                    Sign Extension of B-Bus--This propagates the highest-order (sign) bit of the
                    B Bus through the entire left half  of the B input.  That is, if  the number
                    on the B  Bus is negative, the  left half of the  B input will be  all ones;
                    while, if it is positive, the left  half of the B input will be  filled with
                    zeroes.

                    Three  Zeroes Followed  By Bits  0-12 of  Latch--This basically  divides the
                    contents of the Register Stack Latch  by 8.  It is used only with  Test Bit,
                    Set Bit,  Reset Bit,and Complement  Bit instructions, to  locate the  bit in
                    question.

            Bits 16-23 of the B input to the ALU are provided by the second part of the 8:1 MUX.
            Its inputs are listed below:

                    Zero--This puts zeroes on bits 16-23 of  the B input to the ALU.  Used  as a
                    default setting.

                    Bits 16-23 of Latch--Used to  pass the contents of the Register  Stack Latch
                    straight through to the ALU.  Puts bits 16-23 of the Latch onto the  B input
                    of the ALU.

                    Extended Working Register--Puts bits 16-23 of the XWR into bits 16-23 of the
                    B input to the ALU.

                    Working Register--Passes the contents of bits 16-23 of the  Working Register
                    to bits 16-23 of the B input of the ALU.

                    Bits 0-7 of Latch--Puts the highest-order byte from the Register Stack Latch
                    into the higher order byte of the right half of the B input.  Used with EXHR
                    instructions.

                    Bits 24-31 of Latch--Exchanges  the lowest-order byte of the  Register Stack
                    Latch  with  the  next-lowest.   Used  with  EXBR  (Exchange  Byte Register)
                    instructions.



            CPU BLOCK DIAGRAM EXPLANATION                                                     71
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


              B-Bus--Puts bits 0-7 of the B Bus onto bits 16-23 of the B input.

              Bits 13-20 of  Latch--Used for Test Bit,  Set Bit, Reset Bit  and Complement
              Bit instructions.

      The third part of the 8:1 MUX provides the least significant byte of the B  input to
      the ALU.  Its inputs are:

              Zero--Puts zeroes in bits 24-31 of the B input.

              Bits 24-31 of  Latch--Puts bits 24-31 of  the Register Stack Latch  onto the
              same bits of the B input.

              Extended Working Register--Does the same for the Extended Working Register.

              Working Register--Does the same for the Working Register.

              Bits 16-23 of Latch--Puts bits  16-23 of the Register Stack Latch  onto bits
              24-31 of the B input.  Used with EXBR instructions.

              Bits 8-15 of Latch--Puts bits 8-15 of the Register Stack Latch onto bits 24-
              31 of the B input.  Used with EXHR instructions.

              B Bus--Puts the lowest-order byte  of the B Bus onto the  corresponding byte
              of the B input to the ALU.

              Bits 21-28 of Latch-- Used for Test Bit, Set Bit, Reset Bit,  and Complement
              Bit instructions.

      8:1 MUX Select      8:1 MUX Select      8:1 MUX Select      8:1 MUX Select--This decodes the microcode  into the inputs for the 8:1 MUX  and the
      Sum Bus to B Bus Fast Driver Buffer.  The S0, S1, and S2 signals are used to provide
      the input select  signals for the  MUX.  A "+"  following the signal  name indicates
      that it  specifies bits 0:15  of the MUX,  an "x" indicates  that it  specifies bits
      16:23,  and an  "*" indicates  that it  specifies bits  24:31.  When  bit 48  of the
      microcode is low, and the S2+, S@x and S2* signals are active, the least significant
      bits of each of the three sections of  the 8:1 MUX will all be low.  The S0,  S1 and
      S2 signals to select the latch inputs for each section would be 001 (S0=0, S1=0, and
      S2=1).  If bit 48 is low, the input select code for the 8:1 MUX would be 000 instead
      of 001 and the NULL inputs would be selected.  Microcode bit 48, REGSEL0, is usually
      high.

      Mask Field Decode      Mask Field Decode      Mask Field Decode      Mask Field Decode--Decodes the  four bits of the mask  field for SBT, TBT,  RBT, and
      CBT instructions into 16 bits for the ALU to check.  The 4-bit mask field is decoded
      into a halfword containing  a single 1 and 15  zeroes.  This halfword is  anded with
      the halfword of data to be tested for the specified bit.

      Register Stack Latch      Register Stack Latch      Register Stack Latch      Register Stack Latch--Latches  the data from the  selected register of  the Register
      Stack.

      Register Stack      Register Stack      Register Stack      Register Stack--Consists of 16 sets of 16 general purpose 32-bit registers.  Bits 8-
      11 of  the PSW  determine which  set of registers  will be  used and  the microcode,
      through the Register  Address Block on  the ROM &  I/O Card, selects  which register
      within the stack will be used.  The four possibilities are:



      72                                   Chapter 6 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                    SX0-3                    SX0-3                    SX0-3                    SX0-3--This is the second index register for RX3 format instructions.  (Bits
                    20:23 in the instruction.)

                    YS0-3                    YS0-3                    YS0-3                    YS0-3--This  is  the  source  register, the  R2  field  in  the instruction,
                    specified by bits 12:15 in the instruction.

                    YD0-3                    YD0-3                    YD0-3                    YD0-3--This is  the destination register  for Register instructions,  the R1
                    field specified by bits 8:11 of the instruction.

                    The fourth  possibility is  a register selected  directly by  the microcode,
                    rather than one specified in the user instruction.

            System  Clock            System  Clock            System  Clock            System  Clock--The  system  clock  is normally  driven  by  the  32  MHz Oscillator,
            producing the 8  MHz system clock,  and 16 and 32  MHz clocks for  special purposes.
            The clock is  controlled by the  microcode, so that if  there is a  serious failure,
            such  as a  microcode parity  error,  the clock  will stop.   There is  also  a test
            oscillator, which  runs at  a much slower,  switch-selectable speed  to be  used for
            troubleshooting.

            Power-Up and  Initialize            Power-Up and  Initialize            Power-Up and  Initialize            Power-Up and  Initialize--This circuit  is driven by  the Power  Fail Detect  on the
            Multi-Function Card, the  INI button on  the front panel,  and the Early  Power Down
            Reset from the ROM & I/O.  It produces the various signals needed to  initialize the
            system on power-up, and to produce an orderly shut-down in case of power failure.

            Switches On The CPU Board            Switches On The CPU Board            Switches On The CPU Board            Switches On The CPU Board-- The Repeat Switch, SW1, is located at the far  right and
            is accessible without  removing the board.   It is coupled  with an LED  that lights
            when the switch is on.  This switch is the same as the repeat switch on  the console
            except that it is not a momentary contact switch.

            The System Clear Switch,  SW3, is the same as  the INI switch on the  front console.
            It is  a small  flat switch a  little smaller  than a dime  at the  far left  and is
            accessible without removing the board.

            SW2,  the  TEST/RUN Switch,  allows  either the  normal  32Mhz crystal  or  the Test
            Oscillator to drive the clocks.  In  Test mode the associated LED will be  on.  This
            switch is easily reached from the front without board removal.

            SW4, the Test Oscillator Speed Select, is located behind the Test/Run switch  and is
            accessible only by removing  the CPU board.  It consists  of a four switch  DIP pack
            that selects one of four clock speeds:

                  a.  100  nsec--faster  than  normal  clock  for   troubleshooting  timing
                      problems.

                  b.  125 nsec--normal clock speed.

                  c.  250  nsec--slower  than  normal  clock  for   troubleshooting  timing
                      problems.

                  d.  1 second--used for monitoring the microcode a step at a time.

            SW5, On/Momentary, used to single step through the microcode when clock speed is set
            to 1 second, or to allow the test oscillator to free run.



            CPU BLOCK DIAGRAM EXPLANATION                                                     73
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983























































                              Figure 6-2                              Figure 6-2                              Figure 6-2                              Figure 6-2.  ROM & I/O Block Diagram


      74                                   Chapter 6 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            6-2    ROM & I/O CARD BLOCK DIAGRAM            6-2    ROM & I/O CARD BLOCK DIAGRAM            6-2    ROM & I/O CARD BLOCK DIAGRAM            6-2    ROM & I/O CARD BLOCK DIAGRAM

            The B Bus between the  ROM & I/O card and the  CPU goes to many different  places on
            the ROM & I/O card.  The microcode on the card determines the source and destination
            of the B Bus at any given time.

            Instruction Register            Instruction Register            Instruction Register            Instruction Register--This register latches the first 16 bits of an instruction from
            the  Memory Data  Bus.   The 8  most  significant bits  make  up the  opcode  of the
            instruction and  are sent  on to  the Mapping  PROM.  The  Destination Field  of the
            instruction also goes to the Mapping PROM for use in Jump instructions.

            Memory Data Register            Memory Data Register            Memory Data Register            Memory Data Register--Receives  the next 16  bits of the  instruction or 16  bits of
            data from the Memory Data Bus.  This data can then be put onto the B Bus and sent to
            the CPU or some other register on the ROM & I/O board.

            Processor Memory Write Register            Processor Memory Write Register            Processor Memory Write Register            Processor Memory Write Register--This register is used to send data from the  CPU to
            the MAC by way of the B Bus and the Processor Memory Write Bus.

            Program Status Word            Program Status Word            Program Status Word            Program Status Word--The Program Status Word (PSW) is a word that shows  the overall
            status of the machine.  It is contained in  a register and can be put on the  B Bus,
            or loaded from the B Bus.

            Console Register            Console Register            Console Register            Console Register--The  Console Register is  used to take  the 8-bit Console  Bus and
            transfer it onto the least significant 8 bits of the B Bus and vice versa.

            Console Control Register            Console Control Register            Console Control Register            Console Control Register--This register is used to control the shifting of data into
            and out of the Console.

            Constant Register            Constant Register            Constant Register            Constant Register--The Constant  Register stores a  constant given by  the microcode
            and puts it onto the B Bus.

            I/O Data Transceivers            I/O Data Transceivers            I/O Data Transceivers            I/O Data Transceivers--These are  used to put data from  the B Bus onto the  I/O Bus
            and vice versa.

            I/O Control Transceiver            I/O Control Transceiver            I/O Control Transceiver            I/O Control Transceiver--These are used to  transfer data from the B Bus to  the I/O
            control lines.

            Mapping  PROM            Mapping  PROM            Mapping  PROM            Mapping  PROM--Takes the  opcode for  the current  instruction from  the Instruction
            Register  along  with the  Destination  Field  for that  instruction  and  the least
            significant four bits of the PSW and uses them to generate a 12-bit address  for the
            microcode ROM.

            Interrupt  Address MUX  and  Latch            Interrupt  Address MUX  and  Latch            Interrupt  Address MUX  and  Latch            Interrupt  Address MUX  and  Latch--This takes  the various  interrupt  signals, and
            combines it with certain bits of the current PSW to obtain a 12-bit address  for the
            microcode, which goes to the ROM Address MUX.  The PSW can cause some  interrupts to
            be disabled, depending upon its setting.

            ROM Address  MUX            ROM Address  MUX            ROM Address  MUX            ROM Address  MUX--A 4:1 MUX  used to determine  the address of  the microcode  to be
            accessed.  Its inputs are the output of the Mapping PROM, the Interrupt Address MUX,
            the  BR0:11 bits  from the  microcode, and  the most  significant nine  bits  of the
            current PROM  address.  The BR0:11  bits from the  microcode are used  for branching
            within  the  microcode.   The  Interrupt  Address  MUX  gives  the  address  of  the
            appropriate  interrupt service  routine in  the microcode.   The output  of  the ROM
            Address MUX is selected by the microcode itself.


            ROM & I/O CARD BLOCK DIAGRAM                                                      75
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      ROM Address Counter      ROM Address Counter      ROM Address Counter      ROM Address Counter--This contains the actual address being accessed in the ROM.

      ROM      ROM      ROM      ROM--This is the read-only memory which contains the microcode.   Potentially, there
      can be up to 4096 words of 64  bits each, although not all of it is  currently used.
      The microcode is  used to decode each  instruction into the necessary  operations of
      the system.  In some cases,  entire frequently-used routines have been put  into the
      microcode, so that only one instruction is need to perform the routine.   The output
      of  the ROM  goes  to the  ROM Data  Latch  and is  also used  immediately  for some
      purposes.

      ROM Data Latch      ROM Data Latch      ROM Data Latch      ROM Data Latch--This  Latches up the  64 bits of microcode  output from the  ROM and
      sends  it to  the  Microcode Parity  Checker,  the backplane,  the  Register Address
      Select, and the Constant Register.

      Microcode Parity  Checker      Microcode Parity  Checker      Microcode Parity  Checker      Microcode Parity  Checker--Checks the parity  of the microcode.   If a  parity error
      occurs, the system clock stops and the machine halts completely, displaying an alarm
      message on the console.

      The MUX and  Latch blocks all  have much the  same function, decoding  the microcode
      output from the ROM into control signals  for the system.  The B Bus Source  MUX and
      Latch, as  its name implies,  determines which register  or bus driver  provides the
      data for the B  Bus during a given operation.   The B Bus Destination MUX  and Latch
      performs the same function for the register or bus driver that is to be the receiver
      for the data on the bus.   The Miscellaneous MUX and Latch produces  control signals
      used for many different functions on the MAC and CPU boards.































      76                                   Chapter 6 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



























                                                     *
                                                    * *
                                                     *




























            ROM & I/O CARD BLOCK DIAGRAM                                                      77
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983























































                                 Figure 6-3                                 Figure 6-3                                 Figure 6-3                                 Figure 6-3.  MAC Block Diagram


      78                                   Chapter 6 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            6-3    MAC BLOCK DIAGRAM EXPLANATION            6-3    MAC BLOCK DIAGRAM EXPLANATION            6-3    MAC BLOCK DIAGRAM EXPLANATION            6-3    MAC BLOCK DIAGRAM EXPLANATION

            Segmentation Registers            Segmentation Registers            Segmentation Registers            Segmentation Registers--These are dedicated core locations used as registers for the
            software-controlled relocation and protection  circuitry.  There are 16,  located in
            memory addresses 00300 to 0033E.  The values contained in each Segmentation Register
            determine the amount of relocation and level of protection for that block of memory.

            Segmentation Register Trap            Segmentation Register Trap            Segmentation Register Trap            Segmentation Register Trap--When the MAC is off, it checks the 12 highest-order bits
            on the PMA Bus.  If the high-order ten bits are low, and the two low-order  bits are
            high (that is, the Processor Memory  Address is 0000 0000 0011 XXXX), an  attempt is
            being made to read from or write  to the Segmentation Registers or one of  the other
            reserved memory locations.

            Segmentation  Register  Select            Segmentation  Register  Select            Segmentation  Register  Select            Segmentation  Register  Select--When  the  MAC  is  on,  it  decodes  the  four most
            significant bits of  the Processor Memory  Address Bus and  uses them to  select the
            appropriate  Segmentation Register.   When the  MAC  is off,  it is  enabled  by the
            Segmentation Register  Trap to  decode the  bits 14  to 17  of the  Processor Memory
            Address to  select the Segmentation  Register to  be read from  or written  to.  The
            signals which select the correct Segmentation Register are the AREL0:3 bits.

            Limit Comparator            Limit Comparator            Limit Comparator            Limit Comparator--This compares the  contents of the PMA  Bus with the value  of the
            SLF field  in the  selected Segmentation Register.   It is  used for  the protection
            circuitry.  If  the result  indicates that the  address is  outside the  bounds, the
            PAOL1 signal is generated, indicating that the processor address is over limit.

            Relocation ALU            Relocation ALU            Relocation ALU            Relocation ALU--This ALU adds the relocation value from the Segmentation Register to
            the PMA  Bus when the  MAC is  on.  The result  is the actual  memory address  to be
            accessed.

            Memory Address Register            Memory Address Register            Memory Address Register            Memory Address Register--In effect, a  2:1 MUX which contains the actual  address of
            the memory location to  be accessed.  Its two sources  are the DMA address  from the
            DMA Address Latch, and the relocated PMA Bus from the Relocation ALU.  The output of
            the Memory  Address Register  goes to  a Quad  Bus Transceiver,  and to  the Partial
            Address Decode.

            Processor Memory Address            Processor Memory Address            Processor Memory Address            Processor Memory Address--This is a latch which contains the contents of the PMA Bus
            before relocation.  It can be read as  memory locations 34C and 34E when the  MAC is
            off.

            Parity Error  Address            Parity Error  Address            Parity Error  Address            Parity Error  Address--This latch contains  the actual location  of the  last memory
            parity error to occur.  It can also be read like a normal memory location if the MAC
            is off.  Its addresses are 00348 and 0034A.

            Fetch  Address            Fetch  Address            Fetch  Address            Fetch  Address--This is  a latch  which contains  the actual  address of  the memory
            location just accessed.  It can be read as memory locations 344 and 346 when the MAC
            is off.

            Partial Address Decode            Partial Address Decode            Partial Address Decode            Partial Address Decode--This decodes the Memory Address Bus from the  Memory Address
            Register  into the  addresses for  the on-board  memory locations,  such as  the the
            Parity  Error Address.   It also  provides  inputs for  the Memory  Data  Bus Source
            Select.

            DMA Data Latch            DMA Data Latch            DMA Data Latch            DMA Data Latch--Latches up  the data on the DMA  Bus after it comes through  the DMA
            Quad Bus Transceiver.


            MAC BLOCK DIAGRAM EXPLANATION                                                     79
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      DMA Address Latch      DMA Address Latch      DMA Address Latch      DMA Address Latch--Latches up the address information on the DMA Bus after  it comes
      through the DMA Quad Bus Transceiver.

      Memory Data Bus  Source Decoder      Memory Data Bus  Source Decoder      Memory Data Bus  Source Decoder      Memory Data Bus  Source Decoder--Essentially, this is  a MUX which  determines where
      the data which is to be written into memory during a write operation, whether DMA or
      by the CPU, is to come from.   It allows the data to come from the  Processor Memory
      Write Bus or the  DMA Data Bus.  The Decoder  also controls the gating  which allows
      the  processor to  read the  special purpose  registers on  the MAC,  that  is:  the
      Segmentation  Registers, the  MAC  Status Latch,  the Fetch  Address,  the Processor
      Memory Address, or the Parity Error  Address.  It is controlled by signals  from the
      Memory Data Bus Source Select.

      Parity Generator      Parity Generator      Parity Generator      Parity Generator--Takes the output of the Memory Data Bus Source Decoder and uses it
      to create a parity bit, which it  sends to the Memory Data Latch as Memory  Data Bit
      16.

      Memory Data Latch      Memory Data Latch      Memory Data Latch      Memory Data Latch--This latches up the output of the Memory Data Bus  Source Decoder
      and the Parity Generator  and puts them onto the  Memory Data Bus.  It is  also used
      for returning information from the the special-purpose registers on the board to the
      ROM & I/O Board.

      Memory Sense Latch      Memory Sense Latch      Memory Sense Latch      Memory Sense Latch--Latches the data on the Memory Sense Bus, which is  the contents
      of the memory location read.

      Parity Bit Latch      Parity Bit Latch      Parity Bit Latch      Parity Bit Latch--Latches the  parity bit from the Memory  Sense Bus for use  by the
      Parity Checker.

      Parity Checker      Parity Checker      Parity Checker      Parity Checker--Generates its own parity bit from the data in the Memory Sense Latch
      and compares it with  the one stored in the  Parity Bit Latch.  If they  disagree, a
      memory parity error interrupt is generated.

      Quad  Bus Transceivers      Quad  Bus Transceivers      Quad  Bus Transceivers      Quad  Bus Transceivers--These  are  used to  transfer  information from  one  bus to
      another in  either direction.   During a memory  read operation,  the output  of the
      Memory Sense Latch  goes to a  Quad Bus Transceiver, which  puts it onto  the Memory
      Data Bus, sending it to the ROM &  I/O card if it is a standard read  operation, and
      writing it back  into the same memory  location.  This is necessary  because reading
      core memory is a  destructive operation.  If it  were a DMA read  operation, another
      Quad Bus Transceiver would have  put the data onto the  RMD Bus to the DMA  Quad Bus
      Transceiver, which  would put  it onto  the DMA  Bus.  During  a write  operation of
      either type, the output of the Memory  Data Latch would be put onto the  Memory Data
      Bus by a Quad Bus Transceiver and written into memory.

      DMA Timing  and Control      DMA Timing  and Control      DMA Timing  and Control      DMA Timing  and Control--This block  translates the control  signals on the  DMA Bus
      into timing and control signals for the MAC.

      MAC  Timing and  Control      MAC  Timing and  Control      MAC  Timing and  Control      MAC  Timing and  Control--This takes  the control  signals from  the DMA  Timing and
      Control, the ROM  & I/O card,  the CPU, and the  MAC Control Registers,  and decodes
      them into control signals for the MAC.

      MAC Control Register      MAC Control Register      MAC Control Register      MAC Control Register--Contains MAC control  information from the ROM & I/O  card and
      various signals on the MAC itself.





      80                                   Chapter 6 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



























                                                     *
                                                    * *
                                                     *




























            MAC BLOCK DIAGRAM EXPLANATION                                                     81
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983























































                         Figure 6-4                         Figure 6-4                         Figure 6-4                         Figure 6-4.  Multifunction Card Block Diagram


      82                                   Chapter 6 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            6-4    MULTI-FUNCTION CARD BLOCK DIAGRAM EXPLANATION            6-4    MULTI-FUNCTION CARD BLOCK DIAGRAM EXPLANATION            6-4    MULTI-FUNCTION CARD BLOCK DIAGRAM EXPLANATION            6-4    MULTI-FUNCTION CARD BLOCK DIAGRAM EXPLANATION

            Each function of the Multi-Function Card  is a separate I/O device, with  a separate
            address.  They are accessed in the same way that any other I/O device is accessed.

            Address and Control  Latch/Decode            Address and Control  Latch/Decode            Address and Control  Latch/Decode            Address and Control  Latch/Decode--Decodes and latches  the I/O control  signals and
            the device addresses from  the I/O Bus into the  control signals for the  devices on
            the board.

            Quad Bus Transceiver            Quad Bus Transceiver            Quad Bus Transceiver            Quad Bus Transceiver--Used to put the lower 8 bits of the I/O Bus onto  the internal
            address bus and vice versa.

            3600 Baud Interrupt            3600 Baud Interrupt            3600 Baud Interrupt            3600 Baud Interrupt--This interrupt goes up via the standard interrupt route  to the
            CPU 3600 times per second.  It is  used for system timing, for example, in  the Baud
            rate sampling done during the log-in sequence.  Its I/O addresses are 70 through 75.

            TTY Interface            TTY Interface            TTY Interface            TTY Interface--This  is a standard  asynchronous interface.  It  consists of  a Baud
            Rate   generator   and    selector   switch,   a   UART    (Universal   Asynchronous
            Receiver/Transmitter),  which takes  the  serial data  coming  in from  the  TTY and
            converts it into  parallel bytes for the  I/O Bus and vice  versa; a buffer  for the
            incoming signals from the TTY, and an Interrupt and Status Control.  This  takes the
            control  signals  and  turns  them  into  the  proper  operations  and  creates  the
            appropriate interrupts and acknowledgements.  The address of this device is 02.

            AC Voltage  Sensor            AC Voltage  Sensor            AC Voltage  Sensor            AC Voltage  Sensor--This is an  8 bit  A/D converter which  monitors the  AC voltage
            level through a level converter.  It shares address 04 with the  Temperature Sensor,
            but they are accessed through different signals.  The Voltage Sensor is  accessed by
            SR0 04, while the Temperature Sensor is accessed through DR0 04.

            Temperature  Sensor            Temperature  Sensor            Temperature  Sensor            Temperature  Sensor--Again,  an  8-bit  A/D converter,  this  time  hooked  up  to a
            temperature  sensor.  As  mentioned above,  it shares  port 04  with the  AC Voltage
            Sensor.

            Watch-Dog Timer and Power Fail Detect            Watch-Dog Timer and Power Fail Detect            Watch-Dog Timer and Power Fail Detect            Watch-Dog Timer and Power Fail Detect--The Power Fail Detect monitors the DC voltage
            levels and triggers a  power fail interrupt if they  drop.  It is also  connected to
            the Watch-Dog Timer, setting it off  when power comes back up.  The  Watch-Dog timer
            is a simple one-shot that goes off unless the software tickles it  periodically.  If
            it doesn't get tickled before it times  out, it causes the system to be  booted back
            up.  It shares address 05 with the Loader Storage Unit, but since it is a write-only
            device and the LSU is  a read-only device, they are  accessed by the DA0 05  and the
            DR0 05 signals, respectively.

            Loader Storage Unit            Loader Storage Unit            Loader Storage Unit            Loader Storage Unit--These are the boot PROMs for the system.  They are  accessed by
            the CMD0 05 and DR0 05 signals and addressed individually, via the Address Register.
            The output  of the  Address Register  goes to the  PROMs and  to the  Chip Selector,
            selecting which chip the  information is to be read  from.  The output of  the PROMs
            goes to the Quad Bus Transceiver and thence to the I/O Bus.

            Real-Time Clock Interface            Real-Time Clock Interface            Real-Time Clock Interface            Real-Time Clock Interface--This feature is only used on the network  supervisors for
            billing and  accounting purposes.   The standard  nodes do  not use  it a 19.546      27.486      27.486      62.302      50.037     168.874      56.292      31.273      31.273      87.955      87.955     398.731
5132686511  DAYTON      OH  7781XXX  328  3                                      319.600     4.300       5.512      12.402       3.101       1.378       1.378       1.938       1.938       4.392       3.528      11.906       3.969       2.205       2.205       6.201       6.201      28.111
5132923100  COVINGTON   KY  7783XXX  922  3                                       13.300      .300        .344        .774        .194        .086        .086        .121        .121        .274        .220  P ?     iH  iH  lP  > HB%` >;5Ep   0  EPAFULL;                            }x(y
EQ  ' 'HAiH  iH  .n > rE`;8   p0  WLAWVV;                  4]  
]%  I,(yeQ  5S -2"iH  iH  12  }P1$AP V;*3s   P   PERGAMON;                 u- bw  T(y%Q  U  (PriH  iH  .v  > 6r	` ;*3^@  p0  TLR11248;                4\d (  A"(y5  % pniH  iH  B8$  > ^f0P ;.3|  0   W1;66350,,P              4\d 0yh  -(Y(y  >5 ,PiH  iH  )@  >G =P F;43l   @   EPAFULL;                             5.(y%  R &`RiH  iH  .n >rE` F;43g@  p0  EMSACORPS;           X ?                      )(y%  UT A.iH  iH  p  0n~  
Kv;64P  p0  DOW1;                    wX$ D(  `(y %   US  0piH  iH  N,  > U" ;<3t  0   C2;                      4\d 2  X(y,%  ES   JiH  iH  dh  >G> F;H3xP  p   NASFC;2 F  logoff l  file           -D(y0e  	5 
bpFiH  iH  l( >*H'P F;N4   0  CSWX25;                  wX$ C_0 N
(y;u  U $j fiH  iH  6.  > $
` ;\4p  P   EMSCL;                               g.(yA ZUT  ` jiH  iH  +D
  > 'D @0 
;d4   P   IAFV1;COLBAUGH SCARAGE VV            D(yAe  eU 	`diH  iH  qF @> 2, 	`  ` ?     ;d4`  `   EMSDDCC;                              (yE5  E  %@^iH  iH  2/|  > `"~   ;h4U       WLAWXX;                  4]  
]%   v0(yK  S r&iH  iH  Bp  }P1$AP V;p3rp   0  TSDUANB;                             B(y\%  E  PPiH  iH  cr  > ':    <3b   0  DAC2;                    wX$ ~< b(ycu  ^ 2`DiH  iH  %  >Vn0 F<4Jp  @   DIALOG2;FCY90215 S RN=PB 4\d  Nh  H`(yuR  UU +0JiH  iH    > 6 P <.4p  p0  C2;DLR,37514,,P          4\d *Jx  
Y(y{ER  u  N&iH  iH  dh  0XX#p Kv<83y      WSI;                                 K(y}Rivers            Status Latches/Drivers            Status Latches/Drivers--These latch up  and drive the status and/or  control signals
            from the CPU for the bi-sync lines.   They are enabled by either the DA  signal from
            the CPU or  the ADRSL signal  from the CPU  Address Decode/Latch.  They  receive the
            information from the I/O Bus via the Bus Receiver.

            Transmit and Receive  Clock Selectors            Transmit and Receive  Clock Selectors            Transmit and Receive  Clock Selectors            Transmit and Receive  Clock Selectors--These are  connected to the  On-Board Address
            Bus and select  the addressed Transmit  and Receive Clocks.   They are used  so that
            different clock speeds can be accommodated on the same board.

            Transmit  Data  Latches/Drivers            Transmit  Data  Latches/Drivers            Transmit  Data  Latches/Drivers            Transmit  Data  Latches/Drivers--These  select the  addressed  latch  and  driver to
            transmit the data bit received on that clock cycle.

            Receive Data Receivers/Selectors            Receive Data Receivers/Selectors            Receive Data Receivers/Selectors            Receive Data Receivers/Selectors--These select the addressed data receiver  and send
            its data to the Working Memory.

            Board Address  MUX            Board Address  MUX            Board Address  MUX            Board Address  MUX--This Multiplexor selects  either the CPU  Address Decode  or the
            Address Counter to drive the On-Board  Address Bus.  The CPU Address Decode  is only
            selected  when the  CPU is  writing  to or  reading from  an address  on  the board,
            otherwise, the Address Counter is selected.

            Address Counter (Line Scan)            Address Counter (Line Scan)            Address Counter (Line Scan)            Address Counter (Line Scan)--This is simply a 5-bit circular counter, driven  by the
            2MHz F/4 clock, that scans across the 32 board addresses.

            CPU Address Decode/Latch            CPU Address Decode/Latch            CPU Address Decode/Latch            CPU Address Decode/Latch--This  decodes and latches  the address information  on the
            I/O Bus.  It is clocked by the ADRS0 I/O control signal, and its output is  used all
            over the board,  for the buffer memories,  the data receivers and  transmitters, the
            interrupt generating circuitry, and the clock selectors.

            Clock Last State and Interrupt Pending  Flag 32 By 2 Memory            Clock Last State and Interrupt Pending  Flag 32 By 2 Memory            Clock Last State and Interrupt Pending  Flag 32 By 2 Memory            Clock Last State and Interrupt Pending  Flag 32 By 2 Memory-- This is  effectively 2
            separate 32 by  1 memories.  One stores  the previous state of  the Transmit/Receive
            Clock for that address.  The other  stores the status of the Interrupt  Pending Flag
            for the address.



            SYNC CARD BLOCK DIAGRAM EXPLANATION                                               85
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      Clock Transition Detector      Clock Transition Detector      Clock Transition Detector      Clock Transition Detector--Detects  whether the clock  for a particular  address has
      changed state.  This is necessary because the address counter scans the addresses at
      a  2MHz rate,  and the  maximum speed  of the  transmit and  receive clocks  is only
      9.6KHz.  Thus an address will be scanned several times before its clock  will change
      state.  The transition is detected by comparing the present state of the  clock with
      its previous state, contained in the Clock Last State Memory.

      If a change  is detected the RWWM  signal goes low.  This  causes the data  from the
      Working Memory Shift Left to be  loaded into the Working Memory along with  the 16th
      bit from the Receive Data Selector or the Wrap or Transmit Fill.

      Last Bit Detect      Last Bit Detect      Last Bit Detect      Last Bit Detect--Detects when the last bit of data has been transmitted or received.
      It creates the MUXSEL  and MUXSTR signals.  If the  last bit has not  been received,
      the MUXSEL  signal is active.   When the last  bit is received  or sent,  the MUXSTR
      signal is active.  This  stops the shift operation and  puts the Wrap Mark  into the
      least significant bit  of the Working  Memory for that  address.  The output  of the
      Last Bit Detector also goes to the Interrupt Request Circuitry.

      Interrupt  Request      Interrupt  Request      Interrupt  Request      Interrupt  Request--When  that  last bit  of  data  has been  sent  or  received, an
      interrupt is generated.   This block creates the  IOCOMS signal, which  triggers the
      interrupt queueing.  When the Last Bit  Detector signals that the last bit  has been
      detected, RWIBM and RWOBM go low, allowing the received data from that address to be
      written into the  Input Buffer Memory,  or the CPU to  write into the  Output Buffer
      Memory.   These signals,  once triggered,  will recur  each time  that that  line is
      scanned until the CPU responds to that interrupt.

      Interrupt  Device  Queue  and   Priority  Encode      Interrupt  Device  Queue  and   Priority  Encode      Interrupt  Device  Queue  and   Priority  Encode      Interrupt  Device  Queue  and   Priority  Encode--Stores  the  address(es)   of  the
      interrupting device(s) and places them in order of priority.

      Interrupt  Device Address  Latch      Interrupt  Device Address  Latch      Interrupt  Device Address  Latch      Interrupt  Device Address  Latch--Latches  up the  address of  the  device currently
      interrupting for communication with the CPU.

      Interrupt Control      Interrupt Control      Interrupt Control      Interrupt Control--This creates  the I/O and RACK0  signals to the CPU,  and handles
      the CPU's response to the interrupt.

      16 By 16 Output Buffer Memory      16 By 16 Output Buffer Memory      16 By 16 Output Buffer Memory      16 By 16 Output Buffer Memory--This is used to hold the 16 bits of  transmitted data
      sent out by the CPU to each line.

      32  By  16  Working  Memory      32  By  16  Working  Memory      32  By  16  Working  Memory      32  By  16  Working  Memory--Holds  the  interim  results  of  transmit  and receive
      operations  for each  line.  For  transmit operations,  it takes  the output  of the
      Working Memory Shift Left and MUX and stores it until the next clock cycle  for that
      line, when it feeds it  back to the MUX.  The MUXSEL*  signal is used to put a  1 in
      the least significant bit of the memory for transmit operations.  When  the location
      is all 1's, the transmit operation is complete, and another 16 bits must be  sent by
      the CPU to that address for transmission.

      For receive operations, the Working Memory stores the upper 15 bits of the output of
      the Working Memory Shift Left and MUX in the upper 15 bits of the location  for that
      line.  The 16th bit for that line comes from the Data Receivers.  The  MUXSTR signal
      provides  the  Wrap  Mark for  receiving,  indicating  that the  16th  bit  is being
      received.  Note that the Working Memory will only contain 15 bits of  received data,
      since one bit is the Wrap Mark, which is always one.




      86                                   Chapter 6 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            The 32 locations in the Working Memory correspond to the send and  receive addresses
            for each line.

            Working Memory Shift  Left and MUX            Working Memory Shift  Left and MUX            Working Memory Shift  Left and MUX            Working Memory Shift  Left and MUX--The  MUX part of  this block selects  either the
            Output Buffer Memory Contents or the Working Memory contents.  The Output  Buffer is
            selected only at the  beginning of a transmit  operation for a line,  otherwise, the
            Working Memory is selected.

            The Shift Left shifts the selected 16 bits left by one bit.  If the address  is that
            of a transmit port, the most significant bit of the half-word, before the  shift, is
            sent to the Transmit  Data Latch/Driver.  The output of  the Shift Left goes  to the
            Working Memory.   When the last  bit of  a transmit or  receive is  detected, MUXSTR
            causes the output of the Shift Left to become all zeroes.

            16 By 16 Input Buffer Memory            16 By 16 Input Buffer Memory            16 By 16 Input Buffer Memory            16 By 16 Input Buffer Memory--This holds the 16 bits of received data for  each line
            until the CPU is ready to read them.  It is enabled for each address when  the RWIBM
            signal goes low, when  the address is scanned.  At  this time, the upper 15  bits of
            the  addressed location  are loaded  with bits  1-15 from  the Working  Memory.  The
            lowest order-bit, bit 16, is caught on the fly from the Receive Data Selector.

            MUX's            MUX's            MUX's            MUX's--These multiplexers select either the output of the Input Buffer Memory or the
            status signals from the bi-sync lines.  The Input Buffer Memory is selected when the
            port is to be read.  The status signals are only selected when the bi-sync lines are
            used and  the CPU  needs to  find their status.   Bits 0-7  of the  Bus are  the DSR
            signals for  the 8 bi-sync  lines, and bits  8-15 are the  CTS signals.  The  MUX is
            enabled by the DRAD* signal and the status bits are selected by the ADRSL  and ALACK
            signals.

            Bus Drivers            Bus Drivers            Bus Drivers            Bus Drivers--These  simply buffer the  information from the  input MUX's and  put it
            onto the MUX I/O Bus.


























            SYNC CARD BLOCK DIAGRAM EXPLANATION                                               87
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983























































                             Figure 6-6                             Figure 6-6                             Figure 6-6                             Figure 6-6.  Async Card Block Diagram


      88                                   Chapter 6 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            6-6    ASYNC CARD BLOCK DIAGRAM EXPLANATION            6-6    ASYNC CARD BLOCK DIAGRAM EXPLANATION            6-6    ASYNC CARD BLOCK DIAGRAM EXPLANATION            6-6    ASYNC CARD BLOCK DIAGRAM EXPLANATION

            Addressing and Operation            Addressing and Operation            Addressing and Operation            Addressing and Operation--There are 32  asynchronous ports on the board  accessed by
            only 6 device addresses.  This is done by splitting the ports into two groups  of 16
            and sending or reading one bit for  each port in the group with a  single operation.
            The  Engine I/O  device addresses  then  each correspond  to one  RS232C  signal for
            sending  and one  for receiving  for all  the ports  in the  port group.   Table 6-1
            shows the addresses  and the signals  to which they  correspond for the  first Async
            board in a standard Engine:


                                                 Table 6-1                                                 Table 6-1                                                 Table 6-1                                                 Table 6-1

                                     Async Board Addresses and Signals

                 ADDRESS   TRANSMIT SIGNAL   RECEIVE SIGNAL    PORT GROUP
                   91        TD 0-15           RD 0-15           0-15
                   92        DTR 0-15          DSR 0-15
                   93        BSY 0-15          CD 0-15
                   95        TD 16-31          RD 16-31          16-31
                   96        DTR 16-31         DSR 16-31
                   97        BSY 16-31         CD 16-31


            Note that none of the addresses used has both of the least significant bits equal to
            zero.

            The tables on the block diagram show the address ranges and switch settings  for the
            enhanced and non-enhanced Engines.  The enhanced Engine can have up to 8 Async cards
            and a total  of 256 ports, while  the non-enhanced Engine can  only have 4  with 128
            ports.  The  board addresses for  standard and enhanced  Engines are shown  in Table
            6-2 below:


                                                 Table 6-2                                                 Table 6-2                                                 Table 6-2                                                 Table 6-2

                                           Async Board Addresses

                 BOARD   PORT    STANDARD        ENHANCED
                 NUMBER  GROUP   ADDRESS         ADDRESS
                 1       0-31    91-97           C1-C7
                 2       32-63   99-9F           C9-CF
                 3       64-95   A1-A7           D1-D7
                 4       96-127  A9-AF           D9-DF
                 5       128-159 NOT USED        E1-E7
                 6       160-191 NOT USED        E9-EF
                 7       161-223 NOT USED        F1-F7
                 8       224-255 NOT USED        F9-FF








            ASYNC CARD BLOCK DIAGRAM EXPLANATION                                              89
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      Input Buffer and 8:1 MUX      Input Buffer and 8:1 MUX      Input Buffer and 8:1 MUX      Input Buffer and 8:1 MUX--This buffers  the incoming signals from the I/O  ports and
      selects the port group and signal which it will put on the bus.

      Data Bus Buffer      Data Bus Buffer      Data Bus Buffer      Data Bus Buffer--Simply buffers the incoming data for the board from the I/O Bus.

      S1 and S2      S1 and S2      S1 and S2      S1 and S2--These are the switches which select the addresses that the board responds
      to.

      Board Address Decode      Board Address Decode      Board Address Decode      Board Address Decode--Decodes  the address on the  board, and thus which  port group
      and signal is to be sent or received.

      Device Address Latch      Device Address Latch      Device Address Latch      Device Address Latch--Latches up the  information from the Board Address  Decode and
      either generates a transmit clock, if the DA0 signal is active, to one of the 6 sets
      of output  latches, transferring  information from the  data bus  buffer to  the I/O
      devices; or it generates  BUSEN0 and selects the input  to the Input Buffer  and MUX
      from the 6 I/O device addresses.

      Clock Decoder      Clock Decoder      Clock Decoder      Clock Decoder--Decodes the  signals from the Device  Address Latch into  the control
      signals for the Output Latches.

      Output Latches      Output Latches      Output Latches      Output Latches--Latch the output from the I/O Bus into the required signal lines.

      SYN0  Generator      SYN0  Generator      SYN0  Generator      SYN0  Generator--Generates  the  SYN0  control  signal  on  the  I/O  Control Lines,
      acknowledging that the board is ready to send or receive information.

      BUSEN0 Generator      BUSEN0 Generator      BUSEN0 Generator      BUSEN0 Generator--Generates the BUSEN0 signal to enable the Input Buffer and 8:1 MUX
      to put the required information on the I/O Bus.





























      90                                   Chapter 6 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



























                                                     *
                                                    * *
                                                     *




























            ASYNC CARD BLOCK DIAGRAM EXPLANATION                                              91
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983























































                       Figure 6-7                       Figure 6-7                       Figure 6-7                       Figure 6-7.  Quad Printer Interface Block Diagram


      92                                   Chapter 6 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            6-7    QUAD PRINTER INTERFACE CARD BLOCK DIAGRAM EXPLANATION            6-7    QUAD PRINTER INTERFACE CARD BLOCK DIAGRAM EXPLANATION            6-7    QUAD PRINTER INTERFACE CARD BLOCK DIAGRAM EXPLANATION            6-7    QUAD PRINTER INTERFACE CARD BLOCK DIAGRAM EXPLANATION

            The  Quad Printer  Interface Board  uses additional  daughter boards,  one  for each
            printer,  up to  the maximum  of four.   The daughter  board is  shown in  the block
            diagram, and explained after the board proper.

            Data  Output            Data  Output            Data  Output            Data  Output--Bits  0-2  of the  data  output  to the  board  are  used  for control
            functions.   If bit  0 is  set,  the printer  addressed prints  all  its accumulated
            characters.  Setting  bit 1 or  2 makes the  interface buffer ready.   Bit 1  is the
            master clear for the entire printer, while bit 2 is simply a buffer clear.   Bits 9-
            15 of the data become data bits 1-7 for the printer that was addressed by the output
            instruction.

            Status Input            Status Input            Status Input            Status Input--The status of a printer may be monitored by either a status request or
            an input instruction.  The data the CPU receives has the following meanings:

                    Bit 9--If set, means that the printer is out of paper.

                    Bit 12--If set, means  that the printer is  busy, either printing a  line or
                    reading a character into its line buffer.

                    Bit 13--Has the same meaning as Bit 9, printer is out of paper.

                    Bit 15--If set, means that the printer is not ready.

            Address Switches            Address Switches            Address Switches            Address Switches--These select the addresses  the board will respond to.   Note that
            the maximum address of the board is only 8 bits.

            Address Comparator, Decoder, and Latch            Address Comparator, Decoder, and Latch            Address Comparator, Decoder, and Latch            Address Comparator, Decoder, and Latch--This  decodes the address on the I/O  Bus by
            comparing it with the switch settings  for a particular board.  One is  provided for
            each of the four printers, labeled A-D.  It is enabled by the ADRS0 signal  from the
            I/O Control Bus.

            Receiver A-D            Receiver A-D            Receiver A-D            Receiver A-D--This  is a line  receiver and deMUX,  which takes the  control signals
            from  the MUX  I/O Bus  and the  Address Enable  (ADDEN A-D)  bits from  the Address
            Comparator,  Decoder, and  Latch;  and generates  a  separate set  of  these control
            signals for each of the four board addresses.

            DR0/SR0 Encoder and SYN0 Generator            DR0/SR0 Encoder and SYN0 Generator            DR0/SR0 Encoder and SYN0 Generator            DR0/SR0 Encoder and SYN0 Generator--Encodes the DR0 and SR0 signals for a particular
            board address into an  enable signal for the  Bus Transmitter that sends  the status
            information for that address to the CPU via the MUX I/O Bus.

            Status Encoder            Status Encoder            Status Encoder            Status Encoder--Takes the status information from the daughter board  and translates
            it into a form that the CPU can understand.

            Control Signal Generator A-D            Control Signal Generator A-D            Control Signal Generator A-D            Control Signal Generator A-D--Takes the DA0 A-D bits from the Receiver A-D, the D011
            bit from  the MUX  I/O Bus,  the System Clear  signal (BSCLR0  and BSCLR1),  and the
            Character Requests (CRREQA-D) from  the printers; and generates the  control signals
            for the Daughter Boards.







            QUAD PRINTER INTERFACE CARD BLOCK DIAGRAM EXPLANATION                             93
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      6-7.1    DAUGHTER BOARD BLOCK DIAGRAM EXPLANATION:      6-7.1    DAUGHTER BOARD BLOCK DIAGRAM EXPLANATION:      6-7.1    DAUGHTER BOARD BLOCK DIAGRAM EXPLANATION:      6-7.1    DAUGHTER BOARD BLOCK DIAGRAM EXPLANATION:

      Each Quad Printer Interface Card can  have up to four of these Daughter  Boards, one
      for each printer.

      Master Clear/Buffer Clear Generator      Master Clear/Buffer Clear Generator      Master Clear/Buffer Clear Generator      Master Clear/Buffer Clear Generator--This uses the Clock Clear (CCLRA-D)  and Enable
      Master Clear (ENMC A-D) signals from the Control Signal Generator, along with  bit 2
      from the  Data Bus  to provide  the Buffer Clear  and Master  Clear signals  for the
      board.  These signals  empty the character buffer  in the printer  and re-initialize
      the board.

      Data Register      Data Register      Data Register      Data Register--This takes the two characters  sent from the CPU off the I/O  Bus and
      stores them.  It is enabled by the LDDR (Load Data Register) signal from the Control
      Signal Generator.

      Opto-Isolator and Transmitter      Opto-Isolator and Transmitter      Opto-Isolator and Transmitter      Opto-Isolator and Transmitter--This transmits  the data from the Data  Register, the
      Buffer and Master Clear signals, and  the Start Data Strobe (SDSTB) signal  from the
      Control Signal Generator to the printer.

      Opto-Isolator  and  Receiver      Opto-Isolator  and  Receiver      Opto-Isolator  and  Receiver      Opto-Isolator  and  Receiver--Receives  the  status  information  and  the Character
      Request signals from the printer and sends them to the Quad Printer Interface Board.



































      94                                   Chapter 6 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                                 Chapter 7                                                 Chapter 7                                                 Chapter 7                                                 Chapter 7

                                               THE SIO SYSTEM                                               THE SIO SYSTEM                                               THE SIO SYSTEM                                               THE SIO SYSTEM




            The Tymshare SIO (Serial Input/Output) system is used to interface high-speed serial
            communications lines to  the Engine via  DMA.  The system  consists of the  PCSIO, a
            standard-size board  in the Engine  card cage, which  controls the operation  of the
            system via instructions drawn from the Engine's memory and commands from the  CPU; a
            small card cage  at the back of  the Engine, containing up  to 16 (with  two PCSIO's
            installed)  small interface  boards, each  of which  accommodates  two communication
            links of a particular protocol, sync, async, HDLC, or high-speed  optically coupled;
            and the ribbon cable  which connects the PCSIO  and the small interface  cards.  The
            number  of  small  boards  and  their types  is  completely  flexible,  so  that any
            combination of communications protocols can be handled.

            This chapter  gives hardware and  functional descriptions of  the boards in  the SIO
            System, and a description of the software interface between the PCSIO and the Engine
            CPU.



            7-1    HARDWARE            7-1    HARDWARE            7-1    HARDWARE            7-1    HARDWARE

            The hardware of the SIO system consists of the PCSIO board in the Engine  card cage,
            the auxiliary card cage on the rear  of the Engine, a ribbon cable to  connect them,
            and from 1 to 8 small interface  boards of various types per PCSIO installed  in the
            Engine.  This section will discuss the  hardware and functions of the boards  in the
            system at a block level.


            7-1.1    THE PCSIO            7-1.1    THE PCSIO            7-1.1    THE PCSIO            7-1.1    THE PCSIO

            The PCSIO, also known as the "big board" or "mother board" is a  standard-size board
            which resides in the Engine card cage.  It must be placed in a slot which has access
            to  both the  MUX bus  and the  DMA bus.   It controls  the operation  of  the small
            interface boards,  translating commands  from the CPU  on the  MUX bus  into control
            signals for  them, and  transferring data between  the small  boards and  the Engine
            memory via DMA.  It also obtains the Channel Command Programs that control the small
            boards from the Engine via DMA.














            THE SIO SYSTEM                                                                    95
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      A.    SIO BLOCK DIAGRAM EXPLANATION      A.    SIO BLOCK DIAGRAM EXPLANATION      A.    SIO BLOCK DIAGRAM EXPLANATION      A.    SIO BLOCK DIAGRAM EXPLANATION

      The  SIO Block  Diagram (Figure  7-1)  shows the  major functional  sections  of the
      PCSIO.  This section explains the function of each of these sections individually.

      Quad  Bus Transceiver  and Latch      Quad  Bus Transceiver  and Latch      Quad  Bus Transceiver  and Latch      Quad  Bus Transceiver  and Latch--Two  of  these are  used to  transmit  and receive
      signals from the MUX Bus, while the third is used to interface to the DMA Bus.

      Latch A2      Latch A2      Latch A2      Latch A2--This latches bits 8-15 of the SIO card's internal B Bus, so that  they can
      be sent out over the MUX I/O Bus.

      Latch B3      Latch B3      Latch B3      Latch B3--When the PCSIO is addressed  by the processor, this latch saves  bits 8-15
      of the  device address  transmitted on the  MUX I/O  Bus for use  in a  later output
      instruction, if necessary.

      Latch B2      Latch B2      Latch B2      Latch B2--Latches bits 0-7 of the data sent by the CPU over the MUX I/O Bus.

      Latch  A3      Latch  A3      Latch  A3      Latch  A3--Takes the  data  from Latch  B3 and  makes  it available  on  the PCSIO's
      internal B Bus.  It is enabled by the signal MUXLNS0-B.

      Latch C3      Latch C3      Latch C3      Latch C3--Latches bits 8-15 of the data sent by the CPU over the MUX I/O Bus.

      Address Switches      Address Switches      Address Switches      Address Switches--Two  thumbwheel switches used  to set the  device address  for the
      PCSIO.  Switch 1 is the most significant hex digit, and Switch 2 the least.

      Address Comparator      Address Comparator      Address Comparator      Address Comparator--When it is  enabled by the ADRS0 signal  on the MUX I/O  Bus, it
      compares bits 0-7 of the MUX I/O Bus with the output from the Address Switches.  the
      two are equal, the board has been addressed by the CPU, and the B Bus  and Interrupt
      Control Circuits are enabled.



























      96                                   Chapter 7 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983























































                                      Figure 7-1                                      Figure 7-1                                      Figure 7-1                                      Figure 7-1.  PCSIO Block Diagram


            SIO BLOCK DIAGRAM EXPLANATION                                                     97
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      B Bus and Interrupt  Control      B Bus and Interrupt  Control      B Bus and Interrupt  Control      B Bus and Interrupt  Control--This circuitry controls the board's  hand-shaking with
      the MUX I/O Bus.  It converts the  command and status lines of the bus  into control
      signals  for  the board,  handles  the  RACK0/TACK0 chain,  and  generates  the ATN0
      interrupt signal when there is data to be sent out on the MUX I/O Bus in Latch A2.

      Hex Displays      Hex Displays      Hex Displays      Hex Displays--Provision has been made to install two sets of TIL311 hex LED displays
      on the board.  These blocks are  shown with dotted lines because they are  only used
      for testing and trouble-shooting, and are not installed on boards in the field.  One
      set shows the address of the micro- instruction being fetched, while the other shows
      the micro-instruction currently being executed.

      Latch      Latch      Latch      Latch--Used to latch data  from the B Bus to  send to the Quad Bus  Transceiver that
      interfaces to the DMA Bus.

      Sequence Counter, 8x32 PROM and Latch      Sequence Counter, 8x32 PROM and Latch      Sequence Counter, 8x32 PROM and Latch      Sequence Counter, 8x32 PROM and Latch--Clocked by the 8 MHz C8M signal, the Sequence
      Counter controls the operation of the  DMA Quad Bus Transceiver, causing it  to send
      out the DMA address, and then either  transmit data over the DMA Bus during  a write
      operation, or put the received data onto the B Bus during a read operation.

      DMA Start      DMA Start      DMA Start      DMA Start--Handles the handshaking between the PCSIO and the DMA Bus.

      TX/RX Latch and MUX      TX/RX Latch and MUX      TX/RX Latch and MUX      TX/RX Latch and MUX--This  is the interface between the  B Bus and the  ribbon cable
      (J1)  to  the small  interface  boards.  It  determines,  under the  control  of the
      Sequence Counter, whether data is received or transmitted, and whether the 8 bits of
                                                                                  Sequence                                                                                  Sequence                                                                                  Sequence      data on the cable are to or from  the upper or lower 8 bits of the B  Bus.  Sequence
      Counter, 8x512 PROM and Latch      Counter, 8x512 PROM and Latch      Counter, 8x512 PROM and Latch      Counter, 8x512 PROM and Latch--  This provides the control signals to  the interface
      boards and the TX/RX  Latch and MUX for all  the input and output operations  by the
      PCSIO.  It is controlled  by the PCSIO microcode,  which selects the sequence  to be
      performed by loading a starting address for the PROM into the counter.   The counter
      is then clocked by  the standard 4 MHz CLOCK  signal.  This block also provides  a 2
      MHz clock, SIOCLK, on the ribbon cable for the interface boards.

      Channel Counter      Channel Counter      Channel Counter      Channel Counter--This  is a  four-bit counter, clocked  by the  4 MHz  CLOCK signal,
      which is used  to address the 16  I/O channels.  Its output  goes to J1,  the ribbon
      cable connector, and is  also used to provide part  of the RAM address,  dividing it
      into 16 pages of 64 words each.  The counter can be loaded with bits 12-15 of  the B
      Bus, using the B-COUNTD0 signal from the SIO microcode.

      1K x 16 RAM      1K x 16 RAM      1K x 16 RAM      1K x 16 RAM--This is the random-access memory used for temporary data storage on the
      PCSIO.  It is addressed by the Channel Counter, which effectively divides it into 16
      pages of 64 words,  and directly from the  microcode, which selects the  word within
      the page.

      Gates      Gates      Gates      Gates--These are used to  gate data onto the B  Bus.  One, enabled by  the COUNTS0-B
      signal, is used to put the output  of the Channel Counter on the B Bus.   The other,
      enabled by CONSTS0-B, puts  a constant from bits 25-39  of the microcode onto  the B
      Bus.

      1K x 40 PROM      1K x 40 PROM      1K x 40 PROM      1K x 40 PROM--This contains the  PCSIO microcode.  It is organized as 1024  words of
      40 bits each.  Bits 29-39 are sent directly to the Sequence Counter and 8 x 512 PROM
      and Latch, and all 40 bits are sent to the PROM Data Latch.  It is addressed  by the
      2910 Address Sequencer.




      98                                   Chapter 7 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            Latch PROM Data            Latch PROM Data            Latch PROM Data            Latch PROM Data--This  is a 40-bit  latch used to hold  the output of  the microcode
            PROM steady  during a  clock cycle.   Incoming data is  latched by  the 4  MHz CLOCK
            signal.

            B-Destination and  Special Function  Decode            B-Destination and  Special Function  Decode            B-Destination and  Special Function  Decode            B-Destination and  Special Function  Decode--Decodes bits 8-11  of the  latched PROM
            data into  signals controlling  the destination  of data  on the  B Bus  and various
            special function signals.  These signals are listed below:



                  B-REGD0:    Causes bits 4-15 of the B Bus to go into the 2:1 MUX.

                  B-MUXD0:    Loads Latch A2 with bits 8-15 of the B Bus.

                  B-SIOD0:    Loads the TX/RX Latch and MUX  with the contents of the B  Bus for
                              transmission over the ribbon cable.

                  B-COUNTD0:  Loads the Channel Counter with bits 12-15 of the B Bus.

                  COUNT0:     Increments the Channel Counter.

                  B-RAMD0:    Loads the contents of the B Bus into the selected RAM location.

                  DMAH0:      Loads the  high-order four bits  of the DMA  address into  the DMA
                              Quad Bus Transceiver and Latch.

                  B-DMAD0:    Loads the DMA Data Latch with the contents of the B Bus.

                  DMAL0:      Loads the lower 16 bits of  the DMA address into the DMA  Quad Bus
                              Transceiver and starts the DMA operation.


























            SIO BLOCK DIAGRAM EXPLANATION                                                     99
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



      B-Source  Decode      B-Source  Decode      B-Source  Decode      B-Source  Decode--Decodes  bits  12-14  of  the  Latched  PROM  Data   into  signals
      controlling the source of  the information on the  B Bus.  These signals  are listed
      below:



            CONSTS0-B:  Causes bits 25-39 of  the Latched PROM Data  to be put onto  the B
                        Bus through one of the gates.

            SIOS0-B:    Puts the contents of the TX/RX Latch onto the B Bus.

            COUNTS0-B:  Puts the contents  of the Channel Counter  onto the B  Bus through
                        the Gate.

            RAMS0-B:    Puts the contents of the selected RAM location on the B Bus.

            ALU0-B:     Puts the output of the ALU onto the B Bus.

            MUXLNS0-B:  Puts the contents of Latch A3 onto bits 8-15 of the B Bus.

            MUXS0-B:    Puts the contents of Latches B2 and C3 onto the B bus.

            DMAS0-B:    Puts the incoming DMA data  from the DMA Quad Bus  Transceiver and
                        Latch onto the B Bus.

      Test Condition Latch and Decode      Test Condition Latch and Decode      Test Condition Latch and Decode      Test Condition Latch and Decode--This  compares bits 25-28 of the Latched  PROM Data
      with selected bits of the B Bus and various signals in order to determine  where the
      microcode  branches  to.  It  sends  a signal  indicating  whether or  not  the test
      condition was met to the 2910 Address Sequencer.

      2:1 MUX      2:1 MUX      2:1 MUX      2:1 MUX--This determines whether bits 4-15 of the B Bus or bits 30-39 of the Latched
      PROM Data are sent to the  2910 Address Sequencer.  It is controlled by  the B-REGD0
      signal from the B-Destination Decode.

      2910 Address Sequencer      2910 Address Sequencer      2910 Address Sequencer      2910 Address Sequencer--This is an Am2910 Microprogram Controller chip.  It provides
      the address for the microcode PROMs.   It is capable of sequencing through  a series
      of  micro-instructions,  as with  a  counter; accepting  a  direct micro-instruction
      address from the 2:1 MUX, conditional branching to a new address, depending upon the
      results of  the Test Condition  Decode, and  looping, all under  the control  of the
      microcode via bits 0-3 of the Latched PROM Data, which provide the opcode for it.

      2901  Microprocessor  and  Carry  Logic      2901  Microprocessor  and  Carry  Logic      2901  Microprocessor  and  Carry  Logic      2901  Microprocessor  and  Carry  Logic--This  consists  of  four  Am2901  Bit Slice
      microprocessors  and  a 74S182  for  carry propagation.   This  is the  ALU  for the
      processor on the PCSIO.  Each 2901  contains a high-speed, two-port 16 by 4  RAM and
      an eight-operation, four-bit, high-speed ALU, both of which operate under control of
      the micro-code.  The A port of the RAM is addressed by bits 4-7 of the  Latched PROM
      Data and  the B port  by bits 36-39.   Bits 15-17 determine  the sources of  the two
      operands for  the ALU,  while bits 21-23  determine the  destination of  the result.
      Finally, bits  18-20 of the  Latched PROM Data  provide the function  the ALU  is to
      perform.

      8.064 MHz Oscillator      8.064 MHz Oscillator      8.064 MHz Oscillator      8.064 MHz Oscillator--This oscillator provides  the input for the Clock  Driver.  It
      also provides the 8 MHz C8M signal used by the DMA interface.


      100                                  Chapter 7 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            Clock Driver            Clock Driver            Clock Driver            Clock Driver--Divides the output of the  oscillator by 2 to provide the 4  MHz CLOCK
            and  ECLOCK signals  used throughout  the  PCSIO.  If  a microcode  parity  error is
            detected, the clock is stopped.

            Parity Checker            Parity Checker            Parity Checker            Parity Checker--Checks the Latched PROM Data for odd parity.  If even parity occurs,
            an error LED  is lit and the  system clock is stopped  until a system  clear (SCLR0)
            signal occurs.

















































            SIO BLOCK DIAGRAM EXPLANATION                                                    101
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      B.    The PCSIO Microcode      B.    The PCSIO Microcode      B.    The PCSIO Microcode      B.    The PCSIO Microcode

      The PCSIO  microcode resides in  the 1Kx40  PROM and controls  the operation  of the
      board.  It is  addressed by the  2910 Address Sequencer,  which itself is  under the
      control  of  the microcode.   The  microprogram  can loop,  branch  on  various test
      conditions, respond to interrupts, and fetch new instructions from the Engine's main
      memory.  The microcode is pipelined, since, on each clock cycle, the  latched micro-
      instruction is  executed, and the  next one  is fetched and  loaded into  the latch.
      Figure  7-2  shows  the PCSIO  Microcode  Map,  with the  various  fields  and their
      functions.  The fields are explained in more detail below:


      BITS 0-3      BITS 0-3      BITS 0-3      BITS 0-3
      OPCODE FOR THE 2910 ADDRESS SEQUENCER      OPCODE FOR THE 2910 ADDRESS SEQUENCER      OPCODE FOR THE 2910 ADDRESS SEQUENCER      OPCODE FOR THE 2910 ADDRESS SEQUENCER

      This  field provides  the  opcode for  the  2910 Address  Sequencer.   It determines
      whether  the microprogram  loops, branches  if  a test  condition is  met,  jumps to
      another  location unconditionally,  or  simply progresses  sequentially  through the
      microprogram.  The opcodes and their functions are listed below:

            Opcode      Instruction            Opcode      Instruction            Opcode      Instruction            Opcode      Instruction

               0        Jump  Zero.   The  micro-instruction  address  is  unconditionally
                        forced to  zero.  The  system clear signal  causes this  opcode as
                        long as it is active.

               1        Conditional Jump to Subroutine.  If the test condition is matched,
                        the  microprogram jumps  to the  address contained  in  the 2910's
                        pipeline  register, which  is loaded  from the  2:1 MUX  by REGD0.
                        Also,  the current  micro-program address  is stored  for eventual
                        return from the subroutine.

               2        Jump Map.  Not used in the PCSIO.

               3        Conditional Jump Pipeline.  If  the test condition is  matched the
                        microprogram  jumps  to  the  address  contained  in  the pipeline
                        register.

               4        Push/Conditional  Load  Counter.   If the  condition  is  met, the
                        counter  in the  2910 is  loaded with  the value  in  the pipeline
                        register.   This  instruction  is  used to  set  up  loops  in the
                        microprogram.

               5        Conditional Jump to  Subroutine via Pipeline Register  or Counter.
                        If the test condition is  met, the microprogram address is  set to
                        the value in the pipeline register, if the test fails, the address
                        is set to the value  in the counter.  In either case,  the current
                        address is stored for eventual return from the subroutine.

               6        Conditional Jump Vector.  Not used in the PCSIO.

               7        Conditional  Jump   via  Pipeline   Register  or   Counter.   This
                        instruction is  similar to instruction  5, except that  the return
                        address is not stored.


      102                                  Chapter 7 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983























































                                      Figure 7-2                                      Figure 7-2                                      Figure 7-2                                      Figure 7-2.  PCSIO Microcode Map


            The PCSIO Microcode                                                              103
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


               8        Repeat Loop, Counter not zero.  If the contents of the counter are
                        not zero, the microprogram address jumps to the address at the top
                        of the 2910's  internal stack.  Each time  the check is  made, the
                        counter is decremented.  When the counter reaches zero, the micro-
                        program address is set to the next micro-instruction.

               9        Repeat Pipeline Register,  Counter not zero.  This  instruction is
                        similar to  instruction 8,  except that  the branch  address comes
                        from the pipeline register.

               A        Conditional Return from Subroutine.  If the test condition is met,
                        the micro-program address is set to one greater than the  value of
                        the  last address  stored  as a  result  of a  Jump  To Subroutine
                        instruction.

               B        Conditional Jump  Pipeline Register  and Pop  Stack.  If  the test
                        condition is met, a jump  to the address in the  pipeline register
                        is made, and the top address in the stack will be popped.   If the
                        test fails,  the next  sequential micro-instruction  is performed.
                        Used in loops where multiple conditions are tested for.

               C        Load Counter and Continue.  Loads the 2901's internal counter from
                        the 2:1 MUX and continues on to the next micro-instruction.

               D        Test  End  of  Loop.   If the  test  condition  is  met,  the next
                        sequential  micro-instruction  is  performed.   If  it  fails, the
                        micro-program branches to the address at the top of the stack.

               E        Continue.  Go to the next sequential micro-instruction.

               F        Three Way Branch.  If the test condition fails,  the micro-program
                        branches to the address at the top of the stack and decrements the
                        counter.   When  the  counter  reaches  zero,   the  micro-program
                        branches  to the  address in  the pipeline  register.  If,  at any
                        time, the test condition  is met, the micro-program  falls through
                        to the next sequential micro-instruction.


      BITS 4-7      BITS 4-7      BITS 4-7      BITS 4-7
      A SELECT FOR 2901      A SELECT FOR 2901      A SELECT FOR 2901      A SELECT FOR 2901

      These four bits  select the address  for the A  port of the  RAM on the  2901 micro-
      processors.


      BITS 8-11      BITS 8-11      BITS 8-11      BITS 8-11
      B BUS DESTINATION OR SPECIAL FUNCTION SELECT      B BUS DESTINATION OR SPECIAL FUNCTION SELECT      B BUS DESTINATION OR SPECIAL FUNCTION SELECT      B BUS DESTINATION OR SPECIAL FUNCTION SELECT

      This field selects the destination for the PCSIO's internal B Bus, or one of several
      special functions.  The functions and destinations are shown below in Table 7-1:






      104                                  Chapter 7 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                                 Table 7-1                                                 Table 7-1                                                 Table 7-1                                                 Table 7-1

                                  B Bus Destinations and Special Functions


                  Value B Bus Destination                  Value B Bus Destination                  Value B Bus Destination                  Value B Bus Destination

                  0-6   Null.

                    7   The pipeline  register in  the 2910 Address  Sequencer, this  is decoded
                              into the REGD0 signal.

                    8   MUX Bus interface (B-MUXD0).

                    9   RAM (B-RAMD0).

                    A   Channel Counter (B-COUNTD0).

                    B   DMA Output Buffer (B-DMAD0).

                    C   SIO Cable Interface (B-SIOD0), also starts cable sequencer.

                    D   Loads the four high-order address bits into the DMA Quad Bus Transceiver
                              and Latch (DMAH0).

                    E   Increments the Channel Counter (COUNT0).

                    F   Loads the low-order address bits  into the DMA Quad Bus  Transceiver and
                              starts the DMA sequence (DMAL0).



            BITS 12-14            BITS 12-14            BITS 12-14            BITS 12-14
            B BUS SOURCE            B BUS SOURCE            B BUS SOURCE            B BUS SOURCE

            This field selects  the source of  the data to  be put on  the B Bus.   The possible
            sources are listed in Table 7-2.



















            The PCSIO Microcode                                                              105
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                           Table 7-2                                           Table 7-2                                           Table 7-2                                           Table 7-2

                                         B Bus Sources


            Value B Bus Source            Value B Bus Source            Value B Bus Source            Value B Bus Source

              0   Constant (CONSTS0-B), puts bits 25-39 of the latched PROM data on  the B
                  Bus.

              1   2901 ALU (ALU0-B).

              2   Channel Counter (COUNTS0-B).

              3   MUX Bus Interface (MUXS0-B).

              4   SIO Cable Interface (SIOS0-D).

              5   Eight high-order bits  of address sent  to board by  CPU on the  MUX Bus
                  (MUXLNS0-B).

              6   RAM (RAMS0-B).

              7   DMA Interface (DMAS0-B).



      BITS 15-17      BITS 15-17      BITS 15-17      BITS 15-17
      OPERAND SOURCE CONTROL FOR 2901 MICROPROCESSORS      OPERAND SOURCE CONTROL FOR 2901 MICROPROCESSORS      OPERAND SOURCE CONTROL FOR 2901 MICROPROCESSORS      OPERAND SOURCE CONTROL FOR 2901 MICROPROCESSORS

      This  determines  the  source  of  the  two  operands  for  the  ALU  in   the  2901
      microprocessors.  The possible sources are the A and B ports of the RAM in  the 2901
      itself, the 2901's internal Q register, data from the B Bus, and a 0 operand.  Table
      7-3 shows the possible combinations of sources for the ALU.






















      106                                  Chapter 7 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983




                                                 Table 7-3                                                 Table 7-3                                                 Table 7-3                                                 Table 7-3

                                     Operand Sources for the 2901 ALU.


                  Value Operand Sources                  Value Operand Sources                  Value Operand Sources                  Value Operand Sources

                    0   The contents  of the  2901 RAM  selected by  the A  port select  and the
                        2901's internal Q Register.

                    1   The contents of the 2901 RAM selected by the A and B port select bits.

                    2   A zero operand and the Q Register of the 2901 RAM.

                    3   A zero operand and the contents of the RAM selected by the B port select
                        bits.

                    4   A zero operand and the contents of the RAM selected by the A port select
                        bits.

                    5   The B  Bus and the  contents of the  RAM selected by  the A  port select
                        bits.

                    6   The B Bus and the Q Register.

                    7   The B Bus and a zero operand.



            BITS 18-20            BITS 18-20            BITS 18-20            BITS 18-20
            OPERATION CONTROL FOR 2901 ALU            OPERATION CONTROL FOR 2901 ALU            OPERATION CONTROL FOR 2901 ALU            OPERATION CONTROL FOR 2901 ALU

            This  field  determines   the  operation  performed  by   the  ALU's  in   the  2901
            microprocessors.  The operations possible are shown in Table 7-4.




















            The PCSIO Microcode                                                              107
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                           Table 7-4                                           Table 7-4                                           Table 7-4                                           Table 7-4

                                   2901 ALU Operation Control


            Value ALU Operation            Value ALU Operation            Value ALU Operation            Value ALU Operation

              0   Adds the R and S inputs (R+S).

              1   Subtracts R from S (S-R).

              2   Subtracts S from R (R-S).

              3   Ors R and S (R OR S).

              4   Ands R and S (R AND S).

              5   Ands not-R and S (NOT-R AND S).

              6   Exclusive ors R and S (R EXOR S).

              7   Exclusive nor of R and S (NOT[R EXOR S]).



      BITS 21-23      BITS 21-23      BITS 21-23      BITS 21-23
      DESTINATION CONTROL FOR 2901      DESTINATION CONTROL FOR 2901      DESTINATION CONTROL FOR 2901      DESTINATION CONTROL FOR 2901

      Controls the  destination of  the result  from the  ALU in  the 2901.   The possible
      destinations and the corresponding values of the field are shown in Table 7-5.


























      108                                  Chapter 7 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983




                                                 Table 7-5                                                 Table 7-5                                                 Table 7-5                                                 Table 7-5

                                       2901 ALU Result Destinations.


                  Value ALU Result Destination                  Value ALU Result Destination                  Value ALU Result Destination                  Value ALU Result Destination

                    0   Q Register.  The output of the ALU is the result of the operation, which
                        is also loaded into the 2901's internal Q Register.

                    1   Null.  The output of the ALU  is the result of the operation, but  it is
                        not loaded into the 2901's internal register or RAM.

                    2   RAM B.  The output of the  ALU is the contents of the 2901  RAM location
                        selected by port A.  The result of the ALU operation is loaded  into the
                        RAM location selected by port B.

                    3   The ALU output is the result of the ALU operation, which is  also loaded
                        into the RAM location selected by port B.

                    4   The ALU output  is the result of  the operation, while the  RAM location
                        selected by port B is loaded  with the result divided by two, and  the Q
                        register contents are shifted right one bit.

                    5   The  ALU output  is the  result of  the operation  and the  RAM location
                        selected by port B is loaded  with the result shifted right one.   The Q
                        register is unaffected.

                    6   The ALU output  is the result of  the operation, while the  RAM location
                        selected by port B is loaded with the result shifted left one  bit.  The
                        contents of the Q Register are also shifted left one bit.

                    7   The ALU output  is the result of  the operation, while the  RAM location
                        selected by port B is loaded with the result shifted left one  bit.  The
                        contents of the Q Register are unaffected.



            BIT 24            BIT 24            BIT 24            BIT 24
            CARRY INPUT FOR 2901'S            CARRY INPUT FOR 2901'S            CARRY INPUT FOR 2901'S            CARRY INPUT FOR 2901'S

            This  bit is  used for  the carry  input to  the 2901  microprocessors, and  is also
            sometimes used by the SIO microcode assembler for a parity bit.


            BITS 25-39            BITS 25-39            BITS 25-39            BITS 25-39
            CONSTANT SOURCE FOR B BUS            CONSTANT SOURCE FOR B BUS            CONSTANT SOURCE FOR B BUS            CONSTANT SOURCE FOR B BUS

            These bits are  used to put a  constant stored in the  microprogram onto the  B Bus,
            when the Gate  is enabled by the  B Bus Source Decode.   Note that these  bits serve
            several purposes, depending upon the contents of the rest of the micro-instruction.



            The PCSIO Microcode                                                              109
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      BITS 25-28      BITS 25-28      BITS 25-28      BITS 25-28
      TEST CONDITION SELECT FOR 2910      TEST CONDITION SELECT FOR 2910      TEST CONDITION SELECT FOR 2910      TEST CONDITION SELECT FOR 2910

      These bits are used to select  the test condition for the Test Condition  Decode and
      the 2910 Address Sequencer.   Note that only one condition  at a time can  be tested
      for.  The possible conditions and  the corresponding values for the field  are shown
      in Table 7-6.


                                           Table 7-6                                           Table 7-6                                           Table 7-6                                           Table 7-6

                                   Test Condition Selection.


            Value Test Condition Selected            Value Test Condition Selected            Value Test Condition Selected            Value Test Condition Selected

              0   False.  Forces the test to fail.

              1   True.  Forces the test to succeed.

              2   DMA Busy.

              3   F3 (sign bit of the 2901).

              4   FE0 (result of 2901 operation was 0).

              5   SIO Cable Interface busy.

              6   Multiplexer Ready (the CPU has output data to the board over the MUX I/O
                  Bus).

              7   Interrupt pending (CPU has not responded to last interrupt yet).

              8   B Bus bit 0.

              9   B Bus bit 1.

              A   B Bus bit 8.

              B   B Bus bit 9.

              C   B Bus bit 10.

              D   B Bus bit 12.

              E   B Bus bit 5.

              F   B Bus bit 7.








      110                                  Chapter 7 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            BITS 29-39            BITS 29-39            BITS 29-39            BITS 29-39
            SIO CABLE PROM SEQUENCE START ADDRESS            SIO CABLE PROM SEQUENCE START ADDRESS            SIO CABLE PROM SEQUENCE START ADDRESS            SIO CABLE PROM SEQUENCE START ADDRESS

            This is the address for the PROM in the SIO Cable Sequence Counter and PROM.   It is
            loaded into  the Sequence Counter  whenever an  input or output  operation is  to be
            performed by the SIO Cable Interface.  Note that these bits are taken  directly from
            the  output of  the microcode  PROMs, rather  than being  latched.   Therefore, they
            arrive  at  the Sequence  Counter  one clock  cycle  earlier than  the  rest  of the
            instruction is executed.


            BITS 30-39            BITS 30-39            BITS 30-39            BITS 30-39
            LATCHED PROM DATA ADDRESS TO 2910            LATCHED PROM DATA ADDRESS TO 2910            LATCHED PROM DATA ADDRESS TO 2910            LATCHED PROM DATA ADDRESS TO 2910

            Used to provide a direct address  input from the microcode to the  Address Sequencer
            for use in conditional and unconditional branches.


            BITS 30-35            BITS 30-35            BITS 30-35            BITS 30-35
            REGISTER SELECTOR IN RAM            REGISTER SELECTOR IN RAM            REGISTER SELECTOR IN RAM            REGISTER SELECTOR IN RAM

            From the point of view  of the micro-code, the RAM  on the PCSIO is divided  into 16
            pages of 64 registers each.  Each register corresponds to one word of RAM (16 bits).
            These bits select the register within the page selected by the Channel Counter.


            BITS 36-39            BITS 36-39            BITS 36-39            BITS 36-39
            B SELECT FOR 2901 RAM            B SELECT FOR 2901 RAM            B SELECT FOR 2901 RAM            B SELECT FOR 2901 RAM

            These bits are used to  select the Port B address  of the RAM contained in  the 2901
            microprocessors.


            7-1.2    INTERFACE BOARDS            7-1.2    INTERFACE BOARDS            7-1.2    INTERFACE BOARDS            7-1.2    INTERFACE BOARDS

            The Interface  Boards reside in  the small auxiliary  card cage on  the rear  of the
            Engine, and are connected to the SIO board via the ribbon cable from J1.  Each board
            contains two serial I/O ports  two interface to a particular type  of communications
            link.  The types presently supported are asynchronous RS232, synchronous RS232/V.35,
            and  high-speed  optically  coupled.   Each  channel  on  the  board  is  separately
            controlled, and all types of the boards can be simultaneously connected to  a single
            SIO card.

            All of the Interface Boards use the Z-80 SIO chip and the custom T609  support chip,
            but the chips are used differently  on the different types of board.   The operation
            of the Z-80  SIO chip and the  T609, common to all  three types of  interface board,
            will be  discussed in  one section, while  the distinctive  features of  the various
            types of Interface Boards will be discussed individually.








            The PCSIO Microcode                                                              111
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      A.    The Z-80 SIO Chip      A.    The Z-80 SIO Chip      A.    The Z-80 SIO Chip      A.    The Z-80 SIO Chip

      The Z-80 SIO Chip is a programmable communications interface, which takes 8  bits of
      parallel data from the SIO Cable  Interface and converts it into serial data  of the
      appropriate line protocol  and data rate, including  the control signals  needed for
      the line, and vice versa.

      Almost all of the line protocol characteristics may be specified by writing into the
      Z-80 SIO's seven Write Registers.   The three Read Registers contain  information on
      the status of the line, including  any CRC errors detected if the  Cyclic Redundancy
      checking is enabled.

      Each of the two lines on the chip  has its own sets of Read and Write  Registers, so
      that the characteristics of the two lines on the board can be different.   The Write
      Registers are written into by means  of Command Pairs.  A command pair is  two 8-bit
      bytes, one of which writes into Write Register 0 and selects the Register  the other
      byte is written into.  The Write  Registers are shown in Figure 7-3 and  the meaning
      of each is explained below.






































      112                                  Chapter 7 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983























































                                Figure 7-3                                Figure 7-3                                Figure 7-3                                Figure 7-3.  Z-80 SIO Chip Write Registers.


            The Z-80 SIO Chip                                                                113
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      WRITE REGISTER 0      WRITE REGISTER 0      WRITE REGISTER 0      WRITE REGISTER 0

      Write Register 0 has certain special characteristics.  First, every command  pair (2
      bytes) output to  the SIO writes into  the Register.  Second, the  least significant
      three bits of the  first byte select the Write  Register into which the  second byte
      will be  written.  The high  order five bits  of the register  are divided  into two
      fields, and  the meanings  of the  various bit  combinations in  the two  fields are
      explained below:

                                          First Field                                          First Field                                          First Field                                          First Field



            Bit 7 Bit 6      Meaning            Bit 7 Bit 6      Meaning            Bit 7 Bit 6      Meaning            Bit 7 Bit 6      Meaning

              0     0   Null Code.

              0     1   Resets the Transmit Data Cyclic Redundancy Checker.

              1     0   Resets the Receive Data Cyclic Redundancy Checker.

              1     1   Resets the Transmit Underrun and End Of Message Latch.


































      114                                  Chapter 7 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



            The second  field contains the  basic Z-80 SIO  commands, which are  used constantly
            during normal operation.

                                        Second Field--Basic Commands                                        Second Field--Basic Commands                                        Second Field--Basic Commands                                        Second Field--Basic Commands

                  Bit 5 Bit 4 Bit 3       Meaning                  Bit 5 Bit 4 Bit 3       Meaning                  Bit 5 Bit 4 Bit 3       Meaning                  Bit 5 Bit 4 Bit 3       Meaning

                    0     0     0   Null Command.  This code has no effect.  It is  usually used
                                    when writing to another Write Register in the chip.

                    0     0     1   Send Abort (SDLC Mode only).  Sends a string of 8 to  13 1's
                                    out on the channel.

                    0     1     0   Reset External/Status Interrupts.  After  an External/Status
                                    Interrupt, for example a change in a modem line,  the status
                                    bits of Read Register 0 are latched.  This command unlatches
                                    them and allows the SIO chip to send interrupts once again.

                    0     1     1   Channel  Reset.  Zeroes  out all  the control  registers for
                                    that channel.

                    1     0     0   Enable  Interrupt on  Next Received  Character.  If  the SIO
                                    chip is in the  Interrupt on First Received  Character Mode,
                                    this command  re-enables the  interrupt after  each complete
                                    message is received, preparing the SIO for the next message.

                    1     0     1   Reset  Transmitter  Interrupt  Pending.   If  the  channel's
                                    Transmit  Interrupt  is  enabled,  it  interrupts  when  the
                                    transmit  buffer  empties.   This  command  prevents further
                                    interrupts when there are no more characters to be sent, for
                                    example, at the end of a network packet.

                    1     1     0   Error Reset.  Resets the Parity and Overrun Error Latches in
                                    Read Register 1.

                    1     1     1   Return From  Interrupt.  Can only  be issued for  Channel A.
                                    Resets  the  Interrupt-Under-Service  Latch  of  the highest
                                    priority device in the chip's internal daisy  chain.  Allows
                                    lower  level  internal  devices to  use  the  internal daisy
                                    chain.















            The Z-80 SIO Chip                                                                115
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      WRITE REGISTER 1      WRITE REGISTER 1      WRITE REGISTER 1      WRITE REGISTER 1

      Write  Register  1 contains  the  control  bits for  the  interrupts  and Wait/Ready
      functions.  Each of the bits is explained separately below:

            Bit   Function            Bit   Function            Bit   Function            Bit   Function

             7    Wait/Ready Enable.  Enables the Wait/Ready functions controlled  by bits
                  5 and 6.

             6    Wait or  Ready Function.  If  set, causes the  WAIT/READY output  of the
                  chip to  go low  when the  chip is  ready to  transfer data.   If reset,
                  causes the output to float, until it goes active (low).

             5    Wait/Ready  on Receive  or  Transmit Function.   Determines  whether the
                  Wait/Ready Function Set by Bit  6 is used for receiving  or transmitting
                  data.  It cannot be used for both at once.

      Bits 3  and 4  specify the various  Receive Interrupt  Modes.  In  Receive Interrupt
      mode, these bits  determine when an interrupt  occurs.  The different modes  and the
      bit conditions that determine them are shown below:

            Bit 4 Bit 3       Receive Interrupt Mode            Bit 4 Bit 3       Receive Interrupt Mode            Bit 4 Bit 3       Receive Interrupt Mode            Bit 4 Bit 3       Receive Interrupt Mode

              0     0   Mode 0.  Receive interrupts disabled.

              0     1   Mode 1.  Receive interrupt on first character only.

              1     0   Mode 2.  Interrupt on all received characters.  Parity error  is a
                        Special Receive condition.

              1     1   Mode 3.   Interrupt on all  received characters.  Parity  error is
                        not a Special Receive condition.

      Special Receive conditions  affect the interrupt vector,  which the Engine  does not
      use, so Modes 2 and 3 are essentially the same in the Engine.

            Bit         Function            Bit         Function            Bit         Function            Bit         Function

             2    Status  Affects Vector.   This is  also used  with the  interrupt vector
                  feature and does not affect the Engine.

             1    Transmit Interrupt Enable.  If enabled, an interrupt occurs whenever the
                  transmit buffer empties.

             0    External/Status  Interrupt  Enable.   Allows interrupts  to  occur  as a
                  result of changes in the DCD,  CTS, and SYNC inputs to the chip,  when a
                  BREAK or ABORT is detected, or at the beginning of CRC or sync character
                  transmission.







      116                                  Chapter 7 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            WRITE REGISTER 2            WRITE REGISTER 2            WRITE REGISTER 2            WRITE REGISTER 2

            This Register is only  used on channel B.  It  sets the interrupt vector and  is not
            used in the Engine.


            WRITE REGISTER 3            WRITE REGISTER 3            WRITE REGISTER 3            WRITE REGISTER 3

            This register contains the bits that control the receiver logic for a channel.  Bits
            6 and  7 control  the number of  received bits  that the chip  will assemble  into a
            character.  The meanings of the other bits are explained below:

                  Bit   Function                  Bit   Function                  Bit   Function                  Bit   Function

                   5    Auto Enables.  If this  bit is set, the DCD  and CTS inputs to  the chip
                        become the  receive and  transmit enables, respectively.   If it  is not
                        set, these inputs are simply  used for the status bits in  Read Register
                        0.

                   4    Enter Hunt Phase.   If this is  set, the Hunt Phase  in the SIO  chip is
                        entered.  This is used to re-establish character synchronization.

                   3    Receiver CRC Enable.  If this bit is set, the chip starts  calculating a
                        Cyclic Redundancy Check at the beginning of the last character received.

                   2    Address Search Mode.  If it is  set, and the channel is using  SDLC, the
                        chip checks the addresses of all received messages to see if  they match
                        the address in Write Register  6 or the global address of  11111111.  If
                        the message address doesn't match one of those, it is rejected.

                   1    Sync Character  Load Inhibit.   Leading sync  characters are  not loaded
                        into the receive buffer.

                   0    Receiver Enable.  Writing a 1 into this bit causes the receive operation
                        to begin.





















            The Z-80 SIO Chip                                                                117
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      WRITE REGISTER 4      WRITE REGISTER 4      WRITE REGISTER 4      WRITE REGISTER 4

      Write Register 4 contains  those control bits which  are used for both  the receiver
      and transmitter sides of a channel.  The functions of the bits in this  register are
      explained below.

      Bits 6 and 7 select the multiplier between the clocks (for transmit and receive) and
      the actual data rate.  This must be 1 for any type of synchronous operation, but may
      be 1,16,32, or 64 for async lines.

      Bits  4  and  5  are  used to  select  the  mode  of  character  synchronization for
      synchronous  communication.   The possible  options  and the  bit  combinations that
      select them are shown below:

            Bit 5 Bit 4       Character Sync Mode            Bit 5 Bit 4       Character Sync Mode            Bit 5 Bit 4       Character Sync Mode            Bit 5 Bit 4       Character Sync Mode

              0     0   8-bit programmed sync character.

              0     1   16-bit programmed sync character.

              1     0   SDLC mode (01111110 flag pattern).

              1     1   External sync mode.

      Bits 2 and  3 determine the number  of stop bits for  each character in  async mode,
      while bits 0 and 1 determine the parity used, if any.  If bit 0 is set, a parity bit
      is  added to  each  character transmitted,  and a  parity  bit is  expected  in each
      received character.  Bit 1 selects whether even or odd parity is sent or checked, if
      it is set parity is even.



























      118                                  Chapter 7 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            WRITE REGISTER 5            WRITE REGISTER 5            WRITE REGISTER 5            WRITE REGISTER 5

            This register contains control bits for the operation of the transmitter, except for
            bit 2 which is used to control both the transmitter and receiver.

                  Bit         Function                  Bit         Function                  Bit         Function                  Bit         Function

                   7    DTR.  This controls the Data Terminal Ready signal from the  chip.  When
                        set, the signal is active.

                  5&6   These  two bits  control  the number  of  bits transmitted  as  a single
                        character.  This can range from five or less up to eight as shown below:
                                    Bit 6  Bit 5          Bits/Character                                    Bit 6  Bit 5          Bits/Character                                    Bit 6  Bit 5          Bits/Character                                    Bit 6  Bit 5          Bits/Character
                                      0      0                   5 or less
                                      0      1                   7
                                      1      0                   6
                                      1      1                   8

                   4    Send  Break.   Setting this  bit  immediately forces  the  Transmit Data
                        output to  spaces, regardless of  any data currently  being transmitted.
                        When  the bit  is then  reset, the  Transmit Data  returns to  its idle,
                        marking state.

                   3    Transmit Enable.  This bit enables the transmitter to send data  when it
                        is set.   If it is  not set, the  transmit line is  held in  the marking
                        state.

                   2    CRC-16/SDLC.  This bit selects the CRC polynomial for both  the receiver
                        and transmitter.

                   1    Request to Send.  This bit controls the RTS output from the  chip.  When
                        set, the signal is active.

                   0    Transmit CRC Enable.  This bit determines if the Cyclic Redundancy Check
                        is calculated on a particular transmit character.


            WRITE REGISTER 6            WRITE REGISTER 6            WRITE REGISTER 6            WRITE REGISTER 6

            Write Register 6 contains the transmit sync character, or, in SDLC mode, a secondary
            address field.


            WRITE REGISTER 7            WRITE REGISTER 7            WRITE REGISTER 7            WRITE REGISTER 7

            Write Register 7 contains the receive sync character in normal sync mode, or  a flag
            character in SDLC mode.  It is not used in External Sync mode.

            The Z-80 SIO also has three Read Registers, which contain status information on each
            channel.   These  registers are  accessed  by  writing into  Write  Register  0, and
            selecting the number of the register to be read.  An input operation is then used to
            get the information from the  selected Read Register.  The Read Registers  are shown
            in Figure 7-4.



            The Z-80 SIO Chip                                                                119
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983























































                             Figure 7-4                             Figure 7-4                             Figure 7-4                             Figure 7-4.  Z-80 SIO Read Registers.


      120                                  Chapter 7 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            READ REGISTER 0            READ REGISTER 0            READ REGISTER 0            READ REGISTER 0

            This  Read  Register  contains  the  External/Status  Bits  (DCD,  CTS, Break/Abort,
            Sync/Hunt, and  Transmit Underrun/EOM) and  the status of  the receive  and transmit
            buffers.


            READ REGISTER 1            READ REGISTER 1            READ REGISTER 1            READ REGISTER 1

            This register contains  the status bits for  the Special Receive conditions  (End of
            SDLC  Frame,  CRC/Framing  Error,  Receiver Overrun,  Parity  Error,  and  All Async
            Characters Sent) and the I Field Residue Code for SDLC Mode.


            READ REGISTER 2            READ REGISTER 2            READ REGISTER 2            READ REGISTER 2

            This  register  is on  channel  B only,  and  contains the  Interrupt  Vector, which
            Tymshare does not use.


            B.    T609 CMOS Support Chip            B.    T609 CMOS Support Chip            B.    T609 CMOS Support Chip            B.    T609 CMOS Support Chip

            The T609 is a custom-designed support chip for the Z-80 SIO chip.  It provides RS232
            line receivers, clock monitors, a local clock source, and an address  comparator for
            the daughter  boards.  It  also provides HDLC  idle line  detection and  extra clock
            pulses for bisync.


            C.    Synchronous RS232/V.24 and V.35 Interface Boards            C.    Synchronous RS232/V.24 and V.35 Interface Boards            C.    Synchronous RS232/V.24 and V.35 Interface Boards            C.    Synchronous RS232/V.24 and V.35 Interface Boards

            These  boards are  used for  synchronous data  communication with  one of  the above
            interface specifications.  Both provide two  input and two output control  lines per
            channel, and  can detect  the HDLC  idle line  condition.  The  RS232/V.24 Interface
            Board has  an on-board 8000  Hz clock for  hard-wired applications, and  can provide
            extra receive clocks for bisync  applications, and detect missing clocks.   The V.35
            board is similar, except that it has no internal clock.


            D.    Asynchronous RS232/V.24 Interface Board            D.    Asynchronous RS232/V.24 Interface Board            D.    Asynchronous RS232/V.24 Interface Board            D.    Asynchronous RS232/V.24 Interface Board

            This board  is used  for asynchronous  data communication  with the  above interface
            specifications.   It  provides  two  input  and  two  output  control  lines,  and a
            thumbwheel-controlled baud rate generator with  rates from 75 to 9600 baud  for each
            channel.


            E.    Optically Coupled Serial I/O (OCSIO) Interface Board            E.    Optically Coupled Serial I/O (OCSIO) Interface Board            E.    Optically Coupled Serial I/O (OCSIO) Interface Board            E.    Optically Coupled Serial I/O (OCSIO) Interface Board

            This board is used only for very high speed hardwired applications.  It  operates at
            rates of  40,000 to 160,000  bps, depending upon  the load on  the SIO card  and the
            CPU's  at  either  end.   Currently,  these  links  are  used  between  the  network
            supervisors and  the Tymnet II  switchers in the  main computer centers.   The board
            uses an optically-isolated coaxial cable with no clocks transmitted over the cables.



            The Z-80 SIO Chip                                                                121
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      A one is represented by a 2  microsecond pulse and a zero by a 4  microsecond pulse,
      with at  least 2 microseconds  between pulses.  There  is no current  output between
      pulses.



      7-2    SOFTWARE INTERFACE      7-2    SOFTWARE INTERFACE      7-2    SOFTWARE INTERFACE      7-2    SOFTWARE INTERFACE

      This section describes the software  interface used to control the operation  of the
      SIO.  The general sequence of operations is as follows:  The CPU sends a  command to
      the SIO card  over the MUX Bus.   The high-order byte of  the command is  the device
      address for the SIO, and the  low-order byte contains the command type and  the line
      number.  After the SIO  has acknowledged receiving the  command, the CPU sends  it a
      halfword of data.  This  is the quad word (divided  by X'10) virtual address  of the
      memory location that the SIO card is to read from or write into via DMA.

      From there, the sequence varies  depending upon the type of operation  ordered.  For
      input and output operations,  the address is that  of a Channel Command  Word, which
      may be the first of many making up a Channel Command Program.  The SIO  will execute
      each command in the Channel Command Program with no further commands from the Engine
      CPU until it either encounters a stop command or an error.  If jump instructions are
      included in the program, it will loop indefinitely.  There may be two  such programs
      for each channel, one for output and one for input, for a maximum of  thirty-two for
      a fully- loaded SIO card.  All  of these programs can run indefinitely,  without any
      further instructions from the CPU.  Other  command types will cause the SIO  to read
      the Engine's  memory and write  into the registers  in the Z-80  SIO chip,  or write
      status information into memory.


      7-2.1    CPU COMMANDS TO THE SIO CARD      7-2.1    CPU COMMANDS TO THE SIO CARD      7-2.1    CPU COMMANDS TO THE SIO CARD      7-2.1    CPU COMMANDS TO THE SIO CARD

      This section describes the commands sent by the Engine CPU to the SIO card  over the
      MUX I/O Bus.  These commands consist of two halfwords.  The first  halfword contains
      the device address of the SIO card  in its high-order byte, and the line  number and
      command  type in  the low-order  byte.  The  second halfword  is data,  providing an
      address for DMA operations, or a  number for the DMA window size or  relocation.  In
      addition  to sending  commands  to the  SIO card,  the  CPU can  also  obtain status
      information from  it with  the Sense Status  instruction.  This  instruction returns
      data to the CPU over the  MUX I/O Bus.  The various commands possible  are described
      below.  Figure 7-5 summarizes these commands and their formats.


      A.    Sense Status Instructions      A.    Sense Status Instructions      A.    Sense Status Instructions      A.    Sense Status Instructions

      The Sense Status Register instruction returns the device status in the  Engine CPU's
      condition code.  A condition code of 0 indicates that the SIO is ready and available
      for commands on the MUX Bus.  A code of 4 indicates that the board is not available,
      or not present.  An 8 indicates that the SIO is busy or not ready to accept commands
      from the MUX Bus.

      If  the  Sense Status  was  in response  to  an ATN2  interrupt,  then  the register
      specified in the instruction will contain 8 bits of status describing  the condition
      which caused the interrupt and the  SIO line number involved.  Bits 0-3  contain the



      122                                  Chapter 7 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983























































                        Figure 7-5                        Figure 7-5                        Figure 7-5                        Figure 7-5.  Pictorial Summary of the SIO/MUX Bus Interface.


            Sense Status Instructions                                                        123
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      interrupt condition, a  1 signifies that  an async input  command for that  line has
      been completed, a 2 that a Channel Command Word error has occurred, a 6 that the SIO
      chip lost data due to an overrun, and an 8 indicates an I/O command error.  Bits 4-7
      of the register contain the offending line number.


      B.    Start Input Command      B.    Start Input Command      B.    Start Input Command      B.    Start Input Command

      SIO input Channel Programs are started with this command, when the SIO  is addressed
      on the MUX Bus with  a command type of zero.  The  16 bits of data following  it are
      interpreted by the SIO as a right-justified quad word address for the  first Channel
      Command Word.  A quad word address has zeroes in its low-order four bits, so that 16
      bits of data can be used to address any quad word location in the Engine Memory.  To
      obtain the actual memory address from the quad word address, multiply the  quad word
      address by X'10.  When  the input command is received,  the SIO uses the DMA  Bus to
      read the  memory location specified  by the  quad word address  to obtain  the first
      command in  the Channel Command  Program.  The SIO  will keep executing  the Channel
      Command Program for input  on this line until it  reaches a stop command  or another
      Start Input command is received for the line.


      C.    Start Output Command      C.    Start Output Command      C.    Start Output Command      C.    Start Output Command

      This command works in exactly the same way the Start Input command does, except that
      it has a command type  of 1, and starts the program  for the output side of  a line.
      Again, the program will keep running  until it reaches a stop instruction,  an error
      condition,  or another  Start Output  command is  sent for  that line.   See Section
      7-2.2 for a description of the input and output Channel Commands.


      D.    Relocation Command      D.    Relocation Command      D.    Relocation Command      D.    Relocation Command

      The Relocation command is used in connection with the memory management  features of
      the Engine (see  Chapter 9).  It has  a command type of  2 and the halfword  of data
      specifies a quad word  address which is to be  added to all further  memory accesses
      for the specified line.  The relocation value is initialized to zero.


      E.    Lower Limit Command      E.    Lower Limit Command      E.    Lower Limit Command      E.    Lower Limit Command

      The Lower Limit  command has a command  type of 3 and  the halfword of data  with it
      sets  the  smallest quad  word  virtual address  that  is allowed  for  DMA accesses
      relating to that line.  It is also initialized to zero.


      F.    Window Size Command      F.    Window Size Command      F.    Window Size Command      F.    Window Size Command

      The Window  Size command sets  the size, in  quad words, of  the DMA window  for the
      selected line.  Memory accesses outside of the set window, which starts at the lower
      limit, are not allowed.  The command has a type of 4.






      124                                  Chapter 7 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            G.    Read Status Command            G.    Read Status Command            G.    Read Status Command            G.    Read Status Command

            The Read Status command is the only one which can be issued during the  execution of
            Channel Command Programs  on a given line  without affecting the program.   The data
            accompanying  the command  is the  quad  word address  starting at  which  the three
            halfwords of status information are  to be written.  The information given  by those
            three halfwords is shown in Table 7-7.


                                                 Table 7-7                                                 Table 7-7                                                 Table 7-7                                                 Table 7-7

                                           SIO Status Halfwords.


                  Bit         Description                  Bit         Description                  Bit         Description                  Bit         Description

                  0-7         Read Register 0 in the SIO chip.

                  8-15        Read Register 1 in the SIO chip.

                  16-23       Idle line counter.  This counter is incremented each time  an HDLC
                              idle line state is detected.

                  24-31       CRC error counter.

                  32-43       Abort  Counter.   This  counter  increments  when  an  HDLC  abort
                              condition is detected.  It will also increment when a  line begins
                              an idle state.

                  44          This bit is always a  1.  It is usually used to  determine whether
                              the command is complete, by setting it to zero before  the command
                              is sent.

                  45          This bit is a 1 if the receive clock is present.

                  46          This  bit  is  a 1  if  the  HDLC line  is  currently  idle.  This
                              condition occurs if the last sixteen bits received were all ones.

                  47          This bit is a 1 if the transmit clock is present.


            The first halfword will be X'FFFF for non-existent ports.


            H.    Reset Command            H.    Reset Command            H.    Reset Command            H.    Reset Command

            This command needs no  data to accompany it.  It  returns the board to  the power-up
            state, stopping  all Channel  Command Programs, and  resetting all  of the  Z-80 SIO
            chips.







            Read Status Command                                                              125
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      I.    Channel Reset Command      I.    Channel Reset Command      I.    Channel Reset Command      I.    Channel Reset Command

      This command works like the Reset Command, but it affects only one line.


      7-2.2    CHANNEL COMMANDS      7-2.2    CHANNEL COMMANDS      7-2.2    CHANNEL COMMANDS      7-2.2    CHANNEL COMMANDS

      Channel Commands are the instructions which  the SIO pulls out of the  Engine memory
      with DMA.  These commands  make up the Channel  Command Programs, which are  used to
      control  the SIO's  input and  output  operations.  There  are two  sets  of Channel
      Command Words, one for input and one for output, which will be explained separately.
      For an overall pictorial summary of the Channel Command Words, see Figure 7-6.

      The format  of both input  and output  Channel Commands is  the same.   Each channel
      command occupies a full word (32 bits).  The upper 16 bits contain the command code,
      while the lower ones  contain a quad word address  or data.  In executing  a Channel
      Command Program, the SIO goes  through the instructions sequentially, unless  a Jump
      instruction is  encountered.  Note that  a Channel Command  Program cannot  cross an
      address divisible by X'100 except by the use of a Jump command.





































      126                                  Chapter 7 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983























































                              Figure 7-6                              Figure 7-6                              Figure 7-6                              Figure 7-6.  SIO DMA Interface Channel Commands.


            CHANNEL COMMANDS                                                                 127
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      A.    Input Channel Commands      A.    Input Channel Commands      A.    Input Channel Commands      A.    Input Channel Commands

      When the SIO is sending data to the Engine, it writes the data into a buffer  in the
      Engine's memory.   These commands  control the size  of the  buffer and  the records
      (where applicable),  the type  of input  expected, and  the flow  of the  data.  The
      individual command codes and the effects of the commands are described below.

                Code    Command Description                Code    Command Description                Code    Command Description                Code    Command Description

                 0      Stop  Command.  Halts  the  execution of  this  particular Channel
                        Command Program.

                 1      Input to Buffer Command.  Starts input of HDLC records at the quad
                        word address specified in the second halfword of the  command (the
                        starting address of the input buffer). The first halfword  of each
                        record in  the buffer is  initialized to a  negative value  by the
                        software in the SIO.  When the record has been successfully input,
                        the negative value is replaced by a positive byte count.

                        If the byte count of the record is odd, the last byte of  the last
                        halfword will be the first  byte of the CRC, which is  normally of
                        no interest.  The halfword following the end of the record  is set
                        to X'FFFF.   If there  is enough room  left in  the buffer  to put
                        another maximum-size record  in, the next  record is input  in the
                        same way, followed  by another halfword  set to X'FFFF.   If there
                        isn't  enough room  left,  the process  starts over  again  at the
                        beginning of the buffer.

                 2      Jump Command.  The second halfword of the command is the quad word
                        address of the destination of the jump.

                 3      Set Input  Buffer and  Max Record Size  Command.  The  halfword of
                        data is the input buffer  size.  Its minimum size is X'20  and its
                        maximum size is X'2000.  The maximum size of a record is  one less
                        than one-eighth of the buffer size.  This means that no  more than
                        seven maximum-length records will be put into a buffer  before the
                        software has to start over at the beginning of the  buffer because
                        of the byte count and X'FFFF marker halfwords.

                        WARNING:  RECORDS LARGER THAN  THE MAXIMUM SIZE SET  ARE DISCARDED                        WARNING:  RECORDS LARGER THAN  THE MAXIMUM SIZE SET  ARE DISCARDED                        WARNING:  RECORDS LARGER THAN  THE MAXIMUM SIZE SET  ARE DISCARDED                        WARNING:  RECORDS LARGER THAN  THE MAXIMUM SIZE SET  ARE DISCARDED
                        WITHOUT RECORDING THEM IN ANY WAY!                        WITHOUT RECORDING THEM IN ANY WAY!                        WITHOUT RECORDING THEM IN ANY WAY!                        WITHOUT RECORDING THEM IN ANY WAY!

                 4      Input  Async  Command.   Inputs  from  1  to  8  async characters,
                        starting at the quad word address given in the second  halfword of
                        the command.  When the input  is completed, the SIO sends  an ATN2
                        interrupt to  the CPU, and  a code of  1 will show  up if  a Sense
                        Status instruction  is performed.  This  interrupt occurs  when at
                        least   one  character   has  been   input  or   approximately  20
                        milliseconds after the  last character was input.   Each character
                        occupies  one halfword,  right justified.   The left  byte  of the
                        halfword is 00 for normal characters and 01 for a break character.





      128                                  Chapter 7 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            B.    Output Channel Commands            B.    Output Channel Commands            B.    Output Channel Commands            B.    Output Channel Commands

            These commands control the flow of output data and the set up of the Write Registers
            in the Z-80 SIO chips.  The  commands are listed below with their command  codes and
            an explanation of each command.

                      Code    Command Description                      Code    Command Description                      Code    Command Description                      Code    Command Description

                       0      Stop Command.  Stops execution of the Channel Command Program.

                       1      Output HDLC  Record.  The  second halfword of  the command  is the
                              quad  word address  of  the beginning  of the  record.   The first
                              halfword of the  record is the byte  count.  When the  command has
                              been executed, the SIO checks  the next command.  If it is  a Stop
                              Command, the Output HDLC Record Command just executed  is replaced
                              by X'200.  If  it was not a  Stop Command, the Output  HDLC Record
                              command is replaced by X'100 and the SIO executes the next Channel
                              Command.

                       2      Jump Command.   Causes the SIO  to jump to  the quad  word address
                              contained in the second halfword of the command.

                       3      Output  Command Pair.   The  halfword of  data in  the  command is
                              output as a  command pair to the  registers in the Z-80  SIO chip.
                              This must be done to  set up both input and output  operations for
                              each line before any such operations can be started.

                       4      Output Async Record Command.   This command works like  the Output
                              HDLC Record Command, except that it is used for async output.


            7-2.3    SIO INTERRUPTS            7-2.3    SIO INTERRUPTS            7-2.3    SIO INTERRUPTS            7-2.3    SIO INTERRUPTS

            The SIO  card interrupts  the Engine CPU  on the  ATN2 line.  It  can have  only two
            interrupts, one for the board and one for a Channel Command Program, pending  at any
            one time.  If a second interrupt occurs  while one of the same type is  pending, the
            new interrupt replaces it and the old one is forgotten.



















            Output Channel Commands                                                          129
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



























                                               *
                                              * *
                                               *




























      130                                  Chapter 7 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                                 Chapter 8                                                 Chapter 8                                                 Chapter 8                                                 Chapter 8

                                     INTERRUPTS AND INTERRUPT HANDLING                                     INTERRUPTS AND INTERRUPT HANDLING                                     INTERRUPTS AND INTERRUPT HANDLING                                     INTERRUPTS AND INTERRUPT HANDLING




            An interrupt is a  request by some part of  the system for immediate  attention from
            the processor.  It is  not necessarily the result of  an error condition, but  it is
            frequently used to flag them.  It is also used to indicate that an I/O  device needs
            servicing from the CPU.

            The  Engine  uses  five   different  kinds  of  interrupts.   These   are:   machine
            malfunction,  illegal  instruction,  relocation/protection  (MAC),  supervisor  call
            (SVC), and I/O interrupts.  The general sequence of operation for all  interrupts is
            described below, followed by the descriptions of the individual interrupt sequences.



            8-1    GENERAL SEQUENCE            8-1    GENERAL SEQUENCE            8-1    GENERAL SEQUENCE            8-1    GENERAL SEQUENCE

            The first  step in the  interrupt handling  sequence is a  PSW swap.   The microcode
            stores the  old PSW  and Program Counter  in dedicated  memory locations  or general
            registers, and loads  a new PSW  and Program Counter  from another set  of dedicated
            memory locations.  In effect, the CPU is switched to another program,  the interrupt
            service routine  for that interrupt.   After the service  routine is  completed, the
            programmer usually  has the old  PSW and Program  Counter reloaded, and  the machine
            goes back  to doing  what it  was doing  before it  was interrupted.   The dedicated
            memory addresses for interrupts are shown in Table 8-1:



























            INTERRUPTS AND INTERRUPT HANDLING                                                131
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                           Table 8-1                                           Table 8-1                                           Table 8-1                                           Table 8-1

                                   Dedicated Memory Addresses

           HEXADECIMAL
           ADDRESS         FUNCTION
           20-27           Old PSW and Program Counter for Machine
                           Malfunction Interrupts.
           30-37           New PSW and Program Counter for Illegal
                           Instruction Interrupts.
           38-3F           New PSW and Program Counter for Machine
                           Malfunction Interrupts.
           90-97           New PSW and Program Counter for Relocation/
                           Protection Interrupts.
           98-9B           New PSW for Supervisor Call Interrupts.
           9C-BB           Addresses of service routines for Supervisory
                           Call Interrupts.
           D0-2CF          Interrupt Service Pointer Table for I/O
                           interrupts.
           300-3FF         Dedicated special-purpose registers on the
                           Memory Access Controller.




      8-2    INTERRUPT PRIORITIES      8-2    INTERRUPT PRIORITIES      8-2    INTERRUPT PRIORITIES      8-2    INTERRUPT PRIORITIES

      Pending interrupts are prioritized and  queued so that, if several  interrupts occur
      simultaneously or nearly so, they are serviced in the order of priority  shown below
      in Table 8-2:



                                           Table 8-2                                           Table 8-2                                           Table 8-2                                           Table 8-2

                                      Interrupt Priorities

           PRIORITY        INTERRUPT
           0               NOT USED
           1               EARLY POWER DOWN
           2               CONSOLE ATTENTION
           3               MEMORY PARITY ERROR
           4               MAC
           5               ATN0 (ENHANCED ASYNC)
           6               ATN1 (ENHANCED SYNC)
           7               ATN2 (ALL OTHER I/O)


      Note  that  Illegal  Instruction  interrupts are  not  prioritized,  since  they are
      triggered directly by the microcode and serviced instantly.






      132                                  Chapter 8 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            8-3    ILLEGAL INSTRUCTION INTERRUPT            8-3    ILLEGAL INSTRUCTION INTERRUPT            8-3    ILLEGAL INSTRUCTION INTERRUPT            8-3    ILLEGAL INSTRUCTION INTERRUPT

            When  an  illegal  opcode  is detected  by  the  microcode,  an  illegal instruction
            interrupt is generated.  The microcode then stores the old PSW in register E  of the
            register set selected  by the new  PSW, while the old  Program Counter is  stored in
            register F of the same set.  The processor will halt if the wait bit in the  new PSW
            will set, otherwise,  it will begin executing  instructions from the new  address in
            the Program Counter.



            8-4    MACHINE MALFUNCTION INTERRUPTS            8-4    MACHINE MALFUNCTION INTERRUPTS            8-4    MACHINE MALFUNCTION INTERRUPTS            8-4    MACHINE MALFUNCTION INTERRUPTS

            There are two types of Machine Malfunction Interrupts, Early Power Down,  and Memory
            Parity Error.  If an Early Power  Down Interrupt occurs, there is no PSW  swap.  The
            console displays the microcode address in an error message "0060 DEAD."

            If a Memory Parity Error Interrupt occurs, the microcode stores the PSW in effect at
            the time in locations 20-23 and the Program Counter into locations 24-27.  A new PSW
            is loaded from locations  38-3B and a new  Program Counter is loaded  from locations
            3C-3F.  The address where the parity  error occurred is stored in locations  348 and
            34A.



            8-5    CONSOLE ATTENTION            8-5    CONSOLE ATTENTION            8-5    CONSOLE ATTENTION            8-5    CONSOLE ATTENTION

            This interrupt is caused by pressing  one of the function keys on the  console.  The
            PSW is set to 8000, halting the computer, and the PSW and current memory address are
            displayed  on the  console.  Note  that,  since the  keyboard is  disabled  when the
            keyswitch is in the LOCK position, no Console Attention interrupts can occur at that
            time.



            8-6    RELOCATION/PROTECTION (MAC)            8-6    RELOCATION/PROTECTION (MAC)            8-6    RELOCATION/PROTECTION (MAC)            8-6    RELOCATION/PROTECTION (MAC)

            A MAC interrupt is enabled whenever the MAC is turned on by setting PSW Bit 5.  When
            the interrupt occurs, a  new PSW is loaded from  addresses 90-93, and a  new Program
            Counter from addresses  from locations 94-97.  The  old PSW and old  Program Counter
            are stored in registers E and F  of the set selected by the new PSW.   The processor
            then begins the MAC Interrupt service routine.  At this point, it usually  reads the
            MAC Status Register to find the cause of the interrupt.













            ILLEGAL INSTRUCTION INTERRUPT                                                    133
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983





      8-7    SUPERVISORY CALL (SVC)      8-7    SUPERVISORY CALL (SVC)      8-7    SUPERVISORY CALL (SVC)      8-7    SUPERVISORY CALL (SVC)

      A Supervisory Call is  a user instruction (opcode E1),  used to invoke a  routine to
      perform  some  special  type  of service.   In  essence,  it  is  a software-induced
      interrupt.  The R1 field of the instruction is used to indicate the type  of service
      required.  Since  there are  16 possible entries,  there are  16 types  of services.
      There  is a  table in  locations  9C to  BB, holding  16 half-words,  each  of which
      contains  the  address  of an  SVC  service  routine.  When  an  SVC  instruction is
      executed, the microcode loads in a new PSW from memory addresses 98-9B.  The old PSW
      and Program Counter are loaded into registers E and F, respectively, of the  new set
      selected by the new PSW.  Then, the contents of the R1 field of the  instruction are
      doubled and added to 9C.  The result is the address of the half-word pointer of that
      service routine in the SVC service table.  This half-word pointer is placed into the
      Program Counter,  and execution begins  from the  new location.  At  the end  of the
      service routine,  an LPSWR instruction  from register E  will return control  to the
      original program, starting at the address immediately following that of the SVC.



      8-8    I/O INTERRUPTS      8-8    I/O INTERRUPTS      8-8    I/O INTERRUPTS      8-8    I/O INTERRUPTS

      I/O interrupts  occur when  an I/O device  needs service  from the  processor.  This
      usually occurs when the I/O device is ready to accept more data, or when it has data
      ready to send to the processor.

      Up to  three levels of  I/O interrupts  are possible in  the Engine,  depending upon
      whether it is a standard Engine, or has enhanced async, or enhanced  sync microcode.
      The three levels of interrupt  are explained below, together with the  devices which
      cause them for each level of enhancement.

      The general sequence for all levels of I/O interrupts is as follows:

      When  an I/O  interrupt  occurs, the  processor  sends out  an  acknowledgement.  On
      receiving the acknowledgement, the device sends its address to the processor  on the
      I/O Bus.  Then, the  PSW is set to 2000,  disabling more I/O interrupts and  the old
      PSW  and Program  Counter are  loaded  into registers  0 and  1 of  register  set 0,
      selected by the new PSW.  The device  address is loaded into register 2 of  the same
      set.   After this,  the processor  starts executing  the interrupt  service routine.
      When the routine is finished an LPSWR instruction to register 0 will restore the old
      PSW and the program will continue from where it was interrupted.


      8-8.1    ATN0 INTERRUPTS      8-8.1    ATN0 INTERRUPTS      8-8.1    ATN0 INTERRUPTS      8-8.1    ATN0 INTERRUPTS

      This interrupt only occurs in Engines with enhanced async microcode.  It is produced
      by  the 3600  Baud  Interrupter on  the  Multi-Function Card.   This  interrupts the
      processor  3600 times  a second.   Each time  it interrupts  on the  ATN0  line, the
      processor sends out TACK0, acknowledging  that it has received the  interrupt.  Then
      it stores the old PSW in register 0 of set 0, while setting the new PSW to 0010.




      134                                  Chapter 8 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            When the 3600 Baud  Interrupter receives the TACK0  signal, it sends out  a counter-
            acknowledgement SYN0.  Then it puts its address on the I/O Bus. This  address counts
            in a ring from 70 to 75, that is, the first time, it acknowledges as address 70, the
            second time as address 71,  and so on, up to 75,  when it begins the cycle  all over
            again.  In  effect, there are  6 different devices,  each interrupting at  600 Baud,
            staggered at  1/3600 of a  second intervals.   The microcode uses  this ring  of six
            addresses to determine when it should  send or receive a bit from a  port, depending
            on its Baud  rate.  For example, the  processor might read from  or write to  a 1200
            Baud port when the ring address is 70  or 73, and for a 600 Baud port,  whenever the
            ring address is 70.

            Once it has received the ring address from the 3600 Baud Interrupter,  the microcode
            in the processor begins the service  routine, reading from and writing to  the Async
            Cards as it  is needed.  When the  routine is ended the  old PSW is  restored.  Note
            that,  since the  service routine  for the  ATN0 interrupt  is contained  within the
            microcode, no  new Program  Counter needs  to be  loaded, and  the main  program can
            continue execution from where it left off.


            8-8.2    ATN1 INTERRUPTS            8-8.2    ATN1 INTERRUPTS            8-8.2    ATN1 INTERRUPTS            8-8.2    ATN1 INTERRUPTS

            The ATN1 interrupt should only  occur in machines with enhanced sync  microcode.  If
            the machine  does not  have enhanced sync  microcode, and  ATN1 occurs,  the machine
            dies, and  displays 01A0 DEAD  on the  console.  If PSW  bit 6 is  set and  the ATN1
            interrupt occurs,  it is handled  as described below.   If bit 6  is reset,  ATN1 is
            treated as an ATN2 interrupt.

            The ATN1 interrupt is created by the  Sync Card when an input buffer is full,  or an
            output buffer  is empty.  When  the interrupt occurs,  the CPU responds  with TACK1.
            The PSW is set to 6200 and the old PSW and Program Counter are loaded into registers
            0 and 1 of set 0, respectively.   Then the microcode waits for a SYN0  response from
            the interrupting device.  If it  doesn't respond within 2 microseconds,  the machine
            dies.  If the card does respond in time, the processor gets its address,  and begins
            the service routine.  When the routine is completed, the old PSW and Program Counter
            are re-loaded, and the machine continues the interrupted program.


            8-8.3    ATN2 INTERRUPTS            8-8.3    ATN2 INTERRUPTS            8-8.3    ATN2 INTERRUPTS            8-8.3    ATN2 INTERRUPTS

            ATN2 interrupts  are the only  kind which  an occur on  a non-enhanced  Engine.  The
            conditions that would trigger ATN0 or ATN1 in an enhanced Engine only cause  ATN2 in
            a standard one.  In  an enhanced Engine, ATN2 is  triggered by any of the  other I/O
            devices,  either those  on the  Multi-Function Card,  those on  the PCSIO,  the Quad
            Printer Interface, or the  ESELCH; that are not  mentioned above as causing  ATN0 or
            ATN1.  Note that, in an Engine with enhanced async, but not enhanced sync,  that the
            Async Ring Driver will cause ATN0, but the Sync Card should cause ATN2 and not ATN1.
            The sequence of events in an ATN2 interrupt is described below.

            When ATN2 occurs, the processor sends  out TACK2. The device responds with  SYN0 and
            then puts its  address on the I/O  Bus.  Once the processor  has the address  of the
            interrupting device, it sets the  PSW to 2000,disabling all further  ATN2 interrupts
            until this one  gets cleared up.   The old PSW and  Program Counter are  loaded into
            registers 0 and 1  of the new register set,  set 0.  The number of  the interrupting



            ATN0 INTERRUPTS                                                                  135
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      device (its address) is stored in register  2 of the same set.  Next, the  number of
      the device is doubled  and added to 0D0.  The  result is the address of  the service
      routine for that  particular device number.  The  contents of that address  are then
      loaded  into the  Program Counter  and the  processor begins  executing  the service
      routine.  When the  routine is through, an  LPSWR instruction to register  0 reloads
      the old  PSW, and the  original program starts  executing again, beginning  with the
      instruction immediately following the one it was interrupted after.

      Since up to 256 I/O devices can be interfaced to the Engine, there is a table of 256
      half-words, each  containing the  address of a  service routine  for an  I/O device,
      located in memory addresses D0 to 2CF.


      8-8.4    THE RACKX/TACKX CHAIN      8-8.4    THE RACKX/TACKX CHAIN      8-8.4    THE RACKX/TACKX CHAIN      8-8.4    THE RACKX/TACKX CHAIN

      When the processor  receives an interrupt  from an I/O device,  it needs to  get the
      number of the  device in order to  service the interrupt.  The  way it does  this is
      through the RACKX/TACKX (Receive Acknowledge/Transmit Acknowledge) chain.   When the
      processor first receives an I/O interrupt, say ATN1, it acknowledges  that interrupt
      with the corresponding  Transmit Acknowledge signal, in  this case, TACK1.   This is
      sent down the backplane  to the first I/O card  slot where it is received  as TACK1.
      On the card is  a flip-flop, which is set  when that card has an  interrupt pending.
      If this flip-flop  is set, the card  sends out a counter-acknowledgement,  SYN0, and
      one clock cycle later, sends out its address on the I/O Bus.  On the other  hand, if
      the flip-flop is not set, that is, the card is not the one interrupting;  the signal
      is passed along  the backplane to the  next I/O card slot,  where it is  received as
      RACK1.  If this is the interrupting card,  then it will send out SYN0, and  then its
      address; if not, it will pass the signal along to the next I/O card as TACK1; and so
      on, until the card that is interrupting breaks the chain.

      If a card other than an I/O card is put in an I/O card slot, the RACK and TACK lines
      for whichever interrupts are allowed should be jumpered past the  board.  Otherwise,
      if the processor  gets an interrupt from  a card below that  slot, and sends  out an
      acknowledgement, it will never receive SYN0 and the system will crash.






















      136                                  Chapter 8 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                                 Chapter 9                                                 Chapter 9                                                 Chapter 9                                                 Chapter 9

                                             MEMORY MANAGEMENT                                             MEMORY MANAGEMENT                                             MEMORY MANAGEMENT                                             MEMORY MANAGEMENT




            The  Memory  Access Controller  on  the Tymnet  Engine  provides software-controlled
            memory relocation and  protection.  Under program  control, it can  relocate program
            addresses to physical addresses, write- or execute-protect user-defined  segments of
            memory, and detect illegal memory accesses.

            The  MAC's  memory  management  capabilities are  used  mainly  for  Tymshare's ISIS
            communications interface  operating system.  The  relocation feature permits  any of
            the interface programs available to be loaded into any slot on the  machine, without
            any need to modify  the program; and any combination  of slots may be loaded  into a
            single  machine.  The  protection  capabilities of  the  MAC prevent  any  slot from
            crashing the ISIS operating system or any  of the other slots in the machine  if the
            software in that slot fails.



            9-1    RELOCATION            9-1    RELOCATION            9-1    RELOCATION            9-1    RELOCATION

            Relocation of program addresses to physical  addresses is enabled by PSW bit  5.  If
            this bit is off, the MAC does not translate the address, it simply uses  the program
            address as the physical address.  If bit 5 is on, all memory accesses are assumed to
            be program addresses which must be relocated to the physical addresses.   Before the
            bit  is set,  the MAC  Segmentation Registers  must be  loaded with  the appropriate
            values  to  map  the program  address  to  the physical  address.   Each  of  the 16
            Segmentation  Registers describes  the starting  address and  length of  a  block of
            physical memory allocated to the program address space.  These blocks, which  may be
            up to 64K bytes long,  are allocated in multiples of  256 bytes and must start  on a
            256 byte boundary.

            When   the   Segmentation   Registers   have  been   properly   set   up,   and  the
            Relocation/Protection bit in the PSW is  set, the MAC uses the high-order  four bits
            of  the  processor  memory  address (program  address)  to  select  the Segmentation
            Register.  This Segmentation Register contains the starting address for the block of
            memory, which is added  to the low-order 16 bits  of the program address  to produce
            the physical address for the memory access.















            MEMORY MANAGEMENT                                                                137
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



















                           Figure 9-1                           Figure 9-1                           Figure 9-1                           Figure 9-1.  Example of Relocation by MAC


      In the example above (Figure 9-1), Segmentation Register 1 is selected.   Bits 12:23
      of the register specify  the starting address of the  block of memory, in  this case
      X'36400, and  bits 4:19  of the  processor memory  address contain  the displacement
      within the block.   The starting address contained  in the Segmentation  Register is
      added to the displacement in the  low-order 16 bits of the processor  memory address
      to give the physical address used for the memory access.



      9-2    PROTECTION      9-2    PROTECTION      9-2    PROTECTION      9-2    PROTECTION
      Each Segmentation Register can also be used to limit the type of access to the block
      of memory it defines.   There are five types of  protection that can be  provided by
      the MAC when the  Relocation/Protection bit of the  PSW is turned on.   Violation of
      any of these types of protection causes  a MAC interrupt to be sent to the  CPU, and
      the type of  violation to be  loaded into the MAC  Status Register.  These  types of
      protection are listed below:



           1.   If the Presence  Bit (bit 27) in  the Segmentation Register is  reset, and
                the Segmentation Register is addressed by a memory access, a MAC interrupt
                will be generated for an attempt to access a non-existent memory address.

           2.   If the Write Protection Bit (bit 26) of the Segmentation Register  is set,
                and an attempt is made to  store into its block of memory a  MAC interrupt
                is generated, and the MAC Status Register will show that there was a write
                protection violation.

           3.   If the  Write/Interrupt Protection  Bit (bit  25) is  set in  the selected
                Segmentation Register, and  a store is made  into its memory block,  a MAC
                interrupt  will  be  generated,  and  the  Status  Register  will  show  a
                Write/Interrupt Protection violation.  Note that if bit 26 is on, this bit
                has no effect.



      138                                  Chapter 9 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                 4.   If  the Execution  Protection Bit  (bit 24)  of the  selected Segmentation
                      Register is set, and an instruction fetch is attempted, a MAC interrupt is
                      caused for execute-protect violation.

                 5.   If the value of the lower  16 bits of the program address is  greater than
                      the limit set for the memory block of the selected  Segmentation Register,
                      then a MAC interrupt for a Relocation/Protection Fault is generated.



            If the MAC interrupt was caused by an execute-protect or write-protect violation, or
            by an invalid  address, and it  cannot be accepted immediately  by the CPU,  the MAC
            continues to  operate, but  all write  operations are  converted to  read operations
            until the interrupt is cleared.  In the case of a write/interrupt protect violation,
            the  store  operation is  completed  and then  a  MAC interrupt  is  generated.  The
            interrupt condition  is cleared  by any CPU  reference to  the MAC  interrupt status
            register.



            9-3    THE SEGMENTATION REGISTERS            9-3    THE SEGMENTATION REGISTERS            9-3    THE SEGMENTATION REGISTERS            9-3    THE SEGMENTATION REGISTERS

            The  MAC  has 16  Segmentation  Registers,  which are  accessed  as  reserved memory
            locations.  Each register occupies 4  bytes, with the first one starting  at address
            300. Table 9-1 shows these dedicated addresses.


                                                 Table 9-1                                                 Table 9-1                                                 Table 9-1                                                 Table 9-1

                               Dedicated Addreses for Segmentation Registers.


                    Register        Memory Location

                       0                 300
                       1                 304
                       2                 308
                       3                 30C
                       4                 310
                       5                 314
                       6                 318
                       7                 31C
                       8                 320
                       9                 324
                       A                 328
                       B                 32C
                       C                 330
                       D                 334
                       E                 338
                       F                 33C






            PROTECTION                                                                       139
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      These registers  are loaded  by storing  the desired  values into  the corresponding
      memory locations  with the  Relocation/Protection Bit of  the PSW  off, and  read by
      reading from that location.

      All attempts to read  from the Segmentation Registers  will return the value  in the
      corresponding memory location,  which, after relocation has  been turned on,  may no
      longer be the same  as the value in the  Segmentation Register.  The only  time that
      the Segmentation Register can  be read is just  after the register has  been loaded,
      and before the Relocation/Protection bit in the PSW is turned on.

      Figure  9-2  shows  the  various  fields  in  each  Segmentation  Register,  and the
      meanings of each field.












































      140                                  Chapter 9 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983






            Field    Bits       Meaning            Field    Bits       Meaning            Field    Bits       Meaning            Field    Bits       Meaning

                     0-3        Unused--must be zero.

            SLF      4-11       Segment Limit Field.  Contains one less than the number  of 256-
                                byte blocks in the segment described by the register.

            SRF      12-23      Segment Relocation Field.  Indicates the starting address of the
                                segment  described by  the register.   (The starting  address is
                                equal to the SRF multiplied by X'100).

            E        24         Execute  Protect bit--  if set,  an instruction  fetch  from the
                                segment  will  cause  a relocation/protection  fault  and  a MAC
                                interrupt.

            WP       25-26      Write Protection field.  This field is encoded as follows:


                                00--no Write Protection

                                01  or  11--Write  Protected.  Any  attempt  to  store  into the
                                    segment causes a relocation/protection fault, and  the store
                                    is not executed.

                                10--Write/Interrupt  Protect.   An  attempt  to  store  into the
                                    segment causes  a relocation/protection  fault, but  the the
                                    store is executed.

            P        27         Presence  bit.   If  this  bit is  not  set,  selection  of this
                                register causes a relocation/protection fault for  attempting to
                                address non-existent memory.

                     28-31      Unused--must be zero.

                                 Figure 9-2                                 Figure 9-2                                 Figure 9-2                                 Figure 9-2.  Segmentation Register Fields.




            9-4    INTERRUPT STATUS REGISTER            9-4    INTERRUPT STATUS REGISTER            9-4    INTERRUPT STATUS REGISTER            9-4    INTERRUPT STATUS REGISTER

            The Interrupt Status Register is  set by the MAC when a  relocation/protection fault
            interrupt  is generated.   The first  reference to  the register's  dedicated memory
            address (X'340) will clear the interrupt condition.  The meanings of the bits in the
            Interrupt Status Register are explained below:







            THE SEGMENTATION REGISTERS                                                       141
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983




      Field    Bits       Meaning      Field    Bits       Meaning      Field    Bits       Meaning      Field    Bits       Meaning

      I        27         Invalid  Address.  The  value of  the low-order  16 bits  of the
                          program address was greater than the limit specified by  the SLF
                          in the selected Segmentation Register.

      N        28         Non-Present Address.  An  attempt was made  to read from  a non-
                          existent memory address.

      WP       29         Write Protect Violation.   An attempt was  made to store  into a
                          write-protected memory segment.

      WI       30         Write/Interrupt Protect Violation.  An attempt was made to store
                          into a write/interrupt-protected memory segment.

      E        31         Execute Protect Violation.  An instruction fietch  was attempted
                          from an execute-protected memory segment.

                    Figure 9-3                    Figure 9-3                    Figure 9-3                    Figure 9-3.  Interrupt Status Register Bits and Meanings



































      142                                  Chapter 9 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



























                                                     *
                                                    * *
                                                     *




























            INTERRUPT STATUS REGISTER                                                        143
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983














































                                   Figure 9-4                                   Figure 9-4                                   Figure 9-4                                   Figure 9-4.  Microcode Map











      144                                  Chapter 9 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                                 Chapter 10                                                 Chapter 10                                                 Chapter 10                                                 Chapter 10

                                         MICROCODE MAP EXPLANATION                                         MICROCODE MAP EXPLANATION                                         MICROCODE MAP EXPLANATION                                         MICROCODE MAP EXPLANATION




            The Microcode Map  shows the various  fields the microcode  is divided into  and the
            functions controlled by the bits in those fields.  This explanation will  cover each
            field one at a time, in the order they are on the microcode map.

            Some bits of the microcode, those  indicated on the map by diagonal lines,  are used
            immediately as they are output, while the others, indicated by horizontal lines, are
            latched and used on the next clock cycle.  Thus, a latched function will be executed
            at the same time as an  immediate function in the next microcode  instruction.  This
            fact is important to remember when  tracing out a sequence of operation  through the
            microcode.

            Field 1--This field can be used to provide a constant for several  different control
            functions.   The full  sixteen  bits can  be used  as  a constant  for  the Constant
            Register, and thus the B Bus.  If bit 0 is high, the system clock will be stopped if
            there is  a memory operation  in progress, until  the memory operation  is complete.
            Bit 3 is sometimes used as a parity  bit for the microcode.  It can also be  used as
            an address for the microcode to branch to, in this case, only the lower  twelve bits
            are used.  Bits  11-15 may also be  used to load the  MAC Control Register,  and the
            least-significant four bits  may be used to  determine the register  stack selected.
            The function this field performs in a given instruction is determined by the rest of
            the microcode for that instruction.

            Field  2--This  field consists  of  only four  bits  and is  used  to  determine the
            conditions  under which  the microcode  will branch  for a  given  instruction.  The
            instruction can be set up so that it will never branch, or always branch; or so that
            it will branch on the least significant bit of the Working Register or  the Extended
            Working Register, or on the sign bit of the Working Register, or on an  interrupt or
            bit in the PSW.

            Field 3--The first two  bits of this field select  the location of the  address that
            the microcode will branch to in this instruction.  The default of 00 means  that the
            instruction will branch  to the microcode  address specified in  field 1.  A  01 for
            those  two bits  specifies the  address decoded  for RX1,2  and 3  instructions.  10
            specifies that the address is obtained from the mapping PROM, by decoding the opcode
            of the user instruction.  Lastly, the interrupt vector can be specified, causing the
            microcode to branch  to the address obtained  from the interrupt  control circuitry.
            The second bit of this field may be  used as a parity bit instead of bit 3  in Field
            1.  Since the parity bit is  generated by the computer, which creates  the microcode
            before it is blown into the PROMS,  it is not recommended that a constant  be loaded
            into the Constant Register at the same  time that a branch is being done.   The next
            two bits  of the field  are the ALU  Mode Control and  Carry In  Complement signals.
            These are control signals for the ALU, and in conjunction with the last four bits of
            the field ALS0-3, determine the function the ALU will be performing.

            Field 4--This field controls the functions of the Working Register and  the Extended
            Working Register.  The Working Registers can be loaded, or their contents rotated or
            shifted within the registers, under the control of this field of the microcode.


            MICROCODE MAP EXPLANATION                                                        145
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      Field 5--This determines the source of the B Bus.  The bus can simply be  ignored by
      setting this field to zero, or the bus can have the contents of one of the registers
      on the ROM and I/O board placed on it.  The possible B Bus Sources are:

      MICROCODE       B BUS SOURCE

           0               Null.  Nothing is put onto the B Bus.

           1               MDR.  The  contents of  the Memory  Data Register  are put
                           onto the B Bus.

           2               PSW.   The  Program  Status  Word  contained  in  the  PSW
                           Register is put onto the B Bus.

           3               Console.  The contents of the Console Register are  put on
                           the B Bus.

           4               Constant.    The  contents   of  the   Constant  Register,
                           specified by Field  1 of the microcode,  are put on  the B
                           Bus.

           5               I/O Bus.  The contents of the I/O Bus are put on the B Bus
                           through the I/O Bus Transceivers.

           6               YS*2.  This puts  double the contents  of the YS  field of
                           the user instruction currently in the Instruction Register
                           onto  the   B  Bus.   It   is  used  in   determining  the
                           displacement in short format Jump instructions.

           7               YS.  This simply puts the contents of the YS field  in the
                           Instruction Register on the B Bus.

           8               ALU.  This puts the lower 16 bits of the ALU's output onto
                           the  B Bus,  through  the Sum  Bus  to B  Bus  Fast Buffer
                           Driver.

           9               MDRA.   This  is the  lower  15 bits  of  the  Memory Data
                           Register.   It  is  only used  in  this  fashion  with the
                           displacement fields of RX2 format user instructions.

      Field 6--This  field is the  B Bus  destination control, and  the MAC  control.  The
      first bit is the Load MAC Control.  It causes the MAC Control Register to  be loaded
      with  the contents  of bits  11-15 of  Field 1.   The control  functions  these bits
      perform are shown below:












      146                                 Chapter 10 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



                 BIT NO.  FUNCTION

                 11              Causes the Instruction Register to be loaded.

                 12              When low, forces non-relocate (overrides PSW5).

                 13              High for Write, Low for Read.

                 14              Used only with the Test and Set instructions.

                 15              Tells MAC that this  is an instruction fetch.  It  is used
                                 for validity  testing, to see  if the location  is execute
                                 protected.

            The next three bits  are the B Bus  Destination control.  They control  the location
            the B Bus contents will be loaded into.  This can be any of the registers on the ROM
            & I/O board, the  I/O or Console Buses, or  the I/O and Console Control  Buses.  The
            bits of the B Bus which correspond to signals on those two buses are shown below.
                                    B BUS   CONSOLE CONTROL
                                    1       SRG
                                    2       SHL
                    (LOW ACTIVE)    4       SHR
                                    6       LB
                                    7       LA
                                            I/O CONTROL
                                    8       ADRS
                                    9       DA
                                    10      DR
                                    11      SR
                    (HIGH ACTIVE)   12      CMD
                                    13      TACK0
                                    14      TACK1
                                    15      TACK2

            Note that the Console Control  Bus only receives the upper  8 bits of the B  Bus and
            doesn't uses all of them, while the I/O Control Bus uses only the lower 8 bits.

            Field 7--This field  is 8 bits wide  and consists of miscellaneous  control signals.
            It uses the first four bits MISC0-3 to reset various interrupts, store the condition
            code into the PSW, increment and decrement the YD Counter, and make memory requests.
            The fifth bit is the Map Select Bit used by the mapping PROM.  If this bit  is high,
            it selects the first  decode of the opcode in  the user instruction.  If it  is low,
            the second decode is selected.  The next three bits of the field control the general
            registers on the  CPU board.  The  first of these three  bits is the  Register Write
            Enable.  This  allows the contents  of the  Working Register to  be loaded  into the
            selected general  register.  The  next two bits  select the  general register  to be
            used.  This can be specified by the YD or YS fields in the user instruction,  the SX
            field, used for indexing in RX3 format instructions; or the register can be selected
            directly by the microcode in bits 12-15 of field 1.

            Field 8--This field is 12 bits wide and contains the control signals for the 4:1 and
            8:1 MUX's on  the CPU board.  The  8:1 MUX control is  split into three  parts.  One



            MICROCODE MAP EXPLANATION                                                        147
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      selects the input for the left half  of the MUX (bits 0-15), the second  selects the
      input for bits 16-23, and the third for bits 24-31.  This facilitates byte and half-
      word swapping and rotation.  The 4:1 MUX has fewer inputs and is controlled  by only
      two bits,  52 and 56,  since no swap  or rotation operations  are needed.   The zero
      setting to each of the three parts of the 8:1 MUX cause that part of the MUX to send
      all zeroes to the ALU.  The 4:1  MUX has no such default setting.  The first  bit of
      Field 8, bit 48, is the Register Zero Select Override.  This bit is active  low, but
      is normally high unless register 0 is selected as an index register.  If this is the
      case, bit 48 goes low and causes 0 to be substituted for bits 51, 55, and 59  of the
      micro-instruction on the next cycle.  Used to prevent user register 0 being  used as
      an index register.

      Field 9--Field  9 is used  to control  the Memory and  Program Counters.   These can
      either be incremented by 2, to obtain the next memory location or instruction  to be
      accessed; or they can be loaded with a new value.









































      148                                 Chapter 10 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



























                                                     *
                                                    * *
                                                     *




























            MICROCODE MAP EXPLANATION                                                        149
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983














































                                 Figure 10-1                                 Figure 10-1                                 Figure 10-1                                 Figure 10-1.  Op-code Decoding











      150                                 Chapter 10 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                                 Chapter 11                                                 Chapter 11                                                 Chapter 11                                                 Chapter 11

                                    THE MAPPING PROM AND OPCODE DECODING                                    THE MAPPING PROM AND OPCODE DECODING                                    THE MAPPING PROM AND OPCODE DECODING                                    THE MAPPING PROM AND OPCODE DECODING




            Each user instruction  has a section  of microcode to  emulate it.  This  section is
            addressed  by  decoding  the  opcode of  the  user  instruction  into  the necessary
            microcode address with the Mapping PROM.

            The actual  PROMs used for  the mapping are  512 by 8  bit devices.  There  are only
            eight bits  of opcode, so  that a ninth  bit is needed  to fully address  the PROMs.
            This is provided by bit 44 of the microcode, the MAP SELECT bit.  This allows  for a
            second decode of the opcode, depending upon  whether the MAP SEL bit is set  or not.
            This second  decode is used  to save  space in the  microcode by  permitting several
            instructions to share  a common routine, for  example, all half-word  immediate type
            instructions go to the same address on the first decode, but different  addresses on
            the second.

            If  an unused  or illegal  opcode is  presented for  a first  decode,  the resulting
            address is that of  an illegal instruction routine.   If an instruction that  has no
            need for a second decode is decoded  anyway, the second decode is the address  of an
            illegal second decode service routine, which causes the computer to stop and display
            an error message on the console.

            The output of the PROMs is 16 bits wide, of which only 11 are used directly  to make
            up the 12-bit microcode address.  Bits 0-8 come directly from the PROMs, as  do bits
            10 and 11.  Bit 9 comes from  the Mask Field of the instruction, the  Condition Code
            of the PSW, and bits 14 and 15 from the PROMs.

            In a Jump instruction, the Mask Field and the Condition Code, bits 12:15 of the PSW,
            are run through a 4-Wide And-Or-Invert Gate.  The output of this gate will be low if
            the condition is true.   This output is then split  and one side of it  is inverted.
            These two signals, inversions of each  other, are then run through a 2  Wide And-Or-
            Invert, together with  bits 14 and 15  from the PROMs.  If  bits 14 and 15  are both
            zero, then bit 9 of the microcode address will be 1, if they are both 1, then  bit 9
            is zero.  If bit 14 is 0 and bit  15 is 1, bit 9 is the complement of the  output of
            the And-Or-Invert, otherwise bit 9 follows the output of the And-Or-Invert.

            For example,  if the  instruction was  a Jump  True Backward  Short, opcode  20, the
            output of the PROMs is 1301.  If the condition were met, its microcode address would
            be 130, and if the condition were not met, the address would be 134.













            THE MAPPING PROM AND OPCODE DECODING                                             151
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



























                                               *
                                              * *
                                               *




























      152                                 Chapter 11 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                                 Chapter 12                                                 Chapter 12                                                 Chapter 12                                                 Chapter 12

                                            System Illustrations                                            System Illustrations                                            System Illustrations                                            System Illustrations




            This section contains photographs of the complete Tymnet Engine system,  showing the
            locations of its various components. Figure 12-7 is particularly important,  in that
            it shows the placement of the terminators for the backplane connectors.














































            System Illustrations                                                             153
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983























































                                  Figure 12-1                                  Figure 12-1                                  Figure 12-1                                  Figure 12-1.  Tymnet Engine


      154                                 Chapter 12 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983























































                                  Figure 12-2                                  Figure 12-2                                  Figure 12-2                                  Figure 12-2.  Basic Engine (Front View)


            System Illustrations                                                             155
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983























































                             Figure 12-3                             Figure 12-3                             Figure 12-3                             Figure 12-3.  Basic Engine (Rear View)


      156                                 Chapter 12 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983























































                                 Figure 12-4                                 Figure 12-4                                 Figure 12-4                                 Figure 12-4.  Basic Engine (with options)


            System Illustrations                                                             157
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983























































                           Figure 12-5                           Figure 12-5                           Figure 12-5                           Figure 12-5.  Basic Engine (with options)


      158                                 Chapter 12 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983























































                                 Figure 12-6                                 Figure 12-6                                 Figure 12-6                                 Figure 12-6.  Tymnet Engine (Two Chassis)


            System Illustrations                                                             159
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983





















































            Figure 12-7            Figure 12-7            Figure 12-7            Figure 12-7.  Tymnet Engine (Two Chassis Back View, Showing Terminators)




      160                                 Chapter 12 
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



                                                 Appendix A                                                 Appendix A                                                 Appendix A                                                 Appendix A

                             ALPHABETICAL SUMMARY OF THE ENGINE INSTRUCTION SET                             ALPHABETICAL SUMMARY OF THE ENGINE INSTRUCTION SET                             ALPHABETICAL SUMMARY OF THE ENGINE INSTRUCTION SET                             ALPHABETICAL SUMMARY OF THE ENGINE INSTRUCTION SET





            Add                                  A        5A          RX1 43
            Add                                  A        5A          RX2 43
            Add                                  A        5A          RX3 43
            Add Halfword                         AH       4A          RX1 43
            Add Halfword                         AH       4A          RX2 43
            Add Halfword                         AH       4A          RX3 43
            Add Halfword Immediate               AHI      CA          RI1 43
            Add Halfword to Memory               AHM      61          RX1 44
            Add Halfword to Memory               AHM      61          RX2 44
            Add Halfword to Memory               AHM      61          RX3 44
            Add Immediate                        AI       FA          RI2 43
            Add Immediate Short                  AIS      26          SF  43
            Add Register                         AR       0A          RR  43
            Add to Memory                        AM       51          RX1 44
            Add to Memory                        AM       51          RX2 44
            Add to Memory                        AM       51          RX3 44
            Align Sync input                     **ALIGN  36          RR  61
            aNd                                  N        54          RX1 30
            aNd                                  N        54          RX2 30
            aNd                                  N        54          RX3 30
            aNd Halfword                         NH       44          RX1 30
            aNd Halfword                         NH       44          RX2 30
            aNd Halfword                         NH       44          RX3 30
            aNd Halfword Immediate               NHI      C4          RI1 30
            aNd Immediate                        NI       F4          RI2 30
            aNd Register                         NR       04          RR  30
            ARray AND                            *ARAND   3E           R?? 32


            Checksum Sync input                  **CKSUM  37          RR  61
            Compare                              C        59          RX1 45
            Compare                              C        59          RX2 45
            Compare                              C        59          RX3 45
            Compare Halfword                     CH       49          RX1 45
            Compare Halfword                     CH       49          RX2 45
            Compare Halfword                     CH       49          RX3 45
            Compare Halfword Immediate           CHI      C9          RI1 45
            Compare Immediate                    CI       F9          RI2 45
            Compare Logical                      CL       55          RX1 29
            Compare Logical                      CL       55          RX2 29
            Compare Logical                      CL       55          RX3 29
            Compare Logical Byte                 CLB      D4          RX1 29
            Compare Logical Byte                 CLB      D4          RX2 29
            Compare Logical Byte                 CLB      D4          RX3 29
            Compare Logical Halfword             CLH      45          RX1 29


            ALPHABETICAL SUMMARY OF THE ENGINE INSTRUCTION SET                               161
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      Compare Logical Halfword             CLH      45          RX2 29
      Compare Logical Halfword             CLH      45          RX3 29
      Compare Logical Halfword Immediate   CLHI     C5          RI1 29
      Compare Logical Immediate            CLI      F5          RI2 29
      Compare Logical Register             CLR      05          RR  29
      Compare Register                     CR       09          RR  45
      Complement BiT                       CBT      77          RX1 37
      Complement BiT                       CBT      77          RX2 37
      Complement BiT                       CBT      77          RX3 37
      Compute BCT                          **CBCT   3A          ??? 62
      Console IO                           CIO      99          RR  53
      Convert Halfword Value Register      CHVR     12          RR  48
      COPY memory                          **COPY   3F          R?  28


      Divide                               D        5D          RX1 47
      Divide                               D        5D          RX2 47
      Divide                               D        5D          RX3 47
      Divide Halfword                      DH       4D          RX1 47
      Divide Halfword                      DH       4D          RX2 47
      Divide Halfword                      DH       4D          RX3 47
      Divide Halfword Register             DHR      0D          RR  47
      Divide Register                      DR       1D          RR  47


      EXchange Byte Register               EXBR     94          RR  26
      EXchange Halfword Register           EXHR     34          RR  26
      Exchange Program Status Register     EPSR     95          RR  51
      eXclusive or                         X        57          RX1 31
      eXclusive or                         X        57          RX2 31
      eXclusive or                         X        57          RX3 31
      eXclusive or Halfword                XH       47          RX1 31
      eXclusive or Halfword                XH       47          RX2 31
      eXclusive or Halfword                XH       47          RX3 31
      eXclusive or Halfword Immediate      XHI      C7          RI1 31
      eXclusive or Immediate               XI       F7          RI2 31
      eXclusive or Register                XR       07          RR  31


      Get Character Input                  **GCI    38          ??? 62


      Jump                                 J        430         RX1 40
      Jump                                 J        430         RX2 40
      Jump                                 J        430         RX3 40
      Jump And Link                        JAL      41          RX1 41
      Jump And Link                        JAL      41          RX2 41
      Jump And Link                        JAL      41          RX3 41
      Jump And Link Register               JALR     01          RR  41
      Jump Backward Short                  JBS      220         SF  40
      Jump Carry                           JC       428         RX1 41
      Jump Carry                           JC       428         RX2 41
      Jump Carry                           JC       428         RX3 41
      Jump Carry Backward Short            JCBS     208         SF  41


      162                                  Appendix A
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            Jump Carry Forward Short             JCFS     218         SF  41
            Jump Carry Register                  JCR      028         RR  41
            Jump Equal                           JE       433         RX1 40
            Jump Equal                           JE       433         RX2 40
            Jump Equal                           JE       433         RX3 40
            Jump Equal Backward Short            JEBS     223         SF  40
            Jump Equal Forward Short             JEFS     233         SF  40
            Jump Equal Register                  JER      033         RR  40
            Jump False Backward Short            JFBS     22M         SF  39
            Jump False Forward Short             JFFS     23M         SF  39
            Jump Find First One                  JFFO     31          SF  41
            Jump Find First One Halfword         JFFOH    33          SF  41
            Jump Forward Short                   JFS      230         SF  40
            Jump Greater                         JG       422         RX1 40
            Jump Greater                         JG       422         RX2 40
            Jump Greater                         JG       422         RX3 40
            Jump Greater Backward Short          JGBS     202         SF  40
            Jump Greater Equal                   JGE      431         RX1 40
            Jump Greater Equal                   JGE      431         RX2 40
            Jump Greater Equal                   JGE      431         RX3 40
            Jump Greater Equal Backward Short    JGEBS    221         SF  40
            Jump Greater Equal Forward Short     JGEFS    231         SF  40
            Jump Greater Equal Register          JGER     031         RR  40
            Jump Greater Forward Short           JGFS     212         SF  40
            Jump Greater Register                JGR      022         RR  40
            Jump Less                            JL       421         RX1 41
            Jump Less                            JL       421         RX2 41
            Jump Less                            JL       421         RX3 41
            Jump Less Backward Short             JLBS     201         SF  41
            Jump Less Equal                      JLE      432         RX1 40
            Jump Less Equal                      JLE      432         RX2 40
            Jump Less Equal                      JLE      432         RX3 40
            Jump Less Equal Backward Short       JLEBS    222         SF  40
            Jump Less Equal Forward Short        JLEFS    232         SF  40
            Jump Less Equal Register             JLER     032         RR  40
            Jump Less Forward Short              JLFS     211         SF  41
            Jump Less Register                   JLR      021         RR  41
            Jump No Carry                        JNC      438         RX1 41
            Jump No Carry                        JNC      438         RX2 41
            Jump No Carry                        JNC      438         RX3 41
            Jump No Carry Backward Short         JNCBS    228         SF  41
            Jump No Carry Forward Short          JNCFS    238         SF  41
            Jump No Carry Register               JNCR     038         RR  41
            Jump Not equal                       JN       423         RX1 40
            Jump Not equal                       JN       423         RX2 40
            Jump Not equal                       JN       423         RX3 40
            Jump Not equal Backward Short        JNBS     203         SF  40
            Jump Not equal Forward Short         JNFS     213         SF  40
            Jump Not equal Register              JNR      023         RR  40
            Jump on False condition              JF       43M         RX1 39
            Jump on False condition              JF       43M         RX2 39
            Jump on False condition              JF       43M         RX3 39
            Jump on False condition Register     JFR      03M         RR  39
            Jump on True condition               JT       42M         RX1 39


            ALPHABETICAL SUMMARY OF THE ENGINE INSTRUCTION SET                               163
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      Jump on True condition               JT       42M         RX2 39
      Jump on True condition               JT       42M         RX3 39
      Jump on True condition Register      JTR      02M         RR  39
      Jump Register                        JR       030         RR  40
      Jump True Backward Short             JTBS     20M         SF  39
      Jump True Forward Short              JTFS     21M         SF  39


      Load                                 L        58          RX1 23
      Load                                 L        58          RX2 23
      Load                                 L        58          RX3 23
      Load Address                         LA       E6          RX1 24
      Load Address                         LA       E6          RX2 24
      Load Address                         LA       E6          RX3 24
      Load Byte                            LB       D3          RX1 25
      Load Byte                            LB       D3          RX2 25
      Load Byte                            LB       D3          RX3 25
      Load Byte Register                   LBR      93          RR  25
      Load Complement Short                LCS      25          SF  23
      Load Halfword                        LH       48          RX1 23
      Load Halfword                        LH       48          RX2 23
      Load Halfword                        LH       48          RX3 23
      Load Halfword Immediate              LHI      C8          RI1 23
      Load Halfword Logical                LHL      73          RX1 24
      Load Halfword Logical                LHL      73          RX2 24
      Load Halfword Logical                LHL      73          RX3 24
      Load Halfword Register               LHR      12          RR  48
      Load Immediate                       LI       F8          RI2 23
      Load Immediate Short                 LIS      24          SF  23
      Load Multiple                        LM       D1          RX1 25
      Load Multiple                        LM       D1          RX2 25
      Load Multiple                        LM       D1          RX3 25
      Load Program Status Word             LPSW     C2          RX1 51
      Load Program Status Word             LPSW     C2          RX2 51
      Load Program Status Word             LPSW     C2          RX3 51
      Load Program Status Word Register    LPSWR    18          RR  51
      Load Register                        LR       08          RR  23


      Multiply                             M        5C          RX1 46
      Multiply                             M        5C          RX2 46
      Multiply                             M        5C          RX3 46
      Multiply Halfword                    MH       4C          RX1 46
      Multiply Halfword                    MH       4C          RX2 46
      Multiply Halfword                    MH       4C          RX3 46
      Multiply Halfword Register           MHR      0C          RR  46
      Multiply Register                    MR       1C          RR  46


      No OPeration                         NOP      420         RX1 40
      No OPeration                         NOP      420         RX2 40
      No OPeration                         NOP      420         RX3 40
      No OPeration Register                NOPR     020         RR  40



      164                                  Appendix A
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            Or Halfword                          OH       46          RX1 31
            Or Halfword                          OH       46          RX2 31
            Or Halfword                          OH       46          RX3 31
            Or Halfword Immediate                OHI      C6          RI1 31
            Or Immediate                         OI       F6          RI2 31
            Or Register                          OR       06          RR  31
            Or word                              O        56          RX1 31
            Or word                              O        56          RX2 31
            Or word                              O        56          RX3 31
            Output Command                       OC       DE          RX1 54
            Output Command                       OC       DE          RX2 54
            Output Command                       OC       DE          RX3 54
            Output Command Register              OCR      9E          RR  54


            Read Data                            RDR      9B          RR  55
            Reset BiT                            RBT      76          RX1 37
            Reset BiT                            RBT      76          RX2 37
            Reset BiT                            RBT      76          RX3 37
            RMAKE Copy 1                         **RMA1   0E          ??? 62
            RMAKE Copy 2                         **RMA2   0F          ??? 62
            Rotate Left Logical                  RLL      EB          RI1 34
            Rotate Right Logical                 RRL      EA          RI1 35
            RTD Copy 1                           **RTD1   3B          ??? 62
            RTD Copy 2                           **RTD2   3C          ??? 62


            Scan Sync input                      **SCAN   35          RR  61
            Sense Status Register                SSR      9D          RR  54
            Set BiT                              SBT      75          RX1 36
            Set BiT                              SBT      75          RX2 36
            Set BiT                              SBT      75          RX3 36
            Shift Left Halfword Logical          SLHL     CD          RI1 33
            Shift Left Halfword Logical Short    SLHLS    91          SF  33
            Shift Left Logical                   SLL      ED          RI1 33
            Shift Left Logical Short             SLLS     11          SF  33
            Shift Right Arithmetic               SRA      EE          RX1 48
            Shift Right Arithmetic               SRA      EE          RX2 48
            Shift Right Arithmetic               SRA      EE          RX3 48
            Shift Right Halfword Logical         SRHL     CC          RI1 34
            Shift Right Halfword Logical Short   SRHLS    90          SF  34
            Shift Right Logical                  SRL      EC          RI1 33
            Shift Right Logical Short            SRLS     10          SF  33
            Start Baud                           **SBOD   13          RR  57
            Start Baud Input                     **GCHAR  16          RR  57
            Start Baud Output                    **XMIT   14          RR  57
            Start Baud TID                       **SPM    15          RR  57
            STore                                ST       50          RX1 27
            STore                                ST       50          RX2 27
            STore                                ST       50          RX3 27
            STore Byte                           STB      D2          RX1 28
            STore Byte                           STB      D2          RX2 28
            STore Byte                           STB      D2          RX3 28
            STore Byte Register                  STBR     92          RR  28


            ALPHABETICAL SUMMARY OF THE ENGINE INSTRUCTION SET                               165
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      STore Halfword                       STH      40          RX1 27
      STore Halfword                       STH      40          RX2 27
      STore Halfword                       STH      40          RX3 27
      STore Multiple                       STM      D0          RX1 27
      STore Multiple                       STM      D0          RX2 27
      STore Multiple                       STM      D0          RX3 27
      Subtract                             S        5B          RX1 44
      Subtract                             S        5B          RX2 44
      Subtract                             S        5B          RX3 44
      Subtract Halfword                    SH       4B          RX1 44
      Subtract Halfword                    SH       4B          RX2 44
      Subtract Halfword                    SH       4B          RX3 44
      Subtract Halfword Immediate          SHI      CB          RI1 44
      Subtract Immediate                   SI       FB          RI2 44
      Subtract Immediate Short             SIS      27          SF  44
      Subtract Register                    SR       0B          RR  44
      SuperVisor Call                      SVC      E1          RX1 52
      SuperVisor Call                      SVC      E1          RX2 52
      SuperVisor Call                      SVC      E1          RX3 52


      Test and Set                         TS       E0          RX1 35
      Test and Set                         TS       E0          RX2 35
      Test and Set                         TS       E0          RX3 35
      Test BiT                             TBT      74          RX1 36
      Test BiT                             TBT      74          RX2 36
      Test BiT                             TBT      74          RX3 36
      Test Halfword Immediate              THI      C3          RI1 32
      Test Immediate                       TI       F3          RI2 32


      User Program Status Word             UPSW     D5          RX1 51
      User Program Status Word             UPSW     D5          RX2 51
      User Program Status Word             UPSW     D5          RX3 51


      Write Character Input                **WCI    39          ??? 62
      Write Data                           WD       DA          RX1 55
      Write Data                           WD       DA          RX2 55
      Write Data                           WD       DA          RX3 55
      Write Data Register                  WDR      9A          RR  55















      166                                  Appendix A
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983



                                                 Appendix B                                                 Appendix B                                                 Appendix B                                                 Appendix B

                               NUMERIC SUMMARY OF THE ENGINE INSTRUCTION SET                               NUMERIC SUMMARY OF THE ENGINE INSTRUCTION SET                               NUMERIC SUMMARY OF THE ENGINE INSTRUCTION SET                               NUMERIC SUMMARY OF THE ENGINE INSTRUCTION SET





            020   NOPR     No OPeration Register                      RR  40
            021   JLR      Jump Less Register                         RR  41
            022   JGR      Jump Greater Register                      RR  40
            023   JNR      Jump Not equal Register                    RR  40
            028   JCR      Jump Carry Register                        RR  41
            030   JR       Jump Register                              RR  40
            031   JGER     Jump Greater Equal Register                RR  40
            032   JLER     Jump Less Equal Register                   RR  40
            033   JER      Jump Equal Register                        RR  40
            038   JNCR     Jump No Carry Register                     RR  41


            201   JLBS     Jump Less Backward Short                   SF  41
            202   JGBS     Jump Greater Backward Short                SF  40
            203   JNBS     Jump Not equal Backward Short              SF  40
            208   JCBS     Jump Carry Backward Short                  SF  41
            211   JLFS     Jump Less Forward Short                    SF  41
            212   JGFS     Jump Greater Forward Short                 SF  40
            213   JNFS     Jump Not equal Forward Short               SF  40
            218   JCFS     Jump Carry Forward Short                   SF  41
            220   JBS      Jump Backward Short                        SF  40
            221   JGEBS    Jump Greater Equal Backward Short          SF  40
            222   JLEBS    Jump Less Equal Backward Short             SF  40
            223   JEBS     Jump Equal Backward Short                  SF  40
            228   JNCBS    Jump No Carry Backward Short               SF  41
            230   JFS      Jump Forward Short                         SF  40
            231   JGEFS    Jump Greater Equal Forward Short           SF  40
            232   JLEFS    Jump Less Equal Forward Short              SF  40
            233   JEFS     Jump Equal Forward Short                   SF  40
            238   JNCFS    Jump No Carry Forward Short                SF  41


            420   NOP      No OPeration                               RX1 40
            420   NOP      No OPeration                               RX2 40
            420   NOP      No OPeration                               RX3 40
            421   JL       Jump Less                                  RX1 41
            421   JL       Jump Less                                  RX2 41
            421   JL       Jump Less                                  RX3 41
            422   JG       Jump Greater                               RX1 40
            422   JG       Jump Greater                               RX2 40
            422   JG       Jump Greater                               RX3 40
            423   JN       Jump Not equal                             RX1 40
            423   JN       Jump Not equal                             RX2 40
            423   JN       Jump Not equal                             RX3 40
            428   JC       Jump Carry                                 RX1 41


            NUMERIC SUMMARY OF THE ENGINE INSTRUCTION SET                                    167
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      428   JC       Jump Carry                                 RX2 41
      428   JC       Jump Carry                                 RX3 41
      430   J        Jump                                       RX1 40
      430   J        Jump                                       RX2 40
      430   J        Jump                                       RX3 40
      431   JGE      Jump Greater Equal                         RX1 40
      431   JGE      Jump Greater Equal                         RX2 40
      431   JGE      Jump Greater Equal                         RX3 40
      432   JLE      Jump Less Equal                            RX1 40
      432   JLE      Jump Less Equal                            RX2 40
      432   JLE      Jump Less Equal                            RX3 40
      433   JE       Jump Equal                                 RX1 40
      433   JE       Jump Equal                                 RX2 40
      433   JE       Jump Equal                                 RX3 40
      438   JNC      Jump No Carry                              RX1 41
      438   JNC      Jump No Carry                              RX2 41
      438   JNC      Jump No Carry                              RX3 41


      01    JALR     Jump And Link Register                     RR  41
      02M   JTR      Jump on True condition Register            RR  39
      03M   JFR      Jump on False condition Register           RR  39
      04    NR       aNd Register                               RR  30
      05    CLR      Compare Logical Register                   RR  29
      06    OR       Or Register                                RR  31
      07    XR       eXclusive or Register                      RR  31
      08    LR       Load Register                              RR  23
      09    CR       Compare Register                           RR  45
      0A    AR       Add Register                               RR  43
      0B    SR       Subtract Register                          RR  44
      0C    MHR      Multiply Halfword Register                 RR  46
      0D    DHR      Divide Halfword Register                   RR  47
      0E    **RMA1   RMAKE Copy 1                               ??? 62
      0F    **RMA2   RMAKE Copy 2                               ??? 62


      10    SRLS     Shift Right Logical Short                  SF  33
      11    SLLS     Shift Left Logical Short                   SF  33
      12    LHR      Load Halfword Register                     RR  48
      12    CHVR     Convert Halfword Value Register            RR  48
      13    **SBOD   Start Baud                                 RR  57
      14    **XMIT   Start Baud Output                          RR  57
      15    **SPM    Start Baud TID                             RR  57
      16    **GCHAR  Start Baud Input                           RR  57
      18    LPSWR    Load Program Status Word Register          RR  51
      1C    MR       Multiply Register                          RR  46
      1D    DR       Divide Register                            RR  47


      20M   JTBS     Jump True Backward Short                   SF  39
      21M   JTFS     Jump True Forward Short                    SF  39
      22M   JFBS     Jump False Backward Short                  SF  39
      23M   JFFS     Jump False Forward Short                   SF  39
      24    LIS      Load Immediate Short                       SF  23


      168                                  Appendix B
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            25    LCS      Load Complement Short                      SF  23
            26    AIS      Add Immediate Short                        SF  43
            27    SIS      Subtract Immediate Short                   SF  44


            31    JFFO     Jump Find First One                        SF  41
            33    JFFOH    Jump Find First One Halfword               SF  41
            34    EXHR     EXchange Halfword Register                 RR  26
            35    **SCAN   Scan Sync input                            RR  61
            36    **ALIGN  Align Sync input                           RR  61
            37    **CKSUM  Checksum Sync input                        RR  61
            38    **GCI    Get Character Input                        ??? 62
            39    **WCI    Write Character Input                      ??? 62
            3A    **CBCT   Compute BCT                                ??? 62
            3B    **RTD1   RTD Copy 1                                 ??? 62
            3C    **RTD2   RTD Copy 2                                 ??? 62
            3E     *ARAND   ARray AND                                  R?? 32
            3F    **COPY   COPY memory                                R?  28


            40    STH      STore Halfword                             RX1 27
            40    STH      STore Halfword                             RX2 27
            40    STH      STore Halfword                             RX3 27
            41    JAL      Jump And Link                              RX1 41
            41    JAL      Jump And Link                              RX2 41
            41    JAL      Jump And Link                              RX3 41
            42M   JT       Jump on True condition                     RX1 39
            42M   JT       Jump on True condition                     RX2 39
            42M   JT       Jump on True condition                     RX3 39
            43M   JF       Jump on False condition                    RX1 39
            43M   JF       Jump on False condition                    RX2 39
            43M   JF       Jump on False condition                    RX3 39
            44    NH       aNd Halfword                               RX1 30
            44    NH       aNd Halfword                               RX2 30
            44    NH       aNd Halfword                               RX3 30
            45    CLH      Compare Logical Halfword                   RX1 29
            45    CLH      Compare Logical Halfword                   RX2 29
            45    CLH      Compare Logical Halfword                   RX3 29
            46    OH       Or Halfword                                RX1 31
            46    OH       Or Halfword                                RX2 31
            46    OH       Or Halfword                                RX3 31
            47    XH       eXclusive or Halfword                      RX1 31
            47    XH       eXclusive or Halfword                      RX2 31
            47    XH       eXclusive or Halfword                      RX3 31
            48    LH       Load Halfword                              RX1 23
            48    LH       Load Halfword                              RX2 23
            48    LH       Load Halfword                              RX3 23
            49    CH       Compare Halfword                           RX1 45
            49    CH       Compare Halfword                           RX2 45
            49    CH       Compare Halfword                           RX3 45
            4A    AH       Add Halfword                               RX1 43
            4A    AH       Add Halfword                               RX2 43
            4A    AH       Add Halfword                               RX3 43
            4B    SH       Subtract Halfword                          RX1 44


            NUMERIC SUMMARY OF THE ENGINE INSTRUCTION SET                                    169
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      4B    SH       Subtract Halfword                          RX2 44
      4B    SH       Subtract Halfword                          RX3 44
      4C    MH       Multiply Halfword                          RX1 46
      4C    MH       Multiply Halfword                          RX2 46
      4C    MH       Multiply Halfword                          RX3 46
      4D    DH       Divide Halfword                            RX1 47
      4D    DH       Divide Halfword                            RX2 47
      4D    DH       Divide Halfword                            RX3 47


      50    ST       STore                                      RX1 27
      50    ST       STore                                      RX2 27
      50    ST       STore                                      RX3 27
      51    AM       Add to Memory                              RX1 44
      51    AM       Add to Memory                              RX2 44
      51    AM       Add to Memory                              RX3 44
      54    N        aNd                                        RX1 30
      54    N        aNd                                        RX2 30
      54    N        aNd                                        RX3 30
      55    CL       Compare Logical                            RX1 29
      55    CL       Compare Logical                            RX2 29
      55    CL       Compare Logical                            RX3 29
      56    O        Or word                                    RX1 31
      56    O        Or word                                    RX2 31
      56    O        Or word                                    RX3 31
      57    X        eXclusive or                               RX1 31
      57    X        eXclusive or                               RX2 31
      57    X        eXclusive or                               RX3 31
      58    L        Load                                       RX1 23
      58    L        Load                                       RX2 23
      58    L        Load                                       RX3 23
      59    C        Compare                                    RX1 45
      59    C        Compare                                    RX2 45
      59    C        Compare                                    RX3 45
      5A    A        Add                                        RX1 43
      5A    A        Add                                        RX2 43
      5A    A        Add                                        RX3 43
      5B    S        Subtract                                   RX1 44
      5B    S        Subtract                                   RX2 44
      5B    S        Subtract                                   RX3 44
      5C    M        Multiply                                   RX1 46
      5C    M        Multiply                                   RX2 46
      5C    M        Multiply                                   RX3 46
      5D    D        Divide                                     RX1 47
      5D    D        Divide                                     RX2 47
      5D    D        Divide                                     RX3 47


      61    AHM      Add Halfword to Memory                     RX1 44
      61    AHM      Add Halfword to Memory                     RX2 44
      61    AHM      Add Halfword to Memory                     RX3 44





      170                                  Appendix B
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


            73    LHL      Load Halfword Logical                      RX1 24
            73    LHL      Load Halfword Logical                      RX2 24
            73    LHL      Load Halfword Logical                      RX3 24
            74    TBT      Test BiT                                   RX1 36
            74    TBT      Test BiT                                   RX2 36
            74    TBT      Test BiT                                   RX3 36
            75    SBT      Set BiT                                    RX1 36
            75    SBT      Set BiT                                    RX2 36
            75    SBT      Set BiT                                    RX3 36
            76    RBT      Reset BiT                                  RX1 37
            76    RBT      Reset BiT                                  RX2 37
            76    RBT      Reset BiT                                  RX3 37
            77    CBT      Complement BiT                             RX1 37
            77    CBT      Complement BiT                             RX2 37
            77    CBT      Complement BiT                             RX3 37


            90    SRHLS    Shift Right Halfword Logical Short         SF  34
            91    SLHLS    Shift Left Halfword Logical Short          SF  33
            92    STBR     STore Byte Register                        RR  28
            93    LBR      Load Byte Register                         RR  25
            94    EXBR     EXchange Byte Register                     RR  26
            95    EPSR     Exchange Program Status Register           RR  51
            99    CIO      Console IO                                 RR  53
            9A    WDR      Write Data Register                        RR  55
            9B    RDR      Read Data                                  RR  55
            9D    SSR      Sense Status Register                      RR  54
            9E    OCR      Output Command Register                    RR  54


            C2    LPSW     Load Program Status Word                   RX1 51
            C2    LPSW     Load Program Status Word                   RX2 51
            C2    LPSW     Load Program Status Word                   RX3 51
            C3    THI      Test Halfword Immediate                    RI1 32
            C4    NHI      aNd Halfword Immediate                     RI1 30
            C5    CLHI     Compare Logical Halfword Immediate         RI1 29
            C6    OHI      Or Halfword Immediate                      RI1 31
            C7    XHI      eXclusive or Halfword Immediate            RI1 31
            C8    LHI      Load Halfword Immediate                    RI1 23
            C9    CHI      Compare Halfword Immediate                 RI1 45
            CA    AHI      Add Halfword Immediate                     RI1 43
            CB    SHI      Subtract Halfword Immediate                RI1 44
            CC    SRHL     Shift Right Halfword Logical               RI1 34
            CD    SLHL     Shift Left Halfword Logical                RI1 33


            D0    STM      STore Multiple                             RX1 27
            D0    STM      STore Multiple                             RX2 27
            D0    STM      STore Multiple                             RX3 27
            D1    LM       Load Multiple                              RX1 25
            D1    LM       Load Multiple                              RX2 25
            D1    LM       Load Multiple                              RX3 25
            D2    STB      STore Byte                                 RX1 28
            D2    STB      STore Byte                                 RX2 28


            NUMERIC SUMMARY OF THE ENGINE INSTRUCTION SET                                    171
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


      D2    STB      STore Byte                                 RX3 28
      D3    LB       Load Byte                                  RX1 25
      D3    LB       Load Byte                                  RX2 25
      D3    LB       Load Byte                                  RX3 25
      D4    CLB      Compare Logical Byte                       RX1 29
      D4    CLB      Compare Logical Byte                       RX2 29
      D4    CLB      Compare Logical Byte                       RX3 29
      D5    UPSW     User Program Status Word                   RX1 51
      D5    UPSW     User Program Status Word                   RX2 51
      D5    UPSW     User Program Status Word                   RX3 51
      DA    WD       Write Data                                 RX1 55
      DA    WD       Write Data                                 RX2 55
      DA    WD       Write Data                                 RX3 55
      DE    OC       Output Command                             RX1 54
      DE    OC       Output Command                             RX2 54
      DE    OC       Output Command                             RX3 54


      E0    TS       Test and Set                               RX1 35
      E0    TS       Test and Set                               RX2 35
      E0    TS       Test and Set                               RX3 35
      E1    SVC      SuperVisor Call                            RX1 52
      E1    SVC      SuperVisor Call                            RX2 52
      E1    SVC      SuperVisor Call                            RX3 52
      E6    LA       Load Address                               RX1 24
      E6    LA       Load Address                               RX2 24
      E6    LA       Load Address                               RX3 24
      EA    RRL      Rotate Right Logical                       RI1 35
      EB    RLL      Rotate Left Logical                        RI1 34
      EC    SRL      Shift Right Logical                        RI1 33
      ED    SLL      Shift Left Logical                         RI1 33
      EE    SRA      Shift Right Arithmetic                     RX1 48
      EE    SRA      Shift Right Arithmetic                     RX2 48
      EE    SRA      Shift Right Arithmetic                     RX3 48


      F3    TI       Test Immediate                             RI2 32
      F4    NI       aNd Immediate                              RI2 30
      F5    CLI      Compare Logical Immediate                  RI2 29
      F6    OI       Or Immediate                               RI2 31
      F7    XI       eXclusive or Immediate                     RI2 31
      F8    LI       Load Immediate                             RI2 23
      F9    CI       Compare Immediate                          RI2 45
      FA    AI       Add Immediate                              RI2 43
      FB    SI       Subtract Immediate                         RI2 44











      172                                  Appendix B
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983




                                                   NOTES                                                   NOTES                                                   NOTES                                                   NOTES



            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________
            ____________________________________________________________________________________


            NUMERIC SUMMARY OF THE ENGINE INSTRUCTION SET                                    173
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983




                                             NOTES                                             NOTES                                             NOTES                                             NOTES



      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________
      ____________________________________________________________________________________


      174                                  Appendix B
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983


                                                   Index                                                   Index                                                   Index                                                   Index




            001A DEAD  13                               Address Counter (Line Scan)  85
            0020 DEAD  13                               Address Switches  93, 96
            0060 DEAD  13                               Addressing and Control  85
            0100 DEAD  13                               Addressing and Operation  89
            0160 DEAD  13                               ALU (Arithmetic and Logic Unit)  69
            01A0 DEAD  13                               ASYNC-ENHANCED MICROCODE ENABLE  4
            01A8 DEAD  13
            01E9 DEAD  13
            0201 DEAD  13                               B Bus and Interrupt Control  98
            02XX DEAD  13                               B BUS DESTINATION OR SPECIAL FUNCTION
                                                           SELECT  104
                                                        B BUS SOURCE  105
            16 By 16 Input Buffer Memory  87            B SELECT FOR 2901 RAM  111
            16 By 16 Output Buffer Memory  86           B-Destination and Special Function
            1K x 16 RAM  98                                Decode  99
            1K x 40 PROM  98                            B-Source Decode  100
                                                        Board Address Decode  90
                                                        Board Address MUX  85
            2901 Microprocessor and Carry Logic  100    Bus Drivers  87
            2910 Address Sequencer  100                 BUSEN0 Generator  90
            2:1 MUX  100

                                                        Carry Bit Control MUX  70
            32 By 16 Working Memory  86                 CARRY FLAG  6
            3600 Baud Interrupt  83                     CARRY INPUT FOR 2901'S  109
            3600 Baud Interrupter  134                  Channel Counter  98
                                                        Clock Decoder  90
                                                        Clock Driver  101
            4:1 MUX  70                                 Clock Last State and Interrupt Pending
                                                           Flag 32 By 2 Memory  85
                                                        Clock Transition Detector  86
            8.064 MHz Oscillator  100                   CONDITION CODE  5
            8:1 MUX  70                                 Console Control Register  75
            8:1 MUX Select  72                          Console Register  75
                                                        Constant Register  75
                                                        CONSTANT SOURCE FOR B BUS  109
            A SELECT FOR 2901  104                      Control Signal Generator A-D  93
            AC Voltage Sensor  83                       CPU Address Decode/Latch  85
            Address and Control Latch/Decode  83
            Address Comparator  96
            Address Comparator, Decoder, and            Data Bus Buffer  90
               Latch  93                                Data Output  93









            Index                                                                            175
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983







      Data Register  94                           Last Bit Detect  86
      DEAD 0BAD  13                               Latch  98
      DESTINATION CONTROL FOR 2901  108           Latch A2  96
      Device Address Latch  90                    Latch A3  96
      DMA Address Latch  80                       Latch B2  96
      DMA Data Latch  79                          Latch B3  96
      DMA Start  98                               Latch C3  96
      DMA Timing and Control  80                  Latch PROM Data  99
      DR0/SR0 Encoder and SYN0 Generator  93      LATCHED PROM DATA ADDRESS TO 2910  111
                                                  LESS THAN ZERO FLAG  6
                                                  Limit Comparator  79
      Early Power Down Interrupt  133             Loader Storage Unit  83


      Fetch Address  79                           MAC Control Register  80
                                                  MAC Timing and Control  80
                                                  MACHINE MALFUNCTION INTERRUPT ENABLE  4
      Gates  98                                   Mapping PROM  75
      GREATER THAN ZERO FLAG  6                   Mask Field Decode  72
                                                  Master Clear/Buffer Clear Generator  94
                                                  Memory Address Register  79
      Hex Displays  98                            Memory Counter  70
                                                  Memory Data Bus Source Decoder  80
                                                  Memory Data Latch  80
      I/O Control Transceiver  75                 Memory Data Register  75
      I/O Data Transceivers  75                   Memory Parity Error Interrupt  133
      I/O INTERRUPT ENABLE  3                     MEMORY RELOCATION/PROTECTION ENABLE  4
      Input Async Command  128                    Memory Sense Latch  80
      Input Buffer and 8:1 MUX  90                Microcode Parity Checker  76
      Input to Buffer Command  128                MUX's  87
      Instruction Register  75
      Interrupt Address MUX and Latch  75
      Interrupt Control  86                       OPCODE FOR THE 2910 ADDRESS
      Interrupt Device Address Latch  86             SEQUENCER  102
      Interrupt Device Queue and Priority         OPERAND SOURCE CONTROL FOR 2901
         Encode  86                                  MICROPROCESSORS  106
      Interrupt Request  86                       OPERATION CONTROL FOR 2901 ALU  107
                                                  Opto-Isolator and Receiver  94
                                                  Opto-Isolator and Transmitter  94
      Jump Command  128, 129                      Output Async Record Command  129
      Jump on FALSE condition:  39                Output Command Pair  129
      Jump on TRUE condition:  39                 Output HDLC Record  129









      176                                        
            ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983







            Output Latches  90                          Segmentation Register Trap  79
            Overflow Bit and Control MUX  70            Segmentation Registers  79
            OVERFLOW FLAG  6                            Sequence Counter, 8x32 PROM and
                                                           Latch  98
                                                        Sequence Counter, 8x512 PROM and
            Parity Bit Latch  80                           Latch  98
            Parity Checker  80, 101                     Set Input Buffer and Max Record Size
            Parity Error Address  79                       Command  128
            Parity Generator  80                        Shift Register Control Store  69
            Partial Address Decode  79                  SIO CABLE PROM SEQUENCE START
            Power-Up and Initialize  73                    ADDRESS  111
            PRIVILEGED INSTRUCTION DISABLE  5           Status Encoder  93
            Processor Memory Address  79                Status Input  93
            Processor Memory Write Register  75         Status Latches/Drivers  85
            Program Counter  70                         Stop Command  128, 129
            Program Status Word  75                     Sum Bus to B Bus Fast Driver Buffer  70
                                                        Switches On The CPU Board  73
                                                        SX0-3  73
            Quad Bus Transceiver  83                    SYN0 Generator  90
            Quad Bus Transceiver and Latch  96          SYNC-ENHANCED MICROCODE INTERRUPT
            Quad Bus Transceivers  80                      SERVICE ENABLE  5
                                                        System Clock  73

            READ REGISTER 0  121
            READ REGISTER 1  121                        Temperature Sensor  83
            READ REGISTER 2  121                        Test Condition Latch and Decode  100
            Real-Time Clock Interface  83               TEST CONDITION SELECT FOR 2910  110
            Receive Data Receivers/Selectors  85        TRACE BIT  4
            Receiver A-D  93                            Transmit and Receive Clock Selectors  85
            REGISTER SELECTOR IN RAM  111               Transmit Data Latches/Drivers  85
            REGISTER SET SELECT  5                      TTY Interface  83
            Register Stack  72                          TX/RX Latch and MUX  98
            Register Stack Latch  72
            Relocation ALU  79
            ROM  76                                     WAIT BIT  3
            ROM Address Counter  76                     Watch-Dog Timer and Power Fail
            ROM Address MUX  75                            Detect  83
            ROM Data Latch  76                          Working Memory Shift Left and MUX  87
                                                        Working Register and Extended Working
                                                           Register  69
            S1 and S2  90                               WRITE REGISTER 0  114
            Segmentation Register Select  79            WRITE REGISTER 1  116









            Index                                                                            177
      ED MOORING                 TYMNET ENGINE TRAINING MANUAL               June 29, 1983







      WRITE REGISTER 2  117
      WRITE REGISTER 3  117
      WRITE REGISTER 4  118
      WRITE REGISTER 5  119
      WRITE REGISTER 6  119
      WRITE REGISTER 7  119


      YD0-3  73
      YS0-3  73









































      178                                        
@W