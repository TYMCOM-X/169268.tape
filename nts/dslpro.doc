     

                   DOWNSTREAM LOADING PROCEDURES
                        (CES:33)DSLPRO.DOC

     THIS DOCUMENT DISCRIBES THE PROCEDURES USED TO LOAD A VARIAN NODE
     THROUGH THE NETWORK AND MAY BE FOUND IN (CES:33)DSLPRO.DOC .  FOR A
     TECHNICAL DESCRIPTION OF WHAT HAPPENS AND HOW, REFER TO THE FILE
     (CES:33)DSLTCH.DOC .

     1)  THE .REL FILE FOR THE MACHINE MUST BE AVAILABLE ON SYSTEM 33 OR
     36 AND YOU MUST HAVE ACCESS TO IT.  THESE WILL ALWAYS BE
     MAINTAINED IN TYMNET'S DIRECTORY.

     2)  DOWNLINE LOADING OPERATES THROUGH A 201 LINE FROM A NEIGHBOR TO
     THE NODE TO BE LOADED.  NORMALLY THIS IS LINE ZERO ON THE MACHINE
     TO BE LOADED.  YOU MUST KNOW WHICH NODE MUMBER THAT IS THE NEIGHBOR
     ON THIS LINE, AND WHICH LINE NUMBER IT IS ON THAT NEIGHBOR.
     IF SUCH A NEIGHBOR IS NOT AVAILABLE ON LINE ZERO OF THE TARGET
     MACHINE, SELECT THE LOWEST POSSIBLE LINE NUMBER ON THE
     TARGET MACHINE THAT MEETS THE REQUIREMENTS.  IN NO CASE MAY THE
     LINE NUMBER BE GREATER THAN 7 .

     3)  THE CORRECT BOOTSTRAP MUST BE LOADED INTO THE MACHINE.  IF IT
     IS NOT ALREADY LOADED IT MAY BE ENTERED THROUGH THE FRONT PANEL BY
     THE "BOOT" FUNCTION IF THE MACHINE IS A V70 SERIES EQUIPPED WITH
     THE CORRECT PROMS. IF IT IS A 620 SERIES MACHINE THE BOOT MUST BE
     LOADED THROUGH THE FRONT PANEL.  IN THOSE CASES WHERE THE NORMAL
     ASYNC BOOTSTRAP IS IN THE MACHINE AND THERE IS SOMEONE ON SITE TO
     DO THE LOADING, A PROGRAM IS AVAILABLE TO LOAD THE SYNCHRONOUS BOOT
     WITH THE ASYNC BOOT.  REFER TO APPENDIX A FOR THE PROCEDURES ON
     THIS PROGRAM.  LISTINGS OF THE BOOTSTRAP (AND LOADER) ARE AVAILABLE
     ON SYSTEM 33 IN CES'S DIRECTORY:


     XXBOOT.YYY              XX=12  12K BOOT
                                16  16K BOOT
                                24  24K BOOT
                                32  32K BOOT

                             YYY=V72 OR 620


     4)  ONCE THE BOOTSTRAP IS LOADED IT MUST BE SET UP TO RECEIVE ON
     THE CORRECT LINE.  IF THE "DLOAD" COMMAND IS USED (SEE "5") THIS
     WILL BE SET UP AUTOMATICALLY.  ALSO THE BOOTSTRAP LOAD PROGRAM CAN
     SET UP A PRE-MODIFIED BOOT FOR THIS PURPOSE. (SEE APPENDIX A) THE
     PROM BOOTSTRAPS WILL ASSUME LINE ZERO AS A DEFAULT.  IF IT IS

     NECESSARY TO DO THIS MANUALLY THE FOLLOWING ARE THE LOCATIONS THAT
     MUST BE ALTERED:

           LINE  LINE  LINE  LINE  LINE  LINE  LINE  LINE
             0     1     2     3     4     5     6     7
     X7655 50040 50044 50050 50054 50060 50064 50070 50074
     X7656 50042 50046 50052 50056 50062 50066 50072 50076
     X7663 50043 50047 50053 50057 50063 50067 50073 50077
     X7666 50041 50045 50051 50055 50061 50065 50071 50075
     X7770 00021 00023 00025 00027 00031 00033 00035 00037

     X=2 FOR 12K
       3     16K
       5     24K
       7     32K

     5)  THE BOOTSTRAP MUST BE EXECUTED IN THE MACHINE TO BE LOADED. IF
     THE MACHINE IS UP IN THE NET AND THE BOOTSTRAP IS LOADED THE
     MACHINE MAY BE SENT TO THE BOOTSTRAP BY THE "DLOAD" COMMAND. THIS
     IS A PRIVILEGED PROBE COMMAND.  REFER TO PROBE DOCUMENTATION FOR
     THE FORMATS.  THIS COMMAND WILL CAUSE THE MACHINE TO AUTOMATICALLY
     MODIFY THE BOOT FOR THE LINE SPECIFIED IN THE "DLOAD" COMMAND.  THE
     BOOT WILL THEN BE CHECKSUMMED, AND IF CORRECT, EXECUTED.  IF THE
     CHECKSUM IS BAD, THE CONSOLIDATOR LOG WILL DISPLAY THE ERROR AND
     THE NODE WILL REMAIN IN THE NET.  IF THE BOOT MUST BE MANUALLY
     EXECUTED, THE STARTING ADDRESS IS X7640.

     6)  ONCE RUNNING, THE BOOT IS PROTECTED AGAINST POWERFAIL. (THE
     LOADER IS ALSO BUT POWER RESTART WILL RESTART THE BOOT)

     7)  YOU MUST NOW LOG INTO THE NDL SYSTEM AND ENTER:

     GO (NETCON)NLOAD

     A RECORD IS KEPT OF WHO DOES WHAT BY THE PROGRAM.  AT THIS POINT
     THE PROGRAM WILL RETURN WITH A COLON (:) PROMPT, THE OPTIONS
     AVAILABLE ARE:

     L  FOR LOADING NETWORK CODE
     D  FOR DUMPING THE MACHINE
     T  FOR LOADING DIAGNOSTICS

     IF YOU REQUEST A DUMP YOU WILL BE ASKED FOR AN OUTPUT FILE AS WELL
     AS THE STARTING AND ENDING LOCATIONS OF THE DUMP.  THESE NUMBERS
     ARE ENTERED IN OCTAL.  YOU WILL ALSO BE ASKED IF YOU WANT TO LOAD
     THE MACHINE AFTER THE DUMP. IF YOU DO NOT YOU WILL BE GIVEN THE
     OPTION OF DOING A RESTART ON THE MACHINE OR RETURNING TO THE BOOT.
     THE REST OF THE INPUT FOR THE DUMP PROCEEDS LIKE THE LOAD FUNCTION.

     8)  THE LOAD, LOAD DIAGNOSTIC OR DUMP FUNCTION WILL REQUIRE YOU TO
     ENTER THE NEIGHBOR NUMBER AND LINE NUMBER THAT THE DATA IS TO BE
     SENT OUT ON, FROM THAT NEIGHBOR.  EACH OF THEM MUST BE ENTERED
     TWICE TO INSURE AN ACCURATE ENTRY.

     9)  IF YOU ARE USING THE DUMP OR THE LOAD DIAGNOSTIC FUNCTION YOU
     WILL BE ASKED TO ENTER THE CORE SIZE.  IF THE "L" FUNCTION IS USED
     THE PROGRAM WILL FIND THE CORE SIZE FROM THE REL FILE. BE SURE THAT
     THE REL FILE OR THE VALUE YOU ENTER IS CORRECT.

     10)  IF YOU ARE LOADING CODE, THE PROGRAM WILL ASK FOR THE NAME OF
     THE REL FILE.  IF THE FILE NAME EXCEEDS 20 CHARACTERS, THE FILE
     WILL NOT BE OPENED (I.E. "UNABLE TO OPEN FILE CALLED XXXXXX.XXX").
     THE LENGTH OF THE FILE NAME INCLUDES REFERENCES TO OTHER USER
     DIRECTORIES (I.E. (CES)TEST.REL HAS A TOTAL OF 13 CHARACTERS).

     11)  THE REST IS AUTOMATIC. THE PROGRAM WILL READ YOUR REL FILE (IF
     REQUIRED) AS WELL AS THE CORRECT LOADER. YOU WILL BE TOLD THE
     NUMBER OF WORDS TO BE LOADED, THE SIZE OF THE LOADER, THE NODE
     NUMBER AND THE VERSION NUMBER OF THE CODE BEING LOADED.  A CIRCUIT
     WILL BE BUILT TO THE SPECIFIED NEIGHBOR AND YOU WILL BE INFORMED OF
     THIS. THE NEIGHBOR WILL BE PASSED THE LINE NUMBER. IF THE NEIGHBOR
     AGREES, YOU WILL BE INFORMED THAT THE NEIGHBOR HAS ACKNOWLEGED THE
     REQUEST AND A NOTE OF THE FACT WILL APPEAR ON THE CONSOLIDATOR LOG.
     EVERY 40 RECORDS YOU WILL BE INFORMED THAT RECORDS HAVE BEEN
     TRANSMITTED AND ADDITIONALY TOLD HOW MANY HAVE BEEN ACKNOWLEDGED.
     THIS IS TO HELP YOU KEEP TRACK OF THE PROGRESS BEING MADE.
     IT MAY TAKE AS MUCH AS 450 OR MORE RECORDS TO LOAD A MACHINE WHILE
     A DUMP MAY TAKE MUCH MORE.  YOU CAN ESTIMATE THE TOTAL RECORDS BY
     ASSUMING THAT EACH RECORD TRANSFERS 28 WORDS.  REMEMBER THAT DURING
     A LOAD SOME RECORDS WILL NOT BE FULL.

     YOU MAY BE INFORMED THAT THE CIRCUIT IS ZAPPED. THIS COULD BE
     CAUSED BY ONE OF THE FOLLOWING:

     A)  YOU ENTERED THE WRONG LINE NUMBER AND THE NEIGHBOR SAW THAT THE
     LINE WAS NOT DOWN OR THE LINE NUMBER WAS OUT OF RANGE.

     B)  THAT NEIGHBOR IS ALREADY DOING A LOAD AND WILL ALLOW ONLY ONE
     LOAD IN PROGRESS AT A TIME.

     C)  A NODE IN THE LINK HAS FAILED.

     THE HOST MAY BE UNABLE TO BUILD AN AUX CIRCUIT BECAUSE OF
     SUPERVISOR PROBLEMS. (HEAVY LOAD, THE SUP JUST CRASHED OR DOES NOT
     HAVE CONTROL OF THE BASE).  NOTE: YOU CANNOT LOAD A MACHINE THAT
     IS A NEIGHBOR OF THE BASE FOR THE HOST FROM WHICH YOU ARE 
     RUNNING THE NLOAD PROGRAM.

     ONCE THE NEIGHBOR HAS ACKNOWLEGED THE REQUEST, THE LOADER IS SENT
     OUT.  THE HOST WILL WAIT A FEW SECONDS FOR AN ACKNOWLEGEMENT AND IF
     NONE IS RECEIVED IT WILL TELL YOU AND THEN THE LOADER WILL BE
     RESENT EVERY TWENTY SECONDS UNTIL IT IS ACKNOWLEDGED OR ABORTED
     BY THE USER RUNNING NLOAD.  ONCE THE LOADER IS
     RECEIVED SUCCESSFULLY YOU WILL BE INFORMED AND THE LOAD OR DUMP
     WILL PROCEED.  NOTE: ON VERY RARE OCCASIONS, THE NODE MAY
     HAVE RECEIVED AND ACKNOWLEDGED THE LOADER, BUT THE HOST

     PROGRAM NEVER RECEIVES THE ACKNOWLEDGEMENT.  THE HOST PROGRAM
     WILL START RETRANSMITTING THE LOADER, BUT SINCE THE LOADER IS
     RUNNING IN THE TARGET MACHINE, THE DATA THAT IS SENT (LOADER)
     WILL NOT CHECKSUM, CAUSING THE LOADER TO BE RETRANSMITTED
     OVER AND OVER AGAIN.  YOU MAY RECEIVE A WARNING MESSAGE
     THAT 100 ACKS ARE OUTSTANDING BUT THE PROGRAM WILL CONTINUE
     TRYING TO LOAD.  A LARGE NUMBER OF OUTSTANDING ACKS CAN BE
     CAUSED BY THE FOLLOWING REASONS:

     A)  THE NODE BEING LOADED HAS FAILED.

     B)  THE LINK TO THE NEIGHBOR IS LOST.

     C)  THE HOST IS OVERLOADED CAUSING TOO MUCH DELAY BETWEEN RECORDS.

     D)  THE LINE IS EXTREMELY NOISY AND THE DATA CANNOT BE SENT THROUGH
         EASILY.

     IF THE NODE TO BE LOADED FAILS TO HEAR A RECORD WITHIN 53 TO 224
     SECONDS (DEPENDING ON LINE SPEED) IT WILL RETURN TO THE BOOTSTRAP.
     THUS IF ANY OF THE ABOVE ERRORS OCCUR TRY AGAIN IN A FEW MINUTES.
     WHEN ALL THE DATA IS SENT (OR THE REQUESTS IF A DUMP) YOU WILL BE
     INFORMED AND THE PROGRAM WILL WAIT FOR ALL ACKNOWLEGEMENTS TO BE
     RECEIVED. ANY RECORDS NOT RECEIVED WILL BE RETRANSMITTED AND YOU
     WILL BE INFORMED OF THE NUMBER OF RETRANSMISSIONS.  IF YOU ARE
     RUNNING A DUMP FOLLOWED BY A LOAD, THE LOAD WILL BEGIN IMMEDIATLY
     AFTER RETRANSMISSIONS.

     WHEN LOADING IS COMPLETE THE LOADER WILL BE ORDERED TO DO A MANUAL
     RESTART (UNLESS YOU HAVE REQUESTED OTHERWISE AS IN  A DUMP) AND THE
     PROGRAM WILL EXIT.


        APPENDIX I  BOOTSTRAP LOADER

     THIS PROGRAM MAY BE LOADED INTO A VARIAN NODE AND EXECUTED TO
     CREATE A SYNCHRONOUS BOOTSTRAP IN THE MACHINE.  THE PROGRAM
     DETERMINES THE MEMORY SIZE AND I/O ADDRESSES INTERNALLY AND READS
     THE SENSE SWITCHES TO DETERMINE WHAT LINE TO SET UP THE BOOT FOR.

     THE PROGRAM IS LOCATED ON SYSTEM 33 IN THE CES DIRECTORY UNDER THE
     FOLLOWING NAMES:

     SYNCLD.VAS      SOURCE FILE
     SYNCLD.REL      REL FILE
     SYNCLD.CI       CI FILE

     THE PROGRAM MAY BE LOADED EITHER FROM CASSETTE TAPE OR VIA THE
     PROGRAM NETLOA.  BEFORE IT IS LOADED, SET THE SENSE SWITCHES TO THE
     LINE NUMBER YOU INTEND TO RECEIVE THE LOADER ON ( SET THE SENSE
     SWITCHES AS IF THEY WERE AN OCTAL NUMBER, NOT BY THE SENSE SWITCH
     NUMBERS ).  THE PROGRAM WILL EXECUTE UPON LOADING AND WILL BRANCH
     TO THE BOOTSTRAP AS SOON AS IT LOADS IT INTO THE CORRECT PLACE.
   