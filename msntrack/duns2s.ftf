CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C                                                                       C
C       SUBROUTINE: XRNS                                                C
C                                                                       C
C       THIS SUBROUTINE GETS NODE STATISTICS INFORMATION FROM OUTPUT    C
C       FROM THE XRAY NS COMMAND.  THE OUPUT MUST BE IN THE FORMAT OF   C
C       AN ARRAY AS RETURNED FROM THE AXMOUT SUBROUTINE.                C
C                                                                       C
C       FORMAT: CALL XRNS(OUTDEV,NODE,KERNEL,XRHOLD,XRHSIZ,LLINE)       C
C       ARGUMENTS:                                                      C
C           OUTDEV - DEVICE NUMBER TO WRITE DATA TO DISK                C
C           NODE   - NODE DATA WAS COLLECTED FROM                       C
C           KERNEL - KERNEL HOST NUMBER OF NODE                         C
C           XRHOLD: INPUT - ARRAY CONTAINING THE OUTPUT FROM AXMOUT.    C
C           XRHSIZ - MAX NUMBER OF LINES IN XRHOLD.  XRHOLD WILL BE      C
C                    DIMENSIONED TO XRHSIZ * 80.                         C
C           LLINE:  INPUT - LAST LINE OF INFORMATION IN XRHOLD.         C
C                                                                       C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC

        SUBROUTINE XRNS(OUTDV1,CDATE,CTIME,NODE,KERNEL,XRHOLD,
     +  XRHSIZ,LLINE)

        INTEGER XRHSIZ,XRHOLD(XRHSIZ,80),LLINE,OUTDV1,NODE,KERNEL,CDATE,
     1          SDATE(2),STIME,EXCT,EXLW,EXHW,EDHW,EEHW,SYHW,NEHW,NECT,
     2          MPRT,MPAS,MLNK,XCT,NMK,PACK,LCO,LCI,LHO,LHI,ACO,ACI,AHO,
     3          AHI,PCO,PCI,PHO,PHI,CD,HWD,TD,EFF,AP,SYP,QP,HP,SPP,SWP,
     4          LP,DP,SOP,XP,SEP,AM,SYM,QM,HM,SPM,SWM,LM,DM,SOM,XM,SEM,
     5          AA,MA,WA,CLINE,ONELIN(80),OUTDV2,OUTTYP,NAMES(63,3),
     6          EARRAY(63,8),ECOUNT,PAGE,ENDFLG,CTIME,PLCO,PLCI,PLHO,PLHI

        DATA ((NAMES(I,J),J=1,3),I=1,34)/'NODE',' ',' ','KERNE','L',' ',
     +  'CDATE',' ',' ','CTIME',' ',' ','EXCT',' ',' ','EXLW',' ',' ',
     +  'EXHW',' ',' ','EDHW',' ',' ','EEHW',' ',' ','SYHW',' ',' ',
     +  'NEHW',' ',' ','NECT',' ',' ','MPRT',' ',' ','MPAS',' ',' ',
     +  'MLNK',' ',' ','RMK X','CT',' ','RMK N','MK',' ','PACKE','TS',
     +  ' ','LOG L','INK C','PSO','LOG L','INK C','PSI','LOG L','INK H',
     +  'WMO','LOG L','INK H','WMI','PHY L','INK C','PSO','PHY L',
     +  'INK C','PSI','PHY L','INK H','WMO','PHY L','INK H','WMI',
     +  'ASYNC',' CPSO',' ','ASYNC',' CPSI',' ',
     +  'ASYNC',' HWMO',' ','ASYNC',' HWMI',' ','PRINT',' CPSO',' ',
     +  'PRINT',' CPSI',' ','PRINT',' HWMO',' ','PRINT',' HWMI',' '/
        DATA ((NAMES(I,J),J=1,3),I=35,63)/'CODE',
     +  'DELAY',' ','HWARE',' DELA','Y','TOTAL',' DELA','Y',
     +  'EFFIC','IENCY',' ','ASYNC',' %',' ','SYLVR',' %',' ',
     +  'Q-SEC',' %',' ','H-SEC',' %',' ','SPIDR',' %',' ',
     +  'SWICH',' %',' ','LINKR',' %',' ','DWLIN',' %',' ',
     +  'SOURC',' %',' ','X-RAY',' %',' ','1SEC ',' %',' ','ASYNC',
     +  ' MAX',' ','SYLVR',' MAX',' ','Q-SEC',' MAX',' ','H-SEC',' MAX',
     +  ' ','SPIDR',' MAX',' ','SWICH',' MAX',' ','LINKR',' MAX',' ',
     +  'DWLIN',' MAX',' ','SOURC',' MAX',' ','X-RAY',' MAX',' ',
     +  '1SEC ','MAX',' ','AVG A','SY TI','ME','MAX A','SY TI','ME',
     +  'WRAP',' ',' '/

        EXCT=0
        EXLW=0
        EXHW=0
        EDHW=0
        EEHW=0
        SYHW=0
        NEHW=0
        NECT=0
        MPRT=0
        MPAS=0
        MLNK=0
        XCT=0
        NMK=0
        PACK=0
        LCO=0
        LCI=0
        LHO=0
        LHI=0
        PLCO=0
        PLCI=0
        PLHO=0
        PLHI=0
        ACO=0
        ACI=0
        AHO=0
        AHI=0
        PCO=0
        PCI=0
        PHO=0
        PHI=0
        CD=0
        HWD=0
        TD=0
        EFF=0
        AP=0
        SYP=0
        QP=0
        HP=0
        SPP=0
        SWP=0
        LP=0
        DP=0
        SOP=0
        XP=0
        SEP=0
        AM=0
        SYM=0
        QM=0
        HM=0
        SPM=0
        SWM=0
        LM=0
        DM=0
        SOM=0
        SOM=0
        SEM=0
        AA=0
        MA=0
        WA=0

        CLINE=1

CCCCC
C IF THIS LINE BEGINS WITH A BLANK THEN IGNORE IT, UNLESS 2ND CHAR
C IS AN R.
CCCCC
100     IF (XRHOLD(CLINE,1).NE.' '.OR.XRHOLD(CLINE,2).EQ.'R') GOTO 150
        CLINE=CLINE+1
        IF (CLINE.EQ.LLINE)GOTO 900
        GOTO 100

CCCCC
C THIS LINE CONTAINS SOMETHING BESIDES BLANKS. BRANCH ON VALUE OF
C FIRST WORD OF LINE.
CCCCC
150     IF (XRHOLD(CLINE,1).EQ.'E' .AND. XRHOLD(CLINE,2).EQ.'X' .AND.
     1      XRHOLD(CLINE,3).EQ.'C' .AND. XRHOLD(CLINE,4).EQ.'T')
     2     GOTO 200
        IF (XRHOLD(CLINE,1).EQ.' ' .AND. XRHOLD(CLINE,2).EQ.'R' .AND.
     1      XRHOLD(CLINE,3).EQ.'M' .AND. XRHOLD(CLINE,4).EQ.'K')
     2     GOTO 250
        IF (XRHOLD(CLINE,1).EQ.'N' .AND. XRHOLD(CLINE,2).EQ.'O' .AND.
     1      XRHOLD(CLINE,3).EQ.'D' .AND. XRHOLD(CLINE,4).EQ.'E')
     2     GOTO 300
        IF (XRHOLD(CLINE,1).EQ.'A' .AND. XRHOLD(CLINE,2).EQ.'S' .AND.
     1      XRHOLD(CLINE,3).EQ.'Y' .AND. XRHOLD(CLINE,4).EQ.'N')
     2     GOTO 350
        IF (XRHOLD(CLINE,1).EQ.'C' .AND. XRHOLD(CLINE,2).EQ.'O' .AND.
     1      XRHOLD(CLINE,3).EQ.'D' .AND. XRHOLD(CLINE,4).EQ.'E')
     2     GOTO 400
        IF (XRHOLD(CLINE,1).EQ.'P' .AND. XRHOLD(CLINE,2).EQ.'E' .AND.
     1      XRHOLD(CLINE,3).EQ.'R' .AND. XRHOLD(CLINE,4).EQ.'C')
     2     GOTO 450
        IF (XRHOLD(CLINE,1).EQ.'M' .AND. XRHOLD(CLINE,2).EQ.'A' .AND.
     1      XRHOLD(CLINE,3).EQ.'X' .AND. XRHOLD(CLINE,4).EQ.'(')
     2     GOTO 500
        IF (XRHOLD(CLINE,1).EQ.'A' .AND. XRHOLD(CLINE,2).EQ.'V' .AND.
     1      XRHOLD(CLINE,3).EQ.'E' .AND. XRHOLD(CLINE,4).EQ.'R')
     2     GOTO 550
        IF (XRHOLD(CLINE,1).EQ.'P' .AND. XRHOLD(CLINE,2).EQ.'R' .AND.
     1      XRHOLD(CLINE,3).EQ.'I' .AND. XRHOLD(CLINE,4).EQ.'N')
     2     GOTO 600

C       CCCCC
C       C THIS LINE DOESN'T CONTAIN SOMETHING THAT WE ARE LOOKING
C       C FOR, SO CONTINUE
C       CCCCC
        CLINE=CLINE+1
        IF (CLINE.EQ.LLINE) GOTO 900
        GO TO 100

CCCCC
C THE NEXT LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
200     CLINE=CLINE+1
        DO 210 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
210     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THE LINE
C       CCCCC
220     CALL AXISCA(ONELIN,1,EXCT,IERR)
        CALL AXISCA(ONELIN,7,EXLW,IERR)
        CALL AXISCA(ONELIN,13,EXHW,IERR)
        CALL AXISCA(ONELIN,19,EDHW,IERR)
        CALL AXISCA(ONELIN,25,EEHW,IERR)
        CALL AXISCA(ONELIN,31,SYHW,IERR)
        CALL AXISCA(ONELIN,37,NEHW,IERR)
        CALL AXISCA(ONELIN,43,NECT,IERR)
        CALL AXISCA(ONELIN,49,MPRT,IERR)
        CALL AXISCA(ONELIN,55,MPAS,IERR)
        CALL AXISCA(ONELIN,61,MLNK,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
225     CLINE=CLINE+1
        GOTO 100


CCCCC
C THE NEXT LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
250     CLINE=CLINE+1
        DO 255 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
255     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
260     CALL AXISCA(ONELIN,1,XCT,IERR)
        CALL AXISCA(ONELIN,10,NMK,IERR)
        CALL AXISCA(ONELIN,19,PACK,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
270     CLINE=CLINE+1
        GOTO 100

CCCCC
C THE LINE AFTER NEXT CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
300     CPSTYP='L'
        IF (XRHOLD(CLINE,19).EQ.'P') CPSTYP='P'
        CLINE=CLINE+2
        DO 310 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
310     CONTINUE
        IF (CPSTYP.EQ.'P') GOTO 325

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
320     CALL AXISCA(ONELIN,1,LCO,IERR)
        CALL AXISCA(ONELIN,10,LCI,IERR)
        CALL AXISCA(ONELIN,19,LHO,IERR)
        CALL AXISCA(ONELIN,28,LHI,IERR)
        GOTO 330


C       CCCCC
C       C GET ALL PHYSICAL LINK STATISTICS ON THIS LINE
C       CCCCC
325     CALL AXISCA(ONELIN,1,PLCO,IERR)
        CALL AXISCA(ONELIN,10,PLCI,IERR)
        CALL AXISCA(ONELIN,19,PLHO,IERR)
        CALL AXISCA(ONELIN,28,PLHI,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
330     CLINE=CLINE+1
        GOTO 100

CCCCC
C THE NEXT LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
350     CPSTYP='L'
        IF (XRHOLD(CLINE,19).EQ.'P') CPSTYP='P'
        CLINE=CLINE+2
        DO 355 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
355     CONTINUE
        IF (CPSTYP.EQ.'P') GOTO 325

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
360     CALL AXISCA(ONELIN,1,ACO,IERR)
        CALL AXISCA(ONELIN,10,ACI,IERR)
        CALL AXISCA(ONELIN,19,AHO,IERR)
        CALL AXISCA(ONELIN,28,AHI,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
370     CLINE=CLINE+1
        GOTO 100

CCCCC
C THE NEXT LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
400     CLINE=CLINE+1
        DO 410 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
410     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
420     CALL AXISCA(ONELIN,5,CD,IERR)
        CALL AXISCA(ONELIN,19,HWD,IERR)
        CALL AXISCA(ONELIN,33,TD,IERR)
        CALL AXISCA(ONELIN,47,EFF,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
430     CLINE=CLINE+1
        GOTO 100

CCCCC
C THIS LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
450     DO 455 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
455     CONTINUE

C       CCCCC
C       C BEFORE GETTING THE INFORMATION, IT MUST BE DETERMINED WHETHER OR
C       C NOT THE LINE CONTAINS ASYNC INFORMATION.  THE FORMAT OF THE LINE
C       C DIFFERS IF THE LINE CONTAINS ASYNC INFORMATION.
C       C IF THE LINE DOES CONTAIN ASYNC INFORMATION, THEN THE LINE WHICH
C       C PRECEEDS THIS ONE WILL HAVE THE WORD 'ASYNC' BEGINNING AT THE
C       C 10TH POSTION IN THE LINE.
C       CCCCC
        ICHAR=XRHOLD(CLINE-1,10)
        IF (ICHAR.NE.'A') GOTO 465

C       CCCCC
C       C THIS LINE DOES CONTAIN ASYNC INFORMATION
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
460     CALL AXISCA(ONELIN,12,AP,IERR)
        CALL AXISCA(ONELIN,18,SYP,IERR)
        CALL AXISCA(ONELIN,24,QP,IERR)
        CALL AXISCA(ONELIN,30,HP,IERR)
        CALL AXISCA(ONELIN,36,SPP,IERR)
        CALL AXISCA(ONELIN,42,SWP,IERR)
        CALL AXISCA(ONELIN,48,LP,IERR)
        CALL AXISCA(ONELIN,54,DP,IERR)
        CALL AXISCA(ONELIN,60,SOP,IERR)
        CALL AXISCA(ONELIN,66,XP,IERR)
        CALL AXISCA(ONELIN,72,SEP,IERR)
        GOTO 470

C       CCCCC
C       C THIS LINE DOES NOT CONTAIN ASYNC INFORMATION
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
465     CALL AXISCA(ONELIN,12,SYP,IERR)
        CALL AXISCA(ONELIN,18,HP,IERR)
        CALL AXISCA(ONELIN,24,SPP,IERR)
        CALL AXISCA(ONELIN,30,SWP,IERR)
        CALL AXISCA(ONELIN,36,LP,IERR)
        CALL AXISCA(ONELIN,42,DP,IERR)
        CALL AXISCA(ONELIN,48,SOP,IERR)
        CALL AXISCA(ONELIN,54,XP,IERR)
        CALL AXISCA(ONELIN,60,SEP,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
470     CLINE=CLINE+1
        GOTO 100

CCCCC
C THIS LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
500     DO 510 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
510     CONTINUE

C       CCCCC
C       C BEFORE GETTING THE INFORMATION, IT MUST BE DETERMINED WHETHER OR
C       C NOT THE LINE CONTAINS ASYNC INFORMATION.  THE FORMAT OF THE LINE
C       C DIFFERS IF THE LINE CONTAINS ASYNC INFORMATION.
C       C IF THE LINE DOES CONTAIN ASYNC INFORMATION, THEN THE LINE 2 LINES
C       C ABOVE THIS ONE WILL HAVE THE WORD 'ASYNC' BEGINNING AT THE
C       C 10TH POSTION IN THE LINE.
C       CCCCC
        ICHAR=XRHOLD(CLINE-2,10)
        IF (ICHAR.NE.'A') GOTO 525

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
520     CALL AXISCA(ONELIN,10,AM,IERR)
        CALL AXISCA(ONELIN,16,SYM,IERR)
        CALL AXISCA(ONELIN,22,QM,IERR)
        CALL AXISCA(ONELIN,28,HM,IERR)
        CALL AXISCA(ONELIN,34,SPM,IERR)
        CALL AXISCA(ONELIN,40,SWM,IERR)
        CALL AXISCA(ONELIN,46,LM,IERR)
        CALL AXISCA(ONELIN,52,DM,IERR)
        CALL AXISCA(ONELIN,58,SOM,IERR)
        CALL AXISCA(ONELIN,64,XM,IERR)
        CALL AXISCA(ONELIN,70,SEM,IERR)
        GO TO 530

C       CCCCC
C       C THIS LINE DOES NOT CONTAIN ASYNC INFORMATION
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
525     CALL AXISCA(ONELIN,10,SYM,IERR)
        CALL AXISCA(ONELIN,16,HM,IERR)
        CALL AXISCA(ONELIN,22,SPM,IERR)
        CALL AXISCA(ONELIN,28,SWM,IERR)
        CALL AXISCA(ONELIN,34,LM,IERR)
        CALL AXISCA(ONELIN,40,DM,IERR)
        CALL AXISCA(ONELIN,46,SOM,IERR)
        CALL AXISCA(ONELIN,52,XM,IERR)
        CALL AXISCA(ONELIN,58,SEM,IERR)
        GO TO 530

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
530     CLINE=CLINE+1
        GOTO 100

CCCCC
C THIS LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
550     DO 555 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
555     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
560     CALL AXISCA(ONELIN,27,AA,IERR)
        CALL AXISCA(ONELIN,43,MA,IERR)
        CALL AXISCA(ONELIN,60,WA,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
570     CLINE=CLINE+1
        GOTO 100

CCCCC
C THE LINE AFTER NEXT  CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
600     CLINE=CLINE+2
        DO 610 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
610     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
620     CALL AXISCA(ONELIN,1,PCO,IERR)
        CALL AXISCA(ONELIN,10,PCI,IERR)
        CALL AXISCA(ONELIN,19,PHO,IERR)
        CALL AXISCA(ONELIN,28,PHI,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
630     CLINE=CLINE+1
        GOTO 100


CCCCC
C WRITE INFORMATION TO OUTPUT FILE.
CCCCC
900     WRITE(OUTDV1,910)NODE,CDATE,CTIME,
     1          EXCT,EXLW,EXHW,
     2          MPRT,MPAS,LCO,LCI,LHO,LHI,
     3          ACO,ACI,AHO,
     4          AHI,CD,HWD,TD,AP,
     5          AM,
     6          AA,MA,WA

910     FORMAT (I5,I6,I4,5(I4),8(I8),3(I4),I2,4(I4))
        GOTO 999

CCCCC
C RETURN
CCCCC
999     RETURN
        END
  