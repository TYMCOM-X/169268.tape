CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C                                                                       C
C       SUBROUTINE: XRKS                                                C
C                                                                       C
C       THIS SUBROUTINE GETS LINK STATISTICS INFORMATION FROM OUTPUT    C
C       FROM THE XRAY KS COMMAND.  THE OUPUT MUST BE IN THE FORMAT OF   C
C       AN ARRAY AS RETURNED FROM THE AXMOUT SUBROUTINE.                C
C                                                                       C
C       FORMAT: CALL XRKS(OUTDEV,NODE,NEIGH,XRHOLD,XRHSIZ,LLINE)       C
C       ARGUMENTS:                                                      C
C           OUTDEV - DEVICE NUMBER TO WRITE DATA TO DISK                C
C           NODE   - NODE DATA WAS COLLECTED FROM                       C
C           NEIGH  - NEIGHBOR NUMBERR                                   C
C           XRHOLD: INPUT - ARRAY CONTAINING THE OUTPUT FROM AXMOUT.    C
C           XRHSIZ - MAX NUMBER OF LINES IN XRHOLD.  XRHOLD WILL BE      C
C                    DIMENSIONED TO XRHSIZ * 80.                         C
C           LLINE:  INPUT - LAST LINE OF INFORMATION IN XRHOLD.         C
C                                                                       C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC

        SUBROUTINE XRKS(OUTDV1,CDATE,CTIME,NODE,NEIGH,XRHOLD,
     +  XRHSIZ,LLINE)

        INTEGER XRHSIZ,XRHOLD(XRHSIZ,80),LLINE,OUTDV1,NODE,NEIGH,CDATE,
     1          SDATE(2),STIME,LCPSI,LHWIN,LCPOU,LHWOU,PCPSI,PHWIN,
     2          PCPSO,PHWOU,OVHDI,OVHDO,UTLZI,UTLZO,CPSIN,CPSOU,CKTS,
     3          PKTSP,PKTSI,PKSTR,DLAIN,DLTEA,DLBUF,DLOUT,DLXMI,DLTOT,
     4          OVLDC,SATRC,BKLGC,PKTSM,IDLCA,CLINE,ONELIN(80),OUTDV2,
     +          OUTTYP,NAMES(49,3),EARRAY(49,8),ECOUNT,PAGE,ENDFLG,
     +          CTIME,LINES(4,4),LINENO,BFLAG

        DATA LCPSI,LHWIN,LCPOU,LHWOU,PCPSI,PHWIN,PCPSO/7*0/
        DATA PHWOU,OVHDI,OVHDO,UTLZI,UTLZO,CPSIN,CPSOU,CKTS/8*0/
        DATA PKTSP,PKTSI,PKTSR,DLAIN,DLTEA,DLBUF,DLOUT,DLXMI,DLTOT/9*0/
        DATA OVLDC,SATRC,BKLGC,PKTSM,IDLCA/5*0/
        DATA ((NAMES(I,J),J=1,3),I=1,29)/'NODE',' ',' ','NEIGH','BOR',
     +  ' ','CDATE',' ',' ','CTIME',' ',' ','LOGCP','S IN',' ','LOGCP',
     +  'S IN ','HW','LOGCP','S OUT',' ','LOGCP','S OUT',' HW',
     +  'PHYCP','S IN',' ','PHYCP','S IN ','HW','PHYCP','S OUT',' ',
     +  'PHYCP','S OUT',' HW','PACK ',
     +  'OVHD ','IN','PACK ','OVHD ','OUT','UTIL ','IN',' ','UTIL ',
     +  'OUT',' ','CHAR/','SEC I','N','CHAR/','SEC O','UT',
     +  'CIRCU','ITS',' ','PACK/','SEC',' ','PACK ','AVG S','IZ',
     +  'RECOR','DS/PA','CK','LDELA','Y IN-','Q','LDELA','Y RTE',
     +  'AR','LDELA','Y BUF','FR','LDELA','Y OUT','-Q','LDELA',
     +  'Y XMI','T','LDELA','Y TOT','AL','OVERL','OAD C','NT'/
        DATA ((NAMES(I,J),J=1,3),I=30,49)/'SATUR','ATE C','NT',
     +  'BACKL','LOG C','NT','PACKE','TS MA','DE','IDLE ','CALLS',' ',
     +  'LINE ','NUMBE','R','MARKI','NG',' ','REXMI','SSION','S',
     +  'XMISS','IONS',' ',
     +  'LINE ','NUMBE','R','MARKI','NG',' ','REXMI','SSION','S',
     +  'XMISS','IONS',' ',
     +  'LINE ','NUMBE','R','MARKI','NG',' ','REXMI','SSION','S',
     +  'XMISS','IONS',' ',
     +  'LINE ','NUMBE','R','MARKI','NG',' ','REXMI','SSION','S',
     +  'XMISS','IONS',' '/

        CLINE=1
        LINENO=1

CCCCC
C IF THIS LINE BEGINS WITH A BLANK THEN IGNORE IT.
CCCCC
100     IF (XRHOLD(CLINE,1).NE.' ')GOTO 150
        CLINE=CLINE+1
        IF (CLINE.EQ.LLINE)GOTO 900
        GOTO 100

CCCCC
C THIS LINE CONTAINS SOMETHING BESIDES BLANKS. BRANCH ON VALUE OF
C FIRST WORD OF LINE.
CCCCC
150     IF (XRHOLD(CLINE,1).EQ.'L' .AND. XRHOLD(CLINE,2).EQ.'O' .AND.
     1      XRHOLD(CLINE,3).EQ.'G' .AND. XRHOLD(CLINE,4).EQ.'I')
     2     GOTO 200
        IF (XRHOLD(CLINE,1).EQ.'P' .AND. XRHOLD(CLINE,2).EQ.'H' .AND.
     1      XRHOLD(CLINE,3).EQ.'Y' .AND. XRHOLD(CLINE,4).EQ.'S')
     2     GOTO 250
        IF (XRHOLD(CLINE,1).EQ.'P' .AND. XRHOLD(CLINE,2).EQ.'A' .AND.
     1      XRHOLD(CLINE,3).EQ.'C' .AND. XRHOLD(CLINE,4).EQ.'K')
     2     GOTO 300
        IF (XRHOLD(CLINE,1).EQ.'B' .AND. XRHOLD(CLINE,2).EQ.'A' .AND.
     1      XRHOLD(CLINE,3).EQ.'N' .AND. XRHOLD(CLINE,4).EQ.'D')
     2     GOTO 400
        IF (XRHOLD(CLINE,1).EQ.'C' .AND. XRHOLD(CLINE,2).EQ.'H' .AND.
     1      XRHOLD(CLINE,3).EQ.'A' .AND. XRHOLD(CLINE,4).EQ.'R')
     2     GOTO 450
        IF (XRHOLD(CLINE,1).EQ.'L' .AND. XRHOLD(CLINE,2).EQ.'I' .AND.
     1      XRHOLD(CLINE,3).EQ.'N' .AND. XRHOLD(CLINE,4).EQ.'K' .AND.
     2      XRHOLD(CLINE,6).NE.':')
     3     GOTO 500
        IF (XRHOLD(CLINE,1).EQ.'O' .AND. XRHOLD(CLINE,2).EQ.'V' .AND.
     1      XRHOLD(CLINE,3).EQ.'E' .AND. XRHOLD(CLINE,4).EQ.'R')
     2     GOTO 550
        IF (XRHOLD(CLINE,1).EQ.'L' .AND. XRHOLD(CLINE,2).EQ.'I' .AND.
     1      XRHOLD(CLINE,3).EQ.'N' .AND. XRHOLD(CLINE,4).EQ.'E')
     2     GOTO 600

C       CCCCC
C       C THIS LINE DOESN'T CONTAIN SOMETHING THAT WE ARE LOOKING
C       C FOR, SO CONTINUE
C       CCCCC
        CLINE=CLINE+1
        IF (CLINE.EQ.LLINE) GOTO 900
        GO TO 100

CCCCC
C THE NEXT LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
200     CLINE=CLINE+1
        DO 210 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
210     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THE LINE
C       CCCCC
220     CALL AXISCA(ONELIN,14,LCPSI,IERR)
        CALL AXISCA(ONELIN,29,LHWIN,IERR)

C       CCCCC
C       C NEXT LINE ALSO CONTAINS LOGICAL LINK STATS, GET THEM
C       CCCCC
        CLINE=CLINE+1
        DO 225 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
225     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THE LINE
C       CCCCC
227     CALL AXISCA(ONELIN,14,LCPOU,IERR)
        CALL AXISCA(ONELIN,29,LHWOU,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
230     CLINE=CLINE+1
        GOTO 100


CCCCC
C THE NEXT LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
250     CLINE=CLINE+1
        DO 255 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
255     CONTINUE

C       CCCCC
C       C GET ALL PHYSICAL LINK STATISTICS ON THIS LINE
C       CCCCC
260     CALL AXISCA(ONELIN,14,PCPSI,IERR)
        CALL AXISCA(ONELIN,29,PHWIN,IERR)

C       CCCCC
C       C THERE ARE PHYSICAL LINK STATISTICS ON THE NEXT LINE TOO.
C       CCCCC
265     CLINE=CLINE+1
        DO 267 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
267     CONTINUE

C       CCCCC
C       C GET ALL PHYSICAL LINK STATISTICS ON THIS LINE
C       CCCCC
268     CALL AXISCA(ONELIN,14,PCPSO,IERR)
        CALL AXISCA(ONELIN,29,PHWOU,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
270     CLINE=CLINE+1
        GOTO 100

CCCCC
C THIS NEXT LINE CONTAINS PACKET INFORMATION. CK IF IT HAS PACKET
C OVERHEAD OR PACK STATISTICS INFORMATION.
CCCCC
300     BFLAG = 0
        IF (XRHOLD(CLINE,8).EQ.'S')GOTO 350
        IF (XRHOLD(CLINE,33).EQ.'B') BFLAG = 1
CCCCC
C THE NEXT LINE CONTAINS PACKET OVERHEAD INFORMATION. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
        CLINE=CLINE+1
        DO 310 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
310     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
320     CALL AXISCA(ONELIN,10,OVHDI,IERR)
        CALL AXISCA(ONELIN,26,OVHDO,IERR)

C       CCC
C       C CHECK IF THE BANDWIDTH UTILIZATION STATS ARE ALSO ON THIS LINE
C       C IF SO, THEN READ THEM.
C       CCCCC
        IF (BFLAG.EQ.0) GOTO 330
        CALL AXISCA(ONELIN,41,UTLZI,IERR)
        CALL AXISCA(ONELIN,57,UTLZO,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
330     CLINE=CLINE+1
        GOTO 100

CCCCC
C THE NEXT LINE CONTAINS PACKET STATISTICS INFORMATION. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
350     CLINE=CLINE+1
        DO 355 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
355     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
360     CALL AXISCA(ONELIN,19,PKTSP,IERR)
        CALL AXISCA(ONELIN,43,PKTSI,IERR)

C       CCCCC
C       C NEXT LINE MAYALSO CONTAINS PACKET STATISTICS.  CK IF IT DOES.
C       CCCCC
        IF (XRHOLD(CLINE+1,5).NE.'R') GOTO 370

C       CCCCC
C       C NEXT LINE DOES CONTAIN PACKET STATISTICS.
C       CCCCC
        CLINE=CLINE+1
        DO 365 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
365     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
367     CALL AXISCA(ONELIN,22,PKTSR,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
370     CLINE=CLINE+1
        GOTO 100

CCCCC
C THE NEXT LINE CONTAINS BANDWIDTH UTILIZATION INFORMATION. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
400     CLINE=CLINE+1
        DO 410 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
410     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
420     CALL AXISCA(ONELIN,10,UTLZI,IERR)
        CALL AXISCA(ONELIN,26,UTLZO,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
430     CLINE=CLINE+1
        GOTO 100

CCCCC
C THIS LINE CONTAINS CHAR/SEC PER CIRCUIT INFORMATION. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
450     CLINE=CLINE+1
        DO 455 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
455     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
460     CALL AXISCA(ONELIN,10,CPSIN,IERR)
        CALL AXISCA(ONELIN,24,CPSOU,IERR)
        CALL AXISCA(ONELIN,42,CKTS,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
470     CLINE=CLINE+1
        GOTO 100

CCCCC
C THIS LINE CONTAINS LINK DELAY INFORMATION. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
500     CLINE=CLINE+2
        DO 510 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
510     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
520     CALL AXISCA(ONELIN,7,DLAIN,IERR)
        CALL AXISCA(ONELIN,17,DLTEA,IERR)
        CALL AXISCA(ONELIN,27,DLBUF,IERR)
        CALL AXISCA(ONELIN,37,DLOUT,IERR)
        CALL AXISCA(ONELIN,47,DLXMI,IERR)
        CALL AXISCA(ONELIN,57,DLTOT,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
530     CLINE=CLINE+1
        GOTO 100

CCCCC
C THE NEXT LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
550     CLINE=CLINE+1
        DO 555 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
555     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
560     CALL AXISCA(ONELIN,7,OVLDC,IERR)
        CALL AXISCA(ONELIN,23,SATRC,IERR)
        CALL AXISCA(ONELIN,39,BKLGC,IERR)
        CALL AXISCA(ONELIN,55,PKTSM,IERR)
        CALL AXISCA(ONELIN,69,IDLCA,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
570     CLINE=CLINE+1
        GOTO 100

CCCCC
C THIS LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
600     DO 610 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
610     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
620     CALL AXISCA(ONELIN,6,LINES(LINENO,1),IERR)
        CALL AXISCA(ONELIN,21,LINES(LINENO,2),IERR)
        CALL AXISCA(ONELIN,39,LINES(LINENO,3),IERR)
        CALL AXISCA(ONELIN,53,LINES(LINENO,4),IERR)
        LINENO=LINENO+1

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
630     CLINE=CLINE+1
        GOTO 100


CCCCC
C WRITE INFORMATION TO OUTPUT FILE.
CCCCC
900     WRITE(OUTDV1,910)CDATE,CTIME,NODE,NEIGH,
     1          PCPSI,PHWIN,
     2          PCPSO,PHWOU,UTLZI,UTLZO,
     3          DLTOT,
     4          OVLDC,SATRC

910     FORMAT (I6,I4,I5,I5,4(I5),2(I2),3(I4))
        GOTO 999

CCCCC
C RETURN
CCCCC
999     RETURN
        END


CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C                                                                       C
C       SUBROUTINE: XRKST                                               C
C                                                                       C
C       TTURBO VERSION:                                         C
C       THIS SUBROUTINE GETS LINK STATISTICS INFORMATION FROM OUTPUT    C
C       FROM THE XRAY KS COMMAND.  THE OUPUT MUST BE IN THE FORMAT OF   C
C       AN ARRAY AS RETURNED FROM THE AXMOUT SUBROUTINE.                C
C                                                                       C
C       FORMAT: CALL XRKST(OUTDEV,NODE,NEIGH,XRHOLD,XRHSIZ,LLINE)       C
C       ARGUMENTS:                                                      C
C           OUTDEV - DEVICE NUMBER TO WRITE DATA TO DISK                C
C           NODE   - NODE DATA WAS COLLECTED FROM                       C
C           NEIGH  - NEIGHBOR NUMBERR                                   C
C           XRHOLD: INPUT - ARRAY CONTAINING THE OUTPUT FROM AXMOUT.    C
C           XRHSIZ - MAX NUMBER OF LINES IN XRHOLD.  XRHOLD WILL BE      C
C                    DIMENSIONED TO XRHSIZ * 80.                         C
C           LLINE:  INPUT - LAST LINE OF INFORMATION IN XRHOLD.         C
C                                                                       C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC

        SUBROUTINE XRKST(OUTDV1,CDATE,CTIME,NODE,NEIGH,XRHOLD,
     +  XRHSIZ,LLINE)

        INTEGER XRHSIZ,XRHOLD(XRHSIZ,80),LLINE,OUTDV1,NODE,NEIGH,CDATE,
     1          SDATE(2),STIME,LCPSI,LHWIN,LCPOU,LHWOU,PCPSI,PHWIN,
     2          PCPSO,PHWOU,OVHDI,OVHDO,UTLZI,UTLZO,CPSIN,CPSOU,CKTS,
     3          PKTSP,PKTSI,PKSTR,DLAIN,DLTEA,DLBUF,DLOUT,DLXMI,DLTOT,
     4          OVLDC,SATRC,BKLGC,PKTSM,IDLCA,CLINE,ONELIN(80),OUTDV2,
     +          OUTTYP,NAMES(49,3),EARRAY(49,8),ECOUNT,PAGE,ENDFLG,
     +          CTIME,LINES(4,4),LINENO,BFLAG

        DATA LCPSI,LHWIN,LCPOU,LHWOU,PCPSI,PHWIN,PCPSO/7*0/
        DATA PHWOU,OVHDI,OVHDO,UTLZI,UTLZO,CPSIN,CPSOU,CKTS/8*0/
        DATA PKTSP,PKTSI,PKTSR,DLAIN,DLTEA,DLBUF,DLOUT,DLXMI,DLTOT/9*0/
        DATA OVLDC,SATRC,BKLGC,PKTSM,IDLCA/5*0/
        DATA ((NAMES(I,J),J=1,3),I=1,29)/'NODE',' ',' ','NEIGH','BOR',
     +  ' ','CDATE',' ',' ','CTIME',' ',' ','LOGCP','S IN',' ','LOGCP',
     +  'S IN ','HW','LOGCP','S OUT',' ','LOGCP','S OUT',' HW',
     +  'PHYCP','S IN',' ','PHYCP','S IN ','HW','PHYCP','S OUT',' ',
     +  'PHYCP','S OUT',' HW','PACK ',
     +  'OVHD ','IN','PACK ','OVHD ','OUT','UTIL ','IN',' ','UTIL ',
     +  'OUT',' ','CHAR/','SEC I','N','CHAR/','SEC O','UT',
     +  'CIRCU','ITS',' ','PACK/','SEC',' ','PACK ','AVG S','IZ',
     +  'RECOR','DS/PA','CK','LDELA','Y IN-','Q','LDELA','Y RTE',
     +  'AR','LDELA','Y BUF','FR','LDELA','Y OUT','-Q','LDELA',
     +  'Y XMI','T','LDELA','Y TOT','AL','OVERL','OAD C','NT'/
        DATA ((NAMES(I,J),J=1,3),I=30,49)/'SATUR','ATE C','NT',
     +  'BACKL','LOG C','NT','PACKE','TS MA','DE','IDLE ','CALLS',' ',
     +  'LINE ','NUMBE','R','MARKI','NG',' ','REXMI','SSION','S',
     +  'XMISS','IONS',' ',
     +  'LINE ','NUMBE','R','MARKI','NG',' ','REXMI','SSION','S',
     +  'XMISS','IONS',' ',
     +  'LINE ','NUMBE','R','MARKI','NG',' ','REXMI','SSION','S',
     +  'XMISS','IONS',' ',
     +  'LINE ','NUMBE','R','MARKI','NG',' ','REXMI','SSION','S',
     +  'XMISS','IONS',' '/

        CLINE=1
        LINENO=1

CCCCC
C IF THIS LINE BEGINS WITH A BLANK THEN IGNORE IT.
CCCCC
100     IF (XRHOLD(CLINE,1).NE.' ')GOTO 150
        CLINE=CLINE+1
        IF (CLINE.EQ.LLINE)GOTO 900
        GOTO 100

CCCCC
C THIS LINE CONTAINS SOMETHING BESIDES BLANKS. BRANCH ON VALUE OF
C FIRST WORD OF LINE.
CCCCC
150     IF (XRHOLD(CLINE,1).EQ.'L' .AND. XRHOLD(CLINE,2).EQ.'O' .AND.
     1      XRHOLD(CLINE,3).EQ.'G' .AND. XRHOLD(CLINE,4).EQ.'I')
     2     GOTO 200
        IF (XRHOLD(CLINE,1).EQ.'P' .AND. XRHOLD(CLINE,2).EQ.'H' .AND.
     1      XRHOLD(CLINE,3).EQ.'Y' .AND. XRHOLD(CLINE,4).EQ.'S')
     2     GOTO 250
        IF (XRHOLD(CLINE,1).EQ.'P' .AND. XRHOLD(CLINE,2).EQ.'A' .AND.
     1      XRHOLD(CLINE,3).EQ.'C' .AND. XRHOLD(CLINE,4).EQ.'K')
     2     GOTO 300
        IF (XRHOLD(CLINE,1).EQ.'C' .AND. XRHOLD(CLINE,2).EQ.'H' .AND.
     1      XRHOLD(CLINE,3).EQ.'A' .AND. XRHOLD(CLINE,4).EQ.'R')
     2     GOTO 450
        IF (XRHOLD(CLINE,1).EQ.'L' .AND. XRHOLD(CLINE,2).EQ.'I' .AND.
     1      XRHOLD(CLINE,3).EQ.'N' .AND. XRHOLD(CLINE,4).EQ.'K' .AND.
     2      XRHOLD(CLINE,6).NE.':')
     3     GOTO 500
        IF (XRHOLD(CLINE,1).EQ.'O' .AND. XRHOLD(CLINE,2).EQ.'V' .AND.
     1      XRHOLD(CLINE,3).EQ.'E' .AND. XRHOLD(CLINE,4).EQ.'R')
     2     GOTO 550
        IF (XRHOLD(CLINE,1).EQ.'L' .AND. XRHOLD(CLINE,2).EQ.'.' .AND.
     1      XRHOLD(CLINE,3).EQ.'U' .AND. XRHOLD(CLINE,4).EQ.'.')
     2     GOTO 600

C       CCCCC
C       C THIS LINE DOESN'T CONTAIN SOMETHING THAT WE ARE LOOKING
C       C FOR, SO CONTINUE
C       CCCCC
        CLINE=CLINE+1
        IF (CLINE.EQ.LLINE) GOTO 900
        GO TO 100

CCCCC
C THE NEXT LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
200     CLINE=CLINE+1
        DO 210 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
210     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THE LINE
C       CCCCC
220     CALL AXISCA(ONELIN,14,LCPSI,I
        CALL AXISCA(ONELIN,29,LHWIN,IERR)

C       CCCCC
C       C NEXT LINE ALSO CONTAINS LOGICAL LINK STATS, GET THEM
C       CCCCC
        CLINE=CLINE+1
        DO 225 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
225     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THE LINE
C       CCCCC
227     CALL AXISCA(ONELIN,14,LCPOU,IERR)
        CALL AXISCA(ONELIN,29,LHWOU,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
230     CLINE=CLINE+1
        GOTO 100


CCCCC
C THE NEXT LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
250     CLINE=CLINE+1
        DO 255 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
255     CONTINUE

C       CCCCC
C       C GET ALL PHYSICAL LINK STATISTICS ON THIS LINE
C       CCCCC
260     CALL AXISCA(ONELIN,14,PCPSI,IERR)
        CALL AXISCA(ONELIN,29,PHWIN,IERR)

C       CCCCC
C       C THERE ARE PHYSICAL LINK STATISTICS ON THE NEXT LINE TOO.
C       CCCCC
265     CLINE=CLINE+1
        DO 267 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
267     CONTINUE

C       CCCCC
C       C GET ALL PHYSICAL LINK STATISTICS ON THIS LINE
C       CCCCC
268     CALL AXISCA(ONELIN,14,PCPSO,IERR)
        CALL AXISCA(ONELIN,29,PHWOU,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
270     CLINE=CLINE+1
        GOTO 100

CCCCC
C THIS NEXT LINE CONTAINS PACKET INFORMATION. CK IF IT HAS PACKET
C OVERHEAD OR PACK STATISTICS INFORMATION.
CCCCC
300     BFLAG = 0
        IF (XRHOLD(CLINE,8).EQ.'S')GOTO 350
        IF (XRHOLD(CLINE,25).EQ.'B') BFLAG = 1
CCCCC
C THE NEXT LINE CONTAINS PACKET OVERHEAD INFORMATION. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
        CLINE=CLINE+1
        DO 310 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
310     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
320     CALL AXISCA(ONELIN,5,OVHDI,IERR)
        CALL AXISCA(ONELIN,15,OVHDO,IERR)

C       CCC
C       C CHECK IF THE BANDWIDTH UTILIZATION STATS ARE ALSO ON THIS LINE
C       C IF SO, THEN READ THEM.
C       CCCCC
        IF (BFLAG.EQ.0) GOTO 330
        CALL AXISCA(ONELIN,30,UTLZI,IERR)
        CALL AXISCA(ONELIN,39,UTLZO,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
330     CLINE=CLINE+1
        GOTO 100

CCCCC
C THE NEXT LINE CONTAINS PACKET STATISTICS INFORMATION. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
350     CLINE=CLINE+1
        DO 355 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
355     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
360     CALL AXISCA(ONELIN,18,PKTSP,IERR)
        CALL AXISCA(ONELIN,35,PKTSI,IERR)

C       CCCCC
C       C NEXT LINE MAYALSO CONTAINS PACKET STATISTICS.  CK IF IT DOES.
C       CCCCC
        IF (XRHOLD(CLINE+1,5).NE.'R') GOTO 370

C       CCCCC
C       C NEXT LINE DOES CONTAIN PACKET STATISTICS.
C       CCCCC
        CLINE=CLINE+1
        DO 365 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
365     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
367     CALL AXISCA(ONELIN,21,PKTSR,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
370     CLINE=CLINE+1
        GOTO 100


CCCCC
C THIS LINE CONTAINS CHAR/SEC PER CIRCUIT INFORMATION. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
450     CLINE=CLINE+1
        DO 455 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
455     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
460     CALL AXISCA(ONELIN,9,CPSIN,IERR)
        CALL AXISCA(ONELIN,17,CPSOU,IERR)
        CALL AXISCA(ONELIN,30,CKTS,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
470     CLINE=CLINE+1
        GOTO 100

CCCCC
C THIS LINE CONTAINS LINK DELAY INFORMATION. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
500     CLINE=CLINE+2
        DO 510 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
510     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
520     CALL AXISCA(ONELIN,11,DLAIN,IERR)
        CALL AXISCA(ONELIN,19,DLTEA,IERR)
        CALL AXISCA(ONELIN,27,DLBUF,IERR)
        CALL AXISCA(ONELIN,37,DLOUT,IERR)
        CALL AXISCA(ONELIN,45,DLXMI,IERR)
        CALL AXISCA(ONELIN,51,DLTOT,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
530     CLINE=CLINE+1
        GOTO 100

CCCCC
C THE NEXT LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
550     CLINE=CLINE+1
        DO 555 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
555     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
560     CALL AXISCA(ONELIN,14,OVLDC,IERR)
        CALL AXISCA(ONELIN,31,SATRC,IERR)
        CALL AXISCA(ONELIN,46,BKLGC,IERR)
        CALL AXISCA(ONELIN,58,PKTSM,IERR)
        CALL AXISCA(ONELIN,69,IDLCA,IERR)

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
570     CLINE=CLINE+1
        GOTO 100

CCCCC
C THIS LINE CONTAINS INFORMATION THAT WE WANT. PUT THIS LINE
C INTO A TEMP ARRAY SO THAT IT CAN BE SCANNED BY THE SCANNING
C SUBROUTINES.
CCCCC
600     DO 610 I=1,80
        ONELIN(I)=XRHOLD(CLINE,I)
610     CONTINUE

C       CCCCC
C       C GET ALL STATISTICS ON THIS LINE
C       CCCCC
620     CALL AXISCA(ONELIN,7,LINES(LINENO,1),IERR)
        CALL AXISCA(ONELIN,34,LINES(LINENO,3),IERR)
        CALL AXISCA(ONELIN,43,LINES(LINENO,4),IERR)
        LINENO=LINENO+1

C       CCCCC
C       C FINISHED WITH THIS LINE. GO LOOK AT NEXT
C       CCCCC
630     CLINE=CLINE+1
        GOTO 100


CCCCC
C WRITE INFORMATION TO OUTPUT FILE.
CCCCC
900     WRITE(OUTDV1,910)CDATE,CTIME,NODE,NEIGH,
     1          PCPSI,PHWIN,
     2          PCPSO,PHWOU,UTLZI,UTLZO,
     3          DLTOT,
     4          OVLDC,SATRC

910     FORMAT (I6,I4,I5,I5,4(I5),2(I2),3(I4))
        GOTO 999

CCCCC
C RETURN
CCCCC
999     RETURN
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        END
  U 	!£