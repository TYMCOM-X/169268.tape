                                                               December 7, 1979












                      *****  **** *****  ****       *****
                        *   *       *   *             *  
                        *    ***    *    ***  *****   *  
                        *       *   *       *         *  
                      ***** ****  ***** ****        *****

                   Internally Switched Interface System -- I
                               REFERENCE MANUAL

                           Network Development Group
                                Tymshare, Inc.
                             Cupertino, California





    DISCLAMER -- Many of the terms used herein are references to the TYMNET
   technology -- these are more fully described in the document "TYMNET-I".










       =================================================================
       |       THIS DOCUMENT IS THE SOLE PROPERTY AND CONFIDENTIAL     |
       |       INFORMATION  OF  TYMSHARE,  INC.,  AND  MAY  NOT BE     |
       |       COPIED  IN  WHOLE OR IN PART  OR  DISCLOSED  TO ANY     |
       |       THIRD PARTY  WITHOUT THE PRIOR  WRITTEN  CONSENT OF     |
       |       TYMSHARE.                                               |
       =================================================================








                                                                         ISIS-I
                                    ISIS-I                     December 7, 1979


                                   TABLE OF CONTENTS


        1.  Internally Switched Interface System                              1

            1.1 THE KERNEL                                                    1

            1.2 THE DISPATCHER                                                2

            1.3 INTERNAL PROCESS COMMUNICATIONS                               3

            1.4 ROUTING                                                       5

            1.5 EXTERNAL COMMUNICATIONS                                       6

            1.6 INTERNAL PROCESSES                                            6

            1.7 COMMUNICATIONS WITH THE KERNEL                                6

            1.8 LIBRARIES                                                     7


        2.  ISIS Process Intercommunications                                  9

            2.1 Message Format                                               10

            2.2 Message Types                                                10

            2.3 Intra-ISIS Communications                                    14

            2.4 Circuits                                                     16
                2.4.1   Circuit Terminating on a Port                        16
                2.4.2   Circuit Origination                                  17
                    2.4.2.1 Normal Circuits                                  17
                    2.4.2.2 Auxiliary Circuits                               18


        3.  TABLES                                                           19

            3.1 IST -- Interface State Table                                 19

            3.2 ICT -- Interface Control Table                               19


        4.  ISIS KERNEL SVC'S                                                21

            4.1 STANDARD SVC'S                                               21
                4.1.1   DISMISS--                    SVC     DISMISS<0>,VALUE21
                4.1.2   RESTART--                    SVC     1,ADDR          21
                4.1.3   CONNECT FOREGROUND-PROCESS-- SVC     2,START-ADDR    22

            4.2 I/O CONTROL--                   SVC        3,OP:REG          22
                4.2.1   I/O STATUS QUERY                                     22
                                    ISIS-I                     December 7, 1979


                    4.2.1.1 I/O ATTRIBUTES QUERY----OP=800                   23
                4.2.2   SYNCHRONOUS INPUT CONTROL                            23
                    4.2.2.1 CONNECT SYNCHRONOUS INPUT----OP=0                24
                4.2.3   SYNCHRONOUS OUTPUT CONTROL                           24
                    4.2.3.1 CONNECT OUTPUT----OP=1                           25
                    4.2.3.2 FORCE OUTPUT----OP=2                             25
                    4.2.3.3 T-II SYNC-LINE CONNECT----OP=6                   25
                    4.2.3.4 T-IISYNC-LINE IDLE TEST                          26
                4.2.4   ASYNCHRONOUS I/O                                     26
                    4.2.4.1 CONNECT ASYNC----OP=3                            27
                4.2.5   PRINTER OUTPUT                                       28
                    4.2.5.1 CONNECT PRINTER----OP=4                          28
                    4.2.5.2 FORCE PRINTER OUTPUT----OP=5                     28
                4.2.6   EXPERIMENTAL SIO CARD                                29
                    4.2.6.1 CONNECT XSIO---OP=8                              29

            4.3 DISC AND TAPE I/O CONTROL--     SVC        4,ADDR            30
                4.3.1   TAPE SVC                                             32
                4.3.2   DISK I/O                                             33
                4.3.3   DISK I/O (BLOCK)             SVC    0E,ADDR          33
                4.3.4   DISK I/O (SECTOR)            SVC    0F,ADDR          35

            4.4 DDT SVC'S                                                    35
                4.4.1   TTY INPUT--                  SVC     0A,REG:TIME     35
                4.4.2   TTY OUTPUT--                 SVC     0B,ADDR         36
                4.4.3   GENERAL--                    SVC     0D,TYPE         36


        5.  ISIS DDT COMMANDS                                                37

            5.1 A                                                            37

            5.2 B ADDR NUM                                                   38

            5.3 E                                                            38

            5.4 G ADDR                                                       38

            5.5 H                                                            39

            5.6 I                                                            39

            5.7 L DISK-ADDR NUMBER-OF-BLOCKS MEM-ADDR                        39

            5.8 M MASK START-ADDR END-ADDR                                   39

            5.9 N                                                            40

            5.10    P                                                        40

            5.11    R ADDR COUNT                                             40

            5.12    RR REG COUNT                                             40
                                    ISIS-I                     December 7, 1979


            5.13    S DISK-ADDR NUMBER-OF-BLOCKS MEM-ADDR                    41

            5.14    T                                                        41

            5.15    U NUM                                                    41

            5.16    W ADDR COUNT                                             41

            5.17    WR REG COUNT                                             42

            5.18    X (0,1) (1,2,4) VALUE                                    42

            5.19    Y (1,2,3) VALUE1 VALUE2 VALUE3                           42

            5.20    Z                                                        42

            5.21    C  don't use!                                            43

            5.22    control-C                                                43

            5.23    control-O                                                43

            5.24    \                                                        43

            5.25    ^ NUM                                                    44

            5.26    ?COMMAND                                                 44
                5.26.1  ?B        --query Breakpoints                        44
                5.26.2  ?MAC      --query MAC                                44
                5.26.3  ?SLOT     --query SLOT number                        44
                5.26.4  ?BT       --query Background PSD                     44
                5.26.5  ?FT       --query Foreground PSD                     45
                5.26.6  ?BRR R N  --query Background's Read Registers        45
                5.26.7  ?FRR R N  --query Foreground's Read Registers        45
                5.26.8  ?CT       --query Channels Terminating               45
                5.26.9  ?RET      --query return                             45


        6.  NAD-KERNEL COMMUNICATIONS                                        46

            6.1 NAD-DDT commands                                             46


        7.  CONVENTIONS FOR NAD - DDT COMMUNICATIONS                         49

            7.1 PDP10 TO 7/32                                                49

            7.2 7/32 TO PDP10                                                49


        8.  ISIS LIBRARY PACKAGES                                            51

            8.1 THE *.COM FILE                                               51
                                    ISIS-I                     December 7, 1979


            8.2 START.LIB                                                    52

            8.3 BID.LIB                                                      52

            8.4 TIMOUT.LIB                                                   53

            8.5 ISIS RING PACKAGES                                           54
                8.5.1   UTILITY ROUTINES                                     55
                8.5.2   PRIMATIVE INPUT ROUTINES                             55
                8.5.3   PRIMATIVE OUTPUT ROUTINES                            56
                8.5.4   FRING.LIB                                            56
                    8.5.4.1 Utility routines                                 57
                    8.5.4.2 Input routines                                   57
                    8.5.4.3 Output routines                                  57

            8.6 BUFFER PACKAGES                                              58
                8.6.1   BUFFER.LIB                                           60
                8.6.2   FBUFER.LIB                                           60

            8.7 CRASH.LIB                                                    60

            8.8 FRONT.LIB                                                    61
                8.8.1   CONVENTIONS                                          61

            8.9 FINISH.LIB                                                   63

            8.10    ARING.LIB                                                63


        9.  THE INTERDATA MAC                                                66

            9.1 ADDRESS SPACE                                                66

            9.2 MAC MAPPING                                                  67

            9.3 GENERAL CONSIDERATIONS                                       67

            9.4 MODULES                                                      68

            9.5 ISIS USAGE                                                   68


        10. CONFIGURING AN ISIS BOX                                          69

            10.1    FILES                                                    69
                10.1.1  XXX.CMD FILE                                         69
                10.1.2  XXX.TYM file                                         70

            10.2    GENERATION                                               74


        11. STARTING & RESTARTING AN ISIS NODE                               76
                                    ISIS-I                     December 7, 1979


            11.1    INTERDATA                                                76
                11.1.1  START UP (WITHOUT RELOAD)                            76
                11.1.2  RELOAD PROCEDURE (FROM TERMINAL)                     77
                11.1.3  START-FROM-SCRATCH PROCEDURE                         77
                    11.1.3.1    TTY (MULTIFUNCTION) CARD START FROM SCRATCH  77
                11.1.4  RELOAD PROCEDURE (FROM DISK)                         78
                11.1.5  SPECIALIZED INTERDATA RELOADING INFORMATION          79

            11.2    ENGINE                                                   79
                11.2.1  START UP (WITHOUT RELOAD)                            79
                11.2.2  RELOAD PROCEDURE (FROM TERMINAL)                     79
                11.2.3  START-FROM-SCRATCH PROCEDURE                         80
                    11.2.3.1    TTY (MULTIFUNCTION) CARD START FROM SCRATCH  80
                11.2.4  RELOAD PROCEDURE (FROM DISK)                         81

            11.3    SPECIALIZED RELOADING INFORMATION                        81
                11.3.1  PROM START FROM SCRATCH                              82
                11.3.2  DISK BOOTSTRAP                                       82


        12. Loading an ISIS slot                                             83


        13. INDEX                                                            87
                     Internally Switched Interface System      December 7, 1979


                       1.   Internally Switched Interface System



             ISIS  was  defined in  order  to develop,  debug,  and  deploy new
        interfaces on network nodes while protecting these nodes  from possible
        faults in these interfaces.

             ISIS is a system, not a program:   it is a set of rules as  to how
        the interfaces are to be  constructed, and how they are  to communicate
        with each other.  ISIS is not a TYMNET node or implementation of TYMNET
        technology.

             ISIS divides  the machine  into partitions, or  SLOTS.  Slot  0 is
        expected  to  have  special  properties  and  abilities,  including the
        routing  of  circuits  within  the  machine,  and  the   collection  of
        diagnostic and accounting information.

             To this  end, ISIS  treats the  TYMNET node  code as  just another
        interface.  The TYMNET node code has these special properties only when
        executing  in  slot  0.   These  include  the  routing  and  monitoring
        functions relating to the TYMNET supervisor.  When executing in  a slot
        other than  slot 0,  the TYMNET  interface performs  the function  of a
        gateway to TYMNET.








                                    1.1  THE KERNEL

             The control center of ISIS is the KERNEL, a process which provides
        ultimate  control  of  hardware,  including  the  scheduling  of  other
        processes.

             Interrupts  have  absolute   priority  in  the   machine.   During
        intervals when  no interrupts are  active, other processes  are active.
        These are either  the kernel, or some  process to which the  kernel has
        temporarily assigned the machine.

             These processes are,  for the purposes of  scheduling, independent
        jobs, even  though a  set of processes  may be  working together,  as a
        SLOT.  These processes fall into a hierarchy of levels.

             The top level consists  of Foreground (or Quasi-)  processes.  The
        kernel schedules all active foreground processes to execute  once every
        25  milliseconds, for  a maximum  period dependent  upon the  number of
        devices  which must  be serviced...periods  are in  clock  ticks (1/600
        second), with a minimum of 2 ticks, and one additional tick for  each 3


                                       1                                 ISIS-I
                     Internally Switched Interface System      December 7, 1979


        logical units.   These are intended  to communicate with  the interrupt
        level processes, and thus  must be scheduled at frequent  intervals, to
        permit timely responses.   To this end, each  time the kernel  tries to
        schedule a job, it first searches the queue of foreground jobs, to find
        which one should run next.   If none should go immediately,  the time--
        until the  next foreground process  is to run--is  made available  to a
        background process.

             At the bottom level are the Background jobs.  These are  the work-
        horses, which  perform the  major effort  of an  interface.  Background
        jobs  actually  fall  into  several  catagories,  which   the  kernel's
        scheduler treats identically.  The Kernel divides the  time-domain into
        timeslices, of 50 milliseconds; these timeslices are interruptable (for
        foreground  execution).  A  job  may dismiss  at any  time  during it's
        timeslice...a new timeslice is then  created for the next job.   If the
        job doesn't dismiss  itself, the machine is  taken away from it  at the
        end of the timeslice, and all other jobs are given a chance  to execute
        their timeslices.  As a  result, a job may get  as many as 500  or more
        timeslices/second (in a lightly-loaded machine, with well-behaved jobs)
        to as few as 2-4, if there are several pathologic jobs active.

             The true background job, as already mentioned, is the  main effort
        of a given interface.  In addition, there are a set of DDT  jobs.  Each
        of  these  can be  logged  into through  the  network, and  be  used to
        control, modify, debug, or reload a given set of processes (a SLOT).

             Each  slot  has  an  DDT,  a  foreground,  and  a  backgr job
        associated with it (note--not all  jobs associated with a slot  need be
        active concurrently).

             An intermediate  level job is  the DISPATCHER.  The  dispatcher is
        run each time a non-DDT background job runs, and is used to set up that
        background job for  it's next use of  the machine.  In  particular, the
        dispatcher switches the output which  was produced by that slot  to the
        appropriate destination slots.








                                  1.2  THE DISPATCHER

             The heart of ISIS is the DISPATCHER.  The primary function  of the
        dispatcher is to  act in a manner  similar to a switching  node, except
        that, instead of talking to several network lines, it talks  to several
        interfaces.  Subsidiary  functions are  to perform  network accounting,
        and such  other functions  which it is  convenient to  centeralize.  It
        does  NOT have  any  knowledge of  the strange  properties  of specific
        interfaces, except that  the interface associated  with slot 0  has the


                                       2                                 ISIS-I
                     Internally Switched Interface System      December 7, 1979


        capability to  perform routing, and  is the repository  for diagnostic,
        accounting, and other messages.

             Each interface has a set  of descriptors which it uses to  talk to
        the dispatcher, and may have  a translator to convert its  requests and
        messages to the  standard format.  Each interface  runs as one  or more
        independent jobs under the KERNEL, sharing time-slices with the rest of
        the  interfaces.   The  MAC (Memory  Access  Controller)  prevents each
        interface from destroying  another interface because of  illegal memory
        stores.  The  dispatcher checks the  data flow to  insure that,  if the
        interface is in error, it damages only its own subset of circuits.

             Under the MAC,  a job slot  can have up  to 16 segments.   By ISIS
        convention, segment  0 is  writeable but  is protected  from execution,
        while  segment 1  is executable  but write  protected.   The dispatcher
        shares the first few words of each of these segments with each job, and
        uses these fixed cells to communicate with the individual  jobs.  These
        cells are used to transfer certain parameters back and forth, and those
        cells in segment 1 are  used by the dispatcher to maintain  a "witness"
        of job parameters.  The dispatcher  may have cause to re-write  some of
        these  parameters, and  so any  job should  know which  parameters will
        change from assembly time.








                         1.3  INTERNAL PROCESS COMMUNICATIONS

             The  dispatcher and  any particular  interface must  talk  to each
        other.  Because the processes are running concurrently,  the dispatcher
        may interrupt the other after any instruction.  The intercommunications
        has  therefore  been designed  such  that this  is  expected!   The two
        directions of traffic must also be independent.

             The buffering mechanism used  is a ring buffer, which  one process
        fills, and the other empties.  No specific constraint is placed  on the
        size of  the buffer by  ISIS, and  indeed, there is  no reason  that an
        interface input ring must be the same size as it's output ring.

             In designing an interface,  some knowledge is available as  to the
        interface  capacity.   (An  interface with  one  9600-baud  full duplex
        synchronous   line   interface   can   handle   no   more   than   1200
        characters/second  in  each  direction,  and,  allowing   for  protocol
        overhead, the  actual data transfered  is typically  significantly less
        than  this.) A  reasonable approximation  is to  allocate  one second's
        worth  of interface  traffic storage  to the  ring buffer,  to  allow a
        certain degree  of "burstiness" to  data transfers.  (E.g.,  one simple
        interface might have 200 character buffers, while another might require
        5000 characters of buffering for 50 Kbps capacity.)

                                       3                                 ISIS-I
                     Internally Switched Interface System      December 7, 1979


             Two interfaces talk to  each other through the  dispatcher.  There
        is no requirement that the originator and the receiver of a data stream
        be synchronous, so some  mechanism is necessary to  apply back-pressure
        over  a  circuit.  This  back-pressure  may be  end-to-end,  or  may be
        applied by the dispatcher to one of the interfaces.

             The dispatcher normally tries to move data from the source process
        to the  destination, but  for a variety  of reasons,  may be  unable to
        deliver immediately, and must instead buffer the data  temporarily.  In
        this case, it will have reason to back-pressure the source port.  It is
        NOT desirable to back-pressure the source interface itself,  since that
        would  stop ALL  its output--some  of which  would still  be allowable,
        since it might be going to a different interface.  (A common reason for
        buffering would be the destination ring being full--perhaps because the
        destination process is busy processing a burst of data--but this should
        not preclude  all traffic  from this source,  since some  of it  may be
        going elsewhere.)

             The dispatcher, since it talks  to all interfaces, is in  the best
        position to  perform certain control  functions.  In particular,  it is
        the process to connect (and disconnect) interfaces from the KERNEL.  It
        may do  this on  command (from DDT),  or if  it detected  some abnormal
        condition (such as  an invalid message  coming from an  interface), and
        report  a diagnostic  (to the  routing  slot, slot  0) as  to  what has
        happened.  To  do all  this, the  dispatcher has  access to  the entire
        memory of the machine.

             As  defined herein,  the  slot 0  interface includes  that  set of
        functions relating to  inter-node communications, circuit  routing, and
        diagnostic information.  Each interface, including slot 0, has a set of
        permuter  tables,  controlled   by  the  dispatcher,  which   tell  the
        dispatcher which  port of one  interface is connected  to what  port of
        another.

             The dispatcher receives commands and data from slot 0 and forwards
        them to  the appropriate interface,  constructing internal  circuits as
        necessary.   The  dispatcher  also  performs  the  internal  accounting
        function.

             If an interface requests a circuit to another host, the dispatcher
        will make a connection to the slot 0 interface.  If that  circuit turns
        out to  be an internal  circuit, the dispatcher  will do  the necessary
        interconnection from source to  destination process such that  the data
        flows  entirely within  the dispatcher,  without bothering  the  slot 0
        interface.

             The dispatcher could do all this without reference to slot  0, but
        in the case where slot 0 is connected to some external  network special
        constraints may apply, which should not be "wired" into the dispatcher.

             (This  capability  permits  the  deployment  of  stand-alone  ISIS
        configurations  for the  purpose  of local  interconnection  of special


                                       4                                 ISIS-I
                     Internally Switched Interface System      December 7, 1979


        interfaces, such as the routing of a set of dial-up bisync ports to ANY
        of a set of hosts connected to the same machine, perhaps with X-25 host
        interfaces.)

             The internal format of data being transmitted must be  uniform for
        all interfaces.  To this end,  a message format is used.   Each message
        originating at  an interface  has a header.   The header  specifies the
        port number and  the message type:  for  each message type  the message
        length is fixed.  One class  of messages would be pure  data transfers:
        type 1  means 1  character follows, 2==2,  ..., 80x==128d;  others mean
        specific  control  messages,  such  as  DISCONNECT,  etc.    Since  the
        predominance  of  traffic  is  expected  to  be  data,  a  receiver can
        eliminate much of the normal logic required to examine  each character,
        because this  information is  incorporated into  the message  type.  In
        particular, the dispatcher (and  other processes as well)  can process,
        or move  messages from  one ring  to another,  with the  major overhead
        occurring  in  looking  at  the  message  header  and  determining  the
        destination;  if  there is room  there, the message  can be  moved very
        quickly without excess character-by-character overhead.








                                     1.4  ROUTING

             Slot 0, as noted above, has special properties  involving routing,
        accounting, and  diagnostic collection.   The actual  implementation is
        dependent on the usage of that particular ISIS configuration.

             In a self-contained configuration, all circuits are  internal, and
        the routing algorithm may be very simple.

             When the slot 0 interface is part of an external network, circuits
        may  originate  and  terminate both  internally,  and  externally.  The
        interface is now more complex, since, in addition to internal circuits,
        it  need  also  perform  some  measure  of  external  routing,  and may
        additionally  support  external   traffic  which  passes   through  the
        interface, but  which is not  terminated (in the  view of  the external
        network) there.

             In a network with centralized control, such as TYMNET, all routing
        is  defered  to the  control  of the  supervisor,  which  also provides
        centralized accounting and diagnostic collection.  Use is also  made of
        the supervisor's ability to validate requests, and to permit  or reject
        certain connections (fences).





                                       5                                 ISIS-I
                     Internally Switched Interface System      December 7, 1979


                             1.5  EXTERNAL COMMUNICATIONS

             Each logical  interface may require  some sort of  hardware driver
        (although this it  not strictly necessary),  which could imply  loss of
        security  (memory violations  for other  jobs) for  each  new interface
        generated.  However, the  majority of drivers  would seem to  fall into
        one of  four communication classes:   async, synchronous,  bit stuffing
        (SDLC), and channel,  or alternately, some  sort of special  I/O device
        driver  (printer, disc,  etc.).  ISIS  supports drivers  for  all these
        devices.   The value  of  centralized hardware  drivers,  although less
        efficient  than  allowing  each  process  to  drive  it's  own devices,
        outweighs  efficiency  considerations.   The  inter-process  protection
        afforded, the ability to change or share devices without rewriting each
        process using that  device, and the  lack of specialized  knowledge (on
        the part  of the process)  make the processes  much easier  to develop.
        Details  of  specific  logical  interfaces  relate  not  to  the actual
        transfer mechanism used,  but on the  buffer format--a detail  which is
        protectable, under the MAC, from interprocess corruption.  An interface
        which corrupts its buffer handling hurts only itself, not the hardware,
        or the other interfaces with  which it is sharing the  hardware.  Thus,
        each interface is constrained to request actual data transfers from the
        drivers, through the KERNEL.








                                1.6  INTERNAL PROCESSES

             In addition, in  a given machine which  has an available  slot and
        unused capacity, there  is no reason  that special processes  cannot be
        run.   These  processes   may  be  internal  or   network  housekeeping
        functions, or they may be specific applications.








                          1.7  COMMUNICATIONS WITH THE KERNEL

             All interfaces  must be  able to communicate  with the  kernel, if
        only  to dismiss  themselves.  This  is done  through the  mechanism of
        SVC's (SuperVisory Command instructions).  There are a number  of these
        defined,  and  they  provide  primitive  functions,  such  as  dismiss,
        restart, connect  foreground, connect I/O  drivers, as well  as special
        SVC's for the use of DDT.


                                       6                                 ISIS-I
                     Internally Switched Interface System      December 7, 1979


                                    1.8  LIBRARIES

             It is desirable to have a library of functional packages which may
        be  collected as  needed and  used  to produce  the skeleton  of  a new
        interface.  Since these packages  may change with requirements  (and as
        bugs are  found, as well  as when improvements  are discovered),  it is
        desirable to be able to create  a new version of an interface  with all
        corrections incorporated.  These requirements impose two constraints on
        the assembler:

             A.  It is desirable, to  prevent the number of library  files used
        for an interface from getting out of hand, for each library  package to
        contain ALL code and data allocations required for that  package.  This
        means that all packages should  be able to "scatter" blocks  of storage
        and code to  different MAC segments  to acquire the  appropriate access
        protection.   This  facility  is provided  by  the  NAD  assembler.  In
        particular, a  SEG directive provides  a separate location  counter for
        each segment of address space.

             B.   Since  an  interface  may  go  into  several  machines  (with
        different parameters), it is desirable to be able to transmit a list of
        parameter  and  library  files  on  releasing  an  interface,   so  the
        appropriate  code may  be generated.   To help  prevent  possible human
        errors, the assembler permits this file for use as a COMMAND file.






























                                       7                                 ISIS-I
                     Internally Switched Interface System      December 7, 1979



        =====================================================
        |                                                   |
        |       HARDWARE (INTERRUPTS)                       |
        |                                                   |
        ==========================A===========A===========A=|
        |                         |           |           | |
        |      KERNEL (SCHEDULER) |           |           | |
        |                         |           |           | |
        ========================--V--=======--V--=======--V-|
        |                       |   |       |   |       |   |
        |   DISPATCHER      ----|   |   ----|   |   ----|   |
        |                   |   <=======>   <=======>   |   |
        --------------------|   | F |---|   | F |---|   | F |
        |               |   |   | O |   |   | O |   |   | O |
        |   OTHER       | D | B | R | D | B | R | D | B | R |
        |               | D | A | E | D | A | E | D | A | E |
        ----------------| T | C | G | T | C | G | T | C | G |
                        |   | K | R |   | K | R |   | K | R |
                        |   | R | O |   | R | O |   | R | O |
                        |   | O | U |   | O | U |   | O | U |
                        |   | U | N |   | U | N |   | U | N |
                        |   | N | D |   | N | D |   | N | D |
                        |     D     |     D     |     D     |
                        |           |           |           |
                        |   SLOT 0  |           |           |
                        |  (TYMNET) |           |           |
                        ------------|           |           |
                                    |           |   SLOT 2  |
                                    |           |------------
                                    |   SLOT 1  |
                                    -------------

                                       Figure 1.

             Schematic  layout  of  ISIS.  Showing  the  general  layout  for a
        configuration  with   three  slots.    The  hardware   module  services
        interrupts.   The kernel  schedules all  other processes,  and provides
        communications  between the  hardware  module and  the  individule slot
        processes.  Each slot has up to three processes active.  The foreground
        process  has  the  highest   priority  of  service,  and   is  executed
        periodically,  for  short  time-slices.  The  Dispatcher  has  the next
        highest priority, and runs  whenever any slot's background  process has
        finished.  The background process does the major portion of  the slot's
        work, and communicates with  other slots through the  dispatcher.  Each
        slot has a DDT process associated with it, so that maintainance  can be
        performed on that slot.







                                       8                                 ISIS-I
                       ISIS Process Intercommunications        December 7, 1979


                         2.   ISIS Process Intercommunications



             ISIS is a system to support interface processes.   These processes
        are connected  to a  subset of  NODE PORTS,   and communicate  with the
        other processes  ONLY through a  special process, the  DISPATCHER.  The
        interface  is the  SLAVE process,  and knows  ONLY about  its set  of N
        ports.  The  dispatcher translates  the relative  port number  into the
        appropriate real port and buffer numbers.

             Independent processes  communicate with  the dispatcher  via input
        and output  rings.  Each ring  contains a string  of MESSAGES,  each of
        which has a HEADER of  standard format.  Each message starts on  a word
        boundary.  Each ring is described by a collection of  DISCRIPTOR cells,
        to  permit the  driver  and receiver  to synchronize  with  each other.
        Requiring that messages start on word boundaries also insures  that the
        header can be referenced without consideration of ring folding.

             Each ring descriptor has the following parameters:

                --------.-------.-------.-------
                |      NFMI     |      CEI     |
                |-------.-------.-------.------|
                |       THE RING               |
                |----                      ----|
                |                              |

                where:

        NFMI    next fill message index         H-word
                The chararacter index of the next
                message to be filled
        CEI     current empty index             H-word
                The char. index of the char.
                currently being emptied.
        RING    the ring data                   Variable number of Words
                the set of data

                Associated with each ring is an additional 16-bit quantity:

        MAXI    maximum index
                The number of characters reserved in
                the ring.  Used to cycle indicies.










                                       9                                 ISIS-I
                       ISIS Process Intercommunications        December 7, 1979


                                  2.1  Message Format

             Each message header has the format:

        --------.-------.-------.-------.-------.-------.--
        |     RPORT     |M. TYPE| additional string dependent on MESSAGE TYPE
        ---------------------------------------------------
                Where:

        RPORT   halfword        relative port number for this process.
                                NOTE!!! RPORT = 0 is ALWAYS used for
                                intra-node communications.
        M. TYPE byte            MESSAGE TYPE








                                  2.2  Message Types

             The following message types are defined:

        TYPE    length  usage
        (hex)   (total)

        00      Var.    NEEDLE (valid only from TYMNET to
                        Dispatcher, thence to interface)

                format:

                --------.-------.-------.--------
                |    RPORT      |   0   | length|
                |-------.-------.-------.-------|
                |       INVOICE NUMBER          |
                |-------.-------.-------.-------|
                | Dest. Host #  | Orig. Node #  |
                |-------.-------.-------.-------|
                | Orig. Port #  |  TID  | size  |
                |-------.-------.-------.-------|
                |   USER NAME ("size" bytes long)
                ---------------------------------

             4th byte is additional length of needle (in BYTES).

             (NOTE...since a circuit may originate on another interface in this
        node, then the high-order  bit in port   will  be set, and the  rest of
        the port   is the originating TYMNET port)

             USER NAME is several chars long, terminated by CR or ";"...if this
        is an override logon, the first character of username is "!" [0A1]

                                      10                                 ISIS-I
                       ISIS Process Intercommunications        December 7, 1979



        01-9D   4-A1    data text string

                format:

                --------.-------.-------.-------.-------.-------
                |    RPORT      |   n   |   n characters of data
                ------------------------------------------------

        9E      3       detach (originate yellow ball, initiate 1 min.
                        timeout...zap on return or timeout)
        9F      3       disconnect (ZAP circuit)
        A0      3       apply backpressure
        A1      3       release backpressure
        A2      3       flush output (in direction of this message) [GOBBLER]
        A3      3       flush input (in opposite direction to this message)
        A4      3       data lost in this direction (BLACK BALL)
        A5      3       data lost in opposite direction (GREY BALL)
        A6      3       enter 'DEM' (Defered Echo Mode)
        A7      3       leave 'DEM'
        A8      3       enter 'Transparency'
        A9      3       leave 'Transparency'
        AA      3       GREEN BALL
        AB      3       RED BALL
        AC      3       YELLOW BALL
        AD      3       ORANGE BALL
        AE      3       'break' detected
        AF      3       'hang up'
        B0      4       query terminal parameter N, N in byte 4
        B1      5       set terminal parameter N, N in byte 4, value in byte 5

                format:

                --------.-------.-------.--------
                |    RPORT      |  B1   |   N   |
                --------.------------------------
                | value |
                ---------

                        where "value" may be 1 to 4 significant bits, and:

                N       length  USAGE
                0       1       ECHO CONTROL
                1       1       ECHO CONTROL-I
                2       1       ECHO LF WITH CR
                3       1       ECHO CR WITH LF
                4       1       CR DELAY
                5       4       INPUT BAUD RATE
                6       4       OUTPUT BAUD RATE
                7       1       PARITY
                8       1       HALF-DUPLEX
                9       4       PARAMETER A
                10      4       PARAMETER B

                                      11                                 ISIS-I
                       ISIS Process Intercommunications        December 7, 1979


                11      4       PARAMETER C
                12      1       X-ENABLE
                13      1       ECHO CONTROL-H
                14      1       REVERSE X-ENABLE
                15      4       PARAMETER D

        B2      6       AUX pseudo-needle ***(from TYMNET)

                format:

                --------.-------.-------.--------
                |    RPORT      |  B2   | key** |
                |-------.-------.-------.--------
                *           invoice #           *
                *********************************
                |   local key   |
                -----------------

             NOTE...invoice word  present ONLY  between TYMNET  and ISIS...this
        word is  missing in  the message passed  on.  This  is why  the message
        length is listed as 6.

        B3      6       normal pseudo-needle ***(from TYMNET)

                format:

                --------.-------.-------.--------
                |    RPORT      |  B3   | key** |
                --------.-------.-------.--------
                |   local key   |
                --------.-------.

        B4      4       normal logon character ***(to TYMNET)
                        (NOTE...the high-order bit had better be on, or the
                        supervisor may ignor the characters.)

        B5      3       successful normal logon from this port
                        ***(from TYMNET)

                format:

                --------.-------.-------.--------
                |    RPORT      |  B5   |       |
                --------.-------.-------.--------
                *       invoice #               *
                *********************************

                NOTE...invoice word applies ONLY between TYMNET and ISIS.

        B6      4       normal logon status  ***(from TYMNET)

                format:


                                      12                                 ISIS-I
                       ISIS Process Intercommunications        December 7, 1979


                --------.-------.-------.--------
                |    RPORT      |  B6   | stat  |
                --------.-------.-------.--------

                stat has the format:

                X X X 0 0 S S S
                | | |     |
                | | |     Status message code:
                | | |     0 - continue
                | | |     1 - "please log in"
                | | |     2 - "error, type username"
                | | |     3 - "error, type password"
                | | |     4 - "username"
                | | |     5 - "password"
                | | empty output buffer
                | echo on
                empty input buffer

        B7      8       addendum to accounting

                format:

                --------.-------.-------.--------
                |    RPORT      |  B7   | ignor |
                |-------.-------.-------.-------|
                | 0E|   subtype |  value        |
                ---------------------------------

                        subtype = 0 is disconnect accounting

        B8      3       super-'hang up' (for half-duplex terminals)

        B9      4       set transmit limit

                format:

                --------.-------.-------.--------
                |    RPORT      |  B9   | limit |
                ---------------------------------

                limit is the maximum number of characters the source of data
                should send before dismissing and allowing the destination
                to look at the data, and apply back-pressure, if necessary.

        BA-FF   ?       to be defined as the need arises








                                      13                                 ISIS-I
                       ISIS Process Intercommunications        December 7, 1979


                            2.3  Intra-ISIS Communications

             RPORT  = 0  has special  significance and  formats.   Each message
        header has the format:

        --------.-------.-------.-------.-------.-------.----
        |       0       |SUBTYPE| additional string dependent on subtype
        -----------------------------------------------------

             intra-node subtypes:

        SUB-    LENGTH  USAGE
        TYPE    (BYTES)

        00      3       I am dead (voluntary interface disconnect)
        01      3       Restart interface
        02      3       node has been taken over
                        (originates at TYMNET, goes to all slots)
        03      9       report to supervisor's log
                        (originate at slot, goes to TYMNET)
                        format:

                --------.-------.-------.-------
                |       0       |   03  | key  |
                |-------.-------.-------.------|
                |      HW4      |      HW3     |
                |-------.-----------------------
                | HW2low|
                ---------

        04      8       report host status
                        (originates in Dispatcher, goes to TYMNET)

                format:

                --------.-------.-------.-------
                |       0       |   4   |status|
                |-------.-------.--------------|
                | Host number   | number/ports |
                --------------------------------

                        status byte is 2 bits of host status (see CNTRL),
                                then 6 bits of slot #.

        05      8       report accounting
                        (originates in Dispatcher, goes to TYMNET)

                format:

                --------.-------.-------.-------
                |       0       |   5   |unused|
                |-------.-------.-------.------|
                |      accounting message      |

                                      14                                 ISIS-I
                       ISIS Process Intercommunications        December 7, 1979


                --------------------------------

        06      8       tell host time (units: seconds since 1974)
                        (originates in TYMNET, goes to slot)

                format:

                --------.-------.-------.-------
                |       0       |   6   |unused|
                |-------.-------.-------.------|
                |             GMT              |
                --------------------------------

        07      7       I'd like a normal circuit pseudo-needle **
                        (originates in slot, goes to TYMNET)

                format:

                --------.-------.-------.------.
                |       0       |   7   | key  |
                --------.-------.-------.------.
                |   local key   |  TID  |
                -------------------------

             The key is used between the dispatcher and TYMNET to keep track of
        the slot making the request, and is meaningless at the slot level.

             The local key  is used for  the slot to  identify a response  to a
        request.  All requests outstanding should have unique local keys.

        08      6       unable to provide normal circuit pseudo-needle **
                        (because no ports available either at TYMNET, or at
                        slot;  originates in TYMNET, goes to slot)

                format:

                --------.-------.-------.--------
                |       0       |   8   | key** |
                |-------.-------.-------.--------
                |   local key   |
                -----------------

        09      7+var   I'd like to build an auxiliary circuit **
                        (originates in slot, goes to TYMNET)

                format:

                --------.-------.-------.------.
                |       0       |   9   | key  |
                --------.-------.-------.------.
                |   local key   | size  |string
                --------------------------------


                                      15                                 ISIS-I
                       ISIS Process Intercommunications        December 7, 1979


             The key is used between the dispatcher and TYMNET to keep track of
        the slot making the request, and is meaningless at the slot level.

             The local key  is used for  the slot to  identify a response  to a
        request.  All requests outstanding should have unique local keys.

             Usage is exactly like the 0:07 request, except that the "TID" byte
        is replaced by a size byte and username string (this should contain the
        username, a ":", and the decimal string denoting the  destination host;
        it is also desirable to terminate the string with either C/R or ";").

        0A      7       unable to provide pseudo-needle for aux. circuit **

                format:

                --------.-------.-------.--------
                |       0       |  0A   | key** |
                |-------.-------.-------.--------
                |   local key   | err   |
                -------------------------

                where "err" means:
                0       ISIS unable to complete request
                1       format error
                2       bad user name
                3       bad mud
                4       system unavailable
                5       down-line load or dial-out failure
                6       timeout








                                     2.4  Circuits

             An interface may originate or terminate circuits, or both.




            2.4.1       Circuit Terminating on a Port

             The  first indication  that an  interface has  of a  circuit being
        built TO  the interface, is  the appearance of  a NEEDLE in  the input.
        When the NEEDLE  arrives, the circuit  is already constructed,  and the
        NEEDLE may be followed immediately by messages for that port.




                                      16                                 ISIS-I
                       ISIS Process Intercommunications        December 7, 1979


            2.4.2       Circuit Origination

             An  interface  may  originate circuits  in  either  of  two forms,
        depending on the characteristics of the interface and  the requirements
        of the circuit.

             Circuits are  actually constructed by  the TYMNET  supervisor, and
        the  ports  are  assigned  external  to  the  interface.   Thus circuit
        origination  involves  some  initial  communication  with   the  TYMNET
        interface, and, through it, the supervisor.

             The first thing an interface must do, to initiate a circuit, is to
        emit the  appropriate form of  pseudo-needle request.  This  travels to
        the TYMNET  interface, which  either rejects it,  or returns  a pseudo-
        needle, causing a circuit  to be constructed THRU ISIS,  connecting the
        node-code  and the  interface.  this  circuit permits  subsequent logon
        information to travel to the supervisor.


        2.4.2.1 Normal Circuits

             A NORMAL circuit  is normally originated  at an external  entry to
        the network, and is characterized by the need for a password.

             The FIRST thing an interface  must do is request a channel  to the
        TYMNET  interface,  via  a  NORMAL-CIRCUIT-PSEUDO-NEEDLE  request.  The
        response  specifies the  port to  use, and  indicates that  an internal
        circuit has been established to the TYMNET interface.

             At this  time, the interface  may proceed with  the login,  in the
        manner of a TYMSAT.

             When  completed,  a  success/failure  indication  is  sent  to the
        interface, and it may then take the appropriate action.

             The actual sequence of transmissions is:

        inter-  TYMNET  Sup
        face
            ==>                 request pseudo-needle
            <==                 pseudo-needle (assigns port on interface
                                        and on TYMNET)
            ==>    ==>          logon character stream appropriate
                                        to type of logon
                   <==          sup provides a needle to TYMNET interface
                                        for succcessful logon
            <==                 successful logon
                ============>circuit    circuit completed to destination


        2.4.2.2 Auxiliary Circuits



                                      17                                 ISIS-I
                       ISIS Process Intercommunications        December 7, 1979


             An AUX circuit is characterized by the absence of a  password.  It
        is used for  well-defined usage, such as  a circuit originating  at tha
        host.

             An AUX circuit is somewhat simpler to construct, since it involves
        only one request and a single response indicating success or failure.

             AUX circuit messages involve a LOCAL KEY, which is a 16-bit number
        generated by  the requesting  interface, and which  is included  in the
        response,  to  permit  the interface  to  distinguish  between multiple
        outstanding requests.  The only constraint on the local key is that all
        outstanding requests should have unique keys, so the resulting circuits
        may be distinguished.









































                                      18                                 ISIS-I
                                    TABLES                     December 7, 1979


                                      3.   TABLES



             There are two tables which are used by the dispatcher  to maintain
        parameters about a given background job.








                           3.1  IST -- Interface State Table

             Fixed locations used to communicate with dispatcher:

        IST     ORG     0
        UPDOWN  HS      1               :host state flag
                                        high two bits are host state
                                                00 - answered
                                                01 - down
                                                10 - shut
                                                11 - gone
                                        low 14 bits may = NPORTS
        ANSHUT  HS      1               :host number if not 0
        FPANEL  HS      1               :status (may be displayed on console)








                          3.2  ICT -- Interface Control Table

             Fixed locations for constants and temp storage for dispatcher:

        ICT     ORG     10000           :force to segment 1
        CNTRL   WS      1               :Control Flags:
                                High bits are used by dispatcher:
                                High 2 bits are host state--
                                        00 - answered
                                        01 - down
                                        10 - shut
                                        11 - host has gone away
                                Low bits are used to control dispatcher--
                                (in terms of hex mask for bit)
                                1       set of project code is to be ignored
                                2       set if ports not reusable until they
                                        emit a disconnect

                                      19                                 ISIS-I
                                    TABLES                     December 7, 1979


                                4       set if number of ports may be redefined
                                8       set if host number may be redefined
                                10      slot wants to know about take-over
                                20      slot wants to know supervisor time
                                40      not used
        ISTART  WC      START           :job execution start address
        HOSTNO  HS      1               :effective host number for this slot
        NOPORT  HS      1               :number of effective terminating ports
                                         (for TYMNET reference)
        HOSTN   HS      1               :Host number for this slot
        NPORTS  HS      1               :highest real port number (from 0)
        IRINGP  WS      1               :Input -- ring descriptor start address
                                        high bit on ==> absolute address
        ORINGP  WS      1               :Output-- ring descriptor start address
                                        high bit on ==> absolute address
        IMAXI   HS      1               :Input -- size of input ring in bytes
        OMAXI   HS      1               :Output -- size of output ring in bytes
        PTABLE  HS      NPORT+1         :Slot permuter table
                                         (extra entry is for port 0)
                                entry = 0 --> not in use
                                entry  >0 --> index for dispatcher buffer
                                entry  <0 --> timeout waiting to be thrashed
                                        (or waiting for disconnect to return)































                                      20                                 ISIS-I
                               ISIS KERNEL SVC'S               December 7, 1979


                                4.   ISIS KERNEL SVC'S



             Under ISIS, there may be  three kinds of jobs running.   These are
        DDT, RUN, and FOREGROUND jobs.  These have different usage, and  so the
        SVC's  are different.   In particular,  many SVC's  are  illegal except
        under DDT.








                                  4.1  STANDARD SVC'S

             The following SVC's are legal from all jobs.  The kernel  may have
        different Interpretations of the usage, as described below.




            4.1.1       DISMISS--                    SVC     DISMISS<0>,VALUE

             Gives  up the  remaining part  of this  time slice.   The  user is
        rescheduled after VALUE seconds, if he is a RUN or DDT user.  If  he is
        a FOREGROUND  user, VALUE is  taken as the  number of clock  ticks (600
        clock  ticks/second)  to  ADD  to  the  job's  timeout  before resuming
        execution.




            4.1.2       RESTART--                    SVC     1,ADDR

             The Restart  SVC causes all  traps to be  taken by the  Kernel and
        passed to the job, rather than crashing the job.  ADDR specifies a user
        address where traps are to be handled.  If ADDR is not a  valid address
        a non-skip return  is made, else  a skip return  is made.  When  a trap
        occurs, the old PSW is stored at ADDR and the user R0 and R1 are stored
        at  ADDR+8.  The  user program  is then  transfered to  the appropriate
        place for  that type of  trap.  (It  is recommended that  ADDR be  in a
        read-only area).   The user code  should later execute  another Restart
        SVC (this later SVC may have ADDR=0 causing the old addr to be used) to
        reenable restart.  If after  a trap causes transfer to  ADDR+n, another
        trap occurs before another Restart SVC has been executed, then the user
        program will be placed in  a permanent sleep state.  The  complete trap
        sequence at ADDR is:

                ADDR    PSD
                ADDR+8  R0,R1

                                      21                                 ISIS-I
                               ISIS KERNEL SVC'S               December 7, 1979


                ADDR+10 MANUAL RESTART
                ADDR+18 POWER FAILURE
                ADDR+20 PARITY ERROR
                ADDR+28 KERNEL CRASH
                ADDR+30 ILLEGAL INSTRUCTION
                ADDR+38 ILLEGAL SVC
                ADDR+40 PRIVILEGE VIOLATION
                ADDR+48 PROTECTION VIOLATION

             NOTE:  Manual Restart and Power Failure will crash ALL  jobs.  The
        others will crash only the  offending job.  When a job is  crashed, any
        associated FOREGROUND job is disconnected too.

             All user programs have read only access to location  0F0000, which
        relocates to an area in low core.  Thus F0000 is NRATE, F0004 is FASTC,
        F0008 is SLOWC, F000C is GMT, F0010 is temperature.




            4.1.3       CONNECT FOREGROUND-PROCESS-- SVC     2,START-ADDR

             The Connect  Quasi-Process SVC  permits a backround  job to  run a
        foreground  process.   The  foreground  (QUASI)  process  is guaranteed
        frequent, short shots at  the CPU, for real-time activities,  while the
        backround  job  has  longer,  less  frequent  shots.   A  normal return
        indicates SVC failure;  Skip (4) return is success.








               4.2  I/O CONTROL--                   SVC        3,OP:REG#

             SVC 3 connects I/O to the job.  The argument has two  fields.  The
        low  4  bits specifies  a  register,  which contains  the  start  of an
        argument  list.   Preceeding  this  is  the  operation  to  perform, as
        specified below.




            4.2.1       I/O STATUS QUERY

             Each different kind of device has certain attributes, which may be
        of interest to user programs for one reason or another.  A mechanism is
        provided to query the attributes connected with each logical unit.




                                      22                                 ISIS-I
                               ISIS KERNEL SVC'S               December 7, 1979


        4.2.1.1 I/O ATTRIBUTES QUERY----OP=800

             The Query Attributes SVC loads a specified buffer in the user area
        with the  appropriate attributes for  the specified logical  unit.  The
        SVC may  fail for invalid  buffer address ONLY,  resulting in  a normal
        return.  A skip return denotes success, and then status  and attributes
        are returned in the specified buffer area.

                REG# contains the logical unit number;
                REG#+1 contains the start address of the buffer;
                REG#+2 contains the number of attribute bytes requested.

             A skip return will always  cause at least one byte  of information
        to be placed in the buffer...the device type:

              value     device type
                0       syncronous line
                1       asynchronous group
                2       printer
              ...
              376       range check...L.U. queried exceeds number supported
              377       no device assigned to L.U.

             If  the number  of bytes  requested is  greater than  1,  then the
        second  byte delivered  is the  actual device  number assigned  to that
        device:   the  string  "00:02..."  indicates  sync  line  2; "01:03..."
        indicates async group 3.

             Each  device  has  a  maximum  number  of  attributes;  the number
        returned  is the  arithmetic minimum  of the  number requested  and the
        number which exist.  If excess  bytes are requested, they will  be left
        in an undefied state.

             NOTE...This SVC requires the use of RX3 instructions!




            4.2.2       SYNCHRONOUS INPUT CONTROL

             Input is via an input  ring, allocated by the user.  This  ring is
        always an even number of bytes (integral number of halfwords),  and has
        a halfword  header which  is the interrupt  routine's pointer  for next
        halfword to fill.  The format is:

                --------.-------
                | fill index   |
                |-------.------|
                |      the     |
                |--   data   --|
                |     area     |
                |--(variable)--|


                                      23                                 ISIS-I
                               ISIS KERNEL SVC'S               December 7, 1979


        4.2.2.1 CONNECT SYNCHRONOUS INPUT----OP=0

             The Connect Input SVC connects the input process associated with a
        job's Logical Unit to the specified input buffer for that job.  The SVC
        may fail for  unassigned Logical unit, or  for the buffer being  out of
        range, resulting in a normal return.  A skip return signifies success.

                  REG# contains the logical unit number;
                  REG#+1 contains the start address of the input buffer;
                  REG#+2 contains the size of the input buffer.  (Does not
                        include the fill index.)

             This  SVC  overrides  any input  currently  in  progress,  and, if
        successful, initializes the buffer header.




            4.2.3       SYNCHRONOUS OUTPUT CONTROL

             Output is via a control (rotor) list.  Each entry is 8-bytes long,
        and is  subject to word  addressing.  When an  entry is  completed, the
        command  portion is  set  to zero,  and  the next  successive  rotor is
        processed.  The format of a rotor entry is:

                --------.-------.-------.-------
                |   COMMAND     |     COUNT    |
                |-------.-------.-------.------|
                | ADDRESS of OUTPUT STRING     |
                --------------------------------

                where:

        COMMAND is one of the set of operations to perform:
        0       stop output...enter marking state
        1       output COUNT bytes starting at ADDRESS
        2       TRANSFER control to ADDRESS
        3       Turn off Request-to-send
        4       Turn on Request-to-send
        5       Set Bit Flag...Bit COUNT relative to ADDRESS
        6       Connect "clear-to-send"...bit COUNT relative to ADDRESS will
                henceforth reflect the state of this line's CS state
        7       Connect ""data-set-ready"...bit COUNT relative to ADDRESS will
                henceforth reflect the state of this line's DSR state
        8       Turn off Data-terminal-ready
        9       Turn on Data-terminal-ready.
        10d     Set Output Padding to COUNT.

             Output padding is what the  line does when it has nothing  else to
        do.  The  default is  all bits  on ("marking  state").  The  default is
        restored when a line is disconnected from a process.



                                      24                                 ISIS-I
                               ISIS KERNEL SVC'S               December 7, 1979


             NOTE...A  restriction exists...The  command list  and all  of it's
        operands  MUST  be  within  the same  MAC  segment.   Also,  since some
        physical lines do  not have RS or  CS, these commands are  skipped over
        (the driver ignores them) for these lines.

             The attribute list has maximum length of 3 bytes.  These are:

                                       00:sl:sa

             where 00 is the  device type, "sl" is  the sync line, and  "sa" is
        the sync attributes:  x'80' indicates that the line  supports "RS"/"CS"
        usage.


        4.2.3.1 CONNECT OUTPUT----OP=1

             The  Connect  Output SVC  attempts  to connect  a  list  of output
        descriptors to a logical unit.  A normal return indicates  failure, due
        to an invalid specification, or to a logical unit being active.

             A skip return indicates the output operation has started.

                  REG# contains the logical unit number;
                  REG#+1 contains the address of the first output descriptor.

             NOTE...output  descriptors and  buffers MUST  be in  the  same MAC
        segment.


        4.2.3.2 FORCE OUTPUT----OP=2

             The  Force  Output  SVC  attempts  to  connect  a  list  of output
        descriptors to a logical unit.  A normal return indicates  failure, due
        to  an  invalid  specification.  A  skip  return  indicates  the output
        operation has  started.  Any output  currently in progress  is aborted,
        possibly without indication.

                  REG# contains the logical unit number;
                  REG#+1 contains the address of the first output descriptor.

             NOTE...output  descriptors and  buffers MUST  be in  the  same MAC
        segment.


        4.2.3.3 T-II SYNC-LINE CONNECT----OP=6

             The  TYMNET-II sync  line  connect causes  the  special, TYMNET-II
        sync-line driver to be connected for the specified logical  unit.  This
        driver is  very specific  to TYMNET-II, and  is of  no interest  to any
        other application, except for the need to be aware of it's presence.




                                      25                                 ISIS-I
                               ISIS KERNEL SVC'S               December 7, 1979


        4.2.3.4 T-IISYNC-LINE IDLE TEST

             This  SVC permits  the testing  of a  TYMNET-II sync-line  for the
        presence  of  any  transmit  activity.   It  is  of  no  use  to  other
        applications.




            4.2.4       ASYNCHRONOUS I/O

             The attribute list has maximum length of 3 bytes.  These are:

                                       01:ag:aa

             where 01 is the device  type, "ag" is the async group  number, and
        "aa" is  one byte of  attributes:  x'80' indicates  that the  group can
        support 1200-baud.

             Async I/O is bi-directional.  Commands are transfered  between the
        driver and the job in the data stream.  Character "00 is  an escape--it
        is  always  of the  form  "00:"XX; in  particular,  the  character pair
        "00:"00 is data "00.  If the second character of an escaped  pair ("XX)
        is not "00, it is treated as a command.

             the following commands apply, from the job to the driver:

        "01--"8F   generate "XX 1/30-second delays;
        "90--"AF   set output baud rate index to ("XX-"90);
        "B0--"CF   set input baud rate index to ("XX-"B0);
                   Baud rate indicies are:
                   0    10 cps
                   1    15 cps
                   2    30 cps
                   3    40 cps
                   4    60 cps
                   5    120 cps
                   6    30 cps (3767)
                   7    14.7 cps (2741)
                   8    10 cps (at 300 baud)

        "D0--"DF   enter connect mode ("XX-"D0);
                   Place the driver into 'TID' mode.
                   Current modes are:
                   0    TYMNET TID mode

        "E0        enter data mode;
        "E1        disconnect;
        "E2        enable;
        "E3        RS up;
        "E4        RS down.

                   All others are ignored.

                                      26                                 ISIS-I
                               ISIS KERNEL SVC'S               December 7, 1979


             the following commands apply from the driver to the job:

        "80--"8F   Connect mode has detected a character input,
                   and thinks the input baud rate is ("XX-"80):
                   this pair will always be followed by the data
                   character observed, as seen at that speed;

        "90        Start-of-break detected;
        "91        End-of-break detected.


        4.2.4.1 CONNECT ASYNC----OP=3

             The Connect Async SVC attempts to connect a list of pointers to an
        Async  logical unit.   An ALU  covers a  group of  16 ports.   A normal
        return indicates failure, and  leaves the unit disconnected.   This may
        be due to the logical unit not being valid, not being of type Async, or
        because  one of  the  pointers is  outside of  the  requestor's address
        space.

             A skip  return indicates  success, and the  logical unit  has been
        connected.

             if any of the pointers is = 0, that element is NOT connected.

                REG#    Logical Group number
                REG#+1  pointer to start of Group ring array **
                REG#+2  address of Group CP halfword
                REG#+3  address of Group DSR halfword
                REG#+4  address of Group DTR halfword
                REG#+5  address of Group TOPORT halfword **
                REG#+6  address of Group FROMPORT halfword **
                REG#+7  address of Group TAM halfword **

                where:

             Ring array is an array of 16 32-byte blocks, one for each  port in
        the group.  Each block consists of 2 16-byte rings, the first  of which
        is for input TO the slot.  A  ring consists of 1 byte of fill  index, 1
        byte of empty index, and 14  bytes of ring storage.  The ring  is empty
        when the fill index = the empty index.

             CP is the halfword bit array for Carrier Present.

             DSR is the halfword bit array for Data Set Ready.

             DTR is the halfword bit array for Data Terminal Ready.

             TOPORT is the halfword bit  array for data present in  port output
        ring.

             FROMPORT is the halfword bit array for data present in  port input
        ring.

                                      27                                 ISIS-I
                               ISIS KERNEL SVC'S               December 7, 1979


             TAM is the halfword bit array for output ring full.

             **TOPORT, FROMPORT, and TAM  are ignored if Ring array  pointer is
        null.




            4.2.5       PRINTER OUTPUT

             The printer is a pure output device.  the only quantity "input" is
        status information.

             The attribute list has maximum length of 2 bytes.  These are:

                                         02:pp

             where 02 is the device type, and "pp" is the printer number.

             Output is via a control (rotor) list.  Each entry is 8-bytes long,
        and is of the same format as in SYNCHRONOUS OUTPUT CONTROL, above.  The
        only meaningful commands are:

        0       stop output
        1       output COUNT bytes starting at ADDRESS
        2       TRANSFER control to ADDRESS


        4.2.5.1 CONNECT PRINTER----OP=4

             The  Connect  Printer SVC  attempts  to connect  the  list  to the
        printer driver logical unit.  A normal return indicates failure, due to
        an invalid specification, or to the logical unit being active.

             A skip return indicates the output operation has started.

                REG# contains the logical unit number;
                REG#+1 contains the address of the first output descriptor;
                REG#+2 is a pointer to the halfword that you want the printer
                status saved in.


        4.2.5.2 FORCE PRINTER OUTPUT----OP=5

             The Force Printer is  like Connect Printer, except that  if output
        is in progress, it is terminated, and the new output is started.








                                      28                                 ISIS-I
                               ISIS KERNEL SVC'S               December 7, 1979


            4.2.6       EXPERIMENTAL SIO CARD

             The  experimental  SIO (XSIO)  card  is a  device  to  offload and
        service synchronous  lines operating under  HDLC protocol.  The  use of
        this  device is  rather  specialized, and  will be  superceeded  when a
        general card is developed;  as a result, only a cursory  description of
        the SVC is given.

             The card examines certain addresses in real memory...each of these
        is a block of 30  (48d) bytes, containing the information  available to
        the card.   The data  blocks start at  real address  500, and  are made
        available to  any process  by mapping them  to virtual  address 0F0100.
        These  locations  are read  only!   In particular,  line  0's  table is
        available for inspection, at 0F0100, line 1 at 0F0130, etc.

             In addition, there is a  buffer area area required for  each line,
        which the card requires be in low memory (the first 64K).   These areas
        have been arbitrarily limited to be a 4K block (each  line), consisting
        of 8 input  buffers, of 256 bytes  (each buffer), followed by  8 output
        buffers.  Each  buffer contains  a half-word  of flag,  indicating that
        that buffer contains data if non-zero; this is followed by  a half-word
        count specifying the number of  bytes in that buffer; followed  in turn
        by up to 252d bytes of data.  These buffers are round-robin:   when the
        first is serviced, control is advanced to the next.


        4.2.6.1 CONNECT XSIO---OP=8

             The attribute list has maximum length of 2 bytes.  These are:

                                         03:ln

             where 03 is the device type, and "ln" is the physical line number.

             The connect  XSIO SVC  attempts to  connect the  specified logical
        unit:

                REG# contains the logical unit number;
                REG#+1 contains the maximum record size (<253) to be
                        transmitted.

             A normal return indicates failure, due either to bad  device type,
        or  to  bad specification  (size  too big).   A  skip  return indicates
        success.  Then (and not before) the buffer area may be addressed:  this
        will be a 4K  segment assigned to the  slot at this time.   The segment
        number  assigned is  4+ln.   That is,  physical  line 0's  area  may be
        addressed starting at 040000, line 1's area at 050000, etc.  These area
        are NOT in the user address space until this SVC is executed!






                                      29                                 ISIS-I
                               ISIS KERNEL SVC'S               December 7, 1979


                4.3  DISC AND TAPE I/O CONTROL--     SVC        4,ADDR

             For  a variety  of reasons  (such as  common drivers,  required by
        constraints imposed by the  selector channel), the DISC driver  and the
        TAPE driver are treated in a similar manner.

             In particular, requests to  either type of device are  queued, and
        are serviced in turn, by the driver.

             ADDR is the address of a parameter block, of form:

                        --------.-------.----------------
                        |O| R/S |  LU   |    status     |
                        |-------------------------------|
                        |              VMA              |
                        |-------------------------------|
                        |             COUNT             |
                        |-------------------------------|
                        |               P               |
                        ---------------------------------

                where:

        O       high bit = execution overlap...if off (0), dismiss until
                  operation complete.

        R/S     operation requested, status of complete operation.

                R:
                0       read
                1       write
                2       attach unit - make unit available exclusively to this
                          ISIS slot
                3       detach unit - make unit available to other ISIS slots

                S:
                0       operation completed successfully
                1       bad memory accesss
                2       no access allowed to this unit
                3       read/write/attach protection failure - access not
                          allowed
                7       error return from unit
                8       error return from controller
                9       operation aborted by quit character
                A       requested byte count 0 or odd
                12      device unavailable
                13      attempt to write on write-protected volume
                14      unit successfully attached, but volume is
                          write-protected
                15      unit attached to another slot, slot number in "status"
                16      operation ignored for this type of unit
                17      selector channel timeout


                                      30                                 ISIS-I
                               ISIS KERNEL SVC'S               December 7, 1979


        LU      the local I/O unit to access.

        status  device dependent status bits returned on termination of
                  the operation.

        VMA     Virtual Memory Address...the address of the first byte of
                  the buffer.

        COUNT    the number of bytes to transfer

        P       position (device dependent)

             The  last three  arguments are  ignored, except  on read  or write
        operations.

             This SVC is illegal if there is no LU assigned with this number.

             There is a "get status" operation which returns  information about
        a slot's unit.  This information is returned directly to  the parameter
        block, and is of format:

                        --------.-------.----------------
                        |   0   |  LU   |     status    |
                        |-------.-------.---------------|
                        |  PM   |  GU   |       DDB     |
                        |-------.-------.---------------|
                        | TYPE  |  DA   |      name     |
                        |-------------------------------|
                        |             GUDW              |
                        ---------------------------------

                where:

        PM      protection mask:
                bit 0   read access permitted to unit
                    1   write access permitted to unit
                    2   slot can attach/detach unit
                  3-7   reserved

        GU      Global Unit number - used to index system's unit table

        DDB     default block size for device - 256d for disc
                  used when user-supplied "COUNT" is zero.

        TYPE    device type:
                0       disc
                1       tape

        DA      Device address on I/O bus - eg. 0C6

        name    two char ASCII device mnemonic - eg, "DK", "MT"

        GUDW    Global Unit Discription Word

                                      31                                 ISIS-I
                               ISIS KERNEL SVC'S               December 7, 1979


            4.3.1       TAPE SVC

             Additional details:

        R       operation requested:
                0       read a record - count actually read returned in "COUNT"
                4       backspace one record
                5       skip forward file
                6       skip backward file
                7       write end-of-file
                8       rewind
                9       unload - put tape offline
                A       get status
                B       erase gap
                C       set low density (dual density tapes only)

        S       operation status:
                10      end-of-file detected during write, read, backspace, or
                          skip operation
                11      end-of-volume detected during write, read, or skip

        status  status bits returned on termination of the operation:

                --------.-------.-------.--------
                |E|E|E|       |D|     |I|H|W|B| |
                |R|O|N|       |U|     |L|I|P|O| |
                |R|F|D|       | |     |L| | |T| |
                ---------------------------------
                bit:
                0       read or write data overrun/error
                1       EOF detected during read, write, backspace, or skip
                2       unit is at BOT or EOT
                3-6     reserved
                7       device unavailable
                8-10    reserved
                11      illegal operation attempted - eg, erase, write or write
                          EOF on write-protected tape
                12      high density selected (default) - this bit will always
                          be selected for single-density drive
                13      tape is write-protected
                14      tape is at BOT
                15      reserved

        P       always ignored! - need not be present except for
                  "request status"

             This SVC is illegal if there is no tape configured.







                                      32                                 ISIS-I
                               ISIS KERNEL SVC'S               December 7, 1979


            4.3.2       DISK I/O

             Additional details:

                R:
                0A      get unit status.  then:
                GUDW    Global Unit Discription Word
                  formatted for disc as follows:

                ----------------.----------------
                | start cyl. no | no. of cyls.  |
                ---------------------------------

                S:
                  The first 5 errors indicate no data tranfer has occured
                4       virtual block number (P) out of allowed area
                  The next 2 errors are due to bad Kernel tables and
                  should never happen!!
                5       Bad cylinder address
                6       same as 5 but some data tranfer has occured
                  The next 2 errors indicate an error return from
                  the device.  The device status byte is placed in the
                  right byte of the return status
                7       Error return from the disk - eg, disc seek error
                8       Error return from the controller - eg, parity error
                B       invalid cylinder overflow indication
                        this is the half word device problem
                C       controller error - defective sector in
                        alternate cylinder
                D       controller error - defective sector
                        no alternate cylinders left
                E       could not read disk map for this disk
                        no transfers to this disk are permitted
                F       controller error - defective sector
                        alternate cylinder has been assigned
                        all future references to a block in this
                        cylinder will be relocated - ALL data on this
                        cylinder has been lost

        P       position.  What sector (256 bytes long), relative to beginning
                  of area, to start I/O at.




            4.3.3       DISK I/O (BLOCK)             SVC    0E,ADDR

             This is an obsolete  SVC, included for backward  capability.  Each
        user may have up to 8 areas on the disk, numbered 0 to 7.  Each area is
        a fixed integral number of blocks long.  The number of blocks  per area
        is  determined by  the  area's allocation.   ADDR  points to  a  3 word
        parameter block, of format:


                                      33                                 ISIS-I
                               ISIS KERNEL SVC'S               December 7, 1979


                        ---------------------------------
                        |O     R/S      |     count     |
                        |---------------|---------------|
                        |               |A|     P       |
                        |-------------------------------|
                        |      core start address       |
                        ---------------------------------


        R       operation to be performed.  Up to 5 such requests may be made.
                low order bits designate operation:
                0       read
                1       write

        S       Status of operation.  The status is returned in the left-most
                  byte, and in SOME cases there is additional information
                  in the next byte, when appropriate:

                0       no errors encountered...operation successful
                  The first 5 errors indicate no data tranfer has occured
                1       Bad memory access
                2       Bad disk area number
                3       Bad disk area access
                4       Virtual disk address out of area
                  The next 2 errors are due to bad Kernel tables and
                  should never happen!!
                5       Bad cylinder address
                6       same as 5 but some data tranfer has occured
                  The next 2 errors indicate an error return from
                  a device.  The device status byte is placed in the
                  right byte of the return status
                7       Error return from the disk
                8       Error return from the controller
                9       Aborted by quit character
                A       User requested transfer of zero blocks
                B       invalid cylinder overflow indication
                        this is the half word device problem
                C       controller error - defective sector in
                        alternate cylinder
                D       controller error - defective sector
                        no alternate cylinders left
                E       could not read disk map for this disk
                        no transfers to this disk are permited
                F       controller error - defective sector
                        alternate cylinder has been assigned
                        all future references to a block in this
                        cylinder will be relocated - ALL data on this
                        cylinder has been lost

        A       area number.  There may be several areas on the disk available
                  to a single user.

        P       position.  What sector (256 bytes long), relative to beginning

                                      34                                 ISIS-I
                               ISIS KERNEL SVC'S               December 7, 1979


                  of area, to start I/O at.

        number of bytes number of bytes to transfer.

        core start address      address of the start of the core buffer.

             A address is a 3 bit area number.

             P is a 13 bit block  offset into the area.  block offset  into the
        area.




            4.3.4       DISK I/O (SECTOR)            SVC    0F,ADDR

             This is an obsolete SVC, included for backward compatability.  The
        description of SVC 0E applies  exactly to SVC 0F after  substitution of
        "sector" for all occurances of "block".  (A sector contains  256 bytes;
        a block contains 1024.)








                                    4.4  DDT SVC'S

             The following SVC's apply only to DDT users.




            4.4.1       TTY INPUT--                  SVC     0A,REG:TIME

             REG-TIME are two fields of  one byte each.  REG is the  left byte,
        TIME is the  right byte.  A single  character is read and  deposited in
        the user's  register specified  by REG (low  order 4  bits) and  a skip
        return is executed.  If  the input buffer is  empty the user is  put to
        sleep until a character arrives  or TIME seconds have elapsed.   If the
        sleep is terminated by a character arriving a skip return  is executed,
        else a non skip return is executed.  If the buffer is empty and TIME is
        zero a non skip return is executed immediately.









                                      35                                 ISIS-I
                               ISIS KERNEL SVC'S               December 7, 1979


            4.4.2       TTY OUTPUT--                 SVC     0B,ADDR

             A string is sent to the terminal.  The byte at ADDR is a  count of
        how many  subsequent bytes are  to be sent  to the terminal.   The user
        program may be put to sleep by this SVC depending on the length  of the
        output string  and the  condition of the  user's Kernel  output buffer.
        Characters in the  string with hex values  between 0 and  7, inclusive,
        are escaped with a zero for network purposes.




            4.4.3       GENERAL--                    SVC     0D,TYPE

             TYPE determines the meaning of this SVC as follows:

                0  detach circuit (ZAP circuit and log the user out);
                1  transfers control to the command handler (DDT);
                2  returns low 6 bits of TYMNET terminal i.d. (in R0);
                3  turn echo on;
                4  turn echo off;
                5  flush outbound circuit (emit GOBBLER);
                6  change context (to slot with key specified by R0);
                7  change context (to default user-block for name);
                8  check own background;
                9  check any background.

             Change context permits the transfer of a user from one  slot's DDT
        to  another, if  various  criteria are  met.   This SVC  expects  R0 to
        contain a slot key, used to search for the target slot.  If successful,
        transfer is effected to the new slot, and the old is released.   Else a
        diagnostic is issued to the terminal, and:

             Normal  return,  if  there are  NO  slots  available  for transfer
        destination;

             Skip^1 (4) return if no slot is available with the specified key;

             Skip^2  (8)  return,  if  the  requestor  does  not  have adequate
        licences for the destination slot;

             Skip^3  (12d)  return, if  the  requestor username  is  tied  to a
        specific slot, other than the one specified.

             Change context (default) locates the user-assigned slot  (if any),
        and transfers control there.  If no slot is assigned, Skip^3 return.

             Check any background expects a slot key in R0.

             Check any/own background searches  the run list for  a back-ground
        job with the  required key.  Normal return  if not found.   Else Skip^1
        return,  then R0  contains the  execution address  of  that back-ground
        slot.

                                      36                                 ISIS-I
                               ISIS DDT COMMANDS               December 7, 1979


                                5.   ISIS DDT COMMANDS



             ISIS DDT is a subset of the KERNEL process on the  interdata.  One
        may log into  ISIS on any given  interdata, by directing the  log-in to
        that machine's host 0.

             The  kernel  has a  good-guy  list, used  to  verify  the username
        logging in.  If the  user-name is valid, login may  proceed;  otherwise
        the  user  is  dropped.   If  valid,  the  list  is  checked  for  slot
        assignment.  If no slot is assigned to this user, the kernel asks for a
        slot number.  Once the slot has  a valid slot number, and if  that slot
        is available, the kernel will  connect the user to DDT.  The  user sees
        (USER TYPES, kernel types):

        USER:377;PASSWORD
        slot# :3                (only if no slot is pre-assigned)
        *

             When the "*"  prompt occurs, the user  is connected to  DDT.  Then
        the commands below can be used.

             Each user name in  the good-guy list has certain  status assigned.
        In particular, a user may be privileged or non-privileged.

             A  non-privileged user  may  perform certain  operations,  such as
        reading any location in the slot's address-space, or writing into those
        segments of the address-space that the program can write into.

             A privileged  user can execute  additional commands,  which change
        the state of  the slot, and  can write into  all of the  slot's address
        space.   This includes  loading, or  placing patches,  into  the write-
        protected segments.








                                        5.1  A

             Address::  [PRIVILEGED COMMAND]   Set  up address  space  for slot
        (other than slot 0).  At the next prompt, can enter MAC description:

             R SEG SIZE----set up mac register SEG to hold at least SIZE bytes.
        If  size  is  >10000,  will  allocate  multiple   successive  segments.
        Segments need not be defined  in order.  The command may abort  if more
        segments are invoked than are supported.



                                      37                                 ISIS-I
                               ISIS DDT COMMANDS               December 7, 1979


             I----initialize the mac.  May abort if more core is  required than
        is available for slot.  All segments (other than seg 1)  have write/no-
        execute access; segment 1 has read/execute access.  Segments which were
        not defined are not accessible.  (Note...  if NO segments were defined,
        then segment 0 is set up for full size, read/write/execute access.)








                                    5.2  B ADDR NUM

             Breakpoint::  Set breakpoint  NUM at  ADDR.  B  will undo  any old
        breakpoint NUM.  If ADDR is zero B will undo the old breakpoint only.








                                        5.3  E

             Execute:: [PRIVILEGED COMMAND]  connects the job associated with a
        slot (other than slot 0), and starts execution independent of DDT.








                                      5.4  G ADDR

             Go:: Causes your program to start at ADDR.  It creates a PSW using
        a half word  in the user  block.  The status bits  may be changed  by a
        privileged user through the U command.












                                      38                                 ISIS-I
                               ISIS DDT COMMANDS               December 7, 1979


                                        5.5  H

             Halt:: [PRIVILEGED COMMAND]  halts the job associated with  a slot
        (other than slot 0).








                                        5.6  I

             Initialize:: Should only be typed after a new load.








                      5.7  L DISK-ADDR NUMBER-OF-BLOCKS MEM-ADDR

             Load  memory from  disk.:: [VALID  ONLY IF  SYSTEM  INCLUDES DISK]
        Reads NUMBER-OF-BLOCKS starting at user's virtual DISK-ADDR storing the
        result starting at user's MEM-ADDR.








                            5.8  M MASK START-ADDR END-ADDR

             Mask for search:: Set search MASK and range FOR X AND  Y commands.
        The MASK is one word (a MASK of 0 translates to -1).














                                      39                                 ISIS-I
                               ISIS DDT COMMANDS               December 7, 1979


                                        5.9  N

             Next:: Sets a special breakpoint after the current instruction and
        then executes the current instruction.








                                        5.10  P

             Proceed:: Must  be used to  continue from a  breakpoint.  Restores
        identical status that existed when breakpoint was reached.








                                  5.11  R ADDR COUNT

             Read memory:: Prints contents of COUNT bytes starting at ADDR.








                                  5.12  RR REG COUNT

             Read registers::  Prints contents of  COUNT registers  starting at
        REG.   These  are  the  register  values  at  the  time  the  last user
        instruction was executed.














                                      40                                 ISIS-I
                               ISIS DDT COMMANDS               December 7, 1979


                      5.13  S DISK-ADDR NUMBER-OF-BLOCKS MEM-ADDR

             Save memory on  disk.:: [VALID ONLY  IF SYSTEM INCLUDES  DISK] Has
        opposite effect of L.








                                        5.14  T

             Type old PSW:: Types PSW as it was when last user  instruction was
        executed.  Two additional digits are typed indicating the cause  of the
        last MAC interrupt or machine malfunction.








                                      5.15  U NUM

             User Status:: When executed by a non-privileged user makes  NUM (4
        bits) the  condition code in  the new psw  created by all  subsequent G
        commands.  When executed by a privileged user makes NUM (half word) the
        status bits used for all subsequent G commands.  In addition  the users
        old psw is changed to NUM for the status bits and zero for the location
        counter.

             !!!!!!!!!!!!!!!!  ATTENTION !!!!!!!!!!!!!!!!!!!!   All breakpoints
        must be cleared bfore the U command is used to turn the MAC on or off!








                                  5.16  W ADDR COUNT

             Write memory::  Reads COUNT bytes  from the terminal  and deposits
        them starting at ADDR.






                                      41                                 ISIS-I
                               ISIS DDT COMMANDS               December 7, 1979


                                  5.17  WR REG COUNT

             Write  registers::  Reads  4*COUNT  bytes  from  the  terminal and
        deposits them in the register save area starting at REG.








                              5.18  X (0,1) (1,2,4) VALUE

             Data search::  0 or  1 (match or  non-match) 1,2  or 4  (number of
        bytes long).  VALUE  is one word.   The search range  set in M  is used
        with the mask set in M.  The mask is applied only the memory value, not
        the search  value.  In  a match  search only  the addresses  of matched
        cells are printed, in non-match search both address & value are printed
        (on seperate lines).








                         5.19  Y (1,2,3) VALUE1 VALUE2 VALUE3

             Instruction  search::  1,2 or  3  (length of  instruction  in half
        words).   enter  search  value in  appropriate  number  of  half words.
        Search is match only and used  search range set in M but not  the mask.
        Addresses of matches are printed.








                                        5.20  Z

             Zap::  Command to  log off.   Responds with  ZAP? to  confirm your
        intentions.  Type Z to log off, anything else to abort log off.

             Other debugger commands  exist but should  not be used.   They and
        their consequences are:





                                      42                                 ISIS-I
                               ISIS DDT COMMANDS               December 7, 1979


                                  5.21  C  don't use!

             The C  command is used  to switch from  ascii input to  binary and
        back  again.   It is  used  primarily by  NAD,  and use  by  logging in
        directly may cause strange operations.








                                    5.22  control-C

             A control-C is used to interrupt a user program and return control
        to DDT.  It also flushes all characters previously input.








                                    5.23  control-O

             A control-O is used to  flush the input and output  buffers.  This
        also terminates any output SVC in progress.








                                        5.24  \

             "\" is  normally used to  recover from an  unrecognizable command.
        It effectively restarts DDT.  Starting (or restarting) DDT includes the
        examination of  a diagnostic  to determine  if any  abnormal conditions
        have occured  since the  last start.   These conditions  include parity
        error,  illegal memory  references, illegal  SVC's, or  KERNEL crashes,
        either  within DDT,  or  within any  of  the domain  controlled  by DDT
        (Background, Foreground, etc.).  "\" may be used instead of any command
        to examine this diagnostic.







                                      43                                 ISIS-I
                               ISIS DDT COMMANDS               December 7, 1979


                                      5.25  ^ NUM

             "^"  attempts  to  transfer  control  from  the  DDT  of  the slot
        currently logged into,  to the slot specified  by NUM, if  all criteria
        for logging into that slot are otherwise satisfied.  If not successful,
        diagnostics are generated.








                                    5.26  ?COMMAND

             "?"  followed  by  a  command  string  (with  possible arguments),
        terminated with any delimiter, invokes special commands:




            5.26.1      ?B        --query Breakpoints

             ?B outputs a table showing where breakpoints are currently set.




            5.26.2      ?MAC      --query MAC

             ?MAC outputs a table showing the slot's current MAC configuration.




            5.26.3      ?SLOT     --query SLOT number

             ?SLOT outputs the current slot's key.




            5.26.4      ?BT       --query Background PSD

             ?BT outputs the current (running) background PSD.  Approximate!








                                      44                                 ISIS-I
                               ISIS DDT COMMANDS               December 7, 1979


            5.26.5      ?FT       --query Foreground PSD

             ?FT outputs the current (running) foreground PSD.  Approximate!




            5.26.6      ?BRR R N  --query Background's Read Registers

             ?BRR   outputs   the  current   (running)   background  registers.
        Approximate!   "?BRR"  works like  "RR",  with "R"  being  the starting
        register, and "N" being the number of registers to display.




            5.26.7      ?FRR R N  --query Foreground's Read Registers

             ?FRR   outputs   the  current   (running)   foreground  registers.
        Approximate!   "?FRR"  works like  "RR",  with "R"  being  the starting
        register, and "N" being the number of registers to display.

             NOTE..."APPROXIMATE" indicates that the multiple-words  output are
        not necessarily correlated.   DDT will "snapshot" each  successive word
        and output it, but may be dismissed after any word is  output, allowing
        the  process  being  monitored  to  run,  and  change  the  items being
        examined.  USE THIS FACILITY WITH CAUTION!




            5.26.8      ?CT       --query Channels Terminating

             ?CT  outputs a  table  (for slots  connected to  DDT)  of channels
        connected to the slot.  Each is of form:
                PORT i -->Sn:j

             where i is the port number on that slot, n is the slot it connects
        to, and j is the port number on that slot.




            5.26.9      ?RET      --query return

             If you  have a  user-name assigned  to a  specific slot,  and have
        transfered  to DDT,  ?RET will  take you  back (equivalent  to  the "^"
        command, except that you don't  have to know what slot key  is assigned
        to you).





                                      45                                 ISIS-I
                           NAD-KERNEL COMMUNICATIONS           December 7, 1979


                            6.   NAD-KERNEL COMMUNICATIONS



             To communicate with the resident ISIS DDT from NAD, one must first
        establish a circuit via the ;C command.  For example:

        ;C      ISIS:377;

             builds a circuit to DDT on host 377 with user-name ISIS.  ;C types
        3 blanks  and expects a  logon string up  to the first  semicolon (";")
        followed by a carriage return.

             DDT will first validate the  user name, and then will  request the
        user to  enter the  slot number.  Use  the ";R"  command for  this (DDT
        expects a binary number over an auxiliary circuit).

             for example (USER TYPES, typed back):

        ;C   USER:377;
        working
        slot# :;R03     (only if name is not preassigned to a slot)
        *

             The "*" prompt  from DDT shows that  the user is now  connected to
        the slot he specified.

             Any circuit thus built will be zapped if the user executes  the %Q
        command.








                                 6.1  NAD-DDT commands

             Most of the DDT commands implemented in the ENGINE are implemented
        in NAD with a similar calling sequence.  The normal syntax is a command
        character followed by  an argument string which  has N arguments  and N
        delimiters;  namely, N-1 commas  and one carriage return  the arguments
        can  be  complex  expressions  involving  symbols  defined  during  the
        assembly.

             The ISIS DDT commands B,  G, H, I, K, L, P,  R, S, T, W, X,  Z are
        the  same  in NAD  except  that  the command  character  is  either ":"
        followed by the  character, or a  control character, such  as control-G
        for the Go command.  Other commands are :E or ;E for the E command, :RR
        or control-E for the RR  command, :WR or control-F for the  WR command,
        :N  or control-Q  for  the N  command and  :M  or control-N  for  the M
        command.

                                      46                                 ISIS-I
                           NAD-KERNEL COMMUNICATIONS           December 7, 1979


             Using control characters as commands to IDDT has had  some awkward
        side  effects.   Introduction  of line  editing  has  also  caused some
        commands  to be  impossible (^A,  ^Q in  XEXEC; ^U  in PDP).   Any IDDT
        command may now be  entered in the form ":X"  where "X" is the  same as
        would be entered in IDDT directly.  For example, ":N" is Next,  ":M" is
        Mask, ":RR" is Read Register.

             NOTES:

             :A - after ":" response to :A, use ":R" and :I" to  initialize the
        MAC.

             :R :RR,:W  :WR - Due to the  fact that the command syntax  uses no
        seperator between the command and the parameters, if a symbol beginning
        with "R" is used as the first parameter, it must be preceeded by  a "+"
        operator.  For example;

        :R+RET,4        reads 4 bytes starting at "RET"
        :RRET,4         reads 4 registers starting at "ET"

             :Z response is :Z.

             :\ is the same as %\.

             aborting  the  :W  command  does  not  require  entering  ;R81C3C1
        ("flush"::"C"::"A") as NAD will do this for you.

             The following commands are different than their  equivalent direct
        IDDT commands:

        :WRreg,val       store "val" in register "reg".

        :Wadr,val        store "val" right adjusted in the 4 bytes
                        starting at "adr".

        padr,vadr,bcnt:W copy "bcnt" bytes from PDP local memory
                        starting at "vadr" to ENGINE memory starting
                        at "padr".

        adr,bcnt:W       same as "adr,adr,bcnt:W".

        param:W          illegal - see note below.

             sym: is NOT an IDDT  command but defines symbol "sym" to  have the
        current position counter value.

             Characters emitted  from the  ENGINE are  typed on  the NAD-user's
        terminal as they arrive.  normally they are sent to the  user's command
        tty in  asc mode.  However,  they can be  split into 2  hex characters.
        The ENGINE  output relay function  will be changed  to hex if  the user
        types  "1;R".  "0;R"  returns  the relay  function to  normal.   Do not
        confuse this ";R" command,  which has an argument before  the semicolon


                                      47                                 ISIS-I
                           NAD-KERNEL COMMUNICATIONS           December 7, 1979


        with the ";R" command explained  below that has no argument  before the
        semicolon.

             Typing  errors are  best corrected  with the  "%\"  command.  "%\"
        sends a "\" to the ENGINE.   If you foul up the argument string  to the
        control-R  command,  just  type  a  few  "%\"  commands  until  you are
        satisfied with the feedback you get from the ENGINE.

             The control-W command in NAD take exactly 3 arguments in  the same
        convention as the 3-argument option to the ;7 command.

             Miscellany:

             The control-Z command is confirmed with a control-Z.

             Use control-N for the M command.

             Use ":N" or control-Q for the N command.

             Use control-E for the RR command.

             Use  control-F  for  a write-1-register  command.   first  arg. is
        register number.  Second arg is a new value for that register.

             %C and %O  send control-C and control-O  to the ENGINE as  well as
        clearing the  input that  has arrived  in the  pdp-10 on  the auxiliary
        circuit and clearing the command-out circuit that is flooded.

             There is  a handy ;R  (relay) command in  NAD for  sending general
        info to the  ENGINE (or any  other host) that  the NAD user  has logged
        into via the ;C  command.  The ;R is followed  by a string of  pairs of
        hex digits terminated by  any non-hex character.  Carriage return  is a
        bad terminator to use for this command.

             There is  a less  general "%R" (relay)  command which,  like ";R",
        relays  characters  from  the user's  command  terminal  to  the ENGINE
        program.   "%R" sends  a copy  of the  asc string  following  it.  This
        command is  terminated by  an ESCAPE.  (DANGER,  2 ESCAPES  will likely
        return control to  the DEC monitor  which will terminate  all auxiliary
        circuits.)

             It  takes  AC  (auxiliary  circuit) license  to  be  able  to have
        circuits built  from the PDP-10  to user names  other than that  of the
        command circuit.

             The commands are ;C, ;R, %R, %\, %O, %C, and control- B, E,  G, I,
        L, N, P, R, S, T, U(":U"), X, W, Z.







                                      48                                 ISIS-I
                   CONVENTIONS FOR NAD - DDT COMMUNICATIONS    December 7, 1979


                     7.   CONVENTIONS FOR NAD - DDT COMMUNICATIONS










                                  7.1  PDP10 TO 7/32

             80 - ESCAPE CHAR.  Next byte is XOR with 40--the result is data.

             81 - FLUSH CHAR.  Will  cause hand-shake char to be sent  by 7/32.
        7/32 then waits for command.   (Only sent in response to  flush request
        by 7/32.)

             84 - "0" FILL.  Next data character contains count of 00 bytes.

             85 - "1" FILL.  Next data character contains count of FF bytes.

             The only data characters presently requiring escape are:

                80      ESCAPE
                81      FLUSH
                83      
                84      "0" FILL
                85      "1" FILL
                8F
                03      ZAPPER
                0F      








                                  7.2  7/32 TO PDP10

             81 -  Requests a flush  char from the  PDP10, all bytes  until the
        flush char is sent will be ignored.

             80 - ESCAPE CHAR -  The following table indicates meaning  of next
        byte:

        00      DATA CHAR 80.
        01      DATA CHAR 81.
        02      HAND SHAKE - 7/32 waits for a command.
        03      ERROR - illegal command.

                                      49                                 ISIS-I
                   CONVENTIONS FOR NAD - DDT COMMUNICATIONS    December 7, 1979


        04      ERROR - illegal instruction executed
                        followed by 4 bytes of address.
        05      BREAKPOINT ENCOUNTERED
                        followed by 1 byte BP number.
        06      ADDRESS OUT OF RANGE (from G or B).
        07      BREAKPOINT NUMBER OUT OF RANGE (from B).
        08      NO BREAKPOINT TO PROCEED FROM (from P).
        09      MEMORY OUT OF BOUNDS (from R or W).
        0A      ILLEGAL REGISTER NUMBER (from R or W).
        0B      DISK ERROR (from L or S)
                        followed by 2 bytes of status.
        0C      INVALID NUMBER (should never happen).
        0D      INCORRECT BOUNDS (from M).
        0E      BAD SEARCH LENGTH (from X or Y).
        0F      BAD SEARCH BOUNDARY (from X or Y).
        10      ILLEGAL SVC EXECUTED.
        11      ILLEGAL MEMORY REFERENCE BY OUT SVC.
        12      PARITY ERROR.
        13      ILLEGAL MEMORY REFERENCE BY USER PROGRAM.
        14      ZAP?
        15      JUMP OUT OF BOUNDS.
        16      SLOT ALREADY CONNECTED.
        17      ILLEGAL INSTRUCTION IN CONTROLLED CODE.
        18      BREAKPOINT ALREADY EXISTS THERE.
        19      KERNEL CRASH.
        1A      BAD 'M' ARGUMENTS.
        1B      WE ALREADY HAVE USE OF SPY...ABORTING.
        1C      ABORTING.
        1D      HANDSHAKE (":" prompt for "A" command).
        1E      ABORTING--USABLE MAC REGISTERS EXCEEDED.
        1F      ABORTING--BAD SIZE.
        20      ABORTING--AVAILABLE SPACE EXCEEDED.






















                                      50                                 ISIS-I
                             ISIS LIBRARY PACKAGES             December 7, 1979


                              8.   ISIS LIBRARY PACKAGES



             For  convenience  in  developing  and  maintaining  interfaces,  a
        collection of library packages have been created.  These are maintained
        in directory ISIS, and all have the extension "*.LIB".








                                  8.1  THE *.COM FILE

             These packages all require that certain parameters be pre-defined.
        By  convention,  these  parameters  are  defined  in  a  file  with the
        extension "*.COM".

             The following parameters should be included in all *.COM files:

        :       FILE.COM                the name of this file
        HOSTNO  EQ      $A 370          :number of the host to be used
        NPORT   EQ      $A 50           :number of ports on slot, counting
                                         port 0
        NPORTT  EQ      NPORT           :number of ports TYMNET can build TO,
                                         including one for control (Port 0)
        NTOUT   EQ      5               :number of timeout entries
        IRSIZE  EQ      200             :size of ISIS input ring, bytes
        ORSIZE  EQ      300             :size of ISIS output ring, bytes
        CNTRL   EQ      1               :See first word of ICT table
        MAXCHAR EQ      14              :number of chars to input before break
        ECHO    EQ      1               :set up for tymsat echo
        ENGINE  EQ      1               :set up for tymnet engine
                END

             Additional parameters  may be defined  as needed for  the specific
        interface.  Some of the above  symbols are not needed if  certain *.LIB
        files are not used, but  provide a good first approximation to  the set
        required.












                                      51                                 ISIS-I
                             ISIS LIBRARY PACKAGES             December 7, 1979


                                    8.2  START.LIB

             This file should always  be assembled IMMEDIATELY AFTER  the *.COM
        file.  Among other items, segment usage is initialized, and IST and ICT
        are created.  Storage is defined in segments 0 and 1.

             The following parameters should be defined in the *.COM file:

        HOSTNO  the initial host number associated with this interface
        NPORT   the number of ports this interface is configured for
        NPORTT  the number of ports TYMNET is told about
        NTOUT   the number of timeout list entries to generate
        IRSIZE  number of bytes to provide for input ring, from dispatcher
        ORSIZE  number of bytes to provide for output ring, to dispatcher
        CNTRL   dispatcher control bits

             The following symbols MUST be defined SOMEWHERE in the assembly:

        IRING   the start of the input ring, from dispatcher
        ORING   the start of the output ring, to dispatcher
        ENTRY   the location of the first instruction to be executed

             The following symbols are defined for convenience:

        RATE    the rate of the fast clock (ticks/second)
        NRATE   address of a word containing the value RATE
        FASTC   address of a word containing the realtime fast clock
        SLOWC   address of a word containing the realtime slow clock
                (1-second)
        GMT     addres of a word containing the realtime GMT clock
        R0-R15  symbolic names for the registers
        DISMISS symbolic name for dismiss svc
        SEG0    the start address of segment 0
        SEG1    the start address of segment 1
        SEG2    the start address of segment 2
        UPDOWN  halfword cell which contains the state and number of ports
        HOST    halfword cell used to change the host number
        FPANEL  halfword cell for front panel display on ENGINE








                                     8.3  BID.LIB

             Library package  for BID,  BIDH.  Used  to find  the index  of the
        left-most bit within a bit pattern.  Either routine is called  with bit
        pattern in R1,  link on R3.  Returns  number of the  left-most non-zero
        bit in R2.  R0, R4-R15 are preserved.  Storage is allocated  in segment
        1.

                                      52                                 ISIS-I
                             ISIS LIBRARY PACKAGES             December 7, 1979



        BIDH    Halfword bit identifier
                CONSTRAINT---left half of R1 must be zero if bit
                16 is zero!  Returns original word in R1, number
                of leftmost bit of right half of R1 in R2.

        BID     FULLWORD bit identifier
                Returns original word in R1,  number of leftmost
                non-zero bit in R2.

             Note that  if the  symbol ENGINE is  defined and  .GT. 0  then the
        Tymnet Engine instructions JFFO and JFFOH will be used, respectively.








                                    8.4  TIMOUT.LIB

             This package contains the standard timeout routines.  These permit
        the near-automatic scheduling of routines, which are to execute at some
        specific  time in  the  future.  Times  are  based on  FASTC,  and thus
        provide  a resolution  of approximately  1.6 milliseconds.   Storage is
        defined in segments 0 and 1.

             The following parameter MUST be defined at assembly time:

        NTOUT   number of timeout entries which may be active at any one time


                Six symbols are declared:

        IZT     InitialiZe Timeout
                Called at initilization, link on R0.   Registers
                are not preserved.   Should be called before any
                attempts are made to call TOPUT.

        TIMOUT  Timeout servicing
                To be called periodicaly,  link on on R0.   Will
                in turn  jump to any  routines  which  should be
                serviced:

                        R0 = routine address
                        R1 = current fast-clock time.

                No registers are preserved.

        TORET   Timeout service return address
                ALL  routines  called by TIMOUT  should exit to
                here.

                                      53                                 ISIS-I
                             ISIS LIBRARY PACKAGES             December 7, 1979



        TOPUT   Timeout  Put-Up-Timeout
                Any  code  may  call  this to place an entry on
                timeout list:

                        link on R5...R6--R15 preserved
                        R0 = address to transfer to
                        R1 = next time to call routine

                Expects to   JAL R10,CRASH   if list overflows,
                crash type is then 15d.

        TOGET   delete an existing timeout entry
                Called  to delete  an entry  already  on timout
                list:

                        link on R5...R6--R15 preserved
                        R0 = routine address...entry with
                        this address will be deleted.

        TONOW   execute a timeout entry IMMEDIATELY
                Called to flush an entry, and execute it NOW!

                        link on R5...NO registers preserved!
                        routine address in R0

             NOTE...when a routine is  called from timeout list, it  is removed
        from list, and must call TOPUT to be called again.

             ALSO...TOGET and TONOW both do normal returns, even if no entry is
        found.








                                8.5  ISIS RING PACKAGES

             There  are two  packages available  for handling  the  ISIS rings.
        Each  package contains  the same  set of  functional routines,  but the
        conventions for register usage differ.

             The routines  may be  divided into  utility, primative  input, and
        primative output routines.

             If the symbol RSEG is defined, then the rings will be allocated to
        that segment;  otherwise they will be allocated in segment 0.




                                      54                                 ISIS-I
                             ISIS LIBRARY PACKAGES             December 7, 1979


            8.5.1       UTILITY ROUTINES

             Each of these expects an argument in SC format (SC format consists
        of  1 byte  containing a  count of  bytes, followed  by that  number of
        bytes:

        OCS     Output Canned String
                OCS will output the string as a data message to the
                specified port.  OCS may be used to place a complete
                text message to the port.   OCS goes to completion,
                and then terminates the operation.

        OCM     Output Canned Message
                OCM will output the string as a message to the
                specified port.   The first character of the string
                is passed as the message type.  OCM may be used for
                fixed messages, such as logon strings, etc.  OCM goes
                to completion, and terminates the operation.

        OBS     Output Byte String
                OBS will output the specified string into the current
                message.  OBS neither "starts" nor "terminates" the
                message, but instead may be used to insert "canned"
                fragments into a message being constructed.  The
                string is NOT expected to be in SC format.




            8.5.2       PRIMATIVE INPUT ROUTINES

             All link on R4, and pass the argument (if any) in R0.

        GETCH   Get a character

        GETH    Get a halfword
                An even number of bytes should  previously have been
                removed for expected results.

        GETW    Get a word
                An even number of halfwords  should have been removed
                previously for expected results.

        FLUSH   Flush away remainder of input message
                R0 is number of bytes remaining, to skip over.  After
                absorbing these bytes, performs ELIR.

        ELIR    End-Logical-Input-Record
                "Ends"  current  message,  sets up pointers  for next
                message.




                                      55                                 ISIS-I
                             ISIS LIBRARY PACKAGES             December 7, 1979


            8.5.3       PRIMATIVE OUTPUT ROUTINES

             All link on R4, primary argument in R0:

        SPACE   Returns number of characters of space available in
                output ring.

        SLOR    Start Logical Output Record
                MAY DISMISS!
                Provides function of ROOM,  PUTH, and PUTCH for first
                3 chars of message:
                        R0 = number of bytes required
                        R1 = port #
                        R2 = message type code

        PUTCH   places character in next position of ring.

        PUTH    places halfword in next position of ring
                An even number of bytes should have been output
                previously in this message.

        PUTW    places word in next position of ring
                An even number of halfwords should have been output
                previously in this message.

        ELODR   End Logical Output Data Record
                places byte count into message type to make data
                message, then performs ELOR.

        ELOR    End Logical Output Record
                "Ends" message.  Forwards message to DISPATCHER.




            8.5.4       FRING.LIB

             This package is the  fast, efficient ring handler  collection.  It
        does  require  the dedication  of  registers R13-R15  during  a message
        sequence, and does not permit the concurrent manipulation of both input
        and output rings,  unless the appropriate set  of R13-R15 are  saved by
        the user.   It is fast  because all descriptors  are maintained  in the
        registers, and thus  only the operand need  be a memory  reference.  It
        also permits one to scan  through an input message, and  then "back-up"
        and restart the scan if some condition is detected.

             The following CONSTRAINTS apply:

             1.  An input or output  operation must go to "end"  before another
        operation may be started.

             2.  Once started, registers 13,  14, and 15 are dedicated  to that
        operation, until it is "ended".

                                      56                                 ISIS-I
                             ISIS LIBRARY PACKAGES             December 7, 1979


             3.  If a new operation is started before the previous operation is
        "ended", the previous operation is aborted, and the appropriate ring is
        effectively left unchanged.


        8.5.4.1 Utility routines

             These are all called with link R5, and preserve registers R6-R12:

             NOTE...OCS and OCM both expect  R2 = port number, R3 =  pointer to
        string.  Also, OBS expects R2  = number of characters, R3 =  pointer to
        string.


        8.5.4.2 Input routines

             All preserve R1-R3, R5-R12.  An additional routine is defined:

        LOOK    Determine if an input message exists...normal return
                if not; skip (4) return if so, and then:
                        R1 = port number
                        R2 = message type code (peek)
                On skip return, condition codes are set such that JE
                will succeed if message is for port 0.  The port
                number will have been removed from the message, but
                the message code will not have been removed (you
                get a peek at it).


        8.5.4.3 Output routines

             All  preserve  R0-R3,  R5-R12,  unless  used  for   arguments,  or
        otherwise specified.  The following additional routine is supplied:

        ROOM    R0 = number of characters required for next message,
                returns when that much room is available in output ring.
                MAY DISMISS.

        ELODR   Smashes R0, R1.















                                      57                                 ISIS-I
                             ISIS LIBRARY PACKAGES             December 7, 1979


                                 8.6  BUFFER PACKAGES

             There  are two  packages available  for use  of  standard buffers.
        These  are functionally  identical;  the  difference is  that  the slow
        version performs a trace on all calls, which is a useful debugging aid.
        Each  package  contains  all code  and  storage  allocation  needed for
        bufferlet usage.

             The following parameters MUST be defined before assembly:

        NBUF    the number of buffers to create
        NBFLET  the number of bufferlets to create

             A BUFFERLET is an  element in a pool of  data, set up as a  set of
        linked lists.  A  bufferlet is 8  bytes long, and  can contain up  to 6
        bytes of data (the other 2 bytes are used for list linking).

             A BUFFER is  a set of four  half-word descriptors; it  contains no
        data of itself.  It DOES  contain pointers to the data  associated with
        it, in  a pool of  storage associated with  the routines.   Buffers are
        numbered 0, 1, ..., NBUF-1.  Buffers are addressed by buffer index: the
        index for a buffer is twice the number of that buffer.

             Buffer  index may  be used  to index  into the  following halfword
        arrays from external routines:

        BF      buffer flags (see below)
        BB      buffer start address (in bufferlet pool)
        BE      buffer end address (in bufferlet pool)
        BCT     buffer counts

             The  following  should also  be  defined externally  (in  the user
        package):

        FLAGS   a bit array of length corresponding to
                the maximum BF ( buffer flag) value.

             The  significance  of  FLAGS is  as  follows:   normally,  one has
        several different processes running concurrently (e.g., input, output),
        each  of  which  may  need  to  service  a  collection  of  buffers--in
        particular,  that  set  of  buffers  that  is  non-empty.   Whenever  a
        character is placed  into an empty buffer,  the associated BF  value is
        taken as a (bit) index into  FLAGS, and the assigned bit is  turned on.
        This permits the process to pick up one of it's flag words,  and detect
        if it has anything to do.  (If  so, it can use BID to determine  one of
        the  bits,  and  then  service  the  associated  buffer.)  The  bit  is
        automatically turned off  when the last  character is removed  from the
        buffer.

             NOTE...it is up  to the user program  to initialize the  BF array,
        and thereby force the partitioning of the FLAGS array.



                                      58                                 ISIS-I
                             ISIS LIBRARY PACKAGES             December 7, 1979


             There are several routines available.  Each routine is called with
        (unless otherwise specified):

                Link on R4
                R0 = argument
                R1 = buffer index (buffer number*2)


                Routines:

        IZBF    link on R5, used to initialize buffers.  Empties
                all buffers.

        GCI     get a character from buffer
                Crashes if buffer is empty, type 3 crash.

        WCI     write a character into buffer
                Crashes if no room for character,type 5 crash.
                Will "swallow" character if BF is zero.

        WCD     back up a buffer to restore last character
                CAUTION--WCD must be called sequentially after a call
                to GCI with no intervening calls to WCI (none at all!)
                and no calls to GCI for other buffers.

        EMPTY   empty (flush) buffer

        MCI     Move all characters from source to destination buffer
                special register usage:
                        R5      source buffer index
                        R6      destination buffer index
                        R7      link
                MCI may crash (type 4) if either buffer index is invalid.

        GCPEEK  "peek" at first character in buffer

        GCSCAN  "peek" at subsequent characters in buffer
                called AFTER initialization by GCPEEK.  Registers
                R2, R3 MUST be preserved between calls.

                Both GCPEEK and GCSCAN may crash if the buffer is
                exhausted.  Crash type 6.

             Uses routines in TIMOUT.LIB --- requires one timeout list entry.

             The bufferlet pool is divided  into two parts: the main  pool, and
        the reserve tank.  (The reserve tank normally contains 1/8 of the total
        number of bufferlets.)  If the main pool  is ever emptied,  the reserve
        tank is transfered to  it.  At some later  time, an attempt is  made to
        restore the reserve tank, zapping one or more buffers as necessary.  If
        this happens, a diagnostic will be sent to the supervisor,  advising of
        the  buffer  zap.   This  condition  is  abnormal,  and  caused   by  a


                                      59                                 ISIS-I
                             ISIS LIBRARY PACKAGES             December 7, 1979


        malfunctioning program,  or by a  misallocation of bufferlets  (too few
        for the application).

             If  a macro  ZAPBUF is  defined, then  the code  in it  whenever a
        buffer is zapped.




            8.6.1       BUFFER.LIB

             This  is the  slow package,  and includes  the trace  feature.  It
        requires an additional 22 memory  cycles for each call to GCI  and WCI,
        and also 1K of extra storage for the trace.

             The  trace consists  of a  half-word index  HISX, and  a 256-entry
        table HISTAB.  HISX is the index into HISTAB, of the last entry placed.
        Each entry is 4 bytes long, as follows:

        byte 0          the character
        byte 1          buffer number/2
        byte 3,4        the low 16 bits of the address from which
                        the routine was called (segment 1 assumed).

             The trace is circular, and will wrap continuously.




            8.6.2       FBUFER.LIB

             This is the fast package.  It does not have the trace feature.








                                    8.7  CRASH.LIB

             This is a generalized crash package.  It handles both software and
        hardware crashes.  On any crash, the registers are saved in  CRREG, and
        CRSHCT is incremented.  Software crashes occur via:
                                    JAL R10,CRASH.

             CRASH saves (R10) in cell CPOINT.

             Software crashes may be  "good" or "bad"...if "good",  the calling
        sequence is:

                JAL     R10,CRASH

                                      60                                 ISIS-I
                             ISIS LIBRARY PACKAGES             December 7, 1979


                HC      0               :this key distinguishes a "good"
                                        :crash from bad
                BC      4*L,Y           :first byte is 4*register linked
                                        :to routine, Y is crash type

             Then register (L) is saved in CFROM, and Y is saved in CRASHC.

             In  the  event  of   a  hardware  failure,  CPOINT   contains  the
        instruction address at the time of failure, CRASHC contains the failure
        reason, and CFROM is set =-1.

             On completion of crash,  transfers to label START, defined  in the
        user code.

             If the symbol CRSTOP is defined, and set .GT. 0, then this routine
        will permit only  one crash (except  power failure or  manual restart).
        When  this  routie  executed  the second  time  the  registers  will be
        restored from CRREG and the routine will go into a DISMISS loop.








                                    8.8  FRONT.LIB

             This  package is  the ISIS  front end...used  to service  the ISIS
        input and  output rings,  and to  activate user  code whenever  a break
        (user defined) is encountered.

             It also  activates user  code when  a user-processable  (also user
        defined) non-data  message is encountered,  if excessive data  is input
        without a break, or if a timeout occurs for a port.




            8.8.1       CONVENTIONS

             Each of NPORT  ports has a  buffer-pair associated with  it.  Even
        numbered  buffers are  input buffers...the  corresponding  odd numbered
        buffer is  that port's  output buffer.   The user-provided  code should
        intialize these buffers.

             A 0-byte in the buffer is an escape...it is followed by  a data-0,
        or  by  an  ISIS  message code  and  the  appropriate  character stream
        following.  (This  does NOT apply  to needles [message  code =  0], and
        thus unassigned  ports should be  connected to an  appropriate process.
        Needles  are  parsed, and  the  following usage  applies  on activation
        <Needles ALWAYS activate>:


                                      61                                 ISIS-I
                             ISIS LIBRARY PACKAGES             December 7, 1979


                R5      Invoice number,
                R6      Destination Host number,
                R7      Originating Node number,
                R8      Originating Port number,
                R9      TID,
                R10     number of characters in user name (the
                        username is placed into the port's buffer.)

             Data breaks on C/R if no break array is specified.

             Activation always occurs at the END of the message  which contains
        one or more breaks.

             Break is activated with the buffer index in R1, and links  on R15.
        All registers  are available  for use while  in the  user code,  and on
        return, R0 is to contain a number N.  If N>0, it is default timeout (in
        seconds)  until the  next activation...else  timeout is  disabled.  All
        data characters are  automatically placed in  the input buffer,  as are
        any control messages specified for user-handling.

             ALL ISIS special messages are placed in the buffer for port 0, and
        each breaks automatically.

             For non-text messages, the  escape convention applies ONLY  to the
        message type...the body of the message is unescaped.  ALL such messages
        handled by the user cause a break.

             The  following WORD  arrays (length  NPORT words),  and are  to be
        initalized by the user program:

        BREAK   a pointer to the bit array of characters
                to break upon.
        MBREAK  a pointer to the bit array of message
                types to break on.
        PROCESS a pointer to the process to be activated
                upon a break condition.

             The following items are to be provided by the user:

        A bit array TISIS of length NPORT, to signal output data.

        A symbol MAXCHAR...causes break if the buffer count exceeds
        this value.

        A symbol ECHO...causes tymsat echoing for terminals if >0.

             the following routines should be called by the user (link R0):

        IZFRONT at initialization time, after calling IZT.

        INPUT   from exec loop, to process input from ISIS.

        OUTPUT  from exec loop, to process output to ISIS.

                                      62                                 ISIS-I
                             ISIS LIBRARY PACKAGES             December 7, 1979


                                    8.9  FINISH.LIB

             This  file  should  ALWAYS  be  assembled  LAST!!    It  generates
        diagnostics if necessary, and computes the values of the symbols:
                              S0SIZE, S1SIZE, and S2SIZE.

             It  will also  type  out the  memory requirements,  and  cause all
        undefined symbols to be listed on the control terminal.








                                    8.10  ARING.LIB

             For convenience  in handling ASYNC  I/O, this package  is provided
        with  a set  of routines  to  get and  place characters  for  the async
        driver,  performing all  required bookkeeping  on the  appropriate port
        ring's pointers.

             The following parameter MUST be defined before assembly:

        NAPORT  number of async ports.

             The following quantities are defined by the package:

        NGRP    number of groups (16 ports each) required for
                NAPORT ports.

        RBS     number of bytes in a port's ring entry.

        ARING   the start address of the async ring storage.

        DSR     NGRP-halfword bit array for DSR term.

        DTR     NGRP-halfword bit array for DTR term.

        CP      NGRP-halfword bit array for CP term.

        TAM     NGRP-halfword bit array for Transmitter Active
                Mask.

        TOPORT  NGRP-halfword bit array, set if data present
                for port.

        FPORT   NGRP-halfword bit array, set if data present
                coming from port.




                                      63                                 ISIS-I
                             ISIS LIBRARY PACKAGES             December 7, 1979


             The following routines are included.  All link on R4,  expect port
        number in R5 (unless otherwise specified):

        IZASYN  Initialize ASYNC handling.
                preserves NO registers.
                on return, has set:
                        DSR     0
                        DTR     1
                        CP      0
                        TAM     1
                        TOPORT  0
                        FPORT   0
                        ARING   0

        AGCI    get a character from Async input ring
                If that ring is empty, performs a normal
                return (turns off FPORT bit).
                Else skip (4) return, character in R0.

        AWCI    Place a single char in Async output ring
                R0 is char to transmit.
                If less than 4 characters of space remain in
                ring after placing character, TAM is turned
                off.  TOPORT bit is always turned on.

        AWCP    Place escaped char in Async output ring
                R0 is char to transmit.
                Places escaped character PAIR into output
                ring, then acts like AWCI.

             AWCI and AWCP turn off  TAM sufficiently early that a  program may
        place another character or character pair into the ring  before running
        into trouble.  This insures  that a sequence of several  characters may
        be placed without the necessity of implicitly checking if there is room
        available, or of "backing-up" in a ring (dangerous, since the driver is
        executing concurrently).

             The  following  conventions   apply  to  input  and   output  data
        characters:

                INPUT CODES

        0       escape...always followed by second char
        1-FF    data codes 0-FF
        0|0     escaped data code 0
        0|8x    escaped terminal speed:
                x=0     10 cps
                x=1     15 cps
                x=2     30 cps
                x=3     40 cps
                x=4     60 cps
                x=5     120 cps
                x=6     30 cps (3767)

                                      64                                 ISIS-I
                             ISIS LIBRARY PACKAGES             December 7, 1979


                x=7     14.7 cps (2741)
        0|90    escaped break detected
        0|91    escaped break end


                OUTPUT CODES

        0       escape...always followed by second char
        1-FF    data code
        0|0     data 0
        0|1-8F  delay time
        0|90-AF output baud rate
        0|B0-CF input baud rate
        0|D0-DF enter connect mode
        0|E0    enter data mode
        0|E1    disconnect
        0|E2    enable
        0|E3    RS up
        0|E4    RS down



































                                      65                                 ISIS-I
                               THE INTERDATA MAC               December 7, 1979


                                9.   THE INTERDATA MAC



             This chapter is intended to provide a general overview of the use,
        operation,  and   constraints  related  to   the  MAC   (Memory  Access
        Controller).








                                  9.1  ADDRESS SPACE

             All references to addresses are in hexidecimal, of the form 'XXXXX
        (an address is a BYTE reference, and is 20 bits long, or 5 hex digits).
        The  address  space,  for  the  purposes  of  this  discussion,  may be
        considered to  be formatted  into PAGES  of 256  bytes, and  an address
        'PPPBB is a reference to  byte 'BB in page 'PPP.  When  running outside
        of the MAC operation (as an interrupt routine might do), a reference to
        page 'PPP can refer  to any of 4096  pages, subject to the  actual core
        present in the machine.

             This un-MAC'ed  address space is  the ABSOLUTE ADDRESS  SPACE, and
        corresponds to the real memory in one-to-one correspondance.

             A job running under the MAC has a VIRTUAL ADDRESS SPACE,  which is
        independent of  the real  absolute address space  of the  machine.  All
        references to virtual address space for a job is translated to absolute
        address space references  by the MAC in  a mapping process,  which also
        imposes access restrictions on the references.

             Two  independent  jobs  may  have  the  same  virtual  address for
        independent references, but the MAC will sort these out, and  cause the
        references  to   be  to  different   real  addresses.    Likewise,  two
        independent  jobs may  have different  virtual addresses  for  the same
        reference, and the MAC will  cause each job to reference the  same real
        address.













                                      66                                 ISIS-I
                               THE INTERDATA MAC               December 7, 1979


                                   9.2  MAC MAPPING

             When running  under the MAC,  a reference address  is of  the form
        'SPPBB,  where  'S  is a  reference  to  one of  16  SEGMENTS,  and 'PP
        references a page within that segment.

             In practice, the MAC  is set up for a  job before the job  is run,
        and the details need not concern us.  Further discussion is based  on a
        properly set MAC, while a job is running.

             The MAC has a set  of 16 segment registers, or  DESCRIPTORS.  Each
        descriptor  has a  base page  'KKK and  a page  range 'LL,  as  well as
        various sorts of protection status.

             The  program references  address 'SPPBB:   the MAC  intercepts the
        reference,  and looks  up  descriptor    'S.  Using  descriptor  'S, it
        performs two operations in parallel:  it computes absolute page    'JJJ
        = 'PP + 'KKK; and it compares 'PP with 'LL--if 'PP > 'LL, the reference
        is  out of  range,  and the  MAC  traps the  program--otherwise  it may
        reference page 'JJJ.

             In addition to the above, the MAC makes some protection  checks on
        the operation to be performed.  If the segment is flagged  NOT PRESENT,
        the reference is illegal, and  the MAC traps the program.  If  the page
        is flagged NOT  EXECUTABLE, and this  is an instruction  reference, the
        MAC traps the program.  If the page is flagged NOT WRITE, and this is a
        write reference, the MAC traps the program (NOT WRITE has  two aspects,
        and the trapping may take place before or after the write takes place).

             If all of  the above conditions  are satisfied, the  MAC completes
        the reference to page 'JJJ.








                              9.3  GENERAL CONSIDERATIONS

             A job  will typically  have at  least 3  segments, at  least while
        being debugged:  one  for variables, one for  code, and one  for buffer
        storage.










                                      67                                 ISIS-I
                               THE INTERDATA MAC               December 7, 1979


                                     9.4  MODULES

             The NAD  assembler allows the  definition of code  modules.  These
        permit  the  development  of  specific  code  functions,   without  the
        necessity of passing the entire job through the editor.  In some cases,
        a  job  may be  a  single module,  and  will cover  three  or  more MAC
        segments.  In another case, several modules may be concatenated  by the
        assembler, and these all operate under one MAC segment.  There need not
        be a one-to-one correspondance between NAD modules and MAC segments.








                                    9.5  ISIS USAGE

             Two specific examples may be of interest:   Assume a  program (the
        DISPATCHER) is  sharing a machine  with a particular  TYMCOM interface.
        The purpose  of the DISPATCHER  is to insulate  the interface  from the
        environment,  and  in  particular  some  of  the  network  or node-code
        conventions  which  are  not  specific  to  that  interface   (such  as
        accounting).   It  also  serves to  protect  the  environment  from the
        interface.

             CASE a.

             The  interface has  a page  of configuration  parameters  which it
        treats as constants, but which the Dispatcher may address (and modify).
        This  INTERFACE  CONTROL TABLE  includes  such parameters  as  the host
        number,  the  number of  ports,  general option  control  switches, and
        pointers to the interface's data areas (and their sizes) such as buffer
        descriptors,  buffer  areas,  flag  areas,  etc.   A  second  page, the
        INTERFACE STATE TABLE, contains the current state of the  interface, as
        it has itself  determined, and thus is  writable by the  interface job.
        The IST includes such information as host up/down,  host answered/shut,
        etc. in specified  locations.  The dispatcher can  look at the  ICT and
        IST, and, for example, send  messages concerning the host state  to the
        supervisor, without the interface having to know the required format of
        the messages, or addressing node-functions, such as LEPSNU or the node-
        code's buffers.

             CASE b.

             The dispatcher  is treating a  specific host.  It  determines that
        the host is still up, and there are active circuits.  It references the
        absolute addresses of the interface's output ring, and now  proceeds to
        move data from the interface output ring to the appropriate input rings
        of  the corresponding  destination interfaces,  perhaps  applying back-
        pressure  on  the  interface  port,  by  entering  a  message  into the
        interface's input ring.

                                      68                                 ISIS-I
                            CONFIGURING AN ISIS BOX            December 7, 1979


                             10.   CONFIGURING AN ISIS BOX



             In order to configure an ISIS box, some knowledge is needed of the
        proposed  applications,  and  their  resource  requirements.   The ISIS
        enviroment itself takes 32 (or  more) K-bytes of memory, and  the NODE-
        CODE portion  requires an  additional 32-64  K-bytes, depending  on the
        configuration.  Individual  applications require varying  quantities of
        resources,  and must  be computed  on  a configuration-by-configuration
        basis.  With the  advent of TYMNET-II, the  NODE-CODE may grow  by some
        additional, indeterminate, amount.

             Anyone  configuring  ISIS  boxes  must  currently  go   through  a
        "feeling-out" process, where a proposed configuration is tried, and run
        through NAD to determine  the resource requirements.  To this  end, the
        remainder of  this chapter is  devoted to an  annotated example  of the
        generation of a particular configuration.








                                      10.1  FILES

             An ISIS configuration  is easiest to  maintain through the  use of
        several  files on  the  PDP-10.  These  include a  file  containing the
        configuration parameters  (XXX.TYM file),  and a  corresponding command
        file (XXX.CMD file).  These are treated seperately below.




            10.1.1      XXX.CMD FILE

             The command file is just that...a set of commands to NAD, normally
        telling NAD which  other files to assemble  (see NAD chapter  for other
        usages).  A typical command file for node IB (Isis Box), would have the
        following form (shown is what you would see if you typed the  file out;
        the  quantities  <i> are  NOT  in the  file--they  reference  the notes
        following):

        -TYPE IB.CMD
        ;@IB.TYM                <a, b>
        ;@(ISIS)ISIS.NAD        <c>
        ;@(ISIS)IGEN.I          <d>
        -




                                      69                                 ISIS-I
                            CONFIGURING AN ISIS BOX            December 7, 1979


             <a>.  The ";@" tells NAD to assemble this file (IB.TYM).

             <b>.  There is no space between the ";@" and the "IB.TYM".

             <c>.   This  line  tells  NAD to  assemble  the  ISIS  source code
        according to  the parameters  in the IB.TYM  file.  (In  certain cases,
        other files may be specified, for special applications, such as TYMNET-
        I/TYMNET-II, etc.)

             <d>.  The invocation of this  file is optional.  If used,  it will
        output  a   synopsis  of  the   configuration,  telling   the  resource
        requirements.




            10.1.2      XXX.TYM file

             The XXX.TYM corresponds to the X.TYM files, familiar from TYMNET-I
        usage.   Below is  a sample  X.TYM file.   Again, <a>  refers  to notes
        following:

        -TYPE IB.TYM
        :       IB.TYM  :       ISIS BOX DEFINITION PARAMETERS  01-MAY-79 <a>

        :               HARDWARE CONFIGURATION  <b>
        ENGINE  EQ      0               :1 IF MACHINE IS TYMNET ENGINE
        WWVB    EQ      0               :1 IF HARDWARE INCLUDES WWVB RECEIVER
        NDISC   EQ      0               :SET IF THE HARDWARE INCLUDES A DISC
        NTAPE   EQ      0               :SET IF THE HARDWARE INCLUDES A TAPE
        XSYNC   EQ      0               :1 IF THERE'S AN ADDITIONAL SYNC CARD
        NXSIO   EQ      0               :SET TO NUMBER OF XSIO CARDS PRESENT

        :               ISIS CONFIGURATION CONSTRAINTS  <c>
        NSLOT   EQ      2               :NUMBER OF SLOTS TO CONNECT     <d>
        NLU     EQ      3               :MAX. NO. OF LOGICAL UNITS/SLOT <e>
        NASYNG  EQ      2               :NO. OF ASYNC GROUPS   <f>
        NPRINT  EQ      0               :NUMBER OF PRINTERS ATTACHED    <g>

        :               NODE CONFIGURATION      <h>
        TII     EQ      0               :SET NON-ZERO IF TYMNET-II
        MACHNM  EQ      $8 377          :NODE NUMBER
        NUMHST  EQ      NSLOT+1         :NUMBER OF HOSTS        <i>
        HST0    EQ      $A 377          :ISIS KERNEL HOST NUMBER        <i>
        NLINES  EQ      2               :NUMBER OF LINKS        <j>
        MLINKS  EQ      0               :NO. OF MEMORY SHUFFLER LINKS   <j, k>
        PTHRU   EQ      0               :1 INHIBITS PASSTHRU'S
        SUP     EQ      0               :1 IF THERE IS A SUP ON THIS MACHINE

        :               NETWORK CONFIGURATION   <m>
        NEIG0   EQ      $8 1212         :NEIGHBORS ON LINKS     <n>
        NEIG1   EQ      $8 1366
        NGRP0   EQ      1               :NUMBER OF GROUPS ON LINKS      <o>

                                      70                                 ISIS-I
                            CONFIGURING AN ISIS BOX            December 7, 1979


        NGRP1   EQ      3

        :               SLOT PARAMETERS <p>
        SYN     EQ      00000000        :FLAG FOR SYNCHRONOUS LOGICAL UNIT
        ASN     EQ      01000000        :FLAG FOR ASYNCHRONOUS LOGICAL UNIT
        PRN     EQ      02000000        :FLAG FOR PRINTER LOGICAL UNIT

        :       SLOT 0 --- THE NODE CODE        <q>
        NLUS0   EQ      3               :NO. OF LOGICAL UNITS, SLOT 0   <r>
        S0L0    EQ      0+SYN           :LOGICAL UNIT 0 FOR SLOT        <s>
        S0L1    EQ      1+SYN           :LOGICAL UNIT 1 FOR SLOT
        S0L2    EQ      3+SYN           :LOGICAL UNIT 2 FOR SLOT        <t>

        :       SLOT 1
        S1CORE  EQ      $A 16           :NUMBER OF K-BYTES FOR SLOT 1   <u>
        NLUS1   EQ      1               :NUMBER OF LOGICAL UNITS FOR SLOT 1
        S1L0    EQ      2+SYN           :LOGICAL UNIT 0 FOR SLOT

        :       SLOT 2
        S2CORE  EQ      $A 24           :NUMBER OF K-BYTES FOR SLOT 2
        NLUS2   EQ      2               :NUMBER OF LOGICAL UNITS FOR SLOT 2
        S2L0    EQ      0+ASN           :LOGICAL UNIT 0 FOR SLOT (ASYNC)  <v>
        S2L1    EQ      -1              :LOGICAL UNIT 1 FOR SLOT        <w>

        :       M A C R O   D E F I N I T I O N S               <x>

        :       DEFINE MACRO FOR EXTRA GOOD-GUYS (TO INVOLK GG MACRO)
        :       FORM:
        :       GG(LICENCE,ACCESS,NAME)
        :       WHERE:
        :       LICENCE LGOD+LS0+LPATCH+LPRIV+LDISC+LSUP
        :       ACCESS  -1 IF ALL ACCESS, ELSE UNIQUE SLOT #
        :       NAME    USER NAME (UP TO 8 CHARS LONG)
        XGG     MACRO[
                GG(0,2,ISIS)            <y>
        ]
                END     <z>
        -




             <a>.  This is a comment  line...it is not required, but  does make
        the file more readable.

             <b>.  This set of parameters  tells of the presence or  absence of
        various pieces of hardware.  As more work is done, this list  is likely
        to expand.

             <c>.   These  are  a  mix  of  ISIS  parameters,  AND  numbers  of
        particular devices on the machine.



                                      71                                 ISIS-I
                            CONFIGURING AN ISIS BOX            December 7, 1979


             <d>.  The  number of interface  slots, exclusive of  the node-code
        (always slot 0).  In particular, this specifies that this ISIS box will
        have a  total of  3 slots--0 (node  code), 1  (first interface),  and 2
        (second interface).

             <e>.   The maximum  number  of Logical  Units for  any  slot.  All
        peripheral devices are considered  physical units, and are  mapped into
        the contiguous, Logical units for  each slot.  Logical Units may  be of
        the same  (e.g., all  sync lines) type,  or may  be different  for some
        application (e.g., one unit is an async group, another is a printer).

             <f>.  An Async group consists of 16 consecutive async  ports.  (An
        Async card can run up to  32 ports, or 2 groups.) By dividing  the card
        into groups, we can assign different groups to different processes.  We
        can also  have code  which services  only those  groups in  actual use,
        rather than all groups possible.

             <g>.  Each printer is a seperate device, and multiple printers may
        be assigned to different slots.

             <h>.  This set of parameters configure the node-code, in  terms of
        resources.  An ISIS box is ALWAYS a Base!

             <i>.  NUMHST  is the  number of  hosts assigned  to the  node.  In
        TYMNET-I,  this number  is  limited to  4.  By  implication,  this also
        limits  NSLOT to  be 3  or less!   The ISIS  Kernel is  ALWAYS  host 0.
        TYMNET-I also requires that  the node have 256d ports,  divided equally
        between hosts.   Thus; NSLOT=1  means 128 ports  for the  slot; NSLOT>1
        means 64 ports for each slot.

             These  constraints will  not  apply under  TYMNET-II,  which will,
        however, require additional parameters.

             <j>.  NLINES  is the  number of SYNC  lines...the total  number of
        links (and thus neighbors) is NLINES, + MLINKS if there are  any memory
        shuffler connections.  The ORDERING of these is important:
                Sync lines correspond to the lowest TYMNET-I lines;
                If MLINKS is on, the next higher lines are memory shufflers.

             <k>.   Memory  Shufflers   are  the  property  of   the  Node-Code
        exclusively.  They  do not,  therefore, come  under the  constraints of
        logical units.

             <m>.  These parameters describe to position of the node in TYMNET.
        Note that only those parameters required need be  specified...above, we
        specified NLINES=2, MLINKS=0.

             <n>.  The correct form for Neighbor names is "NEIGn"  or "NEIGnn",
        where n or nn are one- or two-digit decimal numbers.

             <o>.    The correct form for these synbols is "NGRPn" or "NGRPnn",
        where n or nn is as described in <n>.


                                      72                                 ISIS-I
                            CONFIGURING AN ISIS BOX            December 7, 1979


             <p>.  These  symbols are  used to  distinguish different  types of
        logical units (e.g., sync line 0 from printer 0).

             <q>.   We finally  come  to allocating  resources to  each  of the
        slots.  Slot 0 is special, in that the node-code defines it's  own size
        at assembly time.  Slot 0 may also have no devices other than  type SYN
        (or NULL) assigned to it.

             <r>.   A  slot may  have  less  than the  maximum  number  of LU's
        assigned.  However, there must  be a definition for each  LU specified.
        The correct format  is "NLUn" or  "NLUnn", where n  or nn is  a decimal
        number.

             <s>.  The correct format for these symbols is "SiLj" (Slot  i Line
        j), where i and j may be 1- or 2-digit decimal numbers.

             <t>.  Note that logical  units need not be assigned  to successive
        physical units.  Indeed, for many configurations, it is  desirable (and
        necessary) to perform assignments such as sync lines 0, 1, 4, 5,  8, 9,
        12, 13 to successive logical units on the node code, in order to permit
        other interfaces  to acquire  enough of the  special sync  lines (those
        with terms, such as Clear-To-Send, available).

             <u>.  This is the memory allocated to this slot.  Once the machine
        is up, no more memory can be assigned without reloading!

             <v>.  Here we see a different type of logical unit assigned.

             <w>.  Since  we said  this slot has  2 logical  units, we  have to
        define all  the symbols.  This  one in particular  is defined  as being
        NULL.

             <x>.   This section  is  used to  specify additional  users  for a
        specific ISIS configuration.

             <y>.  This validates a user "ISIS", with no licences, to  log into
        slot 2 (only).

             <z>.  This is a file  for the NAD assembler, and thus  should have
        an END statement at the end.














                                      73                                 ISIS-I
                            CONFIGURING AN ISIS BOX            December 7, 1979


                                   10.2  GENERATION

             To generate a node from the above files, we execute  the following
        session fragment:

        -R (ISIS)NAD    <a>
        Ready   <b>
        ;X   IB.CMD     <c>

        ;@   IB.TYM     <d>

        End of assembly <e>
        ;@   (ISIS)ISIS.NAD

        TTY 8BC 0D00    <k>
        SYNC 0D00 100C
        CLOCKS 100C 3E20
        FLASH 3E20 3E92
        KERNEL 4100 7400
        DISPAT 7400 0B900
        NODE 0B900 13B00        <l>
        ;@   (ISIS)IGEN.I

         ............................................



            ***  ISIS  ***      <f>
            Version 200.6
        2 interface slots

        node 377 configuration:
        link 0  neighbor 1212, 1 groups <g>
        link 1  neighbor 1366, 3 groups

        Slot configurations

        slot 0, 3 logical units
        L.U. 0 is sync line 0   <h>
        L.U. 1 is sync line 1
        L.U. 2 is sync line 3   <i>

        slot 1 has 16 K-bytes of core, 1 logical units
        L.U. 0 is sync line 2

        slot 2 has 24 K-bytes of core, 2 logical units
        L.U. 0 is async group 0 <j>

        ** HIGHEST LOCATION USED IN THIS CONFIGURATION IS 13B00 <m>

        REQUIRES 120d KILOBYTES OF CORE <n>



                                      74                                 ISIS-I
                            CONFIGURING AN ISIS BOX            December 7, 1979



         ............................................



        End of assembly
        %Q      <o>
        EXIT

        -




             <a>.  Execute NAD.

             <b>.  NAD is ready to accept input.

             <c>.  Tell NAD to use the command file.

             <d>.  NAD assembles the .TYM file.

             <e>.  NAD finishes assembling the .TYM file.

             <f>.  NAD assembles the ISIS source file.  this in turn prints out
        the map of the configuration.

             <g>.  The node configuration is printed.

             <h>.  The slot configuration is printed.

             <i>.  Note that slot 0 has 3 logical units, but the node  only has
        2 neighbors...this may be deliberate, or it may be a bug.

             <j>.  The type  of unit is specified  for each LU.  NULL  LU's are
        ignored.

             <k>.  Various modules  of the code  are assembled, and  the start-
        and end-addresses are output.

             <l>.  This module is the node-code.

             <m>.  The highest location in hex.

             <n>.  The core required.

             <o>.  We enter the command to exit out of NAD.







                                      75                                 ISIS-I
                      STARTING & RESTARTING AN ISIS NODE       December 7, 1979


                       11.   STARTING & RESTARTING AN ISIS NODE



             The following conventions are used during this chapter:

             <ZOT>  means to  press button  ZOT on  the  engine/interdata front
        panel.  <7, 8> means to press buttons 7, then 8, in sequence.

             UPPER CASE IS WHAT YOU TYPE.  Lower case it what is typed  back at
        you.








                                    11.1  INTERDATA

             There  are  certain  differences  between  the  interdata  and the
        engine.  Duplicate instructions (varying where necessary) are provided.

             Always perform the following steps:

             Make sure the console is unlocked.

             If the machine is in the wait state (wait light on) press <FN, 5>.
        Do it again!!  Write down the number displayed on the console.

             To stop  the machine  press <FN, 0>.   Do it  again.  If  the wait
        light is still off, press <FN, 5>.  Do it again.  If the wait  light is
        still off, press  <INI>.  If this fails  turn off the machine  and call
        for help.

             Press <DTA, FN, 1, FN, 4>;  if the consol is now zero,  proceed to
        the  next  paragraph;  else  press <DTA,  ADD,  SGL>,  and  repeat this
        paragraph.  If unable to zero out the console, call for help.




            11.1.1      START UP (WITHOUT RELOAD)

             Press <INI> and wait for the wait light to reappear.   Press <DTA,
        FN,  1, DTA,  7, 0,  ADD,  RUN> -  the machine  should now  be  up.  If
        successful, lock  the console.   If not, go  to the  appropriate reload
        procedure.





                                      76                                 ISIS-I
                      STARTING & RESTARTING AN ISIS NODE       December 7, 1979


            11.1.2      RELOAD PROCEDURE (FROM TERMINAL)

             The machine may be reloaded from the TTY card.

             plug the terminal into the  TTY card!  Press <DTA, FN, 1,  DTA, 6,
        0, ADD,  FN, 5>.  The  console should display  0060.  Now  press <SGL>.
        The console should display 000XXD36,  where XX is a digit folowed  by 7
        or F.



             If  not, do  "start from  scratch procedure".   If the  values are
        correct, log  into ISIS:33 from  the terminal next  to the  machine and
        type:

        -RUN (ISIS)NAD
        <version>
        ;@   ******.CMD         (****** is name of machine)

                        it types a LOT of stuff!
        end of assembly

        0,IEND;8                (SEE NOTE BELOW BEFORE YOU TYPE THIS)
        [garbage]
        %Q
        -

             NOTE...after you type the ;8 an automatic CR LF will  occur (don't
        type CR after  ;8).  After the  CR LF completes  press RUN -  take your
        time, you have 3 seconds.  If  all goes well there will be a  change in
        the console  (it no  longer displays  an address;   instead the  high 5
        digits will start counting down (this is the number of bytes  of memory
        left to load), and the low 2 digits will start flashing (last character
        input).   When done,  a  successful load  is indicated  by  the console
        displaying  FFFFF00xx).   Now  perform  "start  up   (without  reload)"
        procedure.




            11.1.3      START-FROM-SCRATCH PROCEDURE

             This  procedure  has two  options:  you can  either  use  the PROM
        procedure, or the TTY card procedure.


        11.1.3.1        TTY (MULTIFUNCTION) CARD START FROM SCRATCH

             Plug the terminal into the TTY card!  Press <DTA, 7, 8,  ADD, DTA,
        2, 9, 4, WRT, DTA, 5, 0, ADD, DTA, D, 5, 0, 0, WRT, DTA, 2, 8,  0, WRT,
        DTA, 4, 3, 0, 0, WRT, DTA, 8, 0, WRT, DTA, 5, 0, ADD>.



                                      77                                 ISIS-I
                      STARTING & RESTARTING AN ISIS NODE       December 7, 1979


             Now press <RD> 4 times,  noting the values displayed in  the right
        half of the console - they  should be D500, 280, 4300, 80.  If  not, do
        above again.  Now  press <ADD> - the  right half of the  console should
        display  50.   On the  TTY  card you  will  find a  toggle  switch with
        positions labeled 300, 1200, and 110.  Set the switch to 1200.



             Now login to ISIS:33 from  the terminal next to the  interdata and
        type:

        -RUN (ISIS)NAD
        <version>
        ;@   (ISIS)IBOOT.NAD

        disk 0FE5C 0FFA2
        end of assembly

        BBOOT,200%8             (SEE NOTE BELOW BEFORE YOU TYPE THIS)
        [garbage]
        loaded
        %Q
        -

             NOTE...after you type the %8 an automatic CR LF will  occur (don't
        type CR after %8).  After the  CR LF completes press <RUN> -  take your
        time, you have  3 seconds (or  more).  If all  goes well the  typing of
        LOADED  will  correspond to  a  change  in the  console  (it  no longer
        displays 50).  If not call for help.  Now perform reload procedure.

             The bootstrap, once loaded  into memory, immediately find  the end
        of  existing memory,  and relocates  itself to  the last  512  bytes of
        memory.   It also  places the  appropriate instructions  for  the other
        reload procedures.




            11.1.4      RELOAD PROCEDURE (FROM DISK)

             This procedure may apply if the system has a disk.

             Press <DTA,  FN, 1,  DTA, 6, 6,  ADD, FN,  5>.  The  consol should
        display 0066.  Now press <SGL>.  The console should now display 0XXF0C.
        If it doesn't, go to "start from scratch" procedure.   Otherwise, press
        <RUN>.  The right half of the console will go to zero.  When the consol
        goes to 000E,  the load is complete.   If any other value  appears call
        for help.  Now follow start up procedure.






                                      78                                 ISIS-I
                      STARTING & RESTARTING AN ISIS NODE       December 7, 1979


            11.1.5      SPECIALIZED INTERDATA RELOADING INFORMATION

             Occasionally  it becomes  very difficult  to reload  an Interdata.
        This is sometimes overcome by doing a memory clear.  At other times, it
        results from  the Interdata  going into 7-16  mode.  This  condition is
        recognized by being unable to clear the console psw (sequence <DTA, FN,
        1,  FN,  4>  does not  result  in  the consol  showing  all  0's.  This
        condition  may   be  cleared  (hopefully)   by  executing   an  illegal
        instruction...a useful sequence is <DTA, ADD, DTA, WRT, DTA, ADD, SGL>.








                                     11.2  ENGINE

             Always perform the following steps:

             Make sure the console is unlocked.

             If the  machine is in  the wait state  (wait light bars  on) press
        <PSW>.  Write down the number displayed on the console.

             To stop the machine press <SGL>.  If the wait light bars are still
        off, press  <INI>.  If  this fails turn  off the  machine and  call for
        help.

             Press <DTA, ADR, SET>;  if the consol is now zero, proceed  to the
        next paragraph; else press <SGL> and repeat this paragraph.   If unable
        to zero out the console, call for help.




            11.2.1      START UP (WITHOUT RELOAD)

             Press <SGL> and wait for  the wait light bars to  reappear.  Press
        <SGL, 7, 0, ADR, RUN> -  the machine should now be up.   If successful,
        lock the console.  If not, go to the appropriate reload procedure.




            11.2.2      RELOAD PROCEDURE (FROM TERMINAL)

             The machine may be reloaded from the TTY card.

             plug the terminal into the TTY card!  Press <DTA, PSW, 6, 0, ADR>.
        The console should display  00060 8000.  Now press <SGL>.   The console
        should display XXD36 8000, where XX is is a digit followed by 0 or F.

                                      79                                 ISIS-I
                      STARTING & RESTARTING AN ISIS NODE       December 7, 1979


             If  not, do  "start from  scratch procedure".   If the  values are
        correct, log  into ISIS:33 from  the terminal next  to the  machine and
        type:

        -RUN (ISIS)NAD
        <version>
        ;@   ******.CMD         (****** is name of machine)

                        it types a LOT of stuff!
        end of assembly

        0,IEND;8                (SEE NOTE BELOW BEFORE YOU TYPE THIS)
        [garbage]
        %Q
        -

             NOTE...after you type the ;8 an automatic CR LF will  occur (don't
        type CR after ;8).  After the  CR LF completes press <RUN> -  take your
        time, you have at  least 3 seconds.  If all  goes well there will  be a
        change in the console (it  no longer displays an address;   instead the
        high 5 digits will start counting down, (this is the number of bytes of
        memory left to  load), and the low  2 digits will start  flashing (last
        character received).  When done, a successful load is indicated  by the
        console displaying FFFFF00xx).  Now perform "start up (without reload)"
        procedure.




            11.2.3      START-FROM-SCRATCH PROCEDURE

             This  procedure  has two  options:  you can  either  use  the PROM
        procedure, or the TTY card procedure.


        11.2.3.1        TTY (MULTIFUNCTION) CARD START FROM SCRATCH

             Plug the terminal into the TTY card!  Press <DTA, 2, 8, 0, ADR, 2,
        9, 4>.

             on  the TTY  card wou  will find  a toggle  switch  with positions
        labeled 300, 1200, and 110.  Set the switch to 1200.



             Now login  to ISIS:33  from the  terminal next  to the  engine and
        type:

        -RUN (ISIS)NAD
        <version>
        ;@   (ISIS)EBOOT.NAD

        disk 0FE5C 0FFA2

                                      80                                 ISIS-I
                      STARTING & RESTARTING AN ISIS NODE       December 7, 1979


        end of assembly

        BBOOT,200%8             (SEE NOTE BELOW BEFORE YOU TYPE THIS)
        [garbage]
        loaded
        %Q
        -

             NOTE...after you type the %8 an automatic CR LF will  occur (don't
        type CR after %8).   After the CR LF  completes press <BT> -  take your
        time, you have at least 3 seconds.  If all goes well, data  output from
        the terminal will correspond to  a change in the console.  If  not call
        for help.  Now perform reload procedure.

             The bootstrap, once loaded  into memory, immediately find  the end
        of  existing memory,  and relocates  itself to  the last  512  bytes of
        memory.   It also  places the  appropriate instructions  for  the other
        reload procedures.




            11.2.4      RELOAD PROCEDURE (FROM DISK)

             This procedure may apply if the system has a disk.

             Press  <DTA, SET,  6, 6,  ADR>.  The  consol should  display 00066
        8000.  Now press <SGL>.  The console should now display XXF0C 8000.  If
        it doesn't,  go to  "start from  scratch" procedure.   Otherwise, press
        <RUN>.  The right half of the console will go to zero.  When the consol
        goes to 000E,  the load is complete.   If any other value  appears call
        for help.  Now follow start up procedure.








                        11.3  SPECIALIZED RELOADING INFORMATION

             Manual restart is at location 070.  This location contains  a LPSW
        which causes the machine to be re-initialized before restarting.

             The  bootstraps,  either PROM  or  TTY, come  into  low  core, and
        immediately find the end of memory, by successively trying to decrement
        memory at the end  of each 32-K block,  and checking if the  memory has
        really changed.  Once it succeeds, it copies the loaders into  the last
        512 bytes of existing memory,  and transfers to the bootstrap.   Any of
        the bootstraps  will initially save  RX3 format jump  instructions into
        low memory,  each of which  takes execution to  one of  the bootstraps.
        The pertinent locations are:

                                      81                                 ISIS-I
                      STARTING & RESTARTING AN ISIS NODE       December 7, 1979



                60      TTY bootstrap
                66      DISK bootstrap

             Executing either of  the bootstraps will  restore the jumps  at 60
        and 66.




            11.3.1      PROM START FROM SCRATCH

             With the machine  in wait state, press  the PROM loader  switch on
        the TTY card.  This will cause the bootstrap loaders to be  loader into
        memory, starting at 400,  and then executed.  The PROM  loader contains
        both the TTY and the DISK bootstrap.




            11.3.2      DISK BOOTSTRAP

             The disk bootstrap shows  various diagnostics if some part  of the
        disk interface is failing.  The following values displayed on the right
        half of the consol indicate the failure:

                0000    disk is not responding
                0001    disk RESTORE operation failed
                0002    disk SEEK operation failed
                0003    disk CONTROLLER failed
                0004    disk SELECTOR CHANNEL STATUS is bad
                0005    disk CONTROLLER STATUS is bad
                000E    SUCCESS!

             On occasion, it may be  desirable to reference the disk in  a non-
        standard fashion,  requiring patching  of the  bootstrap.  If  the DISK
        bootstrap starts at 0XXF0C, then the following location contain:

                0XXF00  Memory Start Address (4 bytes)
                0XXF04  Memory End Address (4 bytes)
                0XXF08  Initial disk cylinder (2 bytes)
                0XXF0A  Controller Command (read=0130, write=0210) (2 bytes)

             The DISK bootstrap may be  called from a program (NOTE,  from ISIS
        system, not user program), E.G.,  to save a crash.  The  program should
        initialize the  above constants first,  (it can determine  the location
        from the address stored at location 68, the address portion of the jump
        to DISK bootstrap starting at  66), and then JAL to 0XXX0E,  linking on
        register 9.  The diagnostic status normally presented to the  consol at
        the end of a  disk boot is returned  in register 1.  Registers  are NOT
        preserved during this operation!



                                      82                                 ISIS-I
                             Loading an ISIS slot              December 7, 1979


                              12.   Loading an ISIS slot



             In order to bring a process on-line under ISIS, it is necessary to
        perform a sequence  of operations to  generate, load, and  connect that
        process.  These  operations have,  to some  extent, been  automated, so
        that  the  inexperienced  operator  can  load  and  bring  on-line some
        specific process.  This discription is in terms of  this semi-automated
        procedure, with  notes "<x>"  provided for those  users who  would like
        additional information, and  for those programmers  who would set  up a
        procedure for some new process.

             NOTE...an ISIS slot must be reloaded each time that ISIS itself is
        loaded.

             In order  to use  the semi-automated  process, knowledge  of three
        specific pieces of information are required:

             1.  The  name of the  command file describing  the assembly  to be
        performed;

             2.  The ISIS host number (slot 0) of the destination machine;

             3.  The slot number, within that machine, that is to be loaded.

             The process to be described  is in terms of a command  file, which
        is assumed to already exist on the the PDP-10.  The  naming conventions
        for these command files  is IhhhSn.CMD, where "hhh" is  the destination
        host  number,  and "n"  is  the slot  number  (this  convention applies
        currently--it will be necessary to  expand it, within the limits  of 6-
        character file names, as the  range of host numbers, and the  number of
        slots possible, expand).

             For the purposes of illustration, assume that file  I377S1.CMD has
        been defined, to be loaded into host 377, slot 1.  This is what we must
        do:

        ==> we type:    -R (ISIS)NAD
        NAD responds:   Ready
        ==> we type:    ;X   (ISIS)I377S1.CMD   <a>
        NAD responds:   
                        ;@   (ISIS)I377S1.COM   <b, c>

                        End of assembly
                        ;@   (ISIS)START.LIB

                        End of assembly
                        ;@   (ISIS)FRING.LIB

                        RING 6 1020C            <d>
                        End of assembly
                        ;@   (ISIS)TIMOUT.LIB

                                      83                                 ISIS-I
                             Loading an ISIS slot              December 7, 1979



                        TIMOUT 806 102E0
                        End of assembly
                        ;@   (ISIS)BUFFER.LIB

                        BUFFER 846 20802
                        End of assembly
                        ;@   (ISIS)BID.LIB

                        BID 10698 107F0
                        End of assembly
                        ;@   (ISIS)CRASH.LIB

                        CRASH 1050 1092E
                        End of assembly
                        ;@   (ISIS)FRONT.LIB

                        FRONT 10A2 11022
                        End of assembly
                        ;@   (ISIS)TEST.NAD

                        End of assembly
                        ;@   (ISIS)FINISH.LIB

                        SEGMENT 0-length 5246d, requires 1500x bytes of core.
                        SEGMENT 1-length 4314d, requires 1100x bytes of core.
                        SEGMENT 2-length 2050d, requires 900x bytes of core.
                                12d K-bytes of core
                        End of assembly
        ==> we type:    ;C   ISIS:377;          <e>
        NAD responds:   Working
                        Circuit ready

                        node: 377
                        host: 377

        query, respond: slot #: ;R01            <f> (the response is ";R01")
        ==> we type:    *;X   (ISIS)SEMIAT.CMD  <g, h>
        NAD responds:
                        ;@   (ISIS)AUTO.1

                         Now type a control-D to initialize mac!

                        End of assembly
        ==> we type:    ^D                      <control-D>
        NAD responds:   A               <i, this footnote is for everyone!>

                        --Init mac--
                        :R 0,S0SIZE
                        :R 1,S1SIZE
                        :R 2,S2SIZE
                        :        I
        *;@   (ISIS)AUTO.2

                                      84                                 ISIS-I
                             Loading an ISIS slot              December 7, 1979



                         Now type a control-D, and another one after the
                         print-out, "Data Sent", occurs.
                        End of assembly
        ==> we type:    *^D
        NAD responds:   W SEG0, S0SIZE
                         Data Sent

        ==> we type:    *^D
        NAD responds:   W SEG1, S1SIZE
                         Data Sent

        ==> we type:    *^D
        NAD responds:   W SEG2, S2SIZE
                         Data Sent

        ==> we type:    *;E                     <j>
        ==> we type:    *%Q             <this exits us from NAD...we're done>
                        EXIT
                        -

             NOTES:

             <a>  The 3 spaces are  introduced by NAD, to  improve readability.
        The particular command file used for this example would be:

        ;@(ISIS)I377S1.COM
        ;@(ISIS)START.LIB
        ;@(ISIS)FRING.LIB
        ;@(ISIS)TIMOUT.LIB
        ;@(ISIS)BUFFER.LIB
        ;@(ISIS)BID.LIB
        ;@(ISIS)CRASH.LIB
        ;@(ISIS)FRONT.LIB
        ;@(ISIS)TEST.NAD
        ;@(ISIS)FINISH.LIB

             which  invokes a  .COM parameter  file, a  number of  .LIB library
        files, and one .NAD special source file.

             <b>  This entire  sequence of output  is engendered from  the .CMD
        file.

             <c>  A  .COM  file  is normally  used  to  specify  the parameters
        specific  to  a  particular  usage  of  a  particular  application.  In
        particular, a process may be  active several places in the  network, or
        even in the same machine, and each copy of the process is distinguished
        by  parameters  such  as  host number,  number  of  ports,  etc.  These
        parameters are defined within the .COM file.

             <d>  Some of the files may have MODULE references.   Lines output,
        of this form, are related to modules, and may be ignored, except by the
        programmer.

                                      85                                 ISIS-I
                             Loading an ISIS slot              December 7, 1979


             <e>  This command to NAD causes a circuit to be constructed to the
        user-name specified.  This must  be either YOUR user-name, or  else you
        must have previously set "AC" license on the PDP-10.

             <f>  We are  now getting  responses both from  NAD, and  from DDT,
        through NAD.  DDT  is outputting the node  and host numbers,  (just for
        redundancy, in case you mis-typed the destination host in <e>.  DDT may
        then ask you for the  slot number...if it does, use the  ";Rnn" (relay)
        debugger command to send DDT the required slot number.  If it does not,
        then the user-name  you have used is  hard-assigned to a  specific slot
        number.

             <g>  The  "*" is  a prompt  from DDT.   We invoke  another command
        file, to do the rest of the work.

             <h>  This  file  is  normally  used  for  processes   involving  3
        segments.  Special applications may require additional definitions, and
        this  information will  have  been specified  in the  release  for that
        applications.

             <i>  We  will  be getting  output  both from  NAD,  and  from DDT.
        Because of possible  race conditions, these  responses may not  come to
        the terminal in proper time sequence--the ":" prompts may appear at the
        terminal after the "R" and "I" lines have been output--while this looks
        curious, it is NOT fatal!

             <j>  This command causes the process to start  execution...it must
        be typed-in separately (rather than  being a part of the  command file)
        so that if any error  occurs during loading, the human  controlling the
        process can abort the execution, rather than allow something STRANGE to
        execute.























                                      86                                 ISIS-I
                                     INDEX                     December 7, 1979


                                      13.   INDEX



        absolute address space                  66
        accounting                              4,   5,   13
        addendum to accounting message          13
        address space                           66
        AGCI routine                            64
        ASYNC I/O                               63
        asynchronous I/O                        26
        AUX circuit                             18
        AUX pseudo-needle message               12
        AUX pseudo-needle rejection message     16
        AUX pseudo-needle request message       15
        Auxiliary-                              see AUX-
        AWCI routine                            64
        AWCP routine                            64

        Background                              2
        backpressure                            4,   11
        BID routine                             53
        BIDH routine                            53
        Black Ball                              11
        break message                           11
        breakpoints, DDT                        38
        bringing a slot online                  38
        BUFFER                                  58
        buffer index                            58
        BUFFERLET                               58

        Carrier Present                         see CP
        Change Context SVC                      36
        Check Background SVC                    36
        circuit origination                     17
        circuit termination                     16
        circuits                                16
        clear-to-send                           see CS
        Command file                            69
        command list                            24
        configuration memory requirements       74
        configuration, hardware                 70
        configuration, ISIS                     70
        configuration, network                  70
        configuration, node                     70
        configuration, slot                     71
        connect foreground SVC                  22
        connect printer SVC                     28
        connecting a slot                       38
        console                                 76,  79
        control flags, slot                     19
        Control Table                           19
        CP                                      27

                                      87                                 ISIS-I
                                     INDEX                     December 7, 1979


        CS                                      24

        data lost message                       11
        data-set-ready                          see DSR
        data-terminal-ready                     see DTR
        DDT                                     37
        DDT breakpoints                         38
        DDT execution                           38
        DDT initalization                       39
        DDT MAC initialization for slot         37
        DDT memory searches                     39,  42,  42
        DDT process                             2
        DDT program stepping                    40
        DDT slot connection                     38
        DDT slot disconnection                  39
        DDT SVC's                               35
        DDT tty input                           35
        DDT tty output                          36
        DDT-DEBUGGER communications             46
        DDT-DEBUGGER conventions                49
        DDT:  examining memory                  40
        DDT:  examining program status          41
        DDT:  examining registers               40
        DDT:  modifying memory                  41
        DDT:  proceeding from a breakpoint      40
        DDT: interrupting a program             43
        DDT: modifying registers                42
        DEBUGGER-DDT communications             46
        DEBUGGER-DDT conventions                49
        Defered-Echo-Mode                       see DEM
        DEM                                     11
        detach message                          11
        diagnostic collection                   5
        diagnostic message                      14
        DISC driver                             30
        disconnect message                      11
        disconnecting a slot                    39
        disconnection from DDT                  42
        Disk Bootstrap diagnostics              82
        DISK bootstrap diagnostics              82
        DISK reload                             78,  81
        dismiss                                 21
        dismiss SVC                             21
        DISPATCHER                              2
        Dispatcher                              9
        DISPATCHER                              19,  68
        DSR                                     24,  27
        DTR                                     24,  27

        ELIR routine                            55
        ELODR routine                           56
        ELOR routine                            56
        EMPTY routine                           59

                                      88                                 ISIS-I
                                     INDEX                     December 7, 1979


        error message                           14
        executing a program under DDT           38

        FASTC                                   22
        flush message                           11
        FLUSH routine                           55
        Foreground process                      1
        foreground, software connection of      22

        GCI routine                             59
        GCPEEK routine                          59
        GCSCAN routine                          59
        generation, ISIS                        74
        GETCH routine                           55
        GETH routine                            55
        GETW routine                            55
        GMT                                     22
        Gobbler                                 11
        Green Ball                              11
        Grey Ball                               11

        hardware configuration                  70
        HDLC                                    29
        host status                             19

        I/O software connection                 22
        I/O SVC                                 22
        ICT                                     3,   19,  68
        illegal instruction crash               22
        illegal SVC crash                       22
        initialization of MAC for slot          37
        input ring                              9
        Interface                               1
        Interface Control Table                 see ICT
        Interface State Table                   see IST
        internal communications                 3
        internal mesage format                  10
        Interrupts                              1
        ISIS                                    1
        ISIS configuration                      70
        ISIS internal communications            9
        ISIS library                            51
        ISIS mesage format                      10
        ISIS reload                             77,  79
        ISIS Rings                              9
        ISIS rings                              54
        ISIS SVC'S                              21
        ISIS system generation                  74
        IST                                     19,  68
        IZBF routine                            59
        IZT routine                             53

        KERNEL                                  1,   3

                                      89                                 ISIS-I
                                     INDEX                     December 7, 1979


        library                                 51
        loading a slot                          83
        LOOK routine                            57

        MAC                                     3,   66
        MAC initialization for slot             37
        MAC registers                           67
        manual restart crash                    22
        MCI routine                             59
        Memory Access Controller                66
        memory requirements, configuration      74
        module, symbol                          68

        Needle                                  16
        needle message                          10
        network configuration                   70
        node configuration                      70
        NORMAL circuit                          17
        NORMAL pseudo-needle message            12
        NORMAL pseudo-needle rejection message  15
        NORMAL pseudo-needle request message    15
        NRATE                                   22

        OBS routine                             55
        OCM routine                             55
        OCS routine                             55
        offline, taking a slot                  39
        online, bringing a slot                 38
        Orange Ball                             11
        output ring                             9

        packages, library                       51
        parity error crash                      22
        permuter table, slot                    20
        power failure crash                     22
        printer I/O                             28
        Priority                                1
        privilege violation crash               22
        PROM bootstrap                          82
        protection violation crash              22
        pseudo-needle                           17,  17
        PUTCH routine                           56
        PUTW routine                            56,  56

        Quasi-process                           1
        query logical unit attributes           23
        query terminal parameter message        11

        Red Ball                                11
        reload                                  77,  79
        reloading an Interdata                  79
        request-to-send                         see RS
        restart SVC                             21

                                      90                                 ISIS-I
                                     INDEX                     December 7, 1979


        restart, software                       21
        restarting a machine                    76,  79,  81
        Ring                                    9
        RING                                    54
        ROOM routine                            57
        rotor list                              24
        routing                                 5
        RS                                      24,  26

        scheduling                              1
        Scheduling                              2
        Segment                                 67
        segment registers                       67
        set terminal parameter message          11
        SLOR routine                            56
        Slot                                    2
        slot configuration                      71
        slot control flags                      19
        slot MAC initialization                 37
        slot permuter table                     20
        slot, loading                           83
        SLOWC                                   22
        software asynchronous I/O connection    26
        software connection of foreground       22
        software connection of I/O              22
        software crash recovery                 22
        software printer output connection      28
        software restart                        21
        software synch. output forced connection     25
        software synch. output normal connection     25
        software synchronous input connection   23
        software synchronous output connection  24
        SPACE routine                           56
        START-FROM-SCRATCH procedure            77,  80
        starting a machine                      76
        State Table                             19
        Supervisory Commands                    21
        SVC                                     21
        SVC, dismiss                            21
        SVC, restart                            21
        symbol module                           68
        synchronous input                       23
        Synchronous line padding                24
        synchronous output                      24
        system generation                       74

        Takeover Message                        14
        taking a slot offline                   39
        TAPE driver                             30
        temperature                             22
        terminal parameters                     11
        time (GMT) message                      15
        timeslices                              2

                                      91                                 ISIS-I
                                     INDEX                     December 7, 1979


        TIMOUT routine                          53
        TOGET routine                           54
        TONOW routine                           54
        TOPUT routine                           54
        TORET address                           53
        transparency message                    11
        TTY bootstrap                           77,  80
        TTY reload                              77,  79
        TYMNET                                  17

        virtual address space                   66

        WCD routine                             59
        WCI routine                             59

        XSIO                                    29

        Yellow Ball                             11

        ZAP                                     11


































                                      92                                 ISIS-I
vK 5